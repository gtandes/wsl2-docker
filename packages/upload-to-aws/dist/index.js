import e,{parse as t}from"url";import r,{TextDecoder as n,promisify as i}from"util";import s,{Buffer as o}from"buffer";import a,{Readable as c,Writable as l,Transform as u}from"stream";import{Agent as h,request as f}from"http";import{Agent as p,request as d}from"https";import"http2";import m,{EventEmitter as y}from"events";import g,{promises as v,lstatSync as b,fstatSync as w,readFileSync as _}from"fs";import S from"zlib";import E from"constants";import A from"assert";import k,{sep as x,join as C}from"path";import*as R from"crypto";import O,{createHash as N,createHmac as I}from"crypto";import*as T from"process";import{versions as P,env as B}from"process";import{homedir as D,platform as $,release as L}from"os";import{exec as j}from"child_process";var M=(0).constructor;M.isFinite,M.isInteger,[].constructor.isArray;new(function(){function e(e){this.size=e,this.reset()}return e.prototype.reset=function(){this.oldestIndex=0,this.map={},this.cachedKeys=new Array(this.size)},e.prototype.get=function(e){return this.map[e]},e.prototype.set=function(e,t){this.map[e]=t;var r=this.cachedKeys[this.oldestIndex];void 0!==r&&delete this.map[r],this.cachedKeys[this.oldestIndex]=e,this.oldestIndex++,this.oldestIndex%=this.size},e}())(1e3);var U="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function K(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function F(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){if(this instanceof e){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(t,r))}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var H={exports:{}},z=function(...e){try{return JSON.stringify(...e)}catch(e){return"[Cannot display object: "+e.message+"]"}};!function(e,t){const r=z;H.exports=class extends Error{constructor(e){super(e.filter((e=>""!==e)).map((e=>"string"==typeof e?e:e instanceof Error?e.message:r(e))).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}}(0,H.exports);var V=H.exports;const q=V;var G=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new q(t)}};const W=G,X={};var J=function(e,t,r){if(!1===t||null==t)return e;"string"==typeof(r=r||{})&&(r={separator:r});const n=Array.isArray(t);W(!n||!r.separator,"Separator option is not valid for array-based chain");const i=n?t:t.split(r.separator||".");let s=e;for(let e=0;e<i.length;++e){let n=i[e];const o=r.iterables&&X.iterables(s);if(Array.isArray(s)||"set"===o){const e=Number(n);Number.isInteger(e)&&(n=e<0?s.length+e:e)}if(!s||"function"==typeof s&&!1===r.functions||!o&&void 0===s[n]){W(!r.strict||e+1===i.length,"Missing segment",n,"in reach path ",t),W("object"==typeof s||!0===r.functions||"function"!=typeof s,"Invalid segment",n,"in reach path ",t),s=r.default;break}s=o?"set"===o?[...s][n]:s.get(n):s[n]}return s};X.iterables=function(e){return e instanceof Set?"set":e instanceof Map?"map":void 0};var Y={exports:{}};!function(e,t){const r={};t=Y.exports={array:Array.prototype,buffer:Buffer&&Buffer.prototype,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},r.typeMap=new Map([["[object Error]",t.error],["[object Map]",t.map],["[object Promise]",t.promise],["[object Set]",t.set],["[object WeakMap]",t.weakMap],["[object WeakSet]",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(Buffer&&e instanceof Buffer)return t.buffer;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const n=Object.prototype.toString.call(e);return r.typeMap.get(n)||t.generic}}(0,Y.exports);var Z=Y.exports,Q={keys:function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)}};const ee=J,te=Z,re=Q,ne={needsProtoHack:new Set([te.set,te.map,te.weakSet,te.weakMap])};var ie=ne.clone=function(e,t={},r=null){if("object"!=typeof e||null===e)return e;let n=ne.clone,i=r;if(t.shallow){if(!0!==t.shallow)return ne.cloneWithShallow(e,t);n=e=>e}else if(i){const t=i.get(e);if(t)return t}else i=new Map;const s=te.getInternalProto(e);if(s===te.buffer)return Buffer&&Buffer.from(e);if(s===te.date)return new Date(e.getTime());if(s===te.regex)return new RegExp(e);const o=ne.base(e,s,t);if(o===e)return e;if(i&&i.set(e,o),s===te.set)for(const r of e)o.add(n(r,t,i));else if(s===te.map)for(const[r,s]of e)o.set(r,n(s,t,i));const a=re.keys(e,t);for(const r of a){if("__proto__"===r)continue;if(s===te.array&&"length"===r){o.length=e.length;continue}const a=Object.getOwnPropertyDescriptor(e,r);a?a.get||a.set?Object.defineProperty(o,r,a):a.enumerable?o[r]=n(e[r],t,i):Object.defineProperty(o,r,{enumerable:!1,writable:!0,configurable:!0,value:n(e[r],t,i)}):Object.defineProperty(o,r,{enumerable:!0,writable:!0,configurable:!0,value:n(e[r],t,i)})}return o};ne.cloneWithShallow=function(e,t){const r=t.shallow;(t=Object.assign({},t)).shallow=!1;const n=new Map;for(const t of r){const r=ee(e,t);"object"!=typeof r&&"function"!=typeof r||n.set(r,r)}return ne.clone(e,t,n)},ne.base=function(e,t,r){if(!1===r.prototype)return ne.needsProtoHack.has(t)?new t.constructor:t===te.array?[]:{};const n=Object.getPrototypeOf(e);if(n&&n.isImmutable)return e;if(t===te.array){const e=[];return n!==t&&Object.setPrototypeOf(e,n),e}if(ne.needsProtoHack.has(t)){const e=new n.constructor;return n!==t&&Object.setPrototypeOf(e,n),e}return Object.create(n)};var se,oe={},ae={},ce={name:"joi",description:"Object schema validation",version:"17.9.2",repository:"git://github.com/hapijs/joi",main:"lib/index.js",types:"lib/index.d.ts",browser:"dist/joi-browser.min.js",files:["lib/**/*","dist/*"],keywords:["schema","validation"],dependencies:{"@hapi/hoek":"^9.0.0","@hapi/topo":"^5.0.0","@sideway/address":"^4.1.3","@sideway/formula":"^3.0.1","@sideway/pinpoint":"^2.0.0"},devDependencies:{"@hapi/bourne":"2.x.x","@hapi/code":"8.x.x","@hapi/joi-legacy-test":"npm:@hapi/joi@15.x.x","@hapi/lab":"^25.0.1","@types/node":"^14.18.24",typescript:"4.3.x"},scripts:{prepublishOnly:"cd browser && npm install && npm run build",test:"lab -t 100 -a @hapi/code -L -Y","test-cov-html":"lab -r html -o coverage.html -a @hapi/code"},license:"BSD-3-Clause"},le={};function ue(){if(se)return le;se=1;const e=xr(),t={};return t.wrap=e.string().min(1).max(2).allow(!1),le.preferences=e.object({allowUnknown:e.boolean(),abortEarly:e.boolean(),artifacts:e.boolean(),cache:e.boolean(),context:e.object(),convert:e.boolean(),dateFormat:e.valid("date","iso","string","time","utc"),debug:e.boolean(),errors:{escapeHtml:e.boolean(),label:e.valid("path","key",!1),language:[e.string(),e.object().ref()],render:e.boolean(),stack:e.boolean(),wrap:{label:t.wrap,array:t.wrap,string:t.wrap}},externals:e.boolean(),messages:e.object(),noDefaults:e.boolean(),nonEnumerables:e.boolean(),presence:e.valid("required","optional","forbidden"),skipFunctions:e.boolean(),stripUnknown:e.object({arrays:e.boolean(),objects:e.boolean()}).or("arrays","objects").allow(!0,!1),warnings:e.boolean()}).strict(),t.nameRx=/^[a-zA-Z0-9]\w*$/,t.rule=e.object({alias:e.array().items(e.string().pattern(t.nameRx)).single(),args:e.array().items(e.string(),e.object({name:e.string().pattern(t.nameRx).required(),ref:e.boolean(),assert:e.alternatives([e.function(),e.object().schema()]).conditional("ref",{is:!0,then:e.required()}),normalize:e.function(),message:e.string().when("assert",{is:e.function(),then:e.required()})})),convert:e.boolean(),manifest:e.boolean(),method:e.function().allow(!1),multi:e.boolean(),validate:e.function()}),le.extension=e.object({type:e.alternatives([e.string(),e.object().regex()]).required(),args:e.function(),cast:e.object().pattern(t.nameRx,e.object({from:e.function().maxArity(1).required(),to:e.function().minArity(1).maxArity(2).required()})),base:e.object().schema().when("type",{is:e.object().regex(),then:e.forbidden()}),coerce:[e.function().maxArity(3),e.object({method:e.function().maxArity(3).required(),from:e.array().items(e.string()).single()})],flags:e.object().pattern(t.nameRx,e.object({setter:e.string(),default:e.any()})),manifest:{build:e.function().arity(2)},messages:[e.object(),e.string()],modifiers:e.object().pattern(t.nameRx,e.function().minArity(1).maxArity(2)),overrides:e.object().pattern(t.nameRx,e.function()),prepare:e.function().maxArity(3),rebuild:e.function().arity(1),rules:e.object().pattern(t.nameRx,t.rule),terms:e.object().pattern(t.nameRx,e.object({init:e.array().allow(null).required(),manifest:e.object().pattern(/.+/,[e.valid("schema","single"),e.object({mapped:e.object({from:e.string().required(),to:e.string().required()}).required()})])})),validate:e.function().maxArity(3)}).strict(),le.extensions=e.array().items(e.object(),e.function().arity(1)).strict(),t.desc={buffer:e.object({buffer:e.string()}),func:e.object({function:e.function().required(),options:{literal:!0}}),override:e.object({override:!0}),ref:e.object({ref:e.object({type:e.valid("value","global","local"),path:e.array().required(),separator:e.string().length(1).allow(!1),ancestor:e.number().min(0).integer().allow("root"),map:e.array().items(e.array().length(2)).min(1),adjust:e.function(),iterables:e.boolean(),in:e.boolean(),render:e.boolean()}).required()}),regex:e.object({regex:e.string().min(3)}),special:e.object({special:e.valid("deep").required()}),template:e.object({template:e.string().required(),options:e.object()}),value:e.object({value:e.alternatives([e.object(),e.array()]).required()})},t.desc.entity=e.alternatives([e.array().items(e.link("...")),e.boolean(),e.function(),e.number(),e.string(),t.desc.buffer,t.desc.func,t.desc.ref,t.desc.regex,t.desc.special,t.desc.template,t.desc.value,e.link("/")]),t.desc.values=e.array().items(null,e.boolean(),e.function(),e.number().allow(1/0,-1/0),e.string().allow(""),e.symbol(),t.desc.buffer,t.desc.func,t.desc.override,t.desc.ref,t.desc.regex,t.desc.template,t.desc.value),t.desc.messages=e.object().pattern(/.+/,[e.string(),t.desc.template,e.object().pattern(/.+/,[e.string(),t.desc.template])]),le.description=e.object({type:e.string().required(),flags:e.object({cast:e.string(),default:e.any(),description:e.string(),empty:e.link("/"),failover:t.desc.entity,id:e.string(),label:e.string(),only:!0,presence:["optional","required","forbidden"],result:["raw","strip"],strip:e.boolean(),unit:e.string()}).unknown(),preferences:{allowUnknown:e.boolean(),abortEarly:e.boolean(),artifacts:e.boolean(),cache:e.boolean(),convert:e.boolean(),dateFormat:["date","iso","string","time","utc"],errors:{escapeHtml:e.boolean(),label:["path","key"],language:[e.string(),t.desc.ref],wrap:{label:t.wrap,array:t.wrap}},externals:e.boolean(),messages:t.desc.messages,noDefaults:e.boolean(),nonEnumerables:e.boolean(),presence:["required","optional","forbidden"],skipFunctions:e.boolean(),stripUnknown:e.object({arrays:e.boolean(),objects:e.boolean()}).or("arrays","objects").allow(!0,!1),warnings:e.boolean()},allow:t.desc.values,invalid:t.desc.values,rules:e.array().min(1).items({name:e.string().required(),args:e.object().min(1),keep:e.boolean(),message:[e.string(),t.desc.messages],warn:e.boolean()}),keys:e.object().pattern(/.*/,e.link("/")),link:t.desc.ref}).pattern(/^[a-z]\w*$/,e.any()),le}var he={},fe={exports:{}};const pe={};var de=function(e){if(!e)return"";let t="";for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);pe.isSafe(n)?t+=e[r]:t+=pe.escapeHtmlChar(n)}return t};pe.escapeHtmlChar=function(e){const t=pe.namedHtml.get(e);if(t)return t;if(e>=256)return"&#"+e+";";return`&#x${e.toString(16).padStart(2,"0")};`},pe.isSafe=function(e){return pe.safeCharCodes.has(e)},pe.namedHtml=new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[34,"&quot;"],[160,"&nbsp;"],[162,"&cent;"],[163,"&pound;"],[164,"&curren;"],[169,"&copy;"],[174,"&reg;"]]),pe.safeCharCodes=function(){const e=new Set;for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&e.add(t);return e}();var me={};!function(e){const t={operators:["!","^","*","/","%","+","-","<","<=",">",">=","==","!=","&&","||","??"],operatorCharacters:["!","^","*","/","%","+","-","<","=",">","&","|","?"],operatorsOrder:[["^"],["*","/","%"],["+","-"],["<","<=",">",">="],["==","!="],["&&"],["||","??"]],operatorsPrefix:["!","n"],literals:{'"':'"',"`":"`","'":"'","[":"]"},numberRx:/^(?:[0-9]*(\.[0-9]*)?){1}$/,tokenRx:/^[\w\$\#\.\@\:\{\}]+$/,symbol:Symbol("formula"),settings:Symbol("settings")};e.Parser=class{constructor(e,r={}){if(!r[t.settings]&&r.constants)for(const e in r.constants){const t=r.constants[e];if(null!==t&&!["boolean","number","string"].includes(typeof t))throw new Error(`Formula constant ${e} contains invalid ${typeof t} value type`)}this.settings=r[t.settings]?r:Object.assign({[t.settings]:!0,constants:{},functions:{}},r),this.single=null,this._parts=null,this._parse(e)}_parse(r){let n=[],i="",s=0,o=!1;const a=r=>{if(s)throw new Error("Formula missing closing parenthesis");const a=n.length?n[n.length-1]:null;if(o||i||r){if(a&&"reference"===a.type&&")"===r)return a.type="function",a.value=this._subFormula(i,a.value),void(i="");if(")"===r){const t=new e.Parser(i,this.settings);n.push({type:"segment",value:t})}else if(o){if("]"===o)return n.push({type:"reference",value:i}),void(i="");n.push({type:"literal",value:i})}else if(t.operatorCharacters.includes(i))a&&"operator"===a.type&&t.operators.includes(a.value+i)?a.value+=i:n.push({type:"operator",value:i});else if(i.match(t.numberRx))n.push({type:"constant",value:parseFloat(i)});else if(void 0!==this.settings.constants[i])n.push({type:"constant",value:this.settings.constants[i]});else{if(!i.match(t.tokenRx))throw new Error(`Formula contains invalid token: ${i}`);n.push({type:"reference",value:i})}i=""}};for(const e of r)o?e===o?(a(),o=!1):i+=e:s?"("===e?(i+=e,++s):")"===e?(--s,s?i+=e:a(e)):i+=e:e in t.literals?o=t.literals[e]:"("===e?(a(),++s):t.operatorCharacters.includes(e)?(a(),i=e,a()):" "!==e?i+=e:a();a(),n=n.map(((e,t)=>"operator"!==e.type||"-"!==e.value||t&&"operator"!==n[t-1].type?e:{type:"operator",value:"n"}));let c=!1;for(const e of n){if("operator"===e.type){if(t.operatorsPrefix.includes(e.value))continue;if(!c)throw new Error("Formula contains an operator in invalid position");if(!t.operators.includes(e.value))throw new Error(`Formula contains an unknown operator ${e.value}`)}else if(c)throw new Error("Formula missing expected operator");c=!c}if(!c)throw new Error("Formula contains invalid trailing operator");1===n.length&&["reference","literal","constant"].includes(n[0].type)&&(this.single={type:"reference"===n[0].type?"reference":"value",value:n[0].value}),this._parts=n.map((e=>{if("operator"===e.type)return t.operatorsPrefix.includes(e.value)?e:e.value;if("reference"!==e.type)return e.value;if(this.settings.tokenRx&&!this.settings.tokenRx.test(e.value))throw new Error(`Formula contains invalid reference ${e.value}`);return this.settings.reference?this.settings.reference(e.value):t.reference(e.value)}))}_subFormula(r,n){const i=this.settings.functions[n];if("function"!=typeof i)throw new Error(`Formula contains unknown function ${n}`);let s=[];if(r){let e="",i=0,o=!1;const a=()=>{if(!e)throw new Error(`Formula contains function ${n} with invalid arguments ${r}`);s.push(e),e=""};for(let n=0;n<r.length;++n){const s=r[n];o?(e+=s,s===o&&(o=!1)):s in t.literals&&!i?(e+=s,o=t.literals[s]):","!==s||i?(e+=s,"("===s?++i:")"===s&&--i):a()}a()}return s=s.map((t=>new e.Parser(t,this.settings))),function(e){const t=[];for(const r of s)t.push(r.evaluate(e));return i.call(e,...t)}}evaluate(e){const r=this._parts.slice();for(let n=r.length-2;n>=0;--n){const i=r[n];if(i&&"operator"===i.type){const s=r[n+1];r.splice(n+1,1);const o=t.evaluate(s,e);r[n]=t.single(i.value,o)}}return t.operatorsOrder.forEach((n=>{for(let i=1;i<r.length-1;)if(n.includes(r[i])){const n=r[i],s=t.evaluate(r[i-1],e),o=t.evaluate(r[i+1],e);r.splice(i,2);const a=t.calculate(n,s,o);r[i-1]=0===a?0:a}else i+=2})),t.evaluate(r[0],e)}},e.Parser.prototype[t.symbol]=!0,t.reference=function(e){return function(t){return t&&void 0!==t[e]?t[e]:null}},t.evaluate=function(e,r){return null===e?null:"function"==typeof e?e(r):e[t.symbol]?e.evaluate(r):e},t.single=function(e,t){if("!"===e)return!t;const r=-t;return 0===r?0:r},t.calculate=function(e,r,n){if("??"===e)return t.exists(r)?r:n;if("string"==typeof r||"string"==typeof n){if("+"===e)return(r=t.exists(r)?r:"")+(n=t.exists(n)?n:"")}else switch(e){case"^":return Math.pow(r,n);case"*":return r*n;case"/":return r/n;case"%":return r%n;case"+":return r+n;case"-":return r-n}switch(e){case"<":return r<n;case"<=":return r<=n;case">":return r>n;case">=":return r>=n;case"==":return r===n;case"!=":return r!==n;case"&&":return r&&n;case"||":return r||n}return null},t.exists=function(e){return null!=e}}(me);var ye,ge,ve={},be={};function we(){if(ye)return be;ye=1;const e=ie,t=Ie(),r={annotations:Symbol("annotations")};return be.error=function(n){if(!this._original||"object"!=typeof this._original)return this.details[0].message;const i=n?"":"[31m",s=n?"":"[41m",o=n?"":"[0m",a=e(this._original);for(let e=this.details.length-1;e>=0;--e){const n=e+1,i=this.details[e],s=i.path;let o=a;for(let e=0;;++e){const a=s[e];if(t.isSchema(o)&&(o=o.clone()),!(e+1<s.length&&"string"!=typeof o[a])){const e=o[r.annotations]||{errors:{},missing:{}};o[r.annotations]=e;const t=a||i.context.key;void 0!==o[a]?(e.errors[t]=e.errors[t]||[],e.errors[t].push(n)):e.missing[t]=n;break}o=o[a]}}const c=/_\$key\$_([, \d]+)_\$end\$_"/g,l=/"_\$miss\$_([^|]+)\|(\d+)_\$end\$_": "__missing__"/g,u=/\s*"_\$idx\$_([, \d]+)_\$end\$_",?\n(.*)/g,h=/"\[(NaN|Symbol.*|-?Infinity|function.*|\(.*)]"/g;let f=r.safeStringify(a,2).replace(c,((e,t)=>`" ${i}[${t}]${o}`)).replace(l,((e,t,r)=>`${s}"${t}"${o}${i} [${r}]: -- missing --${o}`)).replace(u,((e,t,r)=>`\n${r} ${i}[${t}]${o}`)).replace(h,((e,t)=>t));f=`${f}\n${i}`;for(let e=0;e<this.details.length;++e){f=`${f}\n[${e+1}] ${this.details[e].message}`}return f+=o,f},r.safeStringify=function(e,t){return JSON.stringify(e,r.serializer(),t)},r.serializer=function(){const e=[],t=[],n=(r,n)=>t[0]===n?"[Circular ~]":"[Circular ~."+e.slice(0,t.indexOf(n)).join(".")+"]";return function(i,s){if(t.length>0){const r=t.indexOf(this);~r?(t.length=r+1,e.length=r+1,e[r]=i):(t.push(this),e.push(i)),~t.indexOf(s)&&(s=n.call(this,i,s))}else t.push(s);if(s){const e=s[r.annotations];if(e){if(Array.isArray(s)){const t=[];for(let r=0;r<s.length;++r)e.errors[r]&&t.push(`_$idx$_${e.errors[r].sort().join(", ")}_$end$_`),t.push(s[r]);s=t}else{for(const t in e.errors)s[`${t}_$key$_${e.errors[t].sort().join(", ")}_$end$_`]=s[t],s[t]=void 0;for(const t in e.missing)s[`_$miss$_${t}|${e.missing[t]}_$end$_`]="__missing__"}return s}}return s===1/0||s===-1/0||Number.isNaN(s)||"function"==typeof s||"symbol"==typeof s?"["+s.toString()+"]":s}},be}function _e(){return ge||(ge=1,function(e){const t=we(),r=Ie(),n=Oe();e.Report=class{constructor(t,r,n,i,s,o,a){if(this.code=t,this.flags=i,this.messages=s,this.path=o.path,this.prefs=a,this.state=o,this.value=r,this.message=null,this.template=null,this.local=n||{},this.local.label=e.label(this.flags,this.state,this.prefs,this.messages),void 0===this.value||this.local.hasOwnProperty("value")||(this.local.value=this.value),this.path.length){const e=this.path[this.path.length-1];"object"!=typeof e&&(this.local.key=e)}}_setTemplate(e){if(this.template=e,!this.flags.label&&0===this.path.length){const e=this._template(this.template,"root");e&&(this.local.label=e)}}toString(){if(this.message)return this.message;const e=this.code;if(!this.prefs.errors.render)return this.code;const t=this._template(this.template)||this._template(this.prefs.messages)||this._template(this.messages);return void 0===t?`Error code "${e}" is not defined, your custom type is missing the correct messages definition`:(this.message=t.render(this.value,this.state,this.prefs,this.local,{errors:this.prefs.errors,messages:[this.prefs.messages,this.messages]}),this.prefs.errors.label||(this.message=this.message.replace(/^"" /,"").trim()),this.message)}_template(t,r){return e.template(this.value,t,r||this.code,this.state,this.prefs)}},e.path=function(e){let t="";for(const r of e)"object"!=typeof r&&("string"==typeof r?(t&&(t+="."),t+=r):t+=`[${r}]`);return t},e.template=function(e,t,i,s,o){if(!t)return;if(n.isTemplate(t))return"root"!==i?t:null;let a=o.errors.language;if(r.isResolvable(a)&&(a=a.resolve(e,s,o)),a&&t[a]){if(void 0!==t[a][i])return t[a][i];if(void 0!==t[a]["*"])return t[a]["*"]}return t[i]?t[i]:t["*"]},e.label=function(t,r,n,i){if(t.label)return t.label;if(!n.errors.label)return"";let s=r.path;"key"===n.errors.label&&r.path.length>1&&(s=r.path.slice(-1));const o=e.path(s);return o||(e.template(null,n.messages,"root",r,n)||i&&e.template(null,i,"root",r,n)||"value")},e.process=function(t,r,n){if(!t)return null;const{override:i,message:s,details:o}=e.details(t);if(i)return i;if(n.errors.stack)return new e.ValidationError(s,o,r);const a=Error.stackTraceLimit;Error.stackTraceLimit=0;const c=new e.ValidationError(s,o,r);return Error.stackTraceLimit=a,c},e.details=function(e,t={}){let r=[];const n=[];for(const i of e){if(i instanceof Error){if(!1!==t.override)return{override:i};const e=i.toString();r.push(e),n.push({message:e,type:"override",context:{error:i}});continue}const e=i.toString();r.push(e),n.push({message:e,path:i.path.filter((e=>"object"!=typeof e)),type:i.code,context:i.local})}return r.length>1&&(r=[...new Set(r)]),{message:r.join(". "),details:n}},e.ValidationError=class extends Error{constructor(e,t,r){super(e),this._original=r,this.details=t}static isError(t){return t instanceof e.ValidationError}},e.ValidationError.prototype.isJoi=!0,e.ValidationError.prototype.name="ValidationError",e.ValidationError.prototype.annotate=t.error}(ve)),ve}var Se,Ee,Ae,ke,xe,Ce={};function Re(){return Se||(Se=1,function(e){const t=G,r=ie,n=J,i=Ie();let s;const o={symbol:Symbol("ref"),defaults:{adjust:null,in:!1,iterables:null,map:null,separator:".",type:"value"}};e.create=function(e,r={}){t("string"==typeof e,"Invalid reference key:",e),i.assertOptions(r,["adjust","ancestor","in","iterables","map","prefix","render","separator"]),t(!r.prefix||"object"==typeof r.prefix,"options.prefix must be of type object");const n=Object.assign({},o.defaults,r);delete n.prefix;const s=n.separator,a=o.context(e,s,r.prefix);if(n.type=a.type,e=a.key,"value"===n.type)if(a.root&&(t(!s||e[0]!==s,"Cannot specify relative path with root prefix"),n.ancestor="root",e||(e=null)),s&&s===e)e=null,n.ancestor=0;else if(void 0!==n.ancestor)t(!s||!e||e[0]!==s,"Cannot combine prefix with ancestor option");else{const[t,r]=o.ancestor(e,s);r&&""===(e=e.slice(r))&&(e=null),n.ancestor=t}return n.path=s?null===e?[]:e.split(s):[e],new o.Ref(n)},e.in=function(t,r={}){return e.create(t,{...r,in:!0})},e.isRef=function(e){return!!e&&!!e[i.symbols.ref]},o.Ref=class{constructor(e){t("object"==typeof e,"Invalid reference construction"),i.assertOptions(e,["adjust","ancestor","in","iterables","map","path","render","separator","type","depth","key","root","display"]),t([!1,void 0].includes(e.separator)||"string"==typeof e.separator&&1===e.separator.length,"Invalid separator"),t(!e.adjust||"function"==typeof e.adjust,"options.adjust must be a function"),t(!e.map||Array.isArray(e.map),"options.map must be an array"),t(!e.map||!e.adjust,"Cannot set both map and adjust options"),Object.assign(this,o.defaults,e),t("value"===this.type||void 0===this.ancestor,"Non-value references cannot reference ancestors"),Array.isArray(this.map)&&(this.map=new Map(this.map)),this.depth=this.path.length,this.key=this.path.length?this.path.join(this.separator):null,this.root=this.path[0],this.updateDisplay()}resolve(e,r,n,i,s={}){return t(!this.in||s.in,"Invalid in() reference usage"),"global"===this.type?this._resolve(n.context,r,s):"local"===this.type?this._resolve(i,r,s):this.ancestor?"root"===this.ancestor?this._resolve(r.ancestors[r.ancestors.length-1],r,s):(t(this.ancestor<=r.ancestors.length,"Invalid reference exceeds the schema root:",this.display),this._resolve(r.ancestors[this.ancestor-1],r,s)):this._resolve(e,r,s)}_resolve(e,t,r){let i;if("value"===this.type&&t.mainstay.shadow&&!1!==r.shadow&&(i=t.mainstay.shadow.get(this.absolute(t))),void 0===i&&(i=n(e,this.path,{iterables:this.iterables,functions:!0})),this.adjust&&(i=this.adjust(i)),this.map){const e=this.map.get(i);void 0!==e&&(i=e)}return t.mainstay&&t.mainstay.tracer.resolve(t,this,i),i}toString(){return this.display}absolute(e){return[...e.path.slice(0,-this.ancestor),...this.path]}clone(){return new o.Ref(this)}describe(){const e={path:this.path};"value"!==this.type&&(e.type=this.type),"."!==this.separator&&(e.separator=this.separator),"value"===this.type&&1!==this.ancestor&&(e.ancestor=this.ancestor),this.map&&(e.map=[...this.map]);for(const t of["adjust","iterables","render"])null!==this[t]&&void 0!==this[t]&&(e[t]=this[t]);return!1!==this.in&&(e.in=!0),{ref:e}}updateDisplay(){const e=null!==this.key?this.key:"";if("value"!==this.type)return void(this.display=`ref:${this.type}:${e}`);if(!this.separator)return void(this.display=`ref:${e}`);if(!this.ancestor)return void(this.display=`ref:${this.separator}${e}`);if("root"===this.ancestor)return void(this.display=`ref:root:${e}`);if(1===this.ancestor)return void(this.display=`ref:${e||".."}`);const t=new Array(this.ancestor+1).fill(this.separator).join("");this.display=`ref:${t}${e||""}`}},o.Ref.prototype[i.symbols.ref]=!0,e.build=function(e){return"value"===(e=Object.assign({},o.defaults,e)).type&&void 0===e.ancestor&&(e.ancestor=1),new o.Ref(e)},o.context=function(e,t,r={}){if(e=e.trim(),r){const n=void 0===r.global?"$":r.global;if(n!==t&&e.startsWith(n))return{key:e.slice(n.length),type:"global"};const i=void 0===r.local?"#":r.local;if(i!==t&&e.startsWith(i))return{key:e.slice(i.length),type:"local"};const s=void 0===r.root?"/":r.root;if(s!==t&&e.startsWith(s))return{key:e.slice(s.length),type:"value",root:!0}}return{key:e,type:"value"}},o.ancestor=function(e,t){if(!t)return[1,0];if(e[0]!==t)return[1,0];if(e[1]!==t)return[0,1];let r=2;for(;e[r]===t;)++r;return[r-1,r]},e.toSibling=0,e.toParent=1,e.Manager=class{constructor(){this.refs=[]}register(t,r){if(t)if(r=void 0===r?e.toParent:r,Array.isArray(t))for(const e of t)this.register(e,r);else if(i.isSchema(t))for(const e of t._refs.refs)e.ancestor-r>=0&&this.refs.push({ancestor:e.ancestor-r,root:e.root});else e.isRef(t)&&"value"===t.type&&t.ancestor-r>=0&&this.refs.push({ancestor:t.ancestor-r,root:t.root}),s=s||Oe(),s.isTemplate(t)&&this.register(t.refs(),r)}get length(){return this.refs.length}clone(){const t=new e.Manager;return t.refs=r(this.refs),t}reset(){this.refs=[]}roots(){return this.refs.filter((e=>!e.ancestor)).map((e=>e.root))}}}(Ce)),Ce}function Oe(){return Ee||(Ee=1,function(e,t){const r=G,n=ie,i=de,s=me,o=Ie(),a=_e(),c=Re(),l={symbol:Symbol("template"),opens:new Array(1e3).join("\0"),closes:new Array(1e3).join(""),dateFormat:{date:Date.prototype.toDateString,iso:Date.prototype.toISOString,string:Date.prototype.toString,time:Date.prototype.toTimeString,utc:Date.prototype.toUTCString}};e.exports=l.Template=class{constructor(e,t){r("string"==typeof e,"Template source must be a string"),r(!e.includes("\0")&&!e.includes(""),"Template source cannot contain reserved control characters"),this.source=e,this.rendered=e,this._template=null,this._settings=n(t),this._parse()}_parse(){if(!this.source.includes("{"))return;const e=l.encode(this.source),t=l.split(e);let r=!1;const n=[],i=t.shift();i&&n.push(i);for(const e of t){const t="{"!==e[0],i=t?"}":"}}",s=e.indexOf(i);if(-1===s||"{"===e[1]){n.push(`{${l.decode(e)}`);continue}let o=e.slice(t?0:1,s);const a=":"===o[0];a&&(o=o.slice(1));const c=this._ref(l.decode(o),{raw:t,wrapped:a});n.push(c),"string"!=typeof c&&(r=!0);const u=e.slice(s+i.length);u&&n.push(l.decode(u))}r?this._template=n:this.rendered=n.join("")}static date(e,t){return l.dateFormat[t.dateFormat].call(e)}describe(e={}){if(!this._settings&&e.compact)return this.source;const t={template:this.source};return this._settings&&(t.options=this._settings),t}static build(e){return new l.Template(e.template,e.options)}isDynamic(){return!!this._template}static isTemplate(e){return!!e&&!!e[o.symbols.template]}refs(){if(!this._template)return;const e=[];for(const t of this._template)"string"!=typeof t&&e.push(...t.refs);return e}resolve(e,t,r,n){return this._template&&1===this._template.length?this._part(this._template[0],e,t,r,n,{}):this.render(e,t,r,n)}_part(e,...t){return e.ref?e.ref.resolve(...t):e.formula.evaluate(t)}render(e,t,r,n,s={}){if(!this.isDynamic())return this.rendered;const o=[];for(const a of this._template)if("string"==typeof a)o.push(a);else{const c=this._part(a,e,t,r,n,s),u=l.stringify(c,e,t,r,n,s);if(void 0!==u){const e=a.raw||!1===(s.errors&&s.errors.escapeHtml)?u:i(u);o.push(l.wrap(e,a.wrapped&&r.errors.wrap.label))}}return o.join("")}_ref(e,{raw:t,wrapped:r}){const n=[],i=e=>{const t=c.create(e,this._settings);return n.push(t),e=>t.resolve(...e)};try{var o=new s.Parser(e,{reference:i,functions:l.functions,constants:l.constants})}catch(t){throw t.message=`Invalid template variable "${e}" fails due to: ${t.message}`,t}if(o.single){if("reference"===o.single.type){const e=n[0];return{ref:e,raw:t,refs:n,wrapped:r||"local"===e.type&&"label"===e.key}}return l.stringify(o.single.value)}return{formula:o,raw:t,refs:n}}toString(){return this.source}},l.Template.prototype[o.symbols.template]=!0,l.Template.prototype.isImmutable=!0,l.encode=function(e){return e.replace(/\\(\{+)/g,((e,t)=>l.opens.slice(0,t.length))).replace(/\\(\}+)/g,((e,t)=>l.closes.slice(0,t.length)))},l.decode=function(e){return e.replace(/\u0000/g,"{").replace(/\u0001/g,"}")},l.split=function(e){const t=[];let r="";for(let n=0;n<e.length;++n){const i=e[n];if("{"===i){let i="";for(;n+1<e.length&&"{"===e[n+1];)i+="{",++n;t.push(r),r=i}else r+=i}return t.push(r),t},l.wrap=function(e,t){return t?1===t.length?`${t}${e}${t}`:`${t[0]}${e}${t[1]}`:e},l.stringify=function(e,t,r,n,i,s={}){const o=typeof e,a=n&&n.errors&&n.errors.wrap||{};let u=!1;if(c.isRef(e)&&e.render&&(u=e.in,e=e.resolve(t,r,n,i,{in:e.in,...s})),null===e)return"null";if("string"===o)return l.wrap(e,s.arrayItems&&a.string);if("number"===o||"function"===o||"symbol"===o)return e.toString();if("object"!==o)return JSON.stringify(e);if(e instanceof Date)return l.Template.date(e,n);if(e instanceof Map){const t=[];for(const[r,n]of e.entries())t.push(`${r.toString()} -> ${n.toString()}`);e=t}if(!Array.isArray(e))return e.toString();const h=[];for(const o of e)h.push(l.stringify(o,t,r,n,i,{arrayItems:!0,...s}));return l.wrap(h.join(", "),!u&&a.array)},l.constants={true:!0,false:!1,null:null,second:1e3,minute:6e4,hour:36e5,day:864e5},l.functions={if:(e,t,r)=>e?t:r,length:e=>"string"==typeof e?e.length:e&&"object"==typeof e?Array.isArray(e)?e.length:Object.keys(e).length:null,msg(e){const[t,r,n,i,s]=this,o=s.messages;if(!o)return"";const c=a.template(t,o[0],e,r,n)||a.template(t,o[1],e,r,n);return c?c.render(t,r,n,i,s):""},number:e=>"number"==typeof e?e:"string"==typeof e?parseFloat(e):"boolean"==typeof e?e?1:0:e instanceof Date?e.getTime():null}}(fe)),fe.exports}function Ne(){return Ae||(Ae=1,function(e){const t=G,r=ie,n=Oe();e.compile=function(e,i){if("string"==typeof e)return t(!i,"Cannot set single message string"),new n(e);if(n.isTemplate(e))return t(!i,"Cannot set single message template"),e;t("object"==typeof e&&!Array.isArray(e),"Invalid message options"),i=i?r(i):{};for(let r in e){const s=e[r];if("root"===r||n.isTemplate(s)){i[r]=s;continue}if("string"==typeof s){i[r]=new n(s);continue}t("object"==typeof s&&!Array.isArray(s),"Invalid message for",r);const o=r;for(r in i[o]=i[o]||{},s){const e=s[r];"root"===r||n.isTemplate(e)?i[o][r]=e:(t("string"==typeof e,"Invalid message for",r,"in",o),i[o][r]=new n(e))}}return i},e.decompile=function(e){const t={};for(let r in e){const i=e[r];if("root"===r){t.root=i;continue}if(n.isTemplate(i)){t[r]=i.describe({compact:!0});continue}const s=r;for(r in t[s]={},i){const e=i[r];"root"!==r?t[s][r]=e.describe({compact:!0}):t[s].root=e}}return t},e.merge=function(i,s){if(!i)return e.compile(s);if(!s)return i;if("string"==typeof s)return new n(s);if(n.isTemplate(s))return s;const o=r(i);for(let e in s){const r=s[e];if("root"===e||n.isTemplate(r)){o[e]=r;continue}if("string"==typeof r){o[e]=new n(r);continue}t("object"==typeof r&&!Array.isArray(r),"Invalid message for",e);const i=e;for(e in o[i]=o[i]||{},r){const s=r[e];"root"===e||n.isTemplate(s)?o[i][e]=s:(t("string"==typeof s,"Invalid message for",e,"in",i),o[i][e]=new n(s))}}return o}}(he)),he}function Ie(){return ke||(ke=1,function(e){const t=G,r=V,n=ce;let i,s;const o={isoDate:/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/};e.version=n.version,e.defaults={abortEarly:!0,allowUnknown:!1,artifacts:!1,cache:!0,context:null,convert:!0,dateFormat:"iso",errors:{escapeHtml:!1,label:"path",language:null,render:!0,stack:!1,wrap:{label:'"',array:"[]"}},externals:!0,messages:{},nonEnumerables:!1,noDefaults:!1,presence:"optional",skipFunctions:!1,stripUnknown:!1,warnings:!1},e.symbols={any:Symbol.for("@hapi/joi/schema"),arraySingle:Symbol("arraySingle"),deepDefault:Symbol("deepDefault"),errors:Symbol("errors"),literal:Symbol("literal"),override:Symbol("override"),parent:Symbol("parent"),prefs:Symbol("prefs"),ref:Symbol("ref"),template:Symbol("template"),values:Symbol("values")},e.assertOptions=function(e,r,n="Options"){t(e&&"object"==typeof e&&!Array.isArray(e),"Options must be of type object");const i=Object.keys(e).filter((e=>!r.includes(e)));t(0===i.length,`${n} contain unknown keys: ${i}`)},e.checkPreferences=function(e){s=s||ue();const t=s.preferences.validate(e);if(t.error)throw new r([t.error.details[0].message])},e.compare=function(e,t,r){switch(r){case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}},e.default=function(e,t){return void 0===e?t:e},e.isIsoDate=function(e){return o.isoDate.test(e)},e.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},e.isResolvable=function(t){return!!t&&(t[e.symbols.ref]||t[e.symbols.template])},e.isSchema=function(r,n={}){const i=r&&r[e.symbols.any];return!!i&&(t(n.legacy||i.version===e.version,"Cannot mix different versions of joi schemas"),!0)},e.isValues=function(t){return t[e.symbols.values]},e.limit=function(e){return Number.isSafeInteger(e)&&e>=0},e.preferences=function(t,r){i=i||Ne(),t=t||{},r=r||{};const n=Object.assign({},t,r);return r.errors&&t.errors&&(n.errors=Object.assign({},t.errors,r.errors),n.errors.wrap=Object.assign({},t.errors.wrap,r.errors.wrap)),r.messages&&(n.messages=i.compile(r.messages,t.messages)),delete n[e.symbols.prefs],n},e.tryWithPath=function(e,t,r={}){try{return e()}catch(e){throw void 0!==e.path?e.path=t+"."+e.path:e.path=t,r.append&&(e.message=`${e.message} (${e.path})`),e}},e.validateArg=function(t,r,{assert:n,message:i}){if(e.isSchema(n)){const e=n.validate(t);if(!e.error)return;return e.error.message}if(!n(t))return r?`${r} ${i}`:i},e.verifyFlat=function(e,r){for(const n of e)t(!Array.isArray(n),"Method no longer accepts array arguments:",r)}}(ae)),ae}function Te(){if(xe)return oe;xe=1;const e=G,t=ie,r=Ie(),n={max:1e3,supported:new Set(["undefined","boolean","number","string"])};return oe.provider={provision:e=>new n.Cache(e)},n.Cache=class{constructor(t={}){r.assertOptions(t,["max"]),e(void 0===t.max||t.max&&t.max>0&&isFinite(t.max),"Invalid max cache size"),this._max=t.max||n.max,this._map=new Map,this._list=new n.List}get length(){return this._map.size}set(e,t){if(null!==e&&!n.supported.has(typeof e))return;let r=this._map.get(e);if(r)return r.value=t,void this._list.first(r);r=this._list.unshift({key:e,value:t}),this._map.set(e,r),this._compact()}get(e){const r=this._map.get(e);if(r)return this._list.first(r),t(r.value)}_compact(){if(this._map.size>this._max){const e=this._list.pop();this._map.delete(e.key)}}},n.List=class{constructor(){this.tail=null,this.head=null}unshift(e){return e.next=null,e.prev=this.head,this.head&&(this.head.next=e),this.head=e,this.tail||(this.tail=e),e}first(e){e!==this.head&&(this._remove(e),this.unshift(e))}pop(){return this._remove(this.tail)}_remove(e){const{next:t,prev:r}=e;return t.prev=r,r&&(r.next=t),e===this.tail&&(this.tail=t),e.prev=null,e.next=null,e}},oe}var Pe,Be={};function De(){return Pe||(Pe=1,function(e){const t=G,r=Ie(),n=Re(),i={};e.schema=function(e,t,n={}){r.assertOptions(n,["appendPath","override"]);try{return i.schema(e,t,n)}catch(e){throw n.appendPath&&void 0!==e.path&&(e.message=`${e.message} (${e.path})`),e}},i.schema=function(e,n,s){t(void 0!==n,"Invalid undefined schema"),Array.isArray(n)&&(t(n.length,"Invalid empty array schema"),1===n.length&&(n=n[0]));const o=(t,...r)=>!1!==s.override?t.valid(e.override,...r):t.valid(...r);if(i.simple(n))return o(e,n);if("function"==typeof n)return e.custom(n);if(t("object"==typeof n,"Invalid schema content:",typeof n),r.isResolvable(n))return o(e,n);if(r.isSchema(n))return n;if(Array.isArray(n)){for(const t of n)if(!i.simple(t))return e.alternatives().try(...n);return o(e,...n)}return n instanceof RegExp?e.string().regex(n):n instanceof Date?o(e.date(),n):(t(Object.getPrototypeOf(n)===Object.getPrototypeOf({}),"Schema can only contain plain objects"),e.object().keys(n))},e.ref=function(e,t){return n.isRef(e)?e:n.create(e,t)},e.compile=function(n,s,o={}){r.assertOptions(o,["legacy"]);const a=s&&s[r.symbols.any];if(a)return t(o.legacy||a.version===r.version,"Cannot mix different versions of joi schemas:",a.version,r.version),s;if("object"!=typeof s||!o.legacy)return e.schema(n,s,{appendPath:!0});const c=i.walk(s);return c?c.compile(c.root,s):e.schema(n,s,{appendPath:!0})},i.walk=function(e){if("object"!=typeof e)return null;if(Array.isArray(e)){for(const t of e){const e=i.walk(t);if(e)return e}return null}const n=e[r.symbols.any];if(n)return{root:e[n.root],compile:n.compile};t(Object.getPrototypeOf(e)===Object.getPrototypeOf({}),"Schema can only contain plain objects");for(const t in e){const r=i.walk(e[t]);if(r)return r}return null},i.simple=function(e){return null===e||["boolean","string","number"].includes(typeof e)},e.when=function(s,o,a){if(void 0===a&&(t(o&&"object"==typeof o,"Missing options"),a=o,o=n.create(".")),Array.isArray(a)&&(a={switch:a}),r.assertOptions(a,["is","not","then","otherwise","switch","break"]),r.isSchema(o))return t(void 0===a.is,'"is" can not be used with a schema condition'),t(void 0===a.not,'"not" can not be used with a schema condition'),t(void 0===a.switch,'"switch" can not be used with a schema condition'),i.condition(s,{is:o,then:a.then,otherwise:a.otherwise,break:a.break});if(t(n.isRef(o)||"string"==typeof o,"Invalid condition:",o),t(void 0===a.not||void 0===a.is,'Cannot combine "is" with "not"'),void 0===a.switch){let c=a;void 0!==a.not&&(c={is:a.not,then:a.otherwise,otherwise:a.then,break:a.break});let l=void 0!==c.is?s.$_compile(c.is):s.$_root.invalid(null,!1,0,"").required();return t(void 0!==c.then||void 0!==c.otherwise,'options must have at least one of "then", "otherwise", or "switch"'),t(void 0===c.break||void 0===c.then||void 0===c.otherwise,"Cannot specify then, otherwise, and break all together"),void 0===a.is||n.isRef(a.is)||r.isSchema(a.is)||(l=l.required()),i.condition(s,{ref:e.ref(o),is:l,then:c.then,otherwise:c.otherwise,break:c.break})}t(Array.isArray(a.switch),'"switch" must be an array'),t(void 0===a.is,'Cannot combine "switch" with "is"'),t(void 0===a.not,'Cannot combine "switch" with "not"'),t(void 0===a.then,'Cannot combine "switch" with "then"');const c={ref:e.ref(o),switch:[],break:a.break};for(let e=0;e<a.switch.length;++e){const i=a.switch[e],o=e===a.switch.length-1;r.assertOptions(i,o?["is","then","otherwise"]:["is","then"]),t(void 0!==i.is,'Switch statement missing "is"'),t(void 0!==i.then,'Switch statement missing "then"');const l={is:s.$_compile(i.is),then:s.$_compile(i.then)};if(n.isRef(i.is)||r.isSchema(i.is)||(l.is=l.is.required()),o){t(void 0===a.otherwise||void 0===i.otherwise,'Cannot specify "otherwise" inside and outside a "switch"');const e=void 0!==a.otherwise?a.otherwise:i.otherwise;void 0!==e&&(t(void 0===c.break,"Cannot specify both otherwise and break"),l.otherwise=s.$_compile(e))}c.switch.push(l)}return c},i.condition=function(e,t){for(const r of["then","otherwise"])void 0===t[r]?delete t[r]:t[r]=e.$_compile(t[r]);return t}}(Be)),Be}var $e,Le={};function je(){if($e)return Le;$e=1;const e=G,t=ie,r=Ie(),n=Ne(),i={};return Le.type=function(s,o){const a=Object.getPrototypeOf(s),c=t(a),l=s._assign(Object.create(c)),u=Object.assign({},o);delete u.base,c._definition=u;const h=a._definition||{};u.messages=n.merge(h.messages,u.messages),u.properties=Object.assign({},h.properties,u.properties),l.type=u.type,u.flags=Object.assign({},h.flags,u.flags);const f=Object.assign({},h.terms);if(u.terms)for(const t in u.terms){const r=u.terms[t];e(void 0===l.$_terms[t],"Invalid term override for",u.type,t),l.$_terms[t]=r.init,f[t]=r}u.terms=f,u.args||(u.args=h.args),u.prepare=i.prepare(u.prepare,h.prepare),u.coerce&&("function"==typeof u.coerce&&(u.coerce={method:u.coerce}),u.coerce.from&&!Array.isArray(u.coerce.from)&&(u.coerce={method:u.coerce.method,from:[].concat(u.coerce.from)})),u.coerce=i.coerce(u.coerce,h.coerce),u.validate=i.validate(u.validate,h.validate);const p=Object.assign({},h.rules);if(u.rules)for(const t in u.rules){const n=u.rules[t];e("object"==typeof n,"Invalid rule definition for",u.type,t);let i=n.method;if(void 0===i&&(i=function(){return this.$_addRule(t)}),i&&(e(!c[t],"Rule conflict in",u.type,t),c[t]=i),e(!p[t],"Rule conflict in",u.type,t),p[t]=n,n.alias){const e=[].concat(n.alias);for(const t of e)c[t]=n.method}n.args&&(n.argsByName=new Map,n.args=n.args.map((t=>("string"==typeof t&&(t={name:t}),e(!n.argsByName.has(t.name),"Duplicated argument name",t.name),r.isSchema(t.assert)&&(t.assert=t.assert.strict().label(t.name)),n.argsByName.set(t.name,t),t))))}u.rules=p;const d=Object.assign({},h.modifiers);if(u.modifiers)for(const t in u.modifiers){e(!c[t],"Rule conflict in",u.type,t);const r=u.modifiers[t];e("function"==typeof r,"Invalid modifier definition for",u.type,t);const n=function(e){return this.rule({[t]:e})};c[t]=n,d[t]=r}if(u.modifiers=d,u.overrides){c._super=a,l.$_super={};for(const t in u.overrides)e(a[t],"Cannot override missing",t),u.overrides[t][r.symbols.parent]=a[t],l.$_super[t]=a[t].bind(l);Object.assign(c,u.overrides)}u.cast=Object.assign({},h.cast,u.cast);const m=Object.assign({},h.manifest,u.manifest);return m.build=i.build(u.manifest&&u.manifest.build,h.manifest&&h.manifest.build),u.manifest=m,u.rebuild=i.rebuild(u.rebuild,h.rebuild),l},i.build=function(e,t){return e&&t?function(r,n){return t(e(r,n),n)}:e||t},i.coerce=function(e,t){return e&&t?{from:e.from&&t.from?[...new Set([...e.from,...t.from])]:null,method(r,n){let i;if((!t.from||t.from.includes(typeof r))&&(i=t.method(r,n),i)){if(i.errors||void 0===i.value)return i;r=i.value}if(!e.from||e.from.includes(typeof r)){const t=e.method(r,n);if(t)return t}return i}}:e||t},i.prepare=function(e,t){return e&&t?function(r,n){const i=e(r,n);if(i){if(i.errors||void 0===i.value)return i;r=i.value}return t(r,n)||i}:e||t},i.rebuild=function(e,t){return e&&t?function(r){t(r),e(r)}:e||t},i.validate=function(e,t){return e&&t?function(r,n){const i=t(r,n);if(i){if(i.errors&&(!Array.isArray(i.errors)||i.errors.length))return i;r=i.value}return e(r,n)||i}:e||t},Le}var Me,Ue={};function Ke(){if(Me)return Ue;Me=1;const e=G,t=ie,r=Ie(),n=Ne(),i=Re(),s=Oe();let o;const a={};return Ue.describe=function(i){const s=i._definition,o={type:i.type,flags:{},rules:[]};for(const e in i._flags)"_"!==e[0]&&(o.flags[e]=a.describe(i._flags[e]));Object.keys(o.flags).length||delete o.flags,i._preferences&&(o.preferences=t(i._preferences,{shallow:["messages"]}),delete o.preferences[r.symbols.prefs],o.preferences.messages&&(o.preferences.messages=n.decompile(o.preferences.messages))),i._valids&&(o.allow=i._valids.describe()),i._invalids&&(o.invalid=i._invalids.describe());for(const e of i._rules){if(!1===s.rules[e.name].manifest)continue;const t={name:e.name};for(const r in s.modifiers)void 0!==e[r]&&(t[r]=a.describe(e[r]));if(e.args){t.args={};for(const r in e.args){const n=e.args[r];("options"!==r||Object.keys(n).length)&&(t.args[r]=a.describe(n,{assign:r}))}Object.keys(t.args).length||delete t.args}o.rules.push(t)}o.rules.length||delete o.rules;for(const t in i.$_terms){if("_"===t[0])continue;e(!o[t],"Cannot describe schema due to internal name conflict with",t);const n=i.$_terms[t];if(!n)continue;if(n instanceof Map){n.size&&(o[t]=[...n.entries()]);continue}if(r.isValues(n)){o[t]=n.describe();continue}e(s.terms[t],"Term",t,"missing configuration");const c=s.terms[t].manifest,l="object"==typeof c;if(!n.length&&!l)continue;const u=[];for(const e of n)u.push(a.describe(e));if(l){const{from:e,to:r}=c.mapped;o[t]={};for(const n of u)o[t][n[r]]=n[e]}else"single"!==c?o[t]=u:(e(1===u.length,"Term",t,"contains more than one item"),o[t]=u[0])}return a.validate(i.$_root,o),o},a.describe=function(e,n={}){if(Array.isArray(e))return e.map(a.describe);if(e===r.symbols.deepDefault)return{special:"deep"};if("object"!=typeof e||null===e)return e;if("options"===n.assign)return t(e);if(Buffer&&Buffer.isBuffer(e))return{buffer:e.toString("binary")};if(e instanceof Date)return e.toISOString();if(e instanceof Error)return e;if(e instanceof RegExp)return"regex"===n.assign?e.toString():{regex:e.toString()};if(e[r.symbols.literal])return{function:e.literal};if("function"==typeof e.describe)return"ref"===n.assign?e.describe().ref:e.describe();const i={};for(const t in e){const r=e[t];void 0!==r&&(i[t]=a.describe(r,{assign:t}))}return i},Ue.build=function(e,t){return new a.Builder(e).parse(t)},a.Builder=class{constructor(e){this.joi=e}parse(t){a.validate(this.joi,t);let r=this.joi[t.type]()._bare();const n=r._definition;if(t.flags)for(const i in t.flags){const s=n.flags[i]&&n.flags[i].setter||i;e("function"==typeof r[s],"Invalid flag",i,"for type",t.type),r=r[s](this.build(t.flags[i]))}if(t.preferences&&(r=r.preferences(this.build(t.preferences))),t.allow&&(r=r.allow(...this.build(t.allow))),t.invalid&&(r=r.invalid(...this.build(t.invalid))),t.rules)for(const i of t.rules){e("function"==typeof r[i.name],"Invalid rule",i.name,"for type",t.type);const s=[];if(i.args){const r={};for(const e in i.args)r[e]=this.build(i.args[e],{assign:e});const o=Object.keys(r),a=n.rules[i.name].args;if(a){e(o.length<=a.length,"Invalid number of arguments for",t.type,i.name,"(expected up to",a.length,", found",o.length,")");for(const{name:e}of a)s.push(r[e])}else e(1===o.length,"Invalid number of arguments for",t.type,i.name,"(expected up to 1, found",o.length,")"),s.push(r[o[0]])}r=r[i.name](...s);const o={};for(const e in n.modifiers)void 0!==i[e]&&(o[e]=this.build(i[e]));Object.keys(o).length&&(r=r.rule(o))}const i={};for(const r in t){if(["allow","flags","invalid","whens","preferences","rules","type"].includes(r))continue;e(n.terms[r],"Term",r,"missing configuration");const s=n.terms[r].manifest;if("schema"!==s)if("values"!==s)if("single"!==s)if("object"!=typeof s)i[r]=this.build(t[r]);else{i[r]={};for(const e in t[r]){const n=t[r][e];i[r][e]=this.parse(n)}}else i[r]=this.build(t[r]);else i[r]=t[r].map((e=>this.build(e)));else i[r]=t[r].map((e=>this.parse(e)))}return t.whens&&(i.whens=t.whens.map((e=>this.build(e)))),r=n.manifest.build(r,i),r.$_temp.ruleset=!1,r}build(n,o={}){if(null===n)return null;if(Array.isArray(n))return n.map((e=>this.build(e)));if(n instanceof Error)return n;if("options"===o.assign)return t(n);if("regex"===o.assign)return a.regex(n);if("ref"===o.assign)return i.build(n);if("object"!=typeof n)return n;if(1===Object.keys(n).length){if(n.buffer)return e(Buffer,"Buffers are not supported"),Buffer&&Buffer.from(n.buffer,"binary");if(n.function)return{[r.symbols.literal]:!0,literal:n.function};if(n.override)return r.symbols.override;if(n.ref)return i.build(n.ref);if(n.regex)return a.regex(n.regex);if(n.special)return e(["deep"].includes(n.special),"Unknown special value",n.special),r.symbols.deepDefault;if(n.value)return t(n.value)}if(n.type)return this.parse(n);if(n.template)return s.build(n);const c={};for(const e in n)c[e]=this.build(n[e],{assign:e});return c}},a.regex=function(e){const t=e.lastIndexOf("/"),r=e.slice(1,t),n=e.slice(t+1);return new RegExp(r,n)},a.validate=function(e,t){o=o||ue(),e.assert(t,o.description)},Ue}var Fe={};const He=Z,ze={mismatched:null};var Ve=function(e,t,r){return r=Object.assign({prototype:!0},r),!!ze.isDeepEqual(e,t,r,[])};ze.isDeepEqual=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;const i=typeof e;if(i!==typeof t)return!1;if(null===e||null===t)return!1;if("function"===i){if(!r.deepFunction||e.toString()!==t.toString())return!1}else if("object"!==i)return e!=e&&t!=t;const s=ze.getSharedType(e,t,!!r.prototype);switch(s){case He.buffer:return Buffer&&Buffer.prototype.equals.call(e,t);case He.promise:return e===t;case He.regex:return e.toString()===t.toString();case ze.mismatched:return!1}for(let r=n.length-1;r>=0;--r)if(n[r].isSame(e,t))return!0;n.push(new ze.SeenEntry(e,t));try{return!!ze.isDeepEqualObj(s,e,t,r,n)}finally{n.pop()}},ze.getSharedType=function(e,t,r){if(r)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?ze.mismatched:He.getInternalProto(e);const n=He.getInternalProto(e);return n!==He.getInternalProto(t)?ze.mismatched:n},ze.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},ze.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},ze.isSetSimpleEqual=function(e,t){for(const r of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,r))return!1;return!0},ze.isDeepEqualObj=function(e,t,r,n,i){const{isDeepEqual:s,valueOf:o,hasOwnEnumerableProperty:a}=ze,{keys:c,getOwnPropertySymbols:l}=Object;if(e===He.array){if(!n.part){if(t.length!==r.length)return!1;for(let e=0;e<t.length;++e)if(!s(t[e],r[e],n,i))return!1;return!0}for(const e of t)for(const t of r)if(s(e,t,n,i))return!0}else if(e===He.set){if(t.size!==r.size)return!1;if(!ze.isSetSimpleEqual(t,r)){const e=new Set(Set.prototype.values.call(r));for(const r of Set.prototype.values.call(t)){if(e.delete(r))continue;let t=!1;for(const o of e)if(s(r,o,n,i)){e.delete(o),t=!0;break}if(!t)return!1}}}else if(e===He.map){if(t.size!==r.size)return!1;for(const[e,o]of Map.prototype.entries.call(t)){if(void 0===o&&!Map.prototype.has.call(r,e))return!1;if(!s(o,Map.prototype.get.call(r,e),n,i))return!1}}else if(e===He.error&&(t.name!==r.name||t.message!==r.message))return!1;const u=o(t),h=o(r);if((t!==u||r!==h)&&!s(u,h,n,i))return!1;const f=c(t);if(!n.part&&f.length!==c(r).length&&!n.skip)return!1;let p=0;for(const e of f)if(n.skip&&n.skip.includes(e))void 0===r[e]&&++p;else{if(!a(r,e))return!1;if(!s(t[e],r[e],n,i))return!1}if(!n.part&&f.length-p!==c(r).length)return!1;if(!1!==n.symbols){const e=l(t),o=new Set(l(r));for(const c of e){if(!n.skip||!n.skip.includes(c))if(a(t,c)){if(!a(r,c))return!1;if(!s(t[c],r[c],n,i))return!1}else if(a(r,c))return!1;o.delete(c)}for(const e of o)if(a(r,e))return!1}return!0},ze.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}};var qe,Ge={};function We(){if(qe)return Fe;qe=1;const e=Ve,t=Ge,r=_e(),n={codes:{error:1,pass:2,full:3},labels:{0:"never used",1:"always error",2:"always pass"}};return Fe.setup=function(e){const t=function(){return e._tracer=e._tracer||new n.Tracer,e._tracer};e.trace=t,e[Symbol.for("@hapi/lab/coverage/initialize")]=t,e.untrace=()=>{e._tracer=null}},Fe.location=function(e){return e.$_setFlag("_tracerLocation",t.location(2))},n.Tracer=class{constructor(){this.name="Joi",this._schemas=new Map}_register(e){const r=this._schemas.get(e);if(r)return r.store;const i=new n.Store(e),{filename:s,line:o}=e._flags._tracerLocation||t.location(5);return this._schemas.set(e,{filename:s,line:o,store:i}),i}_combine(e,t){for(const{store:r}of this._schemas.values())r._combine(e,t)}report(e){const t=[];for(const{filename:r,line:i,store:s}of this._schemas.values()){if(e&&e!==r)continue;const o=[],a=[];for(const[e,t]of s._sources.entries()){if(n.sub(t.paths,a))continue;if(!t.entry){o.push({status:"never reached",paths:[...t.paths]}),a.push(...t.paths);continue}for(const r of["valid","invalid"]){const n=e[`_${r}s`];if(!n)continue;const i=new Set(n._values),s=new Set(n._refs);for(const{value:e,ref:n}of t[r])i.delete(e),s.delete(n);(i.size||s.size)&&o.push({status:[...i,...[...s].map((e=>e.display))],rule:`${r}s`})}const r=e._rules.map((e=>e.name));for(const t of["default","failover"])void 0!==e._flags[t]&&r.push(t);for(const e of r){const r=n.labels[t.rule[e]||0];if(r){const n={rule:e,status:r};t.paths.size&&(n.paths=[...t.paths]),o.push(n)}}}o.length&&t.push({filename:r,line:i,missing:o,severity:"error",message:`Schema missing tests for ${o.map(n.message).join(", ")}`})}return t.length?t:null}},n.Store=class{constructor(e){this.active=!0,this._sources=new Map,this._combos=new Map,this._scan(e)}debug(e,t,r,n){e.mainstay.debug&&e.mainstay.debug.push({type:t,name:r,result:n,path:e.path})}entry(e,t){n.debug(t,{type:"entry"}),this._record(e,(e=>{e.entry=!0}))}filter(e,t,r,i){n.debug(t,{type:r,...i}),this._record(e,(e=>{e[r].add(i)}))}log(e,t,r,i,s){n.debug(t,{type:r,name:i,result:"full"===s?"pass":s}),this._record(e,(e=>{e[r][i]=e[r][i]||0,e[r][i]|=n.codes[s]}))}resolve(e,t,r){if(!e.mainstay.debug)return;const n={type:"resolve",ref:t.display,to:r,path:e.path};e.mainstay.debug.push(n)}value(t,r,n,i,s){if(!t.mainstay.debug||e(n,i))return;const o={type:"value",by:r,from:n,to:i,path:t.path};s&&(o.name=s),t.mainstay.debug.push(o)}_record(e,t){const r=this._sources.get(e);if(r)return void t(r);const n=this._combos.get(e);for(const e of n)this._record(e,t)}_scan(e,t){const r=t||[];let i=this._sources.get(e);i||(i={paths:new Set,entry:!1,rule:{},valid:new Set,invalid:new Set},this._sources.set(e,i)),r.length&&i.paths.add(r);e.$_modify({each:(e,t)=>{const i=n.id(e,t);this._scan(e,r.concat(i))},ref:!1})}_combine(e,t){this._combos.set(e,t)}},n.message=function(e){return`${e.paths?r.path(e.paths[0])+(e.rule?":":""):""}${e.rule||""} (${e.status})`},n.id=function(e,{source:t,name:r,path:n,key:i}){return e._flags.id?e._flags.id:i||(r=`@${r}`,"terms"===t?[r,n[Math.min(n.length-1,1)]]:r)},n.sub=function(t,r){for(const n of t)for(const t of r)if(e(n.slice(0,t.length),t))return!0;return!1},n.debug=function(e,t){e.mainstay.debug&&(t.path=e.debug?[...e.path,e.debug]:e.path,e.mainstay.debug.push(t))},Fe}Ge.location=function(e=0){const t=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t;const r={};Error.captureStackTrace(r,this);const n=r.stack[e+1];return Error.prepareStackTrace=t,{filename:n.getFileName(),line:n.getLineNumber()}};const Xe=G,Je=ie,Ye=Q,Ze={};var Qe,et=Ze.merge=function(e,t,r){if(Xe(e&&"object"==typeof e,"Invalid target value: must be an object"),Xe(null==t||"object"==typeof t,"Invalid source value: must be null, undefined, or an object"),!t)return e;if(r=Object.assign({nullOverride:!0,mergeArrays:!0},r),Array.isArray(t)){Xe(Array.isArray(e),"Cannot merge array onto an object"),r.mergeArrays||(e.length=0);for(let n=0;n<t.length;++n)e.push(Je(t[n],{symbols:r.symbols}));return e}const n=Ye.keys(t,r);for(let i=0;i<n.length;++i){const s=n[i];if("__proto__"===s||!Object.prototype.propertyIsEnumerable.call(t,s))continue;const o=t[s];if(o&&"object"==typeof o){if(e[s]===o)continue;!e[s]||"object"!=typeof e[s]||Array.isArray(e[s])!==Array.isArray(o)||o instanceof Date||Buffer&&Buffer.isBuffer(o)||o instanceof RegExp?e[s]=Je(o,{symbols:r.symbols}):Ze.merge(e[s],o,r)}else(null!=o||r.nullOverride)&&(e[s]=o)}return e},tt={};var rt,nt,it,st,ot,at,ct,lt,ut,ht,ft,pt,dt,mt,yt,gt,vt,bt={},wt=function(){};function _t(){return it||(it=1,function(e){const t=G,r=ie,n=wt,i=J,s=Ie(),o=_e(),a=function(){if(nt)return rt;nt=1;const e=ie,t=J,r=Ie(),n={value:Symbol("value")};return rt=n.State=class{constructor(e,t,r){this.path=e,this.ancestors=t,this.mainstay=r.mainstay,this.schemas=r.schemas,this.debug=null}localize(e,t=null,r=null){const i=new n.State(e,t,this);return r&&i.schemas&&(i.schemas=[n.schemas(r),...i.schemas]),i}nest(e,t){const r=new n.State(this.path,this.ancestors,this);return r.schemas=r.schemas&&[n.schemas(e),...r.schemas],r.debug=t,r}shadow(e,t){this.mainstay.shadow=this.mainstay.shadow||new n.Shadow,this.mainstay.shadow.set(this.path,e,t)}snapshot(){this.mainstay.shadow&&(this._snapshot=e(this.mainstay.shadow.node(this.path))),this.mainstay.snapshot()}restore(){this.mainstay.shadow&&(this.mainstay.shadow.override(this.path,this._snapshot),this._snapshot=void 0),this.mainstay.restore()}commit(){this.mainstay.shadow&&(this.mainstay.shadow.override(this.path,this._snapshot),this._snapshot=void 0),this.mainstay.commit()}},n.schemas=function(e){return r.isSchema(e)?{schema:e}:e},n.Shadow=class{constructor(){this._values=null}set(e,t,r){if(!e.length)return;if("strip"===r&&"number"==typeof e[e.length-1])return;this._values=this._values||new Map;let i=this._values;for(let t=0;t<e.length;++t){const r=e[t];let n=i.get(r);n||(n=new Map,i.set(r,n)),i=n}i[n.value]=t}get(e){const t=this.node(e);if(t)return t[n.value]}node(e){if(this._values)return t(this._values,e,{iterables:!0})}override(e,r){if(!this._values)return;const n=e.slice(0,-1),i=e[e.length-1],s=t(this._values,n,{iterables:!0});r?s.set(i,r):s&&s.delete(i)}},rt}(),c={result:Symbol("result")};e.entry=function(e,r,n){let i=s.defaults;n&&(t(void 0===n.warnings,"Cannot override warnings preference in synchronous validation"),t(void 0===n.artifacts,"Cannot override artifacts preference in synchronous validation"),i=s.preferences(s.defaults,n));const a=c.entry(e,r,i);t(!a.mainstay.externals.length,"Schema with external rules must use validateAsync()");const l={value:a.value};return a.error&&(l.error=a.error),a.mainstay.warnings.length&&(l.warning=o.details(a.mainstay.warnings)),a.mainstay.debug&&(l.debug=a.mainstay.debug),a.mainstay.artifacts&&(l.artifacts=a.mainstay.artifacts),l},e.entryAsync=async function(e,t,r){let n=s.defaults;r&&(n=s.preferences(s.defaults,r));const a=c.entry(e,t,n),l=a.mainstay;if(a.error)throw l.debug&&(a.error.debug=l.debug),a.error;if(l.externals.length){let t=a.value;const u=[];for(const a of l.externals){const h=a.state.path,f="link"===a.schema.type?l.links.get(a.schema):null;let p,d,m=t;const y=h.length?[t]:[],g=h.length?i(e,h):e;if(h.length){p=h[h.length-1];let e=t;for(const t of h.slice(0,-1))e=e[t],y.unshift(e);d=y[0],m=d[p]}try{const e=(e,t)=>(f||a.schema).$_createError(e,m,t,a.state,n),i=await a.method(m,{schema:a.schema,linked:f,state:a.state,prefs:r,original:g,error:e,errorsArray:c.errorsArray,warn:(e,t)=>l.warnings.push((f||a.schema).$_createError(e,m,t,a.state,n)),message:(e,t)=>(f||a.schema).$_createError("external",m,t,a.state,n,{messages:e})});if(void 0===i||i===m)continue;if(i instanceof o.Report){if(l.tracer.log(a.schema,a.state,"rule","external","error"),u.push(i),n.abortEarly)break;continue}if(Array.isArray(i)&&i[s.symbols.errors]){if(l.tracer.log(a.schema,a.state,"rule","external","error"),u.push(...i),n.abortEarly)break;continue}d?(l.tracer.value(a.state,"rule",m,i,"external"),d[p]=i):(l.tracer.value(a.state,"rule",t,i,"external"),t=i)}catch(e){throw n.errors.label&&(e.message+=` (${a.label})`),e}}if(a.value=t,u.length)throw a.error=o.process(u,e,n),l.debug&&(a.error.debug=l.debug),a.error}if(!n.warnings&&!n.debug&&!n.artifacts)return a.value;const u={value:a.value};return l.warnings.length&&(u.warning=o.details(l.warnings)),l.debug&&(u.debug=l.debug),l.artifacts&&(u.artifacts=l.artifacts),u},c.Mainstay=class{constructor(e,t,r){this.externals=[],this.warnings=[],this.tracer=e,this.debug=t,this.links=r,this.shadow=null,this.artifacts=null,this._snapshots=[]}snapshot(){this._snapshots.push({externals:this.externals.slice(),warnings:this.warnings.slice()})}restore(){const e=this._snapshots.pop();this.externals=e.externals,this.warnings=e.warnings}commit(){this._snapshots.pop()}},c.entry=function(t,r,n){const{tracer:i,cleanup:s}=c.tracer(r,n),l=n.debug?[]:null,u=r._ids._schemaChain?new Map:null,h=new c.Mainstay(i,l,u),f=r._ids._schemaChain?[{schema:r}]:null,p=new a([],[],{mainstay:h,schemas:f}),d=e.validate(t,r,p,n);s&&r.$_root.untrace();const m=o.process(d.errors,t,n);return{value:d.value,error:m,mainstay:h}},c.tracer=function(e,r){return e.$_root._tracer?{tracer:e.$_root._tracer._register(e)}:r.debug?(t(e.$_root.trace,"Debug mode not supported"),{tracer:e.$_root.trace()._register(e),cleanup:!0}):{tracer:c.ignore}},e.validate=function(e,t,r,n,i={}){if(t.$_terms.whens&&(t=t._generate(e,r,n).schema),t._preferences&&(n=c.prefs(t,n)),t._cache&&n.cache){const n=t._cache.get(e);if(r.mainstay.tracer.debug(r,"validate","cached",!!n),n)return n}const o=(i,s,o)=>t.$_createError(i,e,s,o||r,n),a={original:e,prefs:n,schema:t,state:r,error:o,errorsArray:c.errorsArray,warn:(e,t,n)=>r.mainstay.warnings.push(o(e,t,n)),message:(i,s)=>t.$_createError("custom",e,s,r,n,{messages:i})};r.mainstay.tracer.entry(t,r);const l=t._definition;if(l.prepare&&void 0!==e&&n.convert){const t=l.prepare(e,a);if(t){if(r.mainstay.tracer.value(r,"prepare",e,t.value),t.errors)return c.finalize(t.value,[].concat(t.errors),a);e=t.value}}if(l.coerce&&void 0!==e&&n.convert&&(!l.coerce.from||l.coerce.from.includes(typeof e))){const t=l.coerce.method(e,a);if(t){if(r.mainstay.tracer.value(r,"coerced",e,t.value),t.errors)return c.finalize(t.value,[].concat(t.errors),a);e=t.value}}const u=t._flags.empty;u&&u.$_match(c.trim(e,t),r.nest(u),s.defaults)&&(r.mainstay.tracer.value(r,"empty",e,void 0),e=void 0);const h=i.presence||t._flags.presence||(t._flags._endedSwitch?null:n.presence);if(void 0===e){if("forbidden"===h)return c.finalize(e,null,a);if("required"===h)return c.finalize(e,[t.$_createError("any.required",e,null,r,n)],a);if("optional"===h){if(t._flags.default!==s.symbols.deepDefault)return c.finalize(e,null,a);r.mainstay.tracer.value(r,"default",e,{}),e={}}}else if("forbidden"===h)return c.finalize(e,[t.$_createError("any.unknown",e,null,r,n)],a);const f=[];if(t._valids){const i=t._valids.get(e,r,n,t._flags.insensitive);if(i)return n.convert&&(r.mainstay.tracer.value(r,"valids",e,i.value),e=i.value),r.mainstay.tracer.filter(t,r,"valid",i),c.finalize(e,null,a);if(t._flags.only){const i=t.$_createError("any.only",e,{valids:t._valids.values({display:!0})},r,n);if(n.abortEarly)return c.finalize(e,[i],a);f.push(i)}}if(t._invalids){const i=t._invalids.get(e,r,n,t._flags.insensitive);if(i){r.mainstay.tracer.filter(t,r,"invalid",i);const s=t.$_createError("any.invalid",e,{invalids:t._invalids.values({display:!0})},r,n);if(n.abortEarly)return c.finalize(e,[s],a);f.push(s)}}if(l.validate){const t=l.validate(e,a);if(t&&(r.mainstay.tracer.value(r,"base",e,t.value),e=t.value,t.errors)){if(!Array.isArray(t.errors))return f.push(t.errors),c.finalize(e,f,a);if(t.errors.length)return f.push(...t.errors),c.finalize(e,f,a)}}return t._rules.length?c.rules(e,f,a):c.finalize(e,f,a)},c.rules=function(e,t,r){const{schema:n,state:i,prefs:o}=r;for(const a of n._rules){const l=n._definition.rules[a.method];if(l.convert&&o.convert){i.mainstay.tracer.log(n,i,"rule",a.name,"full");continue}let u,h=a.args;if(a._resolve.length){h=Object.assign({},h);for(const t of a._resolve){const r=l.argsByName.get(t),a=h[t].resolve(e,i,o),c=r.normalize?r.normalize(a):a,f=s.validateArg(c,null,r);if(f){u=n.$_createError("any.ref",a,{arg:t,ref:h[t],reason:f},i,o);break}h[t]=c}}u=u||l.validate(e,r,h,a);const f=c.rule(u,a);if(f.errors){if(i.mainstay.tracer.log(n,i,"rule",a.name,"error"),a.warn){i.mainstay.warnings.push(...f.errors);continue}if(o.abortEarly)return c.finalize(e,f.errors,r);t.push(...f.errors)}else i.mainstay.tracer.log(n,i,"rule",a.name,"pass"),i.mainstay.tracer.value(i,"rule",e,f.value,a.name),e=f.value}return c.finalize(e,t,r)},c.rule=function(e,t){return e instanceof o.Report?(c.error(e,t),{errors:[e],value:null}):Array.isArray(e)&&e[s.symbols.errors]?(e.forEach((e=>c.error(e,t))),{errors:e,value:null}):{errors:null,value:e}},c.error=function(e,t){return t.message&&e._setTemplate(t.message),e},c.finalize=function(e,r,n){r=r||[];const{schema:i,state:s,prefs:a}=n;if(r.length){const t=c.default("failover",void 0,r,n);void 0!==t&&(s.mainstay.tracer.value(s,"failover",e,t),e=t,r=[])}if(r.length&&i._flags.error)if("function"==typeof i._flags.error){r=i._flags.error(r),Array.isArray(r)||(r=[r]);for(const e of r)t(e instanceof Error||e instanceof o.Report,"error() must return an Error object")}else r=[i._flags.error];if(void 0===e){const t=c.default("default",e,r,n);s.mainstay.tracer.value(s,"default",e,t),e=t}if(i._flags.cast&&void 0!==e){const t=i._definition.cast[i._flags.cast];if(t.from(e)){const r=t.to(e,n);s.mainstay.tracer.value(s,"cast",e,r,i._flags.cast),e=r}}if(i.$_terms.externals&&a.externals&&!1!==a._externals)for(const{method:e}of i.$_terms.externals)s.mainstay.externals.push({method:e,schema:i,state:s,label:o.label(i._flags,s,a)});const l={value:e,errors:r.length?r:null};return i._flags.result&&(l.value="strip"===i._flags.result?void 0:n.original,s.mainstay.tracer.value(s,i._flags.result,e,l.value),s.shadow(e,i._flags.result)),i._cache&&!1!==a.cache&&!i._refs.length&&i._cache.set(n.original,l),void 0===e||l.errors||void 0===i._flags.artifact||(s.mainstay.artifacts=s.mainstay.artifacts||new Map,s.mainstay.artifacts.has(i._flags.artifact)||s.mainstay.artifacts.set(i._flags.artifact,[]),s.mainstay.artifacts.get(i._flags.artifact).push(s.path)),l},c.prefs=function(e,t){const r=t===s.defaults;return r&&e._preferences[s.symbols.prefs]?e._preferences[s.symbols.prefs]:(t=s.preferences(t,e._preferences),r&&(e._preferences[s.symbols.prefs]=t),t)},c.default=function(e,t,n,i){const{schema:o,state:a,prefs:c}=i,l=o._flags[e];if(c.noDefaults||void 0===l)return t;if(a.mainstay.tracer.log(o,a,"rule",e,"full"),!l)return l;if("function"==typeof l){const t=l.length?[r(a.ancestors[0]),i]:[];try{return l(...t)}catch(t){return void n.push(o.$_createError(`any.${e}`,null,{error:t},a,c))}}return"object"!=typeof l?l:l[s.symbols.literal]?l.literal:s.isResolvable(l)?l.resolve(t,a,c):r(l)},c.trim=function(e,t){if("string"!=typeof e)return e;const r=t.$_getRule("trim");return r&&r.args.enabled?e.trim():e},c.ignore={active:!1,debug:n,entry:n,filter:n,log:n,resolve:n,value:n},c.errorsArray=function(){const e=[];return e[s.symbols.errors]=!0,e}}(bt)),bt}function St(){if(ot)return st;ot=1;const e=G,t=Ve,r=Ie(),n={};return st=n.Values=class{constructor(e,t){this._values=new Set(e),this._refs=new Set(t),this._lowercase=n.lowercases(e),this._override=!1}get length(){return this._values.size+this._refs.size}add(e,t){r.isResolvable(e)?this._refs.has(e)||(this._refs.add(e),t&&t.register(e)):this.has(e,null,null,!1)||(this._values.add(e),"string"==typeof e&&this._lowercase.set(e.toLowerCase(),e))}static merge(e,t,r){if(e=e||new n.Values,t){if(t._override)return t.clone();for(const r of[...t._values,...t._refs])e.add(r)}if(r)for(const t of[...r._values,...r._refs])e.remove(t);return e.length?e:null}remove(e){r.isResolvable(e)?this._refs.delete(e):(this._values.delete(e),"string"==typeof e&&this._lowercase.delete(e.toLowerCase()))}has(e,t,r,n){return!!this.get(e,t,r,n)}get(e,r,n,i){if(!this.length)return!1;if(this._values.has(e))return{value:e};if("string"==typeof e&&e&&i){const t=this._lowercase.get(e.toLowerCase());if(t)return{value:t}}if(!this._refs.size&&"object"!=typeof e)return!1;if("object"==typeof e)for(const r of this._values)if(t(r,e))return{value:r};if(r)for(const s of this._refs){const o=s.resolve(e,r,n,null,{in:!0});if(void 0===o)continue;const a=s.in&&"object"==typeof o?Array.isArray(o)?o:Object.keys(o):[o];for(const r of a)if(typeof r==typeof e)if(i&&e&&"string"==typeof e){if(r.toLowerCase()===e.toLowerCase())return{value:r,ref:s}}else if(t(r,e))return{value:r,ref:s}}return!1}override(){this._override=!0}values(e){if(e&&e.display){const e=[];for(const t of[...this._values,...this._refs])void 0!==t&&e.push(t);return e}return Array.from([...this._values,...this._refs])}clone(){const e=new n.Values(this._values,this._refs);return e._override=this._override,e}concat(t){e(!t._override,"Cannot concat override set of values");const r=new n.Values([...this._values,...t._values],[...this._refs,...t._refs]);return r._override=this._override,r}describe(){const e=[];this._override&&e.push({override:!0});for(const t of this._values.values())e.push(t&&"object"==typeof t?{value:t}:t);for(const t of this._refs.values())e.push(t.describe());return e}},n.Values.prototype[r.symbols.values]=!0,n.Values.prototype.slice=n.Values.prototype.clone,n.lowercases=function(e){const t=new Map;if(e)for(const r of e)"string"==typeof r&&t.set(r.toLowerCase(),r);return t},st}function Et(){if(ct)return at;ct=1;const e=G,t=ie,r=Ve,n=et,i=Te(),s=Ie(),o=De(),a=_e(),c=je(),l=Ke(),u=Ne(),h=(Qe||(Qe=1,function(e){const t=G,r=Ie(),n=Re(),i={};e.Ids=i.Ids=class{constructor(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}clone(){const e=new i.Ids;return e._byId=new Map(this._byId),e._byKey=new Map(this._byKey),e._schemaChain=this._schemaChain,e}concat(e){e._schemaChain&&(this._schemaChain=!0);for(const[r,n]of e._byId.entries())t(!this._byKey.has(r),"Schema id conflicts with existing key:",r),this._byId.set(r,n);for(const[r,n]of e._byKey.entries())t(!this._byId.has(r),"Schema key conflicts with existing id:",r),this._byKey.set(r,n)}fork(e,n,s){const o=this._collect(e);o.push({schema:s});const a=o.shift();let c={id:a.id,schema:n(a.schema)};t(r.isSchema(c.schema),"adjuster function failed to return a joi schema type");for(const e of o)c={id:e.id,schema:i.fork(e.schema,c.id,c.schema)};return c.schema}labels(e,t=[]){const r=e[0],n=this._get(r);if(!n)return[...t,...e].join(".");const i=e.slice(1);return t=[...t,n.schema._flags.label||r],i.length?n.schema._ids.labels(i,t):t.join(".")}reach(e,r=[]){const n=e[0],i=this._get(n);t(i,"Schema does not contain path",[...r,...e].join("."));const s=e.slice(1);return s.length?i.schema._ids.reach(s,[...r,n]):i.schema}register(e,{key:n}={}){if(!e||!r.isSchema(e))return;(e.$_property("schemaChain")||e._ids._schemaChain)&&(this._schemaChain=!0);const i=e._flags.id;if(i){const r=this._byId.get(i);t(!r||r.schema===e,"Cannot add different schemas with the same id:",i),t(!this._byKey.has(i),"Schema id conflicts with existing key:",i),this._byId.set(i,{schema:e,id:i})}n&&(t(!this._byKey.has(n),"Schema already contains key:",n),t(!this._byId.has(n),"Schema key conflicts with existing id:",n),this._byKey.set(n,{schema:e,id:n}))}reset(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}_collect(e,r=[],n=[]){const i=e[0],s=this._get(i);t(s,"Schema does not contain path",[...r,...e].join(".")),n=[s,...n];const o=e.slice(1);return o.length?s.schema._ids._collect(o,[...r,i],n):n}_get(e){return this._byId.get(e)||this._byKey.get(e)}},i.fork=function(t,r,n){const i=e.schema(t,{each:(e,{key:t})=>{if(r===(e._flags.id||t))return n},ref:!1});return i?i.$_mutateRebuild():t},e.schema=function(e,t){let r;for(const n in e._flags){if("_"===n[0])continue;const s=i.scan(e._flags[n],{source:"flags",name:n},t);void 0!==s&&(r=r||e.clone(),r._flags[n]=s)}for(let n=0;n<e._rules.length;++n){const s=e._rules[n],o=i.scan(s.args,{source:"rules",name:s.name},t);if(void 0!==o){r=r||e.clone();const t=Object.assign({},s);t.args=o,r._rules[n]=t,r._singleRules.get(s.name)===s&&r._singleRules.set(s.name,t)}}for(const n in e.$_terms){if("_"===n[0])continue;const s=i.scan(e.$_terms[n],{source:"terms",name:n},t);void 0!==s&&(r=r||e.clone(),r.$_terms[n]=s)}return r},i.scan=function(e,t,s,o,a){const c=o||[];if(null===e||"object"!=typeof e)return;let l;if(Array.isArray(e)){for(let r=0;r<e.length;++r){const n="terms"===t.source&&"keys"===t.name&&e[r].key,o=i.scan(e[r],t,s,[r,...c],n);void 0!==o&&(l=l||e.slice(),l[r]=o)}return l}if(!1!==s.schema&&r.isSchema(e)||!1!==s.ref&&n.isRef(e)){const r=s.each(e,{...t,path:c,key:a});if(r===e)return;return r}for(const r in e){if("_"===r[0])continue;const n=i.scan(e[r],t,s,[r,...c],a);void 0!==n&&(l=l||Object.assign({},e),l[r]=n)}return l}}(tt)),tt),f=Re(),p=We(),d=_t(),m=St(),y={Base:class{constructor(e){this.type=e,this.$_root=null,this._definition={},this._reset()}_reset(){this._ids=new h.Ids,this._preferences=null,this._refs=new f.Manager,this._cache=null,this._valids=null,this._invalids=null,this._flags={},this._rules=[],this._singleRules=new Map,this.$_terms={},this.$_temp={ruleset:null,whens:{}}}describe(){return e("function"==typeof l.describe,"Manifest functionality disabled"),l.describe(this)}allow(...e){return s.verifyFlat(e,"allow"),this._values(e,"_valids")}alter(t){e(t&&"object"==typeof t&&!Array.isArray(t),"Invalid targets argument"),e(!this._inRuleset(),"Cannot set alterations inside a ruleset");const r=this.clone();r.$_terms.alterations=r.$_terms.alterations||[];for(const n in t){const i=t[n];e("function"==typeof i,"Alteration adjuster for",n,"must be a function"),r.$_terms.alterations.push({target:n,adjuster:i})}return r.$_temp.ruleset=!1,r}artifact(t){return e(void 0!==t,"Artifact cannot be undefined"),e(!this._cache,"Cannot set an artifact with a rule cache"),this.$_setFlag("artifact",t)}cast(t){return e(!1===t||"string"==typeof t,"Invalid to value"),e(!1===t||this._definition.cast[t],"Type",this.type,"does not support casting to",t),this.$_setFlag("cast",!1===t?void 0:t)}default(e,t){return this._default("default",e,t)}description(t){return e(t&&"string"==typeof t,"Description must be a non-empty string"),this.$_setFlag("description",t)}empty(e){const t=this.clone();return void 0!==e&&(e=t.$_compile(e,{override:!1})),t.$_setFlag("empty",e,{clone:!1})}error(t){return e(t,"Missing error"),e(t instanceof Error||"function"==typeof t,"Must provide a valid Error object or a function"),this.$_setFlag("error",t)}example(t,r={}){return e(void 0!==t,"Missing example"),s.assertOptions(r,["override"]),this._inner("examples",t,{single:!0,override:r.override})}external(t,r){return"object"==typeof t&&(e(!r,"Cannot combine options with description"),r=t.description,t=t.method),e("function"==typeof t,"Method must be a function"),e(void 0===r||r&&"string"==typeof r,"Description must be a non-empty string"),this._inner("externals",{method:t,description:r},{single:!0})}failover(e,t){return this._default("failover",e,t)}forbidden(){return this.presence("forbidden")}id(t){return t?(e("string"==typeof t,"id must be a non-empty string"),e(/^[^\.]+$/.test(t),"id cannot contain period character"),this.$_setFlag("id",t)):this.$_setFlag("id",void 0)}invalid(...e){return this._values(e,"_invalids")}label(t){return e(t&&"string"==typeof t,"Label name must be a non-empty string"),this.$_setFlag("label",t)}meta(t){return e(void 0!==t,"Meta cannot be undefined"),this._inner("metas",t,{single:!0})}note(...t){e(t.length,"Missing notes");for(const r of t)e(r&&"string"==typeof r,"Notes must be non-empty strings");return this._inner("notes",t)}only(t=!0){return e("boolean"==typeof t,"Invalid mode:",t),this.$_setFlag("only",t)}optional(){return this.presence("optional")}prefs(t){e(t,"Missing preferences"),e(void 0===t.context,"Cannot override context"),e(void 0===t.externals,"Cannot override externals"),e(void 0===t.warnings,"Cannot override warnings"),e(void 0===t.debug,"Cannot override debug"),s.checkPreferences(t);const r=this.clone();return r._preferences=s.preferences(r._preferences,t),r}presence(t){return e(["optional","required","forbidden"].includes(t),"Unknown presence mode",t),this.$_setFlag("presence",t)}raw(e=!0){return this.$_setFlag("result",e?"raw":void 0)}result(t){return e(["raw","strip"].includes(t),"Unknown result mode",t),this.$_setFlag("result",t)}required(){return this.presence("required")}strict(e){const t=this.clone(),r=void 0!==e&&!e;return t._preferences=s.preferences(t._preferences,{convert:r}),t}strip(e=!0){return this.$_setFlag("result",e?"strip":void 0)}tag(...t){e(t.length,"Missing tags");for(const r of t)e(r&&"string"==typeof r,"Tags must be non-empty strings");return this._inner("tags",t)}unit(t){return e(t&&"string"==typeof t,"Unit name must be a non-empty string"),this.$_setFlag("unit",t)}valid(...e){s.verifyFlat(e,"valid");const t=this.allow(...e);return t.$_setFlag("only",!!t._valids,{clone:!1}),t}when(t,r){const n=this.clone();n.$_terms.whens||(n.$_terms.whens=[]);const i=o.when(n,t,r);if(!["any","link"].includes(n.type)){const t=i.is?[i]:i.switch;for(const r of t)e(!r.then||"any"===r.then.type||r.then.type===n.type,"Cannot combine",n.type,"with",r.then&&r.then.type),e(!r.otherwise||"any"===r.otherwise.type||r.otherwise.type===n.type,"Cannot combine",n.type,"with",r.otherwise&&r.otherwise.type)}return n.$_terms.whens.push(i),n.$_mutateRebuild()}cache(t){e(!this._inRuleset(),"Cannot set caching inside a ruleset"),e(!this._cache,"Cannot override schema cache"),e(void 0===this._flags.artifact,"Cannot cache a rule with an artifact");const r=this.clone();return r._cache=t||i.provider.provision(),r.$_temp.ruleset=!1,r}clone(){const e=Object.create(Object.getPrototypeOf(this));return this._assign(e)}concat(t){e(s.isSchema(t),"Invalid schema object"),e("any"===this.type||"any"===t.type||t.type===this.type,"Cannot merge type",this.type,"with another type:",t.type),e(!this._inRuleset(),"Cannot concatenate onto a schema with open ruleset"),e(!t._inRuleset(),"Cannot concatenate a schema with open ruleset");let r=this.clone();if("any"===this.type&&"any"!==t.type){const e=t.clone();for(const t of Object.keys(r))"type"!==t&&(e[t]=r[t]);r=e}r._ids.concat(t._ids),r._refs.register(t,f.toSibling),r._preferences=r._preferences?s.preferences(r._preferences,t._preferences):t._preferences,r._valids=m.merge(r._valids,t._valids,t._invalids),r._invalids=m.merge(r._invalids,t._invalids,t._valids);for(const e of t._singleRules.keys())r._singleRules.has(e)&&(r._rules=r._rules.filter((t=>t.keep||t.name!==e)),r._singleRules.delete(e));for(const e of t._rules)t._definition.rules[e.method].multi||r._singleRules.set(e.name,e),r._rules.push(e);if(r._flags.empty&&t._flags.empty){r._flags.empty=r._flags.empty.concat(t._flags.empty);const e=Object.assign({},t._flags);delete e.empty,n(r._flags,e)}else if(t._flags.empty){r._flags.empty=t._flags.empty;const e=Object.assign({},t._flags);delete e.empty,n(r._flags,e)}else n(r._flags,t._flags);for(const e in t.$_terms){const n=t.$_terms[e];n?r.$_terms[e]?r.$_terms[e]=r.$_terms[e].concat(n):r.$_terms[e]=n.slice():r.$_terms[e]||(r.$_terms[e]=n)}return this.$_root._tracer&&this.$_root._tracer._combine(r,[this,t]),r.$_mutateRebuild()}extend(t){return e(!t.base,"Cannot extend type with another base"),c.type(this,t)}extract(e){return e=Array.isArray(e)?e:e.split("."),this._ids.reach(e)}fork(t,r){e(!this._inRuleset(),"Cannot fork inside a ruleset");let n=this;for(let e of[].concat(t))e=Array.isArray(e)?e:e.split("."),n=n._ids.fork(e,r,n);return n.$_temp.ruleset=!1,n}rule(r){const n=this._definition;s.assertOptions(r,Object.keys(n.modifiers)),e(!1!==this.$_temp.ruleset,"Cannot apply rules to empty ruleset or the last rule added does not support rule properties");const i=null===this.$_temp.ruleset?this._rules.length-1:this.$_temp.ruleset;e(i>=0&&i<this._rules.length,"Cannot apply rules to empty ruleset");const o=this.clone();for(let s=i;s<o._rules.length;++s){const i=o._rules[s],a=t(i);for(const t in r)n.modifiers[t](a,r[t]),e(a.name===i.name,"Cannot change rule name");o._rules[s]=a,o._singleRules.get(a.name)===i&&o._singleRules.set(a.name,a)}return o.$_temp.ruleset=!1,o.$_mutateRebuild()}get ruleset(){e(!this._inRuleset(),"Cannot start a new ruleset without closing the previous one");const t=this.clone();return t.$_temp.ruleset=t._rules.length,t}get $(){return this.ruleset}tailor(t){t=[].concat(t),e(!this._inRuleset(),"Cannot tailor inside a ruleset");let r=this;if(this.$_terms.alterations)for(const{target:n,adjuster:i}of this.$_terms.alterations)t.includes(n)&&(r=i(r),e(s.isSchema(r),"Alteration adjuster for",n,"failed to return a schema object"));return r=r.$_modify({each:e=>e.tailor(t),ref:!1}),r.$_temp.ruleset=!1,r.$_mutateRebuild()}tracer(){return p.location?p.location(this):this}validate(e,t){return d.entry(e,this,t)}validateAsync(e,t){return d.entryAsync(e,this,t)}$_addRule(t){"string"==typeof t&&(t={name:t}),e(t&&"object"==typeof t,"Invalid options"),e(t.name&&"string"==typeof t.name,"Invalid rule name");for(const r in t)e("_"!==r[0],"Cannot set private rule properties");const r=Object.assign({},t);r._resolve=[],r.method=r.method||r.name;const n=this._definition.rules[r.method],i=r.args;e(n,"Unknown rule",r.method);const o=this.clone();if(i){e(1===Object.keys(i).length||Object.keys(i).length===this._definition.rules[r.name].args.length,"Invalid rule definition for",this.type,r.name);for(const t in i){let a=i[t];if(n.argsByName){const c=n.argsByName.get(t);if(c.ref&&s.isResolvable(a))r._resolve.push(t),o.$_mutateRegister(a);else if(c.normalize&&(a=c.normalize(a),i[t]=a),c.assert){const r=s.validateArg(a,t,c);e(!r,r,"or reference")}}void 0!==a?i[t]=a:delete i[t]}}return n.multi||(o._ruleRemove(r.name,{clone:!1}),o._singleRules.set(r.name,r)),!1===o.$_temp.ruleset&&(o.$_temp.ruleset=null),n.priority?o._rules.unshift(r):o._rules.push(r),o}$_compile(e,t){return o.schema(this.$_root,e,t)}$_createError(e,t,r,n,i,s={}){const o=!1!==s.flags?this._flags:{},c=s.messages?u.merge(this._definition.messages,s.messages):this._definition.messages;return new a.Report(e,t,r,o,c,n,i)}$_getFlag(e){return this._flags[e]}$_getRule(e){return this._singleRules.get(e)}$_mapLabels(e){return e=Array.isArray(e)?e:e.split("."),this._ids.labels(e)}$_match(e,t,r,n){(r=Object.assign({},r)).abortEarly=!0,r._externals=!1,t.snapshot();const i=!d.validate(e,this,t,r,n).errors;return t.restore(),i}$_modify(e){return s.assertOptions(e,["each","once","ref","schema"]),h.schema(this,e)||this}$_mutateRebuild(){e(!this._inRuleset(),"Cannot add this rule inside a ruleset"),this._refs.reset(),this._ids.reset();return this.$_modify({each:(e,{source:t,name:r,path:n,key:i})=>{const s=this._definition[t][r]&&this._definition[t][r].register;!1!==s&&this.$_mutateRegister(e,{family:s,key:i})}}),this._definition.rebuild&&this._definition.rebuild(this),this.$_temp.ruleset=!1,this}$_mutateRegister(e,{family:t,key:r}={}){this._refs.register(e,t),this._ids.register(e,{key:r})}$_property(e){return this._definition.properties[e]}$_reach(e){return this._ids.reach(e)}$_rootReferences(){return this._refs.roots()}$_setFlag(t,n,i={}){e("_"===t[0]||!this._inRuleset(),"Cannot set flag inside a ruleset");const s=this._definition.flags[t]||{};if(r(n,s.default)&&(n=void 0),r(n,this._flags[t]))return this;const o=!1!==i.clone?this.clone():this;return void 0!==n?(o._flags[t]=n,o.$_mutateRegister(n)):delete o._flags[t],"_"!==t[0]&&(o.$_temp.ruleset=!1),o}$_parent(e,...t){return this[e][s.symbols.parent].call(this,...t)}$_validate(e,t,r){return d.validate(e,this,t,r)}_assign(e){e.type=this.type,e.$_root=this.$_root,e.$_temp=Object.assign({},this.$_temp),e.$_temp.whens={},e._ids=this._ids.clone(),e._preferences=this._preferences,e._valids=this._valids&&this._valids.clone(),e._invalids=this._invalids&&this._invalids.clone(),e._rules=this._rules.slice(),e._singleRules=t(this._singleRules,{shallow:!0}),e._refs=this._refs.clone(),e._flags=Object.assign({},this._flags),e._cache=null,e.$_terms={};for(const t in this.$_terms)e.$_terms[t]=this.$_terms[t]?this.$_terms[t].slice():null;e.$_super={};for(const t in this.$_super)e.$_super[t]=this._super[t].bind(e);return e}_bare(){const e=this.clone();e._reset();const t=e._definition.terms;for(const r in t){const n=t[r];e.$_terms[r]=n.init}return e.$_mutateRebuild()}_default(t,r,n={}){s.assertOptions(n,"literal"),e(void 0!==r,"Missing",t,"value"),e("function"==typeof r||!n.literal,"Only function value supports literal option"),"function"==typeof r&&n.literal&&(r={[s.symbols.literal]:!0,literal:r});return this.$_setFlag(t,r)}_generate(e,t,r){if(!this.$_terms.whens)return{schema:this};const n=[],i=[];for(let s=0;s<this.$_terms.whens.length;++s){const o=this.$_terms.whens[s];if(o.concat){n.push(o.concat),i.push(`${s}.concat`);continue}const a=o.ref?o.ref.resolve(e,t,r):e,c=o.is?[o]:o.switch,l=i.length;for(let l=0;l<c.length;++l){const{is:u,then:h,otherwise:f}=c[l],p=`${s}${o.switch?"."+l:""}`;if(u.$_match(a,t.nest(u,`${p}.is`),r)){if(h){const s=t.localize([...t.path,`${p}.then`],t.ancestors,t.schemas),{schema:o,id:a}=h._generate(e,s,r);n.push(o),i.push(`${p}.then${a?`(${a})`:""}`);break}}else if(f){const s=t.localize([...t.path,`${p}.otherwise`],t.ancestors,t.schemas),{schema:o,id:a}=f._generate(e,s,r);n.push(o),i.push(`${p}.otherwise${a?`(${a})`:""}`);break}}if(o.break&&i.length>l)break}const s=i.join(", ");if(t.mainstay.tracer.debug(t,"rule","when",s),!s)return{schema:this};if(!t.mainstay.tracer.active&&this.$_temp.whens[s])return{schema:this.$_temp.whens[s],id:s};let o=this;this._definition.generate&&(o=this._definition.generate(this,e,t,r));for(const e of n)o=o.concat(e);return this.$_root._tracer&&this.$_root._tracer._combine(o,[this,...n]),this.$_temp.whens[s]=o,{schema:o,id:s}}_inner(t,r,n={}){e(!this._inRuleset(),`Cannot set ${t} inside a ruleset`);const i=this.clone();return i.$_terms[t]&&!n.override||(i.$_terms[t]=[]),n.single?i.$_terms[t].push(r):i.$_terms[t].push(...r),i.$_temp.ruleset=!1,i}_inRuleset(){return null!==this.$_temp.ruleset&&!1!==this.$_temp.ruleset}_ruleRemove(e,t={}){if(!this._singleRules.has(e))return this;const r=!1!==t.clone?this.clone():this;r._singleRules.delete(e);const n=[];for(let t=0;t<r._rules.length;++t){const i=r._rules[t];i.name!==e||i.keep?n.push(i):r._inRuleset()&&t<r.$_temp.ruleset&&--r.$_temp.ruleset}return r._rules=n,r}_values(t,r){s.verifyFlat(t,r.slice(1,-1));const n=this.clone(),i=t[0]===s.symbols.override;if(i&&(t=t.slice(1)),!n[r]&&t.length?n[r]=new m:i&&(n[r]=t.length?new m:null,n.$_mutateRebuild()),!n[r])return n;i&&n[r].override();for(const i of t){e(void 0!==i,"Cannot call allow/valid/invalid with undefined"),e(i!==s.symbols.override,"Override must be the first value");const t="_invalids"===r?"_valids":"_invalids";n[t]&&(n[t].remove(i),n[t].length||(e("_valids"===r||!n._flags.only,"Setting invalid value",i,"leaves schema rejecting all values due to previous valid rule"),n[t]=null)),n[r].add(i,n._refs)}return n}}};return y.Base.prototype[s.symbols.any]={version:s.version,compile:o.compile,root:"$_root"},y.Base.prototype.isImmutable=!0,y.Base.prototype.deny=y.Base.prototype.invalid,y.Base.prototype.disallow=y.Base.prototype.invalid,y.Base.prototype.equal=y.Base.prototype.valid,y.Base.prototype.exist=y.Base.prototype.required,y.Base.prototype.not=y.Base.prototype.invalid,y.Base.prototype.options=y.Base.prototype.prefs,y.Base.prototype.preferences=y.Base.prototype.prefs,at=new y.Base}function At(){if(ut)return lt;ut=1;const e=G,t=Et(),r=Ie(),n=Ne();return lt=t.extend({type:"any",flags:{only:{default:!1}},terms:{alterations:{init:null},examples:{init:null},externals:{init:null},metas:{init:[]},notes:{init:[]},shared:{init:null},tags:{init:[]},whens:{init:null}},rules:{custom:{method(t,r){return e("function"==typeof t,"Method must be a function"),e(void 0===r||r&&"string"==typeof r,"Description must be a non-empty string"),this.$_addRule({name:"custom",args:{method:t,description:r}})},validate(e,t,{method:r}){try{return r(e,t)}catch(e){return t.error("any.custom",{error:e})}},args:["method","description"],multi:!0},messages:{method(e){return this.prefs({messages:e})}},shared:{method(t){e(r.isSchema(t)&&t._flags.id,"Schema must be a schema with an id");const n=this.clone();return n.$_terms.shared=n.$_terms.shared||[],n.$_terms.shared.push(t),n.$_mutateRegister(t),n}},warning:{method(t,r){return e(t&&"string"==typeof t,"Invalid warning code"),this.$_addRule({name:"warning",args:{code:t,local:r},warn:!0})},validate:(e,t,{code:r,local:n})=>t.error(r,n),args:["code","local"],multi:!0}},modifiers:{keep(e,t=!0){e.keep=t},message(e,t){e.message=n.compile(t)},warn(e,t=!0){e.warn=t}},manifest:{build(e,t){for(const r in t){const n=t[r];if(["examples","externals","metas","notes","tags"].includes(r))for(const t of n)e=e[r.slice(0,-1)](t);else if("alterations"!==r)if("whens"!==r){if("shared"===r)for(const t of n)e=e.shared(t)}else for(const t of n){const{ref:r,is:n,not:i,then:s,otherwise:o,concat:a}=t;e=a?e.concat(a):r?e.when(r,{is:n,not:i,then:s,otherwise:o,switch:t.switch,break:t.break}):e.when(n,{then:s,otherwise:o,break:t.break})}else{const t={};for(const{target:e,adjuster:r}of n)t[e]=r;e=e.alter(t)}}return e}},messages:{"any.custom":"{{#label}} failed custom validation because {{#error.message}}","any.default":"{{#label}} threw an error when running default method","any.failover":"{{#label}} threw an error when running failover method","any.invalid":"{{#label}} contains an invalid value","any.only":'{{#label}} must be {if(#valids.length == 1, "", "one of ")}{{#valids}}',"any.ref":"{{#label}} {{#arg}} references {{:#ref}} which {{#reason}}","any.required":"{{#label}} is required","any.unknown":"{{#label}} is not allowed"}}),lt}function kt(){if(ft)return ht;ft=1;const e=G,t=et,r=At(),n=Ie(),i=De(),s=_e(),o=Re(),a={};return ht=r.extend({type:"alternatives",flags:{match:{default:"any"}},terms:{matches:{init:[],register:o.toSibling}},args:(e,...t)=>1===t.length&&Array.isArray(t[0])?e.try(...t[0]):e.try(...t),validate(e,r){const{schema:n,error:i,state:o,prefs:c}=r;if(n._flags.match){const r=[],a=[];for(let t=0;t<n.$_terms.matches.length;++t){const i=n.$_terms.matches[t],s=o.nest(i.schema,`match.${t}`);s.snapshot();const l=i.schema.$_validate(e,s,c);l.errors?(a.push(l.errors),s.restore()):(r.push(l.value),s.commit())}if(0===r.length){const e={details:a.map((e=>s.details(e,{override:!1})))};return{errors:i("alternatives.any",e)}}if("one"===n._flags.match)return 1===r.length?{value:r[0]}:{errors:i("alternatives.one")};if(r.length!==n.$_terms.matches.length){const e={details:a.map((e=>s.details(e,{override:!1})))};return{errors:i("alternatives.all",e)}}const l=e=>e.$_terms.matches.some((e=>"object"===e.schema.type||"alternatives"===e.schema.type&&l(e.schema)));return l(n)?{value:r.reduce(((e,r)=>t(e,r,{mergeArrays:!1})))}:{value:r[r.length-1]}}const l=[];for(let t=0;t<n.$_terms.matches.length;++t){const r=n.$_terms.matches[t];if(r.schema){const n=o.nest(r.schema,`match.${t}`);n.snapshot();const i=r.schema.$_validate(e,n,c);if(!i.errors)return n.commit(),i;n.restore(),l.push({schema:r.schema,reports:i.errors});continue}const i=r.ref?r.ref.resolve(e,o,c):e,s=r.is?[r]:r.switch;for(let n=0;n<s.length;++n){const a=s[n],{is:l,then:u,otherwise:h}=a,f=`match.${t}${r.switch?"."+n:""}`;if(l.$_match(i,o.nest(l,`${f}.is`),c)){if(u)return u.$_validate(e,o.nest(u,`${f}.then`),c)}else if(h)return h.$_validate(e,o.nest(h,`${f}.otherwise`),c)}}return a.errors(l,r)},rules:{conditional:{method(t,r){e(!this._flags._endedSwitch,"Unreachable condition"),e(!this._flags.match,"Cannot combine match mode",this._flags.match,"with conditional rule"),e(void 0===r.break,"Cannot use break option with alternatives conditional");const n=this.clone(),s=i.when(n,t,r),o=s.is?[s]:s.switch;for(const e of o)if(e.then&&e.otherwise){n.$_setFlag("_endedSwitch",!0,{clone:!1});break}return n.$_terms.matches.push(s),n.$_mutateRebuild()}},match:{method(t){if(e(["any","one","all"].includes(t),"Invalid alternatives match mode",t),"any"!==t)for(const r of this.$_terms.matches)e(r.schema,"Cannot combine match mode",t,"with conditional rules");return this.$_setFlag("match",t)}},try:{method(...t){e(t.length,"Missing alternative schemas"),n.verifyFlat(t,"try"),e(!this._flags._endedSwitch,"Unreachable condition");const r=this.clone();for(const e of t)r.$_terms.matches.push({schema:r.$_compile(e)});return r.$_mutateRebuild()}}},overrides:{label(e){return this.$_parent("label",e).$_modify({each:(t,r)=>"is"!==r.path[0]?t.label(e):void 0,ref:!1})}},rebuild(e){e.$_modify({each:t=>{n.isSchema(t)&&"array"===t.type&&e.$_setFlag("_arrayItems",!0,{clone:!1})}})},manifest:{build(e,t){if(t.matches)for(const r of t.matches){const{schema:t,ref:n,is:i,not:s,then:o,otherwise:a}=r;e=t?e.try(t):n?e.conditional(n,{is:i,then:o,not:s,otherwise:a,switch:r.switch}):e.conditional(i,{then:o,otherwise:a})}return e}},messages:{"alternatives.all":"{{#label}} does not match all of the required types","alternatives.any":"{{#label}} does not match any of the allowed types","alternatives.match":"{{#label}} does not match any of the allowed types","alternatives.one":"{{#label}} matches more than one allowed type","alternatives.types":"{{#label}} must be one of {{#types}}"}}),a.errors=function(e,{error:t,state:r}){if(!e.length)return{errors:t("alternatives.any")};if(1===e.length)return{errors:e[0].reports};const n=new Set,i=[];for(const{reports:o,schema:c}of e){if(o.length>1)return a.unmatched(e,t);const l=o[0];if(l instanceof s.Report==!1)return a.unmatched(e,t);if(l.state.path.length!==r.path.length){i.push({type:c.type,report:l});continue}if("any.only"===l.code){for(const e of l.local.valids)n.add(e);continue}const[u,h]=l.code.split(".");"base"===h?n.add(u):i.push({type:c.type,report:l})}return i.length?1===i.length?{errors:i[0].report}:a.unmatched(e,t):{errors:t("alternatives.types",{types:[...n]})}},a.unmatched=function(e,t){const r=[];for(const t of e)r.push(...t.reports);return{errors:t("alternatives.match",s.details(r,{override:!1}))}},ht}function xt(){if(dt)return pt;dt=1;const e=G,t=Ve,r=J,n=At(),i=Ie(),s=De(),o={};return pt=n.extend({type:"array",flags:{single:{default:!1},sparse:{default:!1}},terms:{items:{init:[],manifest:"schema"},ordered:{init:[],manifest:"schema"},_exclusions:{init:[]},_inclusions:{init:[]},_requireds:{init:[]}},coerce:{from:"object",method(e,{schema:t,state:r,prefs:n}){if(!Array.isArray(e))return;const i=t.$_getRule("sort");return i?o.sort(t,e,i.args.options,r,n):void 0}},validate(e,{schema:t,error:r}){if(!Array.isArray(e)){if(t._flags.single){const t=[e];return t[i.symbols.arraySingle]=!0,{value:t}}return{errors:r("array.base")}}if(t.$_getRule("items")||t.$_terms.externals)return{value:e.slice()}},rules:{has:{method(e){e=this.$_compile(e,{appendPath:!0});const t=this.$_addRule({name:"has",args:{schema:e}});return t.$_mutateRegister(e),t},validate(e,{state:t,prefs:r,error:n},{schema:i}){const s=[e,...t.ancestors];for(let n=0;n<e.length;++n){const o=t.localize([...t.path,n],s,i);if(i.$_match(e[n],o,r))return e}const o=i._flags.label;return o?n("array.hasKnown",{patternLabel:o}):n("array.hasUnknown",null)},multi:!0},items:{method(...e){i.verifyFlat(e,"items");const t=this.$_addRule("items");for(let r=0;r<e.length;++r){const n=i.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});t.$_terms.items.push(n)}return t.$_mutateRebuild()},validate(e,{schema:t,error:r,state:n,prefs:s,errorsArray:a}){const c=t.$_terms._requireds.slice(),l=t.$_terms.ordered.slice(),u=[...t.$_terms._inclusions,...c],h=!e[i.symbols.arraySingle];delete e[i.symbols.arraySingle];const f=a();let p=e.length;for(let i=0;i<p;++i){const a=e[i];let d=!1,m=!1;const y=h?i:new Number(i),g=[...n.path,y];if(!t._flags.sparse&&void 0===a){if(f.push(r("array.sparse",{key:y,path:g,pos:i,value:void 0},n.localize(g))),s.abortEarly)return f;l.shift();continue}const v=[e,...n.ancestors];for(const e of t.$_terms._exclusions)if(e.$_match(a,n.localize(g,v,e),s,{presence:"ignore"})){if(f.push(r("array.excludes",{pos:i,value:a},n.localize(g))),s.abortEarly)return f;d=!0,l.shift();break}if(d)continue;if(t.$_terms.ordered.length){if(l.length){const c=l.shift(),u=c.$_validate(a,n.localize(g,v,c),s);if(u.errors){if(f.push(...u.errors),s.abortEarly)return f}else if("strip"===c._flags.result)o.fastSplice(e,i),--i,--p;else{if(!t._flags.sparse&&void 0===u.value){if(f.push(r("array.sparse",{key:y,path:g,pos:i,value:void 0},n.localize(g))),s.abortEarly)return f;continue}e[i]=u.value}continue}if(!t.$_terms.items.length){if(f.push(r("array.orderedLength",{pos:i,limit:t.$_terms.ordered.length})),s.abortEarly)return f;break}}const b=[];let w=c.length;for(let l=0;l<w;++l){const u=n.localize(g,v,c[l]);u.snapshot();const h=c[l].$_validate(a,u,s);if(b[l]=h,!h.errors){if(u.commit(),e[i]=h.value,m=!0,o.fastSplice(c,l),--l,--w,!t._flags.sparse&&void 0===h.value&&(f.push(r("array.sparse",{key:y,path:g,pos:i,value:void 0},n.localize(g))),s.abortEarly))return f;break}u.restore()}if(m)continue;const _=s.stripUnknown&&!!s.stripUnknown.arrays||!1;w=u.length;for(const l of u){let u;const h=c.indexOf(l);if(-1!==h)u=b[h];else{const c=n.localize(g,v,l);if(c.snapshot(),u=l.$_validate(a,c,s),!u.errors){c.commit(),"strip"===l._flags.result?(o.fastSplice(e,i),--i,--p):t._flags.sparse||void 0!==u.value?e[i]=u.value:(f.push(r("array.sparse",{key:y,path:g,pos:i,value:void 0},n.localize(g))),d=!0),m=!0;break}c.restore()}if(1===w){if(_){o.fastSplice(e,i),--i,--p,m=!0;break}if(f.push(...u.errors),s.abortEarly)return f;d=!0;break}}if(!d&&((t.$_terms._inclusions.length||t.$_terms._requireds.length)&&!m)){if(_){o.fastSplice(e,i),--i,--p;continue}if(f.push(r("array.includes",{pos:i,value:a},n.localize(g))),s.abortEarly)return f}}return c.length&&o.fillMissedErrors(t,f,c,e,n,s),l.length&&(o.fillOrderedErrors(t,f,l,e,n,s),f.length||o.fillDefault(l,e,n,s)),f.length?f:e},priority:!0,manifest:!1},length:{method(e){return this.$_addRule({name:"length",args:{limit:e},operator:"="})},validate:(e,t,{limit:r},{name:n,operator:s,args:o})=>i.compare(e.length,r,s)?e:t.error("array."+n,{limit:o.limit,value:e}),args:[{name:"limit",ref:!0,assert:i.limit,message:"must be a positive integer"}]},max:{method(e){return this.$_addRule({name:"max",method:"length",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"length",args:{limit:e},operator:">="})}},ordered:{method(...e){i.verifyFlat(e,"ordered");const t=this.$_addRule("items");for(let r=0;r<e.length;++r){const n=i.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});o.validateSingle(n,t),t.$_mutateRegister(n),t.$_terms.ordered.push(n)}return t.$_mutateRebuild()}},single:{method(t){const r=void 0===t||!!t;return e(!r||!this._flags._arrayItems,"Cannot specify single rule when array has array items"),this.$_setFlag("single",r)}},sort:{method(t={}){i.assertOptions(t,["by","order"]);const r={order:t.order||"ascending"};return t.by&&(r.by=s.ref(t.by,{ancestor:0}),e(!r.by.ancestor,"Cannot sort by ancestor")),this.$_addRule({name:"sort",args:{options:r}})},validate(e,{error:t,state:r,prefs:n,schema:i},{options:s}){const{value:a,errors:c}=o.sort(i,e,s,r,n);if(c)return c;for(let r=0;r<e.length;++r)if(e[r]!==a[r])return t("array.sort",{order:s.order,by:s.by?s.by.key:"value"});return e},convert:!0},sparse:{method(e){const t=void 0===e||!!e;if(this._flags.sparse===t)return this;return(t?this.clone():this.$_addRule("items")).$_setFlag("sparse",t,{clone:!1})}},unique:{method(t,r={}){e(!t||"function"==typeof t||"string"==typeof t,"comparator must be a function or a string"),i.assertOptions(r,["ignoreUndefined","separator"]);const n={name:"unique",args:{options:r,comparator:t}};if(t)if("string"==typeof t){const e=i.default(r.separator,".");n.path=e?t.split(e):[t]}else n.comparator=t;return this.$_addRule(n)},validate(n,{state:i,error:s,schema:o},{comparator:a,options:c},{comparator:l,path:u}){const h={string:Object.create(null),number:Object.create(null),undefined:Object.create(null),boolean:Object.create(null),object:new Map,function:new Map,custom:new Map},f=l||t,p=c.ignoreUndefined;for(let t=0;t<n.length;++t){const o=u?r(n[t],u):n[t],c=l?h.custom:h[typeof o];if(e(c,"Failed to find unique map container for type",typeof o),c instanceof Map){const e=c.entries();let r;for(;!(r=e.next()).done;)if(f(r.value[0],o)){const e=i.localize([...i.path,t],[n,...i.ancestors]),o={pos:t,value:n[t],dupePos:r.value[1],dupeValue:n[r.value[1]]};return u&&(o.path=a),s("array.unique",o,e)}c.set(o,t)}else{if((!p||void 0!==o)&&void 0!==c[o]){const e={pos:t,value:n[t],dupePos:c[o],dupeValue:n[c[o]]};u&&(e.path=a);return s("array.unique",e,i.localize([...i.path,t],[n,...i.ancestors]))}c[o]=t}}return n},args:["comparator","options"],multi:!0}},cast:{set:{from:Array.isArray,to:(e,t)=>new Set(e)}},rebuild(e){e.$_terms._inclusions=[],e.$_terms._exclusions=[],e.$_terms._requireds=[];for(const t of e.$_terms.items)o.validateSingle(t,e),"required"===t._flags.presence?e.$_terms._requireds.push(t):"forbidden"===t._flags.presence?e.$_terms._exclusions.push(t):e.$_terms._inclusions.push(t);for(const t of e.$_terms.ordered)o.validateSingle(t,e)},manifest:{build:(e,t)=>(t.items&&(e=e.items(...t.items)),t.ordered&&(e=e.ordered(...t.ordered)),e)},messages:{"array.base":"{{#label}} must be an array","array.excludes":"{{#label}} contains an excluded value","array.hasKnown":"{{#label}} does not contain at least one required match for type {:#patternLabel}","array.hasUnknown":"{{#label}} does not contain at least one required match","array.includes":"{{#label}} does not match any of the allowed types","array.includesRequiredBoth":"{{#label}} does not contain {{#knownMisses}} and {{#unknownMisses}} other required value(s)","array.includesRequiredKnowns":"{{#label}} does not contain {{#knownMisses}}","array.includesRequiredUnknowns":"{{#label}} does not contain {{#unknownMisses}} required value(s)","array.length":"{{#label}} must contain {{#limit}} items","array.max":"{{#label}} must contain less than or equal to {{#limit}} items","array.min":"{{#label}} must contain at least {{#limit}} items","array.orderedLength":"{{#label}} must contain at most {{#limit}} items","array.sort":"{{#label}} must be sorted in {#order} order by {{#by}}","array.sort.mismatching":"{{#label}} cannot be sorted due to mismatching types","array.sort.unsupported":"{{#label}} cannot be sorted due to unsupported type {#type}","array.sparse":"{{#label}} must not be a sparse array item","array.unique":"{{#label}} contains a duplicate value"}}),o.fillMissedErrors=function(e,t,r,n,i,s){const o=[];let a=0;for(const e of r){const t=e._flags.label;t?o.push(t):++a}o.length?a?t.push(e.$_createError("array.includesRequiredBoth",n,{knownMisses:o,unknownMisses:a},i,s)):t.push(e.$_createError("array.includesRequiredKnowns",n,{knownMisses:o},i,s)):t.push(e.$_createError("array.includesRequiredUnknowns",n,{unknownMisses:a},i,s))},o.fillOrderedErrors=function(e,t,r,n,i,s){const a=[];for(const e of r)"required"===e._flags.presence&&a.push(e);a.length&&o.fillMissedErrors(e,t,a,n,i,s)},o.fillDefault=function(e,t,r,n){const i=[];let s=!0;for(let o=e.length-1;o>=0;--o){const a=e[o],c=[t,...r.ancestors],l=a.$_validate(void 0,r.localize(r.path,c,a),n).value;if(s){if(void 0===l)continue;s=!1}i.unshift(l)}i.length&&t.push(...i)},o.fastSplice=function(e,t){let r=t;for(;r<e.length;)e[r++]=e[r];--e.length},o.validateSingle=function(t,r){("array"===t.type||t._flags._arrayItems)&&(e(!r._flags.single,"Cannot specify array item with single rule enabled"),r.$_setFlag("_arrayItems",!0,{clone:!1}))},o.sort=function(e,t,r,n,i){const s="ascending"===r.order?1:-1,a=-1*s,c=s,l=(l,u)=>{let h=o.compare(l,u,a,c);if(null!==h)return h;if(r.by&&(l=r.by.resolve(l,n,i),u=r.by.resolve(u,n,i)),h=o.compare(l,u,a,c),null!==h)return h;const f=typeof l;if(f!==typeof u)throw e.$_createError("array.sort.mismatching",t,null,n,i);if("number"!==f&&"string"!==f)throw e.$_createError("array.sort.unsupported",t,{type:f},n,i);return"number"===f?(l-u)*s:l<u?a:c};try{return{value:t.slice().sort(l)}}catch(e){return{errors:e}}},o.compare=function(e,t,r,n){return e===t?0:void 0===e?1:void 0===t?-1:null===e?n:null===t?r:null},pt}function Ct(){if(yt)return mt;yt=1;const e=G,t=At(),r=Ie(),n=St(),i={isBool:function(e){return"boolean"==typeof e}};return mt=t.extend({type:"boolean",flags:{sensitive:{default:!1}},terms:{falsy:{init:null,manifest:"values"},truthy:{init:null,manifest:"values"}},coerce(e,{schema:t}){if("boolean"!=typeof e){if("string"==typeof e){const r=t._flags.sensitive?e:e.toLowerCase();e="true"===r||"false"!==r&&e}return"boolean"!=typeof e&&(e=t.$_terms.truthy&&t.$_terms.truthy.has(e,null,null,!t._flags.sensitive)||(!t.$_terms.falsy||!t.$_terms.falsy.has(e,null,null,!t._flags.sensitive))&&e),{value:e}}},validate(e,{error:t}){if("boolean"!=typeof e)return{value:e,errors:t("boolean.base")}},rules:{truthy:{method(...t){r.verifyFlat(t,"truthy");const i=this.clone();i.$_terms.truthy=i.$_terms.truthy||new n;for(let r=0;r<t.length;++r){const n=t[r];e(void 0!==n,"Cannot call truthy with undefined"),i.$_terms.truthy.add(n)}return i}},falsy:{method(...t){r.verifyFlat(t,"falsy");const i=this.clone();i.$_terms.falsy=i.$_terms.falsy||new n;for(let r=0;r<t.length;++r){const n=t[r];e(void 0!==n,"Cannot call falsy with undefined"),i.$_terms.falsy.add(n)}return i}},sensitive:{method(e=!0){return this.$_setFlag("sensitive",e)}}},cast:{number:{from:i.isBool,to:(e,t)=>e?1:0},string:{from:i.isBool,to:(e,t)=>e?"true":"false"}},manifest:{build:(e,t)=>(t.truthy&&(e=e.truthy(...t.truthy)),t.falsy&&(e=e.falsy(...t.falsy)),e)},messages:{"boolean.base":"{{#label}} must be a boolean"}}),mt}function Rt(){if(vt)return gt;vt=1;const e=G,t=At(),r=Ie(),n=Oe(),i={isDate:function(e){return e instanceof Date}};return gt=t.extend({type:"date",coerce:{from:["number","string"],method:(e,{schema:t})=>({value:i.parse(e,t._flags.format)||e})},validate(e,{schema:t,error:r,prefs:n}){if(e instanceof Date&&!isNaN(e.getTime()))return;const i=t._flags.format;return n.convert&&i&&"string"==typeof e?{value:e,errors:r("date.format",{format:i})}:{value:e,errors:r("date.base")}},rules:{compare:{method:!1,validate(e,t,{date:n},{name:i,operator:s,args:o}){const a="now"===n?Date.now():n.getTime();return r.compare(e.getTime(),a,s)?e:t.error("date."+i,{limit:o.date,value:e})},args:[{name:"date",ref:!0,normalize:e=>"now"===e?e:i.parse(e),assert:e=>null!==e,message:"must have a valid date format"}]},format:{method(t){return e(["iso","javascript","unix"].includes(t),"Unknown date format",t),this.$_setFlag("format",t)}},greater:{method(e){return this.$_addRule({name:"greater",method:"compare",args:{date:e},operator:">"})}},iso:{method(){return this.format("iso")}},less:{method(e){return this.$_addRule({name:"less",method:"compare",args:{date:e},operator:"<"})}},max:{method(e){return this.$_addRule({name:"max",method:"compare",args:{date:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"compare",args:{date:e},operator:">="})}},timestamp:{method(t="javascript"){return e(["javascript","unix"].includes(t),'"type" must be one of "javascript, unix"'),this.format(t)}}},cast:{number:{from:i.isDate,to:(e,t)=>e.getTime()},string:{from:i.isDate,to:(e,{prefs:t})=>n.date(e,t)}},messages:{"date.base":"{{#label}} must be a valid date","date.format":'{{#label}} must be in {msg("date.format." + #format) || #format} format',"date.greater":"{{#label}} must be greater than {{:#limit}}","date.less":"{{#label}} must be less than {{:#limit}}","date.max":"{{#label}} must be less than or equal to {{:#limit}}","date.min":"{{#label}} must be greater than or equal to {{:#limit}}","date.format.iso":"ISO 8601 date","date.format.javascript":"timestamp or number of milliseconds","date.format.unix":"timestamp or number of seconds"}}),i.parse=function(e,t){if(e instanceof Date)return e;if("string"!=typeof e&&(isNaN(e)||!isFinite(e)))return null;if(/^\s*$/.test(e))return null;if("iso"===t)return r.isIsoDate(e)?i.date(e.toString()):null;const n=e;if("string"==typeof e&&/^[+-]?\d+(\.\d+)?$/.test(e)&&(e=parseFloat(e)),t){if("javascript"===t)return i.date(1*e);if("unix"===t)return i.date(1e3*e);if("string"==typeof n)return null}return i.date(e)},i.date=function(e){const t=new Date(e);return isNaN(t.getTime())?null:t},gt}const Ot=G,Nt=ie,It=et,Tt=J,Pt={};var Bt=function(e,t,r={}){if(Ot(e&&"object"==typeof e,"Invalid defaults value: must be an object"),Ot(!t||!0===t||"object"==typeof t,"Invalid source value: must be true, falsy or an object"),Ot("object"==typeof r,"Invalid options: must be an object"),!t)return null;if(r.shallow)return Pt.applyToDefaultsWithShallow(e,t,r);const n=Nt(e);if(!0===t)return n;const i=void 0!==r.nullOverride&&r.nullOverride;return It(n,t,{nullOverride:i,mergeArrays:!1})};Pt.applyToDefaultsWithShallow=function(e,t,r){const n=r.shallow;Ot(Array.isArray(n),"Invalid keys");const i=new Map,s=!0===t?null:new Set;for(let r of n){r=Array.isArray(r)?r:r.split(".");const n=Tt(e,r);n&&"object"==typeof n?i.set(n,s&&Tt(t,r)||n):s&&s.add(r)}const o=Nt(e,{},i);if(!s)return o;for(const e of s)Pt.reachCopy(o,t,e);const a=void 0!==r.nullOverride&&r.nullOverride;return It(o,t,{nullOverride:a,mergeArrays:!1})},Pt.reachCopy=function(e,t,r){for(const e of r){if(!(e in t))return;const r=t[e];if("object"!=typeof r||null===r)return;t=r}const n=t;let i=e;for(let e=0;e<r.length-1;++e){const t=r[e];"object"!=typeof i[t]&&(i[t]={}),i=i[t]}i[r[r.length-1]]=n};var Dt={};const $t=G,Lt={};var jt,Mt,Ut,Kt,Ft,Ht,zt,Vt,qt,Gt;function Wt(){if(Mt)return jt;Mt=1;const e=Bt,t=G,r=ie,n=Dt,i=At(),s=Ie(),o=De(),a=_e(),c=Re(),l=Oe(),u={renameDefaults:{alias:!1,multiple:!1,override:!1}};return jt=i.extend({type:"_keys",properties:{typeof:"object"},flags:{unknown:{default:!1}},terms:{dependencies:{init:null},keys:{init:null,manifest:{mapped:{from:"schema",to:"key"}}},patterns:{init:null},renames:{init:null}},args:(e,t)=>e.keys(t),validate(e,{schema:t,error:r,state:n,prefs:i}){if(!e||typeof e!==t.$_property("typeof")||Array.isArray(e))return{value:e,errors:r("object.base",{type:t.$_property("typeof")})};if(!(t.$_terms.renames||t.$_terms.dependencies||t.$_terms.keys||t.$_terms.patterns||t.$_terms.externals))return;e=u.clone(e,i);const s=[];if(t.$_terms.renames&&!u.rename(t,e,n,i,s))return{value:e,errors:s};if(!t.$_terms.keys&&!t.$_terms.patterns&&!t.$_terms.dependencies)return{value:e,errors:s};const o=new Set(Object.keys(e));if(t.$_terms.keys){const r=[e,...n.ancestors];for(const a of t.$_terms.keys){const t=a.key,c=e[t];o.delete(t);const l=n.localize([...n.path,t],r,a),u=a.schema.$_validate(c,l,i);if(u.errors){if(i.abortEarly)return{value:e,errors:u.errors};void 0!==u.value&&(e[t]=u.value),s.push(...u.errors)}else"strip"===a.schema._flags.result||void 0===u.value&&void 0!==c?delete e[t]:void 0!==u.value&&(e[t]=u.value)}}if(o.size||t._flags._hasPatternMatch){const r=u.unknown(t,e,o,s,n,i);if(r)return r}if(t.$_terms.dependencies)for(const r of t.$_terms.dependencies){if(null!==r.key&&!1===u.isPresent(r.options)(r.key.resolve(e,n,i,null,{shadow:!1})))continue;const o=u.dependencies[r.rel](t,r,e,n,i);if(o){const r=t.$_createError(o.code,e,o.context,n,i);if(i.abortEarly)return{value:e,errors:r};s.push(r)}}return{value:e,errors:s}},rules:{and:{method(...e){return s.verifyFlat(e,"and"),u.dependency(this,"and",null,e)}},append:{method(e){return null==e||0===Object.keys(e).length?this:this.keys(e)}},assert:{method(e,r,n){l.isTemplate(e)||(e=o.ref(e)),t(void 0===n||"string"==typeof n,"Message must be a string"),r=this.$_compile(r,{appendPath:!0});const i=this.$_addRule({name:"assert",args:{subject:e,schema:r,message:n}});return i.$_mutateRegister(e),i.$_mutateRegister(r),i},validate(e,{error:t,prefs:r,state:n},{subject:i,schema:s,message:o}){const a=i.resolve(e,n,r),l=c.isRef(i)?i.absolute(n):[];return s.$_match(a,n.localize(l,[e,...n.ancestors],s),r)?e:t("object.assert",{subject:i,message:o})},args:["subject","schema","message"],multi:!0},instance:{method(e,r){return t("function"==typeof e,"constructor must be a function"),r=r||e.name,this.$_addRule({name:"instance",args:{constructor:e,name:r}})},validate:(e,t,{constructor:r,name:n})=>e instanceof r?e:t.error("object.instance",{type:n,value:e}),args:["constructor","name"]},keys:{method(e){t(void 0===e||"object"==typeof e,"Object schema must be a valid object"),t(!s.isSchema(e),"Object schema cannot be a joi schema");const r=this.clone();if(e)if(Object.keys(e).length){r.$_terms.keys=r.$_terms.keys?r.$_terms.keys.filter((t=>!e.hasOwnProperty(t.key))):new u.Keys;for(const t in e)s.tryWithPath((()=>r.$_terms.keys.push({key:t,schema:this.$_compile(e[t])})),t)}else r.$_terms.keys=new u.Keys;else r.$_terms.keys=null;return r.$_mutateRebuild()}},length:{method(e){return this.$_addRule({name:"length",args:{limit:e},operator:"="})},validate:(e,t,{limit:r},{name:n,operator:i,args:o})=>s.compare(Object.keys(e).length,r,i)?e:t.error("object."+n,{limit:o.limit,value:e}),args:[{name:"limit",ref:!0,assert:s.limit,message:"must be a positive integer"}]},max:{method(e){return this.$_addRule({name:"max",method:"length",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"length",args:{limit:e},operator:">="})}},nand:{method(...e){return s.verifyFlat(e,"nand"),u.dependency(this,"nand",null,e)}},or:{method(...e){return s.verifyFlat(e,"or"),u.dependency(this,"or",null,e)}},oxor:{method(...e){return u.dependency(this,"oxor",null,e)}},pattern:{method(e,r,n={}){const i=e instanceof RegExp;i||(e=this.$_compile(e,{appendPath:!0})),t(void 0!==r,"Invalid rule"),s.assertOptions(n,["fallthrough","matches"]),i&&t(!e.flags.includes("g")&&!e.flags.includes("y"),"pattern should not use global or sticky mode"),r=this.$_compile(r,{appendPath:!0});const o=this.clone();o.$_terms.patterns=o.$_terms.patterns||[];const a={[i?"regex":"schema"]:e,rule:r};return n.matches&&(a.matches=this.$_compile(n.matches),"array"!==a.matches.type&&(a.matches=a.matches.$_root.array().items(a.matches)),o.$_mutateRegister(a.matches),o.$_setFlag("_hasPatternMatch",!0,{clone:!1})),n.fallthrough&&(a.fallthrough=!0),o.$_terms.patterns.push(a),o.$_mutateRegister(r),o}},ref:{method(){return this.$_addRule("ref")},validate:(e,t)=>c.isRef(e)?e:t.error("object.refType",{value:e})},regex:{method(){return this.$_addRule("regex")},validate:(e,t)=>e instanceof RegExp?e:t.error("object.regex",{value:e})},rename:{method(r,n,i={}){t("string"==typeof r||r instanceof RegExp,"Rename missing the from argument"),t("string"==typeof n||n instanceof l,"Invalid rename to argument"),t(n!==r,"Cannot rename key to same name:",r),s.assertOptions(i,["alias","ignoreUndefined","override","multiple"]);const o=this.clone();o.$_terms.renames=o.$_terms.renames||[];for(const e of o.$_terms.renames)t(e.from!==r,"Cannot rename the same key multiple times");return n instanceof l&&o.$_mutateRegister(n),o.$_terms.renames.push({from:r,to:n,options:e(u.renameDefaults,i)}),o}},schema:{method(e="any"){return this.$_addRule({name:"schema",args:{type:e}})},validate:(e,t,{type:r})=>!s.isSchema(e)||"any"!==r&&e.type!==r?t.error("object.schema",{type:r}):e},unknown:{method(e){return this.$_setFlag("unknown",!1!==e)}},with:{method(e,t,r={}){return u.dependency(this,"with",e,t,r)}},without:{method(e,t,r={}){return u.dependency(this,"without",e,t,r)}},xor:{method(...e){return s.verifyFlat(e,"xor"),u.dependency(this,"xor",null,e)}}},overrides:{default(e,t){return void 0===e&&(e=s.symbols.deepDefault),this.$_parent("default",e,t)}},rebuild(e){if(e.$_terms.keys){const t=new n.Sorter;for(const r of e.$_terms.keys)s.tryWithPath((()=>t.add(r,{after:r.schema.$_rootReferences(),group:r.key})),r.key);e.$_terms.keys=new u.Keys(...t.nodes)}},manifest:{build(e,t){if(t.keys&&(e=e.keys(t.keys)),t.dependencies)for(const{rel:r,key:n=null,peers:i,options:s}of t.dependencies)e=u.dependency(e,r,n,i,s);if(t.patterns)for(const{regex:r,schema:n,rule:i,fallthrough:s,matches:o}of t.patterns)e=e.pattern(r||n,i,{fallthrough:s,matches:o});if(t.renames)for(const{from:r,to:n,options:i}of t.renames)e=e.rename(r,n,i);return e}},messages:{"object.and":"{{#label}} contains {{#presentWithLabels}} without its required peers {{#missingWithLabels}}","object.assert":'{{#label}} is invalid because {if(#subject.key, `"` + #subject.key + `" failed to ` + (#message || "pass the assertion test"), #message || "the assertion failed")}',"object.base":"{{#label}} must be of type {{#type}}","object.instance":"{{#label}} must be an instance of {{:#type}}","object.length":'{{#label}} must have {{#limit}} key{if(#limit == 1, "", "s")}',"object.max":'{{#label}} must have less than or equal to {{#limit}} key{if(#limit == 1, "", "s")}',"object.min":'{{#label}} must have at least {{#limit}} key{if(#limit == 1, "", "s")}',"object.missing":"{{#label}} must contain at least one of {{#peersWithLabels}}","object.nand":"{{:#mainWithLabel}} must not exist simultaneously with {{#peersWithLabels}}","object.oxor":"{{#label}} contains a conflict between optional exclusive peers {{#peersWithLabels}}","object.pattern.match":"{{#label}} keys failed to match pattern requirements","object.refType":"{{#label}} must be a Joi reference","object.regex":"{{#label}} must be a RegExp object","object.rename.multiple":"{{#label}} cannot rename {{:#from}} because multiple renames are disabled and another key was already renamed to {{:#to}}","object.rename.override":"{{#label}} cannot rename {{:#from}} because override is disabled and target {{:#to}} exists","object.schema":"{{#label}} must be a Joi schema of {{#type}} type","object.unknown":"{{#label}} is not allowed","object.with":"{{:#mainWithLabel}} missing required peer {{:#peerWithLabel}}","object.without":"{{:#mainWithLabel}} conflict with forbidden peer {{:#peerWithLabel}}","object.xor":"{{#label}} contains a conflict between exclusive peers {{#peersWithLabels}}"}}),u.clone=function(e,t){if("object"==typeof e){if(t.nonEnumerables)return r(e,{shallow:!0});const n=Object.create(Object.getPrototypeOf(e));return Object.assign(n,e),n}const n=function(...t){return e.apply(this,t)};return n.prototype=r(e.prototype),Object.defineProperty(n,"name",{value:e.name,writable:!1}),Object.defineProperty(n,"length",{value:e.length,writable:!1}),Object.assign(n,e),n},u.dependency=function(e,r,n,i,a){t(null===n||"string"==typeof n,r,"key must be a strings"),a||(a=i.length>1&&"object"==typeof i[i.length-1]?i.pop():{}),s.assertOptions(a,["separator","isPresent"]),i=[].concat(i);const c=s.default(a.separator,"."),l=[];for(const e of i)t("string"==typeof e,r,"peers must be strings"),l.push(o.ref(e,{separator:c,ancestor:0,prefix:!1}));null!==n&&(n=o.ref(n,{separator:c,ancestor:0,prefix:!1}));const h=e.clone();return h.$_terms.dependencies=h.$_terms.dependencies||[],h.$_terms.dependencies.push(new u.Dependency(r,n,l,i,a)),h},u.dependencies={and(e,t,r,n,i){const s=[],o=[],a=t.peers.length,c=u.isPresent(t.options);for(const e of t.peers)!1===c(e.resolve(r,n,i,null,{shadow:!1}))?s.push(e.key):o.push(e.key);if(s.length!==a&&o.length!==a)return{code:"object.and",context:{present:o,presentWithLabels:u.keysToLabels(e,o),missing:s,missingWithLabels:u.keysToLabels(e,s)}}},nand(e,t,r,n,i){const s=[],o=u.isPresent(t.options);for(const e of t.peers)o(e.resolve(r,n,i,null,{shadow:!1}))&&s.push(e.key);if(s.length!==t.peers.length)return;const a=t.paths[0],c=t.paths.slice(1);return{code:"object.nand",context:{main:a,mainWithLabel:u.keysToLabels(e,a),peers:c,peersWithLabels:u.keysToLabels(e,c)}}},or(e,t,r,n,i){const s=u.isPresent(t.options);for(const e of t.peers)if(s(e.resolve(r,n,i,null,{shadow:!1})))return;return{code:"object.missing",context:{peers:t.paths,peersWithLabels:u.keysToLabels(e,t.paths)}}},oxor(e,t,r,n,i){const s=[],o=u.isPresent(t.options);for(const e of t.peers)o(e.resolve(r,n,i,null,{shadow:!1}))&&s.push(e.key);if(!s.length||1===s.length)return;const a={peers:t.paths,peersWithLabels:u.keysToLabels(e,t.paths)};return a.present=s,a.presentWithLabels=u.keysToLabels(e,s),{code:"object.oxor",context:a}},with(e,t,r,n,i){const s=u.isPresent(t.options);for(const o of t.peers)if(!1===s(o.resolve(r,n,i,null,{shadow:!1})))return{code:"object.with",context:{main:t.key.key,mainWithLabel:u.keysToLabels(e,t.key.key),peer:o.key,peerWithLabel:u.keysToLabels(e,o.key)}}},without(e,t,r,n,i){const s=u.isPresent(t.options);for(const o of t.peers)if(s(o.resolve(r,n,i,null,{shadow:!1})))return{code:"object.without",context:{main:t.key.key,mainWithLabel:u.keysToLabels(e,t.key.key),peer:o.key,peerWithLabel:u.keysToLabels(e,o.key)}}},xor(e,t,r,n,i){const s=[],o=u.isPresent(t.options);for(const e of t.peers)o(e.resolve(r,n,i,null,{shadow:!1}))&&s.push(e.key);if(1===s.length)return;const a={peers:t.paths,peersWithLabels:u.keysToLabels(e,t.paths)};return 0===s.length?{code:"object.missing",context:a}:(a.present=s,a.presentWithLabels=u.keysToLabels(e,s),{code:"object.xor",context:a})}},u.keysToLabels=function(e,t){return Array.isArray(t)?t.map((t=>e.$_mapLabels(t))):e.$_mapLabels(t)},u.isPresent=function(e){return"function"==typeof e.isPresent?e.isPresent:e=>void 0!==e},u.rename=function(e,t,r,n,i){const s={};for(const o of e.$_terms.renames){const a=[],c="string"!=typeof o.from;if(c)for(const e in t){if(void 0===t[e]&&o.options.ignoreUndefined)continue;if(e===o.to)continue;const r=o.from.exec(e);r&&a.push({from:e,to:o.to,match:r})}else!Object.prototype.hasOwnProperty.call(t,o.from)||void 0===t[o.from]&&o.options.ignoreUndefined||a.push(o);for(const u of a){const a=u.from;let h=u.to;if(h instanceof l&&(h=h.render(t,r,n,u.match)),a!==h){if(!o.options.multiple&&s[h]&&(i.push(e.$_createError("object.rename.multiple",t,{from:a,to:h,pattern:c},r,n)),n.abortEarly))return!1;if(Object.prototype.hasOwnProperty.call(t,h)&&!o.options.override&&!s[h]&&(i.push(e.$_createError("object.rename.override",t,{from:a,to:h,pattern:c},r,n)),n.abortEarly))return!1;void 0===t[a]?delete t[h]:t[h]=t[a],s[h]=!0,o.options.alias||delete t[a]}}}return!0},u.unknown=function(e,t,r,n,i,o){if(e.$_terms.patterns){let s=!1;const c=e.$_terms.patterns.map((e=>{if(e.matches)return s=!0,[]})),l=[t,...i.ancestors];for(const s of r){const a=t[s],u=[...i.path,s];for(let h=0;h<e.$_terms.patterns.length;++h){const f=e.$_terms.patterns[h];if(f.regex){const e=f.regex.test(s);if(i.mainstay.tracer.debug(i,"rule",`pattern.${h}`,e?"pass":"error"),!e)continue}else if(!f.schema.$_match(s,i.nest(f.schema,`pattern.${h}`),o))continue;r.delete(s);const p=i.localize(u,l,{schema:f.rule,key:s}),d=f.rule.$_validate(a,p,o);if(d.errors){if(o.abortEarly)return{value:t,errors:d.errors};n.push(...d.errors)}if(f.matches&&c[h].push(s),t[s]=d.value,!f.fallthrough)break}}if(s)for(let r=0;r<c.length;++r){const s=c[r];if(!s)continue;const u=e.$_terms.patterns[r].matches,h=i.localize(i.path,l,u),f=u.$_validate(s,h,o);if(f.errors){const r=a.details(f.errors,{override:!1});r.matches=s;const c=e.$_createError("object.pattern.match",t,r,i,o);if(o.abortEarly)return{value:t,errors:c};n.push(c)}}}if(!r.size||!e.$_terms.keys&&!e.$_terms.patterns)return;if(o.stripUnknown&&!e._flags.unknown||o.skipFunctions){const e=!!o.stripUnknown&&(!0===o.stripUnknown||!!o.stripUnknown.objects);for(const n of r)e?(delete t[n],r.delete(n)):"function"==typeof t[n]&&r.delete(n)}if(!s.default(e._flags.unknown,o.allowUnknown))for(const s of r){const r=i.localize([...i.path,s],[]),a=e.$_createError("object.unknown",t[s],{child:s},r,o,{flags:!1});if(o.abortEarly)return{value:t,errors:a};n.push(a)}},u.Dependency=class{constructor(e,t,r,n,i){this.rel=e,this.key=t,this.peers=r,this.paths=n,this.options=i}describe(){const e={rel:this.rel,peers:this.paths};return null!==this.key&&(e.key=this.key.key),"."!==this.peers[0].separator&&(e.options={...e.options,separator:this.peers[0].separator}),this.options.isPresent&&(e.options={...e.options,isPresent:this.options.isPresent}),e}},u.Keys=class extends Array{concat(e){const t=this.slice(),r=new Map;for(let e=0;e<t.length;++e)r.set(t[e].key,e);for(const n of e){const e=n.key,i=r.get(e);void 0!==i?t[i]={key:e,schema:t[i].schema.concat(n.schema)}:t.push(n)}return t}},jt}function Xt(){if(Kt)return Ut;Kt=1;const e=G,t=Wt();return Ut=t.extend({type:"function",properties:{typeof:"function"},rules:{arity:{method(t){return e(Number.isSafeInteger(t)&&t>=0,"n must be a positive integer"),this.$_addRule({name:"arity",args:{n:t}})},validate:(e,t,{n:r})=>e.length===r?e:t.error("function.arity",{n:r})},class:{method(){return this.$_addRule("class")},validate:(e,t)=>/^\s*class\s/.test(e.toString())?e:t.error("function.class",{value:e})},minArity:{method(t){return e(Number.isSafeInteger(t)&&t>0,"n must be a strict positive integer"),this.$_addRule({name:"minArity",args:{n:t}})},validate:(e,t,{n:r})=>e.length>=r?e:t.error("function.minArity",{n:r})},maxArity:{method(t){return e(Number.isSafeInteger(t)&&t>=0,"n must be a positive integer"),this.$_addRule({name:"maxArity",args:{n:t}})},validate:(e,t,{n:r})=>e.length<=r?e:t.error("function.maxArity",{n:r})}},messages:{"function.arity":"{{#label}} must have an arity of {{#n}}","function.class":"{{#label}} must be a class","function.maxArity":"{{#label}} must have an arity lesser or equal to {{#n}}","function.minArity":"{{#label}} must have an arity greater or equal to {{#n}}"}}),Ut}function Jt(){if(Ht)return Ft;Ht=1;const e=G,t=At(),r=Ie(),n=De(),i=_e(),s={};return Ft=t.extend({type:"link",properties:{schemaChain:!0},terms:{link:{init:null,manifest:"single",register:!1}},args:(e,t)=>e.ref(t),validate(t,{schema:r,state:n,prefs:i}){e(r.$_terms.link,"Uninitialized link schema");const o=s.generate(r,t,n,i),a=r.$_terms.link[0].ref;return o.$_validate(t,n.nest(o,`link:${a.display}:${o.type}`),i)},generate:(e,t,r,n)=>s.generate(e,t,r,n),rules:{ref:{method(t){e(!this.$_terms.link,"Cannot reinitialize schema"),t=n.ref(t),e("value"===t.type||"local"===t.type,"Invalid reference type:",t.type),e("local"===t.type||"root"===t.ancestor||t.ancestor>0,"Link cannot reference itself");const r=this.clone();return r.$_terms.link=[{ref:t}],r}},relative:{method(e=!0){return this.$_setFlag("relative",e)}}},overrides:{concat(t){e(this.$_terms.link,"Uninitialized link schema"),e(r.isSchema(t),"Invalid schema object"),e("link"!==t.type,"Cannot merge type link with another link");const n=this.clone();return n.$_terms.whens||(n.$_terms.whens=[]),n.$_terms.whens.push({concat:t}),n.$_mutateRebuild()}},manifest:{build:(t,r)=>(e(r.link,"Invalid link description missing link"),t.ref(r.link))}}),s.generate=function(e,t,r,n){let i=r.mainstay.links.get(e);if(i)return i._generate(t,r,n).schema;const o=e.$_terms.link[0].ref,{perspective:a,path:c}=s.perspective(o,r);s.assert(a,"which is outside of schema boundaries",o,e,r,n);try{i=c.length?a.$_reach(c):a}catch(t){s.assert(!1,"to non-existing schema",o,e,r,n)}return s.assert("link"!==i.type,"which is another link",o,e,r,n),e._flags.relative||r.mainstay.links.set(e,i),i._generate(t,r,n).schema},s.perspective=function(e,t){if("local"===e.type){for(const{schema:r,key:n}of t.schemas){if((r._flags.id||n)===e.path[0])return{perspective:r,path:e.path.slice(1)};if(r.$_terms.shared)for(const t of r.$_terms.shared)if(t._flags.id===e.path[0])return{perspective:t,path:e.path.slice(1)}}return{perspective:null,path:null}}return"root"===e.ancestor?{perspective:t.schemas[t.schemas.length-1].schema,path:e.path}:{perspective:t.schemas[e.ancestor]&&t.schemas[e.ancestor].schema,path:e.path}},s.assert=function(t,r,n,s,o,a){t||e(!1,`"${i.label(s._flags,o,a)}" contains link reference "${n.display}" ${r}`)},Ft}function Yt(){if(Vt)return zt;Vt=1;const e=G,t=At(),r=Ie(),n={numberRx:/^\s*[+-]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e([+-]?\d+))?\s*$/i,precisionRx:/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/,exponentialPartRegex:/[eE][+-]?\d+$/,leadingSignAndZerosRegex:/^[+-]?(0*)?/,dotRegex:/\./,trailingZerosRegex:/0+$/};return zt=t.extend({type:"number",flags:{unsafe:{default:!1}},coerce:{from:"string",method(e,{schema:t,error:r}){if(!e.match(n.numberRx))return;e=e.trim();const i={value:parseFloat(e)};if(0===i.value&&(i.value=0),!t._flags.unsafe)if(e.match(/e/i)){if(n.extractSignificantDigits(e)!==n.extractSignificantDigits(String(i.value)))return i.errors=r("number.unsafe"),i}else{const t=i.value.toString();if(t.match(/e/i))return i;if(t!==n.normalizeDecimal(e))return i.errors=r("number.unsafe"),i}return i}},validate(e,{schema:t,error:n,prefs:i}){if(e===1/0||e===-1/0)return{value:e,errors:n("number.infinity")};if(!r.isNumber(e))return{value:e,errors:n("number.base")};const s={value:e};if(i.convert){const e=t.$_getRule("precision");if(e){const t=Math.pow(10,e.args.limit);s.value=Math.round(s.value*t)/t}}return 0===s.value&&(s.value=0),!t._flags.unsafe&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&(s.errors=n("number.unsafe")),s},rules:{compare:{method:!1,validate:(e,t,{limit:n},{name:i,operator:s,args:o})=>r.compare(e,n,s)?e:t.error("number."+i,{limit:o.limit,value:e}),args:[{name:"limit",ref:!0,assert:r.isNumber,message:"must be a number"}]},greater:{method(e){return this.$_addRule({name:"greater",method:"compare",args:{limit:e},operator:">"})}},integer:{method(){return this.$_addRule("integer")},validate:(e,t)=>Math.trunc(e)-e==0?e:t.error("number.integer")},less:{method(e){return this.$_addRule({name:"less",method:"compare",args:{limit:e},operator:"<"})}},max:{method(e){return this.$_addRule({name:"max",method:"compare",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"compare",args:{limit:e},operator:">="})}},multiple:{method(e){return this.$_addRule({name:"multiple",args:{base:e}})},validate:(e,t,{base:r},n)=>e*(1/r)%1==0?e:t.error("number.multiple",{multiple:n.args.base,value:e}),args:[{name:"base",ref:!0,assert:e=>"number"==typeof e&&isFinite(e)&&e>0,message:"must be a positive number"}],multi:!0},negative:{method(){return this.sign("negative")}},port:{method(){return this.$_addRule("port")},validate:(e,t)=>Number.isSafeInteger(e)&&e>=0&&e<=65535?e:t.error("number.port")},positive:{method(){return this.sign("positive")}},precision:{method(t){return e(Number.isSafeInteger(t),"limit must be an integer"),this.$_addRule({name:"precision",args:{limit:t}})},validate(e,t,{limit:r}){const i=e.toString().match(n.precisionRx);return Math.max((i[1]?i[1].length:0)-(i[2]?parseInt(i[2],10):0),0)<=r?e:t.error("number.precision",{limit:r,value:e})},convert:!0},sign:{method(t){return e(["negative","positive"].includes(t),"Invalid sign",t),this.$_addRule({name:"sign",args:{sign:t}})},validate:(e,t,{sign:r})=>"negative"===r&&e<0||"positive"===r&&e>0?e:t.error(`number.${r}`)},unsafe:{method(t=!0){return e("boolean"==typeof t,"enabled must be a boolean"),this.$_setFlag("unsafe",t)}}},cast:{string:{from:e=>"number"==typeof e,to:(e,t)=>e.toString()}},messages:{"number.base":"{{#label}} must be a number","number.greater":"{{#label}} must be greater than {{#limit}}","number.infinity":"{{#label}} cannot be infinity","number.integer":"{{#label}} must be an integer","number.less":"{{#label}} must be less than {{#limit}}","number.max":"{{#label}} must be less than or equal to {{#limit}}","number.min":"{{#label}} must be greater than or equal to {{#limit}}","number.multiple":"{{#label}} must be a multiple of {{#multiple}}","number.negative":"{{#label}} must be a negative number","number.port":"{{#label}} must be a valid port","number.positive":"{{#label}} must be a positive number","number.precision":"{{#label}} must have no more than {{#limit}} decimal places","number.unsafe":"{{#label}} must be a safe number"}}),n.extractSignificantDigits=function(e){return e.replace(n.exponentialPartRegex,"").replace(n.dotRegex,"").replace(n.trailingZerosRegex,"").replace(n.leadingSignAndZerosRegex,"")},n.normalizeDecimal=function(e){return(e=e.replace(/^\+/,"").replace(/\.0*$/,"").replace(/^(-?)\.([^\.]*)$/,"$10.$2").replace(/^(-?)0+([0-9])/,"$1$2")).includes(".")&&e.endsWith("0")&&(e=e.replace(/0+$/,"")),"-0"===e?"0":e},zt}function Zt(){if(Gt)return qt;Gt=1;const e=Wt();return qt=e.extend({type:"object",cast:{map:{from:e=>e&&"object"==typeof e,to:(e,t)=>new Map(Object.entries(e))}}})}Dt.Sorter=class{constructor(){this._items=[],this.nodes=[]}add(e,t){const r=[].concat((t=t||{}).before||[]),n=[].concat(t.after||[]),i=t.group||"?",s=t.sort||0;$t(!r.includes(i),`Item cannot come before itself: ${i}`),$t(!r.includes("?"),"Item cannot come before unassociated items"),$t(!n.includes(i),`Item cannot come after itself: ${i}`),$t(!n.includes("?"),"Item cannot come after unassociated items"),Array.isArray(e)||(e=[e]);for(const t of e){const e={seq:this._items.length,sort:s,before:r,after:n,group:i,node:t};this._items.push(e)}if(!t.manual){const e=this._sort();$t(e,"item","?"!==i?`added into group ${i}`:"","created a dependencies error")}return this.nodes}merge(e){Array.isArray(e)||(e=[e]);for(const t of e)if(t)for(const e of t._items)this._items.push(Object.assign({},e));this._items.sort(Lt.mergeSort);for(let e=0;e<this._items.length;++e)this._items[e].seq=e;const t=this._sort();return $t(t,"merge created a dependencies error"),this.nodes}sort(){const e=this._sort();return $t(e,"sort created a dependencies error"),this.nodes}_sort(){const e={},t=Object.create(null),r=Object.create(null);for(const n of this._items){const i=n.seq,s=n.group;r[s]=r[s]||[],r[s].push(i),e[i]=n.before;for(const e of n.after)t[e]=t[e]||[],t[e].push(i)}for(const t in e){const n=[];for(const i in e[t]){const s=e[t][i];r[s]=r[s]||[],n.push(...r[s])}e[t]=n}for(const n in t)if(r[n])for(const i of r[n])e[i].push(...t[n]);const n={};for(const t in e){const r=e[t];for(const e of r)n[e]=n[e]||[],n[e].push(t)}const i={},s=[];for(let e=0;e<this._items.length;++e){let t=e;if(n[e]){t=null;for(let e=0;e<this._items.length;++e){if(!0===i[e])continue;n[e]||(n[e]=[]);const r=n[e].length;let s=0;for(let t=0;t<r;++t)i[n[e][t]]&&++s;if(s===r){t=e;break}}}null!==t&&(i[t]=!0,s.push(t))}if(s.length!==this._items.length)return!1;const o={};for(const e of this._items)o[e.seq]=e;this._items=[],this.nodes=[];for(const e of s){const t=o[e];this.nodes.push(t.node),this._items.push(t)}return!0}},Lt.mergeSort=(e,t)=>e.sort===t.sort?0:e.sort<t.sort?-1:1;var Qt,er={},tr={};(Qt=tr).codes={EMPTY_STRING:"Address must be a non-empty string",FORBIDDEN_UNICODE:"Address contains forbidden Unicode characters",MULTIPLE_AT_CHAR:"Address cannot contain more than one @ character",MISSING_AT_CHAR:"Address must contain one @ character",EMPTY_LOCAL:"Address local part cannot be empty",ADDRESS_TOO_LONG:"Address too long",LOCAL_TOO_LONG:"Address local part too long",EMPTY_LOCAL_SEGMENT:"Address local part contains empty dot-separated segment",INVALID_LOCAL_CHARS:"Address local part contains invalid character",DOMAIN_NON_EMPTY_STRING:"Domain must be a non-empty string",DOMAIN_TOO_LONG:"Domain too long",DOMAIN_INVALID_UNICODE_CHARS:"Domain contains forbidden Unicode characters",DOMAIN_INVALID_CHARS:"Domain contains invalid character",DOMAIN_INVALID_TLDS_CHARS:"Domain contains invalid tld character",DOMAIN_SEGMENTS_COUNT:"Domain lacks the minimum required number of segments",DOMAIN_SEGMENTS_COUNT_MAX:"Domain contains too many segments",DOMAIN_FORBIDDEN_TLDS:"Domain uses forbidden TLD",DOMAIN_EMPTY_SEGMENT:"Domain contains empty dot-separated segment",DOMAIN_LONG_SEGMENT:"Domain contains dot-separated segment that is too long"},Qt.code=function(e){return{code:e,error:Qt.codes[e]}},function(t){const r=tr,n={minDomainSegments:2,nonAsciiRx:/[^\x00-\x7f]/,domainControlRx:/[\x00-\x20@\:\/\\#!\$&\'\(\)\*\+,;=\?]/,tldSegmentRx:/^[a-zA-Z](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/,domainSegmentRx:/^[a-zA-Z0-9](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/,URL:e.URL||URL};t.analyze=function(e,t={}){if(!e)return r.code("DOMAIN_NON_EMPTY_STRING");if("string"!=typeof e)throw new Error("Invalid input: domain must be a string");if(e.length>256)return r.code("DOMAIN_TOO_LONG");if(!!n.nonAsciiRx.test(e)){if(!1===t.allowUnicode)return r.code("DOMAIN_INVALID_UNICODE_CHARS");e=e.normalize("NFC")}if(n.domainControlRx.test(e))return r.code("DOMAIN_INVALID_CHARS");e=n.punycode(e),t.allowFullyQualified&&"."===e[e.length-1]&&(e=e.slice(0,-1));const i=t.minDomainSegments||n.minDomainSegments,s=e.split(".");if(s.length<i)return r.code("DOMAIN_SEGMENTS_COUNT");if(t.maxDomainSegments&&s.length>t.maxDomainSegments)return r.code("DOMAIN_SEGMENTS_COUNT_MAX");const o=t.tlds;if(o){const e=s[s.length-1].toLowerCase();if(o.deny&&o.deny.has(e)||o.allow&&!o.allow.has(e))return r.code("DOMAIN_FORBIDDEN_TLDS")}for(let e=0;e<s.length;++e){const t=s[e];if(!t.length)return r.code("DOMAIN_EMPTY_SEGMENT");if(t.length>63)return r.code("DOMAIN_LONG_SEGMENT");if(e<s.length-1){if(!n.domainSegmentRx.test(t))return r.code("DOMAIN_INVALID_CHARS")}else if(!n.tldSegmentRx.test(t))return r.code("DOMAIN_INVALID_TLDS_CHARS")}return null},t.isValid=function(e,r){return!t.analyze(e,r)},n.punycode=function(e){e.includes("%")&&(e=e.replace(/%/g,"%25"));try{return new n.URL(`http://${e}`).host}catch(t){return e}}}(er);var rr={};const nr=er,ir=tr,sr={nonAsciiRx:/[^\x00-\x7f]/,encoder:new(r.TextEncoder||TextEncoder)};rr.analyze=function(e,t){return sr.email(e,t)},rr.isValid=function(e,t){return!sr.email(e,t)},sr.email=function(e,t={}){if("string"!=typeof e)throw new Error("Invalid input: email must be a string");if(!e)return ir.code("EMPTY_STRING");const r=!sr.nonAsciiRx.test(e);if(!r){if(!1===t.allowUnicode)return ir.code("FORBIDDEN_UNICODE");e=e.normalize("NFC")}const n=e.split("@");if(2!==n.length)return n.length>2?ir.code("MULTIPLE_AT_CHAR"):ir.code("MISSING_AT_CHAR");const[i,s]=n;if(!i)return ir.code("EMPTY_LOCAL");if(!t.ignoreLength){if(e.length>254)return ir.code("ADDRESS_TOO_LONG");if(sr.encoder.encode(i).length>64)return ir.code("LOCAL_TOO_LONG")}return sr.local(i,r)||nr.analyze(s,t)},sr.local=function(e,t){const r=e.split(".");for(const e of r){if(!e.length)return ir.code("EMPTY_LOCAL_SEGMENT");if(t){if(!sr.atextRx.test(e))return ir.code("INVALID_LOCAL_CHARS")}else for(const t of e){if(sr.atextRx.test(t))continue;const e=sr.binary(t);if(!sr.atomRx.test(e))return ir.code("INVALID_LOCAL_CHARS")}}},sr.binary=function(e){return Array.from(sr.encoder.encode(e)).map((e=>String.fromCharCode(e))).join("")},sr.atextRx=/^[\w!#\$%&'\*\+\-/=\?\^`\{\|\}~]+$/,sr.atomRx=new RegExp(["(?:[\\xc2-\\xdf][\\x80-\\xbf])","(?:\\xe0[\\xa0-\\xbf][\\x80-\\xbf])|(?:[\\xe1-\\xec][\\x80-\\xbf]{2})|(?:\\xed[\\x80-\\x9f][\\x80-\\xbf])|(?:[\\xee-\\xef][\\x80-\\xbf]{2})","(?:\\xf0[\\x90-\\xbf][\\x80-\\xbf]{2})|(?:[\\xf1-\\xf3][\\x80-\\xbf]{3})|(?:\\xf4[\\x80-\\x8f][\\x80-\\xbf]{2})"].join("|"));var or={},ar={},cr=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")};const lr=G,ur=cr,hr={generate:function(){const e={},t="\\dA-Fa-f",r="["+t+"]",n="\\w-\\.~",i="!\\$&'\\(\\)\\*\\+,;=",s="%"+t,o=n+s+i+":@",a="["+o+"]",c="(?:0{0,2}\\d|0?[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";e.ipv4address="(?:"+c+"\\.){3}"+c;const l=r+"{1,4}",u="(?:"+l+":"+l+"|"+e.ipv4address+")",h="(?:"+l+":){6}"+u,f="::(?:"+l+":){5}"+u,p="(?:"+l+")?::(?:"+l+":){4}"+u,d="(?:(?:"+l+":){0,1}"+l+")?::(?:"+l+":){3}"+u,m="(?:(?:"+l+":){0,2}"+l+")?::(?:"+l+":){2}"+u,y="(?:(?:"+l+":){0,3}"+l+")?::"+l+":"+u,g="(?:(?:"+l+":){0,4}"+l+")?::"+u,v="(?:(?:"+l+":){0,5}"+l+")?::"+l,b="(?:(?:"+l+":){0,6}"+l+")?::";e.ipv4Cidr="(?:\\d|[1-2]\\d|3[0-2])",e.ipv6Cidr="(?:0{0,2}\\d|0?[1-9]\\d|1[01]\\d|12[0-8])",e.ipv6address="(?:"+h+"|"+f+"|"+p+"|"+d+"|"+m+"|"+y+"|"+g+"|"+v+"|"+b+")",e.ipvFuture="v"+r+"+\\.["+n+i+":]+",e.scheme="[a-zA-Z][a-zA-Z\\d+-\\.]*",e.schemeRegex=new RegExp(e.scheme);const w="["+n+s+i+":]*",_="["+n+s+i+"]{1,255}",S="(?:"+("\\[(?:"+e.ipv6address+"|"+e.ipvFuture+")\\]")+"|"+e.ipv4address+"|"+_+")",E="(?:"+w+"@)?"+S+"(?::\\d*)?",A="(?:"+w+"@)?("+S+")(?::\\d*)?",k=a+"*",x=a+"+",C="(?:\\/"+k+")*",R="\\/(?:"+x+C+")?",O=x+C,N="["+n+s+i+"@]+"+C,I="(?:\\/\\/\\/"+k+C+")";return e.hierPart="(?:(?:\\/\\/"+E+C+")|"+R+"|"+O+"|"+I+")",e.hierPartCapture="(?:(?:\\/\\/"+A+C+")|"+R+"|"+O+")",e.relativeRef="(?:(?:\\/\\/"+E+C+")|"+R+"|"+N+"|)",e.relativeRefCapture="(?:(?:\\/\\/"+A+C+")|"+R+"|"+N+"|)",e.query="["+o+"\\/\\?]*(?=#|$)",e.queryWithSquareBrackets="["+o+"\\[\\]\\/\\?]*(?=#|$)",e.fragment="["+o+"\\/\\?]*",e}};hr.rfc3986=hr.generate(),ar.ip={v4Cidr:hr.rfc3986.ipv4Cidr,v6Cidr:hr.rfc3986.ipv6Cidr,ipv4:hr.rfc3986.ipv4address,ipv6:hr.rfc3986.ipv6address,ipvfuture:hr.rfc3986.ipvFuture},hr.createRegex=function(e){const t=hr.rfc3986,r="(?:\\?"+(e.allowQuerySquareBrackets?t.queryWithSquareBrackets:t.query)+")?(?:#"+t.fragment+")?",n=e.domain?t.relativeRefCapture:t.relativeRef;if(e.relativeOnly)return hr.wrap(n+r);let i="";if(e.scheme){lr(e.scheme instanceof RegExp||"string"==typeof e.scheme||Array.isArray(e.scheme),"scheme must be a RegExp, String, or Array");const r=[].concat(e.scheme);lr(r.length>=1,"scheme must have at least 1 scheme specified");const n=[];for(let e=0;e<r.length;++e){const i=r[e];lr(i instanceof RegExp||"string"==typeof i,"scheme at position "+e+" must be a RegExp or String"),i instanceof RegExp?n.push(i.source.toString()):(lr(t.schemeRegex.test(i),"scheme at position "+e+" must be a valid scheme"),n.push(ur(i)))}i=n.join("|")}const s="(?:"+(i?"(?:"+i+")":t.scheme)+":"+(e.domain?t.hierPartCapture:t.hierPart)+")",o=e.allowRelative?"(?:"+s+"|"+n+")":s;return hr.wrap(o+r,i)},hr.wrap=function(e,t){return{raw:e=`(?=.)(?!https?:/(?:$|[^/]))(?!https?:///)(?!https?:[^/])${e}`,regex:new RegExp(`^${e}$`),scheme:t}},hr.uriRegex=hr.createRegex({}),ar.regex=function(e={}){return e.scheme||e.allowRelative||e.relativeOnly||e.allowQuerySquareBrackets||e.domain?hr.createRegex(e):hr.uriRegex};const fr=G,pr=ar;or.regex=function(e={}){fr(void 0===e.cidr||"string"==typeof e.cidr,"options.cidr must be a string");const t=e.cidr?e.cidr.toLowerCase():"optional";fr(["required","optional","forbidden"].includes(t),"options.cidr must be one of required, optional, forbidden"),fr(void 0===e.version||"string"==typeof e.version||Array.isArray(e.version),"options.version must be a string or an array of string");let r=e.version||["ipv4","ipv6","ipvfuture"];Array.isArray(r)||(r=[r]),fr(r.length>=1,"options.version must have at least 1 version specified");for(let e=0;e<r.length;++e)fr("string"==typeof r[e],"options.version must only contain strings"),r[e]=r[e].toLowerCase(),fr(["ipv4","ipv6","ipvfuture"].includes(r[e]),"options.version contains unknown version "+r[e]+" - must be one of ipv4, ipv6, ipvfuture");r=Array.from(new Set(r));const n=r.map((e=>{if("forbidden"===t)return pr.ip[e];const r=`\\/${"ipv4"===e?pr.ip.v4Cidr:pr.ip.v6Cidr}`;return"required"===t?`${pr.ip[e]}${r}`:`${pr.ip[e]}(?:${r})?`})),i=`(?:${n.join("|")})`,s=new RegExp(`^${i}$`);return{cidr:t,versions:r,regex:s,raw:i}};const dr={tlds:["AAA","AARP","ABARTH","ABB","ABBOTT","ABBVIE","ABC","ABLE","ABOGADO","ABUDHABI","AC","ACADEMY","ACCENTURE","ACCOUNTANT","ACCOUNTANTS","ACO","ACTOR","AD","ADAC","ADS","ADULT","AE","AEG","AERO","AETNA","AF","AFL","AFRICA","AG","AGAKHAN","AGENCY","AI","AIG","AIRBUS","AIRFORCE","AIRTEL","AKDN","AL","ALFAROMEO","ALIBABA","ALIPAY","ALLFINANZ","ALLSTATE","ALLY","ALSACE","ALSTOM","AM","AMAZON","AMERICANEXPRESS","AMERICANFAMILY","AMEX","AMFAM","AMICA","AMSTERDAM","ANALYTICS","ANDROID","ANQUAN","ANZ","AO","AOL","APARTMENTS","APP","APPLE","AQ","AQUARELLE","AR","ARAB","ARAMCO","ARCHI","ARMY","ARPA","ART","ARTE","AS","ASDA","ASIA","ASSOCIATES","AT","ATHLETA","ATTORNEY","AU","AUCTION","AUDI","AUDIBLE","AUDIO","AUSPOST","AUTHOR","AUTO","AUTOS","AVIANCA","AW","AWS","AX","AXA","AZ","AZURE","BA","BABY","BAIDU","BANAMEX","BANANAREPUBLIC","BAND","BANK","BAR","BARCELONA","BARCLAYCARD","BARCLAYS","BAREFOOT","BARGAINS","BASEBALL","BASKETBALL","BAUHAUS","BAYERN","BB","BBC","BBT","BBVA","BCG","BCN","BD","BE","BEATS","BEAUTY","BEER","BENTLEY","BERLIN","BEST","BESTBUY","BET","BF","BG","BH","BHARTI","BI","BIBLE","BID","BIKE","BING","BINGO","BIO","BIZ","BJ","BLACK","BLACKFRIDAY","BLOCKBUSTER","BLOG","BLOOMBERG","BLUE","BM","BMS","BMW","BN","BNPPARIBAS","BO","BOATS","BOEHRINGER","BOFA","BOM","BOND","BOO","BOOK","BOOKING","BOSCH","BOSTIK","BOSTON","BOT","BOUTIQUE","BOX","BR","BRADESCO","BRIDGESTONE","BROADWAY","BROKER","BROTHER","BRUSSELS","BS","BT","BUGATTI","BUILD","BUILDERS","BUSINESS","BUY","BUZZ","BV","BW","BY","BZ","BZH","CA","CAB","CAFE","CAL","CALL","CALVINKLEIN","CAM","CAMERA","CAMP","CANCERRESEARCH","CANON","CAPETOWN","CAPITAL","CAPITALONE","CAR","CARAVAN","CARDS","CARE","CAREER","CAREERS","CARS","CASA","CASE","CASH","CASINO","CAT","CATERING","CATHOLIC","CBA","CBN","CBRE","CBS","CC","CD","CENTER","CEO","CERN","CF","CFA","CFD","CG","CH","CHANEL","CHANNEL","CHARITY","CHASE","CHAT","CHEAP","CHINTAI","CHRISTMAS","CHROME","CHURCH","CI","CIPRIANI","CIRCLE","CISCO","CITADEL","CITI","CITIC","CITY","CITYEATS","CK","CL","CLAIMS","CLEANING","CLICK","CLINIC","CLINIQUE","CLOTHING","CLOUD","CLUB","CLUBMED","CM","CN","CO","COACH","CODES","COFFEE","COLLEGE","COLOGNE","COM","COMCAST","COMMBANK","COMMUNITY","COMPANY","COMPARE","COMPUTER","COMSEC","CONDOS","CONSTRUCTION","CONSULTING","CONTACT","CONTRACTORS","COOKING","COOKINGCHANNEL","COOL","COOP","CORSICA","COUNTRY","COUPON","COUPONS","COURSES","CPA","CR","CREDIT","CREDITCARD","CREDITUNION","CRICKET","CROWN","CRS","CRUISE","CRUISES","CU","CUISINELLA","CV","CW","CX","CY","CYMRU","CYOU","CZ","DABUR","DAD","DANCE","DATA","DATE","DATING","DATSUN","DAY","DCLK","DDS","DE","DEAL","DEALER","DEALS","DEGREE","DELIVERY","DELL","DELOITTE","DELTA","DEMOCRAT","DENTAL","DENTIST","DESI","DESIGN","DEV","DHL","DIAMONDS","DIET","DIGITAL","DIRECT","DIRECTORY","DISCOUNT","DISCOVER","DISH","DIY","DJ","DK","DM","DNP","DO","DOCS","DOCTOR","DOG","DOMAINS","DOT","DOWNLOAD","DRIVE","DTV","DUBAI","DUNLOP","DUPONT","DURBAN","DVAG","DVR","DZ","EARTH","EAT","EC","ECO","EDEKA","EDU","EDUCATION","EE","EG","EMAIL","EMERCK","ENERGY","ENGINEER","ENGINEERING","ENTERPRISES","EPSON","EQUIPMENT","ER","ERICSSON","ERNI","ES","ESQ","ESTATE","ET","ETISALAT","EU","EUROVISION","EUS","EVENTS","EXCHANGE","EXPERT","EXPOSED","EXPRESS","EXTRASPACE","FAGE","FAIL","FAIRWINDS","FAITH","FAMILY","FAN","FANS","FARM","FARMERS","FASHION","FAST","FEDEX","FEEDBACK","FERRARI","FERRERO","FI","FIAT","FIDELITY","FIDO","FILM","FINAL","FINANCE","FINANCIAL","FIRE","FIRESTONE","FIRMDALE","FISH","FISHING","FIT","FITNESS","FJ","FK","FLICKR","FLIGHTS","FLIR","FLORIST","FLOWERS","FLY","FM","FO","FOO","FOOD","FOODNETWORK","FOOTBALL","FORD","FOREX","FORSALE","FORUM","FOUNDATION","FOX","FR","FREE","FRESENIUS","FRL","FROGANS","FRONTDOOR","FRONTIER","FTR","FUJITSU","FUN","FUND","FURNITURE","FUTBOL","FYI","GA","GAL","GALLERY","GALLO","GALLUP","GAME","GAMES","GAP","GARDEN","GAY","GB","GBIZ","GD","GDN","GE","GEA","GENT","GENTING","GEORGE","GF","GG","GGEE","GH","GI","GIFT","GIFTS","GIVES","GIVING","GL","GLASS","GLE","GLOBAL","GLOBO","GM","GMAIL","GMBH","GMO","GMX","GN","GODADDY","GOLD","GOLDPOINT","GOLF","GOO","GOODYEAR","GOOG","GOOGLE","GOP","GOT","GOV","GP","GQ","GR","GRAINGER","GRAPHICS","GRATIS","GREEN","GRIPE","GROCERY","GROUP","GS","GT","GU","GUARDIAN","GUCCI","GUGE","GUIDE","GUITARS","GURU","GW","GY","HAIR","HAMBURG","HANGOUT","HAUS","HBO","HDFC","HDFCBANK","HEALTH","HEALTHCARE","HELP","HELSINKI","HERE","HERMES","HGTV","HIPHOP","HISAMITSU","HITACHI","HIV","HK","HKT","HM","HN","HOCKEY","HOLDINGS","HOLIDAY","HOMEDEPOT","HOMEGOODS","HOMES","HOMESENSE","HONDA","HORSE","HOSPITAL","HOST","HOSTING","HOT","HOTELES","HOTELS","HOTMAIL","HOUSE","HOW","HR","HSBC","HT","HU","HUGHES","HYATT","HYUNDAI","IBM","ICBC","ICE","ICU","ID","IE","IEEE","IFM","IKANO","IL","IM","IMAMAT","IMDB","IMMO","IMMOBILIEN","IN","INC","INDUSTRIES","INFINITI","INFO","ING","INK","INSTITUTE","INSURANCE","INSURE","INT","INTERNATIONAL","INTUIT","INVESTMENTS","IO","IPIRANGA","IQ","IR","IRISH","IS","ISMAILI","IST","ISTANBUL","IT","ITAU","ITV","JAGUAR","JAVA","JCB","JE","JEEP","JETZT","JEWELRY","JIO","JLL","JM","JMP","JNJ","JO","JOBS","JOBURG","JOT","JOY","JP","JPMORGAN","JPRS","JUEGOS","JUNIPER","KAUFEN","KDDI","KE","KERRYHOTELS","KERRYLOGISTICS","KERRYPROPERTIES","KFH","KG","KH","KI","KIA","KIM","KINDER","KINDLE","KITCHEN","KIWI","KM","KN","KOELN","KOMATSU","KOSHER","KP","KPMG","KPN","KR","KRD","KRED","KUOKGROUP","KW","KY","KYOTO","KZ","LA","LACAIXA","LAMBORGHINI","LAMER","LANCASTER","LANCIA","LAND","LANDROVER","LANXESS","LASALLE","LAT","LATINO","LATROBE","LAW","LAWYER","LB","LC","LDS","LEASE","LECLERC","LEFRAK","LEGAL","LEGO","LEXUS","LGBT","LI","LIDL","LIFE","LIFEINSURANCE","LIFESTYLE","LIGHTING","LIKE","LILLY","LIMITED","LIMO","LINCOLN","LINDE","LINK","LIPSY","LIVE","LIVING","LK","LLC","LLP","LOAN","LOANS","LOCKER","LOCUS","LOFT","LOL","LONDON","LOTTE","LOTTO","LOVE","LPL","LPLFINANCIAL","LR","LS","LT","LTD","LTDA","LU","LUNDBECK","LUXE","LUXURY","LV","LY","MA","MACYS","MADRID","MAIF","MAISON","MAKEUP","MAN","MANAGEMENT","MANGO","MAP","MARKET","MARKETING","MARKETS","MARRIOTT","MARSHALLS","MASERATI","MATTEL","MBA","MC","MCKINSEY","MD","ME","MED","MEDIA","MEET","MELBOURNE","MEME","MEMORIAL","MEN","MENU","MERCKMSD","MG","MH","MIAMI","MICROSOFT","MIL","MINI","MINT","MIT","MITSUBISHI","MK","ML","MLB","MLS","MM","MMA","MN","MO","MOBI","MOBILE","MODA","MOE","MOI","MOM","MONASH","MONEY","MONSTER","MORMON","MORTGAGE","MOSCOW","MOTO","MOTORCYCLES","MOV","MOVIE","MP","MQ","MR","MS","MSD","MT","MTN","MTR","MU","MUSEUM","MUSIC","MUTUAL","MV","MW","MX","MY","MZ","NA","NAB","NAGOYA","NAME","NATURA","NAVY","NBA","NC","NE","NEC","NET","NETBANK","NETFLIX","NETWORK","NEUSTAR","NEW","NEWS","NEXT","NEXTDIRECT","NEXUS","NF","NFL","NG","NGO","NHK","NI","NICO","NIKE","NIKON","NINJA","NISSAN","NISSAY","NL","NO","NOKIA","NORTHWESTERNMUTUAL","NORTON","NOW","NOWRUZ","NOWTV","NP","NR","NRA","NRW","NTT","NU","NYC","NZ","OBI","OBSERVER","OFFICE","OKINAWA","OLAYAN","OLAYANGROUP","OLDNAVY","OLLO","OM","OMEGA","ONE","ONG","ONL","ONLINE","OOO","OPEN","ORACLE","ORANGE","ORG","ORGANIC","ORIGINS","OSAKA","OTSUKA","OTT","OVH","PA","PAGE","PANASONIC","PARIS","PARS","PARTNERS","PARTS","PARTY","PASSAGENS","PAY","PCCW","PE","PET","PF","PFIZER","PG","PH","PHARMACY","PHD","PHILIPS","PHONE","PHOTO","PHOTOGRAPHY","PHOTOS","PHYSIO","PICS","PICTET","PICTURES","PID","PIN","PING","PINK","PIONEER","PIZZA","PK","PL","PLACE","PLAY","PLAYSTATION","PLUMBING","PLUS","PM","PN","PNC","POHL","POKER","POLITIE","PORN","POST","PR","PRAMERICA","PRAXI","PRESS","PRIME","PRO","PROD","PRODUCTIONS","PROF","PROGRESSIVE","PROMO","PROPERTIES","PROPERTY","PROTECTION","PRU","PRUDENTIAL","PS","PT","PUB","PW","PWC","PY","QA","QPON","QUEBEC","QUEST","RACING","RADIO","RE","READ","REALESTATE","REALTOR","REALTY","RECIPES","RED","REDSTONE","REDUMBRELLA","REHAB","REISE","REISEN","REIT","RELIANCE","REN","RENT","RENTALS","REPAIR","REPORT","REPUBLICAN","REST","RESTAURANT","REVIEW","REVIEWS","REXROTH","RICH","RICHARDLI","RICOH","RIL","RIO","RIP","RO","ROCHER","ROCKS","RODEO","ROGERS","ROOM","RS","RSVP","RU","RUGBY","RUHR","RUN","RW","RWE","RYUKYU","SA","SAARLAND","SAFE","SAFETY","SAKURA","SALE","SALON","SAMSCLUB","SAMSUNG","SANDVIK","SANDVIKCOROMANT","SANOFI","SAP","SARL","SAS","SAVE","SAXO","SB","SBI","SBS","SC","SCA","SCB","SCHAEFFLER","SCHMIDT","SCHOLARSHIPS","SCHOOL","SCHULE","SCHWARZ","SCIENCE","SCOT","SD","SE","SEARCH","SEAT","SECURE","SECURITY","SEEK","SELECT","SENER","SERVICES","SES","SEVEN","SEW","SEX","SEXY","SFR","SG","SH","SHANGRILA","SHARP","SHAW","SHELL","SHIA","SHIKSHA","SHOES","SHOP","SHOPPING","SHOUJI","SHOW","SHOWTIME","SI","SILK","SINA","SINGLES","SITE","SJ","SK","SKI","SKIN","SKY","SKYPE","SL","SLING","SM","SMART","SMILE","SN","SNCF","SO","SOCCER","SOCIAL","SOFTBANK","SOFTWARE","SOHU","SOLAR","SOLUTIONS","SONG","SONY","SOY","SPA","SPACE","SPORT","SPOT","SR","SRL","SS","ST","STADA","STAPLES","STAR","STATEBANK","STATEFARM","STC","STCGROUP","STOCKHOLM","STORAGE","STORE","STREAM","STUDIO","STUDY","STYLE","SU","SUCKS","SUPPLIES","SUPPLY","SUPPORT","SURF","SURGERY","SUZUKI","SV","SWATCH","SWISS","SX","SY","SYDNEY","SYSTEMS","SZ","TAB","TAIPEI","TALK","TAOBAO","TARGET","TATAMOTORS","TATAR","TATTOO","TAX","TAXI","TC","TCI","TD","TDK","TEAM","TECH","TECHNOLOGY","TEL","TEMASEK","TENNIS","TEVA","TF","TG","TH","THD","THEATER","THEATRE","TIAA","TICKETS","TIENDA","TIFFANY","TIPS","TIRES","TIROL","TJ","TJMAXX","TJX","TK","TKMAXX","TL","TM","TMALL","TN","TO","TODAY","TOKYO","TOOLS","TOP","TORAY","TOSHIBA","TOTAL","TOURS","TOWN","TOYOTA","TOYS","TR","TRADE","TRADING","TRAINING","TRAVEL","TRAVELCHANNEL","TRAVELERS","TRAVELERSINSURANCE","TRUST","TRV","TT","TUBE","TUI","TUNES","TUSHU","TV","TVS","TW","TZ","UA","UBANK","UBS","UG","UK","UNICOM","UNIVERSITY","UNO","UOL","UPS","US","UY","UZ","VA","VACATIONS","VANA","VANGUARD","VC","VE","VEGAS","VENTURES","VERISIGN","VERSICHERUNG","VET","VG","VI","VIAJES","VIDEO","VIG","VIKING","VILLAS","VIN","VIP","VIRGIN","VISA","VISION","VIVA","VIVO","VLAANDEREN","VN","VODKA","VOLKSWAGEN","VOLVO","VOTE","VOTING","VOTO","VOYAGE","VU","VUELOS","WALES","WALMART","WALTER","WANG","WANGGOU","WATCH","WATCHES","WEATHER","WEATHERCHANNEL","WEBCAM","WEBER","WEBSITE","WED","WEDDING","WEIBO","WEIR","WF","WHOSWHO","WIEN","WIKI","WILLIAMHILL","WIN","WINDOWS","WINE","WINNERS","WME","WOLTERSKLUWER","WOODSIDE","WORK","WORKS","WORLD","WOW","WS","WTC","WTF","XBOX","XEROX","XFINITY","XIHUAN","XIN","XN--11B4C3D","XN--1CK2E1B","XN--1QQW23A","XN--2SCRJ9C","XN--30RR7Y","XN--3BST00M","XN--3DS443G","XN--3E0B707E","XN--3HCRJ9C","XN--3PXU8K","XN--42C2D9A","XN--45BR5CYL","XN--45BRJ9C","XN--45Q11C","XN--4DBRK0CE","XN--4GBRIM","XN--54B7FTA0CC","XN--55QW42G","XN--55QX5D","XN--5SU34J936BGSG","XN--5TZM5G","XN--6FRZ82G","XN--6QQ986B3XL","XN--80ADXHKS","XN--80AO21A","XN--80AQECDR1A","XN--80ASEHDB","XN--80ASWG","XN--8Y0A063A","XN--90A3AC","XN--90AE","XN--90AIS","XN--9DBQ2A","XN--9ET52U","XN--9KRT00A","XN--B4W605FERD","XN--BCK1B9A5DRE4C","XN--C1AVG","XN--C2BR7G","XN--CCK2B3B","XN--CCKWCXETD","XN--CG4BKI","XN--CLCHC0EA0B2G2A9GCD","XN--CZR694B","XN--CZRS0T","XN--CZRU2D","XN--D1ACJ3B","XN--D1ALF","XN--E1A4C","XN--ECKVDTC9D","XN--EFVY88H","XN--FCT429K","XN--FHBEI","XN--FIQ228C5HS","XN--FIQ64B","XN--FIQS8S","XN--FIQZ9S","XN--FJQ720A","XN--FLW351E","XN--FPCRJ9C3D","XN--FZC2C9E2C","XN--FZYS8D69UVGM","XN--G2XX48C","XN--GCKR3F0F","XN--GECRJ9C","XN--GK3AT1E","XN--H2BREG3EVE","XN--H2BRJ9C","XN--H2BRJ9C8C","XN--HXT814E","XN--I1B6B1A6A2E","XN--IMR513N","XN--IO0A7I","XN--J1AEF","XN--J1AMH","XN--J6W193G","XN--JLQ480N2RG","XN--JLQ61U9W7B","XN--JVR189M","XN--KCRX77D1X4A","XN--KPRW13D","XN--KPRY57D","XN--KPUT3I","XN--L1ACC","XN--LGBBAT1AD8J","XN--MGB9AWBF","XN--MGBA3A3EJT","XN--MGBA3A4F16A","XN--MGBA7C0BBN0A","XN--MGBAAKC7DVF","XN--MGBAAM7A8H","XN--MGBAB2BD","XN--MGBAH1A3HJKRD","XN--MGBAI9AZGQP6J","XN--MGBAYH7GPA","XN--MGBBH1A","XN--MGBBH1A71E","XN--MGBC0A9AZCG","XN--MGBCA7DZDO","XN--MGBCPQ6GPA1A","XN--MGBERP4A5D4AR","XN--MGBGU82A","XN--MGBI4ECEXP","XN--MGBPL2FH","XN--MGBT3DHD","XN--MGBTX2B","XN--MGBX4CD0AB","XN--MIX891F","XN--MK1BU44C","XN--MXTQ1M","XN--NGBC5AZD","XN--NGBE9E0A","XN--NGBRX","XN--NODE","XN--NQV7F","XN--NQV7FS00EMA","XN--NYQY26A","XN--O3CW4H","XN--OGBPF8FL","XN--OTU796D","XN--P1ACF","XN--P1AI","XN--PGBS0DH","XN--PSSY2U","XN--Q7CE6A","XN--Q9JYB4C","XN--QCKA1PMC","XN--QXA6A","XN--QXAM","XN--RHQV96G","XN--ROVU88B","XN--RVC1E0AM3E","XN--S9BRJ9C","XN--SES554G","XN--T60B56A","XN--TCKWE","XN--TIQ49XQYJ","XN--UNUP4Y","XN--VERMGENSBERATER-CTB","XN--VERMGENSBERATUNG-PWB","XN--VHQUV","XN--VUQ861B","XN--W4R85EL8FHU5DNRA","XN--W4RS40L","XN--WGBH1C","XN--WGBL6A","XN--XHQ521B","XN--XKC2AL3HYE2A","XN--XKC2DL3A5EE0H","XN--Y9A3AQ","XN--YFRO4I67O","XN--YGBI2AMMX","XN--ZFR164B","XXX","XYZ","YACHTS","YAHOO","YAMAXUN","YANDEX","YE","YODOBASHI","YOGA","YOKOHAMA","YOU","YOUTUBE","YT","YUN","ZA","ZAPPOS","ZARA","ZERO","ZIP","ZM","ZONE","ZUERICH","ZW"]};var mr,yr,gr,vr,br,wr,_r,Sr,Er=new Set(dr.tlds.map((e=>e.toLowerCase())));function Ar(){if(yr)return mr;yr=1;const e=G,t=er,r=rr,n=or,i=cr,s=Er,o=ar,a=At(),c=Ie(),l={tlds:s instanceof Set&&{tlds:{allow:s,deny:null}},base64Regex:{true:{true:/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}==|[\w\-]{3}=)?$/,false:/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/},false:{true:/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}(==)?|[\w\-]{3}=?)?$/,false:/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/}},dataUriRegex:/^data:[\w+.-]+\/[\w+.-]+;((charset=[\w-]+|base64),)?(.*)$/,hexRegex:/^[a-f0-9]+$/i,ipRegex:n.regex({cidr:"forbidden"}).regex,isoDurationRegex:/^P(?!$)(\d+Y)?(\d+M)?(\d+W)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?$/,guidBrackets:{"{":"}","[":"]","(":")","":""},guidVersions:{uuidv1:"1",uuidv2:"2",uuidv3:"3",uuidv4:"4",uuidv5:"5"},guidSeparators:new Set([void 0,!0,!1,"-",":"]),normalizationForms:["NFC","NFD","NFKC","NFKD"]};return mr=a.extend({type:"string",flags:{insensitive:{default:!1},truncate:{default:!1}},terms:{replacements:{init:null}},coerce:{from:"string",method(e,{schema:t,state:r,prefs:n}){const i=t.$_getRule("normalize");i&&(e=e.normalize(i.args.form));const s=t.$_getRule("case");s&&(e="upper"===s.args.direction?e.toLocaleUpperCase():e.toLocaleLowerCase());const o=t.$_getRule("trim");if(o&&o.args.enabled&&(e=e.trim()),t.$_terms.replacements)for(const r of t.$_terms.replacements)e=e.replace(r.pattern,r.replacement);const a=t.$_getRule("hex");if(a&&a.args.options.byteAligned&&e.length%2!=0&&(e=`0${e}`),t.$_getRule("isoDate")){const t=l.isoDate(e);t&&(e=t)}if(t._flags.truncate){const i=t.$_getRule("max");if(i){let s=i.args.limit;if(c.isResolvable(s)&&(s=s.resolve(e,r,n),!c.limit(s)))return{value:e,errors:t.$_createError("any.ref",s,{ref:i.args.limit,arg:"limit",reason:"must be a positive integer"},r,n)};e=e.slice(0,s)}}return{value:e}}},validate(e,{schema:t,error:r}){if("string"!=typeof e)return{value:e,errors:r("string.base")};if(""===e){const n=t.$_getRule("min");if(n&&0===n.args.limit)return;return{value:e,errors:r("string.empty")}}},rules:{alphanum:{method(){return this.$_addRule("alphanum")},validate:(e,t)=>/^[a-zA-Z0-9]+$/.test(e)?e:t.error("string.alphanum")},base64:{method(t={}){return c.assertOptions(t,["paddingRequired","urlSafe"]),t={urlSafe:!1,paddingRequired:!0,...t},e("boolean"==typeof t.paddingRequired,"paddingRequired must be boolean"),e("boolean"==typeof t.urlSafe,"urlSafe must be boolean"),this.$_addRule({name:"base64",args:{options:t}})},validate:(e,t,{options:r})=>l.base64Regex[r.paddingRequired][r.urlSafe].test(e)?e:t.error("string.base64")},case:{method(t){return e(["lower","upper"].includes(t),"Invalid case:",t),this.$_addRule({name:"case",args:{direction:t}})},validate:(e,t,{direction:r})=>"lower"===r&&e===e.toLocaleLowerCase()||"upper"===r&&e===e.toLocaleUpperCase()?e:t.error(`string.${r}case`),convert:!0},creditCard:{method(){return this.$_addRule("creditCard")},validate(e,t){let r=e.length,n=0,i=1;for(;r--;){const t=e.charAt(r)*i;n+=t-9*(t>9),i^=3}return n>0&&n%10==0?e:t.error("string.creditCard")}},dataUri:{method(t={}){return c.assertOptions(t,["paddingRequired"]),t={paddingRequired:!0,...t},e("boolean"==typeof t.paddingRequired,"paddingRequired must be boolean"),this.$_addRule({name:"dataUri",args:{options:t}})},validate(e,t,{options:r}){const n=e.match(l.dataUriRegex);if(n){if(!n[2])return e;if("base64"!==n[2])return e;if(l.base64Regex[r.paddingRequired].false.test(n[3]))return e}return t.error("string.dataUri")}},domain:{method(e){e&&c.assertOptions(e,["allowFullyQualified","allowUnicode","maxDomainSegments","minDomainSegments","tlds"]);const t=l.addressOptions(e);return this.$_addRule({name:"domain",args:{options:e},address:t})},validate:(e,r,n,{address:i})=>t.isValid(e,i)?e:r.error("string.domain")},email:{method(t={}){c.assertOptions(t,["allowFullyQualified","allowUnicode","ignoreLength","maxDomainSegments","minDomainSegments","multiple","separator","tlds"]),e(void 0===t.multiple||"boolean"==typeof t.multiple,"multiple option must be an boolean");const r=l.addressOptions(t),n=new RegExp(`\\s*[${t.separator?i(t.separator):","}]\\s*`);return this.$_addRule({name:"email",args:{options:t},regex:n,address:r})},validate(e,t,{options:n},{regex:i,address:s}){const o=n.multiple?e.split(i):[e],a=[];for(const e of o)r.isValid(e,s)||a.push(e);return a.length?t.error("string.email",{value:e,invalids:a}):e}},guid:{alias:"uuid",method(t={}){c.assertOptions(t,["version","separator"]);let r="";if(t.version){const n=[].concat(t.version);e(n.length>=1,"version must have at least 1 valid version specified");const i=new Set;for(let t=0;t<n.length;++t){const s=n[t];e("string"==typeof s,"version at position "+t+" must be a string");const o=l.guidVersions[s.toLowerCase()];e(o,"version at position "+t+" must be one of "+Object.keys(l.guidVersions).join(", ")),e(!i.has(o),"version at position "+t+" must not be a duplicate"),r+=o,i.add(o)}}e(l.guidSeparators.has(t.separator),'separator must be one of true, false, "-", or ":"');const n=void 0===t.separator?"[:-]?":!0===t.separator?"[:-]":!1===t.separator?"[]?":`\\${t.separator}`,i=new RegExp(`^([\\[{\\(]?)[0-9A-F]{8}(${n})[0-9A-F]{4}\\2?[${r||"0-9A-F"}][0-9A-F]{3}\\2?[${r?"89AB":"0-9A-F"}][0-9A-F]{3}\\2?[0-9A-F]{12}([\\]}\\)]?)$`,"i");return this.$_addRule({name:"guid",args:{options:t},regex:i})},validate(e,t,r,{regex:n}){const i=n.exec(e);return i?l.guidBrackets[i[1]]!==i[i.length-1]?t.error("string.guid"):e:t.error("string.guid")}},hex:{method(t={}){return c.assertOptions(t,["byteAligned"]),t={byteAligned:!1,...t},e("boolean"==typeof t.byteAligned,"byteAligned must be boolean"),this.$_addRule({name:"hex",args:{options:t}})},validate:(e,t,{options:r})=>l.hexRegex.test(e)?r.byteAligned&&e.length%2!=0?t.error("string.hexAlign"):e:t.error("string.hex")},hostname:{method(){return this.$_addRule("hostname")},validate:(e,r)=>t.isValid(e,{minDomainSegments:1})||l.ipRegex.test(e)?e:r.error("string.hostname")},insensitive:{method(){return this.$_setFlag("insensitive",!0)}},ip:{method(e={}){c.assertOptions(e,["cidr","version"]);const{cidr:t,versions:r,regex:i}=n.regex(e),s=e.version?r:void 0;return this.$_addRule({name:"ip",args:{options:{cidr:t,version:s}},regex:i})},validate:(e,t,{options:r},{regex:n})=>n.test(e)?e:r.version?t.error("string.ipVersion",{value:e,cidr:r.cidr,version:r.version}):t.error("string.ip",{value:e,cidr:r.cidr})},isoDate:{method(){return this.$_addRule("isoDate")},validate:(e,{error:t})=>l.isoDate(e)?e:t("string.isoDate")},isoDuration:{method(){return this.$_addRule("isoDuration")},validate:(e,t)=>l.isoDurationRegex.test(e)?e:t.error("string.isoDuration")},length:{method(e,t){return l.length(this,"length",e,"=",t)},validate(e,t,{limit:r,encoding:n},{name:i,operator:s,args:o}){const a=n?Buffer&&Buffer.byteLength(e,n):e.length;return c.compare(a,r,s)?e:t.error("string."+i,{limit:o.limit,value:e,encoding:n})},args:[{name:"limit",ref:!0,assert:c.limit,message:"must be a positive integer"},"encoding"]},lowercase:{method(){return this.case("lower")}},max:{method(e,t){return l.length(this,"max",e,"<=",t)},args:["limit","encoding"]},min:{method(e,t){return l.length(this,"min",e,">=",t)},args:["limit","encoding"]},normalize:{method(t="NFC"){return e(l.normalizationForms.includes(t),"normalization form must be one of "+l.normalizationForms.join(", ")),this.$_addRule({name:"normalize",args:{form:t}})},validate:(e,{error:t},{form:r})=>e===e.normalize(r)?e:t("string.normalize",{value:e,form:r}),convert:!0},pattern:{alias:"regex",method(t,r={}){e(t instanceof RegExp,"regex must be a RegExp"),e(!t.flags.includes("g")&&!t.flags.includes("y"),"regex should not use global or sticky mode"),"string"==typeof r&&(r={name:r}),c.assertOptions(r,["invert","name"]);const n=["string.pattern",r.invert?".invert":"",r.name?".name":".base"].join("");return this.$_addRule({name:"pattern",args:{regex:t,options:r},errorCode:n})},validate:(e,t,{regex:r,options:n},{errorCode:i})=>r.test(e)^n.invert?e:t.error(i,{name:n.name,regex:r,value:e}),args:["regex","options"],multi:!0},replace:{method(t,r){"string"==typeof t&&(t=new RegExp(i(t),"g")),e(t instanceof RegExp,"pattern must be a RegExp"),e("string"==typeof r,"replacement must be a String");const n=this.clone();return n.$_terms.replacements||(n.$_terms.replacements=[]),n.$_terms.replacements.push({pattern:t,replacement:r}),n}},token:{method(){return this.$_addRule("token")},validate:(e,t)=>/^\w+$/.test(e)?e:t.error("string.token")},trim:{method(t=!0){return e("boolean"==typeof t,"enabled must be a boolean"),this.$_addRule({name:"trim",args:{enabled:t}})},validate:(e,t,{enabled:r})=>r&&e!==e.trim()?t.error("string.trim"):e,convert:!0},truncate:{method(t=!0){return e("boolean"==typeof t,"enabled must be a boolean"),this.$_setFlag("truncate",t)}},uppercase:{method(){return this.case("upper")}},uri:{method(e={}){c.assertOptions(e,["allowRelative","allowQuerySquareBrackets","domain","relativeOnly","scheme"]),e.domain&&c.assertOptions(e.domain,["allowFullyQualified","allowUnicode","maxDomainSegments","minDomainSegments","tlds"]);const{regex:t,scheme:r}=o.regex(e),n=e.domain?l.addressOptions(e.domain):null;return this.$_addRule({name:"uri",args:{options:e},regex:t,domain:n,scheme:r})},validate(e,r,{options:n},{regex:i,domain:s,scheme:o}){if(["http:/","https:/"].includes(e))return r.error("string.uri");const a=i.exec(e);if(a){const i=a[1]||a[2];return!s||n.allowRelative&&!i||t.isValid(i,s)?e:r.error("string.domain",{value:i})}return n.relativeOnly?r.error("string.uriRelativeOnly"):n.scheme?r.error("string.uriCustomScheme",{scheme:o,value:e}):r.error("string.uri")}}},manifest:{build(e,t){if(t.replacements)for(const{pattern:r,replacement:n}of t.replacements)e=e.replace(r,n);return e}},messages:{"string.alphanum":"{{#label}} must only contain alpha-numeric characters","string.base":"{{#label}} must be a string","string.base64":"{{#label}} must be a valid base64 string","string.creditCard":"{{#label}} must be a credit card","string.dataUri":"{{#label}} must be a valid dataUri string","string.domain":"{{#label}} must contain a valid domain name","string.email":"{{#label}} must be a valid email","string.empty":"{{#label}} is not allowed to be empty","string.guid":"{{#label}} must be a valid GUID","string.hex":"{{#label}} must only contain hexadecimal characters","string.hexAlign":"{{#label}} hex decoded representation must be byte aligned","string.hostname":"{{#label}} must be a valid hostname","string.ip":"{{#label}} must be a valid ip address with a {{#cidr}} CIDR","string.ipVersion":"{{#label}} must be a valid ip address of one of the following versions {{#version}} with a {{#cidr}} CIDR","string.isoDate":"{{#label}} must be in iso format","string.isoDuration":"{{#label}} must be a valid ISO 8601 duration","string.length":"{{#label}} length must be {{#limit}} characters long","string.lowercase":"{{#label}} must only contain lowercase characters","string.max":"{{#label}} length must be less than or equal to {{#limit}} characters long","string.min":"{{#label}} length must be at least {{#limit}} characters long","string.normalize":"{{#label}} must be unicode normalized in the {{#form}} form","string.token":"{{#label}} must only contain alpha-numeric and underscore characters","string.pattern.base":"{{#label}} with value {:[.]} fails to match the required pattern: {{#regex}}","string.pattern.name":"{{#label}} with value {:[.]} fails to match the {{#name}} pattern","string.pattern.invert.base":"{{#label}} with value {:[.]} matches the inverted pattern: {{#regex}}","string.pattern.invert.name":"{{#label}} with value {:[.]} matches the inverted {{#name}} pattern","string.trim":"{{#label}} must not have leading or trailing whitespace","string.uri":"{{#label}} must be a valid uri","string.uriCustomScheme":"{{#label}} must be a valid uri with a scheme matching the {{#scheme}} pattern","string.uriRelativeOnly":"{{#label}} must be a valid relative uri","string.uppercase":"{{#label}} must only contain uppercase characters"}}),l.addressOptions=function(t){if(!t)return t;if(e(void 0===t.minDomainSegments||Number.isSafeInteger(t.minDomainSegments)&&t.minDomainSegments>0,"minDomainSegments must be a positive integer"),e(void 0===t.maxDomainSegments||Number.isSafeInteger(t.maxDomainSegments)&&t.maxDomainSegments>0,"maxDomainSegments must be a positive integer"),!1===t.tlds)return t;if(!0===t.tlds||void 0===t.tlds)return e(l.tlds,"Built-in TLD list disabled"),Object.assign({},t,l.tlds);e("object"==typeof t.tlds,"tlds must be true, false, or an object");const r=t.tlds.deny;if(r)return Array.isArray(r)&&(t=Object.assign({},t,{tlds:{deny:new Set(r)}})),e(t.tlds.deny instanceof Set,"tlds.deny must be an array, Set, or boolean"),e(!t.tlds.allow,"Cannot specify both tlds.allow and tlds.deny lists"),l.validateTlds(t.tlds.deny,"tlds.deny"),t;const n=t.tlds.allow;return n?!0===n?(e(l.tlds,"Built-in TLD list disabled"),Object.assign({},t,l.tlds)):(Array.isArray(n)&&(t=Object.assign({},t,{tlds:{allow:new Set(n)}})),e(t.tlds.allow instanceof Set,"tlds.allow must be an array, Set, or boolean"),l.validateTlds(t.tlds.allow,"tlds.allow"),t):t},l.validateTlds=function(r,n){for(const i of r)e(t.isValid(i,{minDomainSegments:1,maxDomainSegments:1}),`${n} must contain valid top level domain names`)},l.isoDate=function(e){if(!c.isIsoDate(e))return null;/.*T.*[+-]\d\d$/.test(e)&&(e+="00");const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString()},l.length=function(t,r,n,i,s){return e(!s||Buffer&&Buffer.isEncoding(s),"Invalid encoding:",s),t.$_addRule({name:r,method:"length",args:{limit:n,encoding:s},operator:i})},mr}function kr(){if(vr)return gr;vr=1;const e=G,t=At(),r={};return r.Map=class extends Map{slice(){return new r.Map(this)}},gr=t.extend({type:"symbol",terms:{map:{init:new r.Map}},coerce:{method(e,{schema:t,error:r}){const n=t.$_terms.map.get(e);return n&&(e=n),t._flags.only&&"symbol"!=typeof e?{value:e,errors:r("symbol.map",{map:t.$_terms.map})}:{value:e}}},validate(e,{error:t}){if("symbol"!=typeof e)return{value:e,errors:t("symbol.base")}},rules:{map:{method(t){t&&!t[Symbol.iterator]&&"object"==typeof t&&(t=Object.entries(t)),e(t&&t[Symbol.iterator],"Iterable must be an iterable or object");const r=this.clone(),n=[];for(const i of t){e(i&&i[Symbol.iterator],"Entry must be an iterable");const[t,s]=i;e("object"!=typeof t&&"function"!=typeof t&&"symbol"!=typeof t,"Key must not be of type object, function, or Symbol"),e("symbol"==typeof s,"Value must be a Symbol"),r.$_terms.map.set(t,s),n.push(s)}return r.valid(...n)}}},manifest:{build:(e,t)=>(t.map&&(e=e.map(t.map)),e)},messages:{"symbol.base":"{{#label}} must be a symbol","symbol.map":"{{#label}} must be one of {{#map}}"}}),gr}function xr(){if(Sr)return _r;Sr=1;const e=G,t=ie,r=Te(),n=Ie(),i=De(),s=_e(),o=je(),a=Ke(),c=Re(),l=Oe(),u=We();let h;const f={types:{alternatives:kt(),any:At(),array:xt(),boolean:Ct(),date:Rt(),function:Xt(),link:Jt(),number:Yt(),object:Zt(),string:Ar(),symbol:kr()},aliases:{alt:"alternatives",bool:"boolean",func:"function"}};return Buffer&&(f.types.binary=function(){if(wr)return br;wr=1;const e=G,t=At(),r=Ie();return br=t.extend({type:"binary",coerce:{from:"string",method(e,{schema:t}){try{return{value:Buffer.from(e,t._flags.encoding)}}catch(e){}}},validate(e,{error:t}){if(!Buffer.isBuffer(e))return{value:e,errors:t("binary.base")}},rules:{encoding:{method(t){return e(Buffer.isEncoding(t),"Invalid encoding:",t),this.$_setFlag("encoding",t)}},length:{method(e){return this.$_addRule({name:"length",method:"length",args:{limit:e},operator:"="})},validate:(e,t,{limit:n},{name:i,operator:s,args:o})=>r.compare(e.length,n,s)?e:t.error("binary."+i,{limit:o.limit,value:e}),args:[{name:"limit",ref:!0,assert:r.limit,message:"must be a positive integer"}]},max:{method(e){return this.$_addRule({name:"max",method:"length",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"length",args:{limit:e},operator:">="})}}},cast:{string:{from:e=>Buffer.isBuffer(e),to:(e,t)=>e.toString()}},messages:{"binary.base":"{{#label}} must be a buffer or a string","binary.length":"{{#label}} must be {{#limit}} bytes","binary.max":"{{#label}} must be less than or equal to {{#limit}} bytes","binary.min":"{{#label}} must be at least {{#limit}} bytes"}}),br}()),f.root=function(){const t={_types:new Set(Object.keys(f.types))};for(const r of t._types)t[r]=function(...t){return e(!t.length||["alternatives","link","object"].includes(r),"The",r,"type does not allow arguments"),f.generate(this,f.types[r],t)};for(const e of["allow","custom","disallow","equal","exist","forbidden","invalid","not","only","optional","options","prefs","preferences","required","strip","valid","when"])t[e]=function(...t){return this.any()[e](...t)};Object.assign(t,f.methods);for(const e in f.aliases){const r=f.aliases[e];t[e]=t[r]}return t.x=t.expression,u.setup&&u.setup(t),t},f.methods={ValidationError:s.ValidationError,version:n.version,cache:r.provider,assert(e,t,...r){f.assert(e,t,!0,r)},attempt:(e,t,...r)=>f.assert(e,t,!1,r),build(t){return e("function"==typeof a.build,"Manifest functionality disabled"),a.build(this,t)},checkPreferences(e){n.checkPreferences(e)},compile(e,t){return i.compile(this,e,t)},defaults(t){e("function"==typeof t,"modifier must be a function");const r=Object.assign({},this);for(const i of r._types){const s=t(r[i]());e(n.isSchema(s),"modifier must return a valid schema object"),r[i]=function(...e){return f.generate(this,s,e)}}return r},expression:(...e)=>new l(...e),extend(...t){n.verifyFlat(t,"extend"),h=h||ue(),e(t.length,"You need to provide at least one extension"),this.assert(t,h.extensions);const r=Object.assign({},this);r._types=new Set(r._types);for(let n of t){"function"==typeof n&&(n=n(r)),this.assert(n,h.extension);const t=f.expandExtension(n,r);for(const n of t){e(void 0===r[n.type]||r._types.has(n.type),"Cannot override name",n.type);const t=n.base||this.any(),i=o.type(t,n);r._types.add(n.type),r[n.type]=function(...e){return f.generate(this,i,e)}}}return r},isError:s.ValidationError.isError,isExpression:l.isTemplate,isRef:c.isRef,isSchema:n.isSchema,in:(...e)=>c.in(...e),override:n.symbols.override,ref:(...e)=>c.create(...e),types(){const e={};for(const t of this._types)e[t]=this[t]();for(const t in f.aliases)e[t]=this[t]();return e}},f.assert=function(e,r,i,o){const a=o[0]instanceof Error||"string"==typeof o[0]?o[0]:null,c=null!==a?o[1]:o[0],l=r.validate(e,n.preferences({errors:{stack:!0}},c||{}));let u=l.error;if(!u)return l.value;if(a instanceof Error)throw a;const h=i&&"function"==typeof u.annotate?u.annotate():u.message;throw u instanceof s.ValidationError==!1&&(u=t(u)),u.message=a?`${a} ${h}`:h,u},f.generate=function(t,r,n){return e(t,"Must be invoked on a Joi instance."),r.$_root=t,r._definition.args&&n.length?r._definition.args(r,...n):r},f.expandExtension=function(e,t){if("string"==typeof e.type)return[e];const r=[];for(const n of t._types)if(e.type.test(n)){const i=Object.assign({},e);i.type=n,i.base=t[n](),r.push(i)}return r},_r=f.root()}var Cr=K(xr());Cr.extend({type:"string",base:Cr.string(),messages:{"string.contains":"{{#label}} must contain [{{#substring}}]","string.ncontains":"{{#label}} can't contain [{{#substring}}]"},rules:{contains:{args:[{name:"substring",ref:!0,assert:e=>"string"==typeof e,message:"must be a string"}],method(e){return this.$_addRule({name:"contains",args:{substring:e}})},validate:(e,t,{substring:r})=>!1===e.includes(r)?t.error("string.contains",{substring:r}):e},ncontains:{args:[{name:"substring",ref:!0,assert:e=>"string"==typeof e,message:"must be a string"}],method(e){return this.$_addRule({name:"ncontains",args:{substring:e}})},validate:(e,t,{substring:r})=>!0===e.includes(r)?t.error("string.ncontains",{substring:r}):e}}});const Rr=e=>{let t=e.httpHandler;return{setHttpHandler(e){t=e},httpHandler:()=>t,updateHttpClientConfig(e,r){t.updateHttpClientConfig(e,r)},httpHandlerConfigs:()=>t.httpHandlerConfigs()}},Or=e=>({httpHandler:e.httpHandler()});var Nr,Ir,Tr,Pr;!function(e){e.HEADER="header",e.QUERY="query"}(Nr||(Nr={})),function(e){e.HTTP="http",e.HTTPS="https"}(Ir||(Ir={})),function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"}(Tr||(Tr={})),function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(Pr||(Pr={}));const Br="__smithy_context";var Dr;!function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(Dr||(Dr={}));class $r{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){const e=new $r({...this,headers:{...this.headers}});var t;return e.query&&(e.query=(t=e.query,Object.keys(t).reduce(((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}}),{}))),e}}class Lr{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}const jr={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Mr=e=>({applyToStack:t=>{t.add(function(e){return t=>async r=>{const{request:n}=r;return $r.isInstance(n)&&n.body&&"node"===e.runtime&&(n.headers={...n.headers,Expect:"100-continue"}),t({...r,request:n})}}(e),jr)}});const Ur={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Kr=e=>({applyToStack:t=>{t.add((e=>t=>async r=>{if(!$r.isInstance(r.request))return t(r);const{request:n}=r,{handlerProtocol:i=""}=e.requestHandler.metadata||{};if(i.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]="";else if(!n.headers.host){let e=n.hostname;null!=n.port&&(e+=`:${n.port}`),n.headers.host=e}return t(r)})(e),Ur)}}),Fr={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},Hr=e=>({applyToStack:e=>{e.add(((e,t)=>async r=>{try{const n=await e(r),{clientName:i,commandName:s,logger:o,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:c,overrideOutputFilterSensitiveLog:l}=a,u=c??t.inputFilterSensitiveLog,h=l??t.outputFilterSensitiveLog,{$metadata:f,...p}=n.output;return o?.info?.({clientName:i,commandName:s,input:u(r.input),output:h(p),metadata:f}),n}catch(e){const{clientName:n,commandName:i,logger:s,dynamoDbDocumentClientOptions:o={}}=t,{overrideInputFilterSensitiveLog:a}=o,c=a??t.inputFilterSensitiveLog;throw s?.error?.({clientName:n,commandName:i,input:c(r.input),error:e,metadata:e.$metadata}),e}}),Fr)}}),zr="X-Amzn-Trace-Id",Vr={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},qr=e=>({applyToStack:t=>{t.add((e=>t=>async r=>{const{request:n}=r;if(!$r.isInstance(n)||"node"!==e.runtime||n.headers.hasOwnProperty(zr))return t(r);const i=process.env.AWS_LAMBDA_FUNCTION_NAME,s=process.env._X_AMZN_TRACE_ID,o=e=>"string"==typeof e&&e.length>0;return o(i)&&o(s)&&(n.headers[zr]=s),t({...r,request:n})})(e),Vr)}});class Gr{trace(){}debug(){}info(){}warn(){}error(){}}const Wr=(e,t)=>{const r=[];if(e&&r.push(e),t)for(const e of t)r.push(e);return r},Xr=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,Jr=()=>{let e=[],t=[],r=!1;const n=new Set,i=r=>(e.forEach((e=>{r.add(e.middleware,{...e})})),t.forEach((e=>{r.addRelativeTo(e.middleware,{...e})})),r.identifyOnResolve?.(a.identifyOnResolve()),r),s=e=>{const t=[];return e.before.forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...s(e))})),t.push(e),e.after.reverse().forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...s(e))})),t},o=(r=!1)=>{const n=[],i=[],o={};e.forEach((e=>{const t={...e,before:[],after:[]};for(const e of Wr(t.name,t.aliases))o[e]=t;n.push(t)})),t.forEach((e=>{const t={...e,before:[],after:[]};for(const e of Wr(t.name,t.aliases))o[e]=t;i.push(t)})),i.forEach((e=>{if(e.toMiddleware){const t=o[e.toMiddleware];if(void 0===t){if(r)return;throw new Error(`${e.toMiddleware} is not found when adding ${Xr(e.name,e.aliases)} middleware ${e.relation} ${e.toMiddleware}`)}"after"===e.relation&&t.after.push(e),"before"===e.relation&&t.before.push(e)}}));const a=(c=n,c.sort(((e,t)=>Yr[t.step]-Yr[e.step]||Zr[t.priority||"normal"]-Zr[e.priority||"normal"]))).map(s).reduce(((e,t)=>(e.push(...t),e)),[]);var c;return a},a={add:(t,r={})=>{const{name:i,override:s,aliases:o}=r,a={step:"initialize",priority:"normal",middleware:t,...r},c=Wr(i,o);if(c.length>0){if(c.some((e=>n.has(e)))){if(!s)throw new Error(`Duplicate middleware name '${Xr(i,o)}'`);for(const t of c){const r=e.findIndex((e=>e.name===t||e.aliases?.some((e=>e===t))));if(-1===r)continue;const n=e[r];if(n.step!==a.step||a.priority!==n.priority)throw new Error(`"${Xr(n.name,n.aliases)}" middleware with ${n.priority} priority in ${n.step} step cannot be overridden by "${Xr(i,o)}" middleware with ${a.priority} priority in ${a.step} step.`);e.splice(r,1)}}for(const e of c)n.add(e)}e.push(a)},addRelativeTo:(e,r)=>{const{name:i,override:s,aliases:o}=r,a={middleware:e,...r},c=Wr(i,o);if(c.length>0){if(c.some((e=>n.has(e)))){if(!s)throw new Error(`Duplicate middleware name '${Xr(i,o)}'`);for(const e of c){const r=t.findIndex((t=>t.name===e||t.aliases?.some((t=>t===e))));if(-1===r)continue;const n=t[r];if(n.toMiddleware!==a.toMiddleware||n.relation!==a.relation)throw new Error(`"${Xr(n.name,n.aliases)}" middleware ${n.relation} "${n.toMiddleware}" middleware cannot be overridden by "${Xr(i,o)}" middleware ${a.relation} "${a.toMiddleware}" middleware.`);t.splice(r,1)}}for(const e of c)n.add(e)}t.push(a)},clone:()=>i(Jr()),use:e=>{e.applyToStack(a)},remove:r=>"string"==typeof r?(r=>{let i=!1;const s=e=>{const t=Wr(e.name,e.aliases);if(t.includes(r)){i=!0;for(const e of t)n.delete(e);return!1}return!0};return e=e.filter(s),t=t.filter(s),i})(r):(r=>{let i=!1;const s=e=>{if(e.middleware===r){i=!0;for(const t of Wr(e.name,e.aliases))n.delete(t);return!1}return!0};return e=e.filter(s),t=t.filter(s),i})(r),removeByTag:r=>{let i=!1;const s=e=>{const{tags:t,name:s,aliases:o}=e;if(t&&t.includes(r)){const e=Wr(s,o);for(const t of e)n.delete(t);return i=!0,!1}return!0};return e=e.filter(s),t=t.filter(s),i},concat:e=>{const t=i(Jr());return t.use(e),t.identifyOnResolve(r||t.identifyOnResolve()||(e.identifyOnResolve?.()??!1)),t},applyToStack:i,identify:()=>o(!0).map((e=>{const t=e.step??e.relation+" "+e.toMiddleware;return Xr(e.name,e.aliases)+" - "+t})),identifyOnResolve:e=>("boolean"==typeof e&&(r=e),r),resolve:(e,t)=>{for(const r of o().map((e=>e.middleware)).reverse())e=r(e,t);return r&&console.log(a.identify()),e}};return a},Yr={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Zr={high:3,normal:2,low:1};class Qr{constructor(e){this.middlewareStack=Jr(),this.config=e}send(e,t,r){const n="function"!=typeof t?t:void 0,i="function"==typeof t?t:r,s=e.resolveMiddleware(this.middlewareStack,this.config,n);if(!i)return s(e).then((e=>e.output));s(e).then((e=>i(null,e.output)),(e=>i(e))).catch((()=>{}))}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}const en=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),tn=(e,t=0,r=e.byteLength-t)=>{if(!en(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return o.from(e,t,r)},rn=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?o.from(e,t):o.from(e)},nn=/^[A-Za-z0-9+/]*={0,2}$/,sn=e=>{if(3*e.length%4!=0)throw new TypeError("Incorrect padding on base64 string.");if(!nn.exec(e))throw new TypeError("Invalid base64 string.");const t=rn(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},on=e=>tn(e.buffer,e.byteOffset,e.byteLength).toString("base64"),an=e=>{const t=rn(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},cn=e=>"string"==typeof e?an(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),ln=e=>tn(e.buffer,e.byteOffset,e.byteLength).toString("utf8");class un extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return function(e,t){return"base64"===t?un.mutate(sn(e)):un.mutate(an(e))}(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,un.prototype),e}transformToString(e="utf-8"){return function(e,t="utf-8"){return"base64"===t?on(e):ln(e)}(this,e)}}const hn=(e,t)=>{const{base64Encoder:r,bodyLengthChecker:n,checksumAlgorithmFn:i,checksumLocationName:s,streamHasher:o}=t,a=void 0!==r&&void 0!==i&&void 0!==s&&void 0!==o,l=a?o(i,e):void 0,u=new c({read:()=>{}});return e.on("data",(e=>{const t=n(e)||0;u.push(`${t.toString(16)}\r\n`),u.push(e),u.push("\r\n")})),e.on("end",(async()=>{if(u.push("0\r\n"),a){const e=r(await l);u.push(`${s}:${e}\r\n`),u.push("\r\n")}u.push(null)})),u},fn=e=>encodeURIComponent(e).replace(/[!'()*]/g,pn),pn=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;const dn=["ECONNRESET","EPIPE","ETIMEDOUT"],mn=e=>{const t={};for(const r of Object.keys(e)){const n=e[r];t[r]=Array.isArray(n)?n.join(","):n}return t};async function yn(e,t,r=1e3){const n=t.headers??{},i=n.Expect||n.expect;let s=-1,o=!1;"100-continue"===i&&await Promise.race([new Promise((e=>{s=Number(setTimeout(e,Math.max(1e3,r)))})),new Promise((t=>{e.on("continue",(()=>{clearTimeout(s),t()})),e.on("error",(()=>{o=!0,clearTimeout(s),t()}))}))]),o||function(e,t){t instanceof c?t.pipe(e):t?e.end(Buffer.from(t)):e.end()}(e,t.body)}class gn{constructor(e){this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise(((t,r)=>{"function"==typeof e?e().then((e=>{t(this.resolveDefaultConfig(e))})).catch(r):t(this.resolveDefaultConfig(e))}))}resolveDefaultConfig(e){const{requestTimeout:t,connectionTimeout:r,socketTimeout:n,httpAgent:i,httpsAgent:s}=e||{};return{connectionTimeout:r,requestTimeout:t??n,httpAgent:i||new h({keepAlive:true,maxSockets:50}),httpsAgent:s||new p({keepAlive:true,maxSockets:50})}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(e,{abortSignal:t}={}){return this.config||(this.config=await this.configProvider),new Promise(((r,n)=>{let i;const s=async e=>{await i,n(e)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(t?.aborted){const e=new Error("Request aborted");return e.name="AbortError",void s(e)}const o="https:"===e.protocol,a=function(e){const t=[];for(let r of Object.keys(e).sort()){const n=e[r];if(r=fn(r),Array.isArray(n))for(let e=0,i=n.length;e<i;e++)t.push(`${r}=${fn(n[e])}`);else{let e=r;(n||"string"==typeof n)&&(e+=`=${fn(n)}`),t.push(e)}}return t.join("&")}(e.query||{});let c;if(null!=e.username||null!=e.password){c=`${e.username??""}:${e.password??""}`}let l=e.path;a&&(l+=`?${a}`),e.fragment&&(l+=`#${e.fragment}`);const u={headers:e.headers,host:e.hostname,method:e.method,path:l,port:e.port,agent:o?this.config.httpsAgent:this.config.httpAgent,auth:c},h=(o?d:f)(u,(e=>{(async e=>{await i,r(e)})({response:new Lr({statusCode:e.statusCode||-1,reason:e.statusMessage,headers:mn(e.headers),body:e})})}));h.on("error",(e=>{dn.includes(e.code)?s(Object.assign(e,{name:"TimeoutError"})):s(e)})),((e,t,r=0)=>{if(!r)return;const n=setTimeout((()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))}),r);e.on("socket",(e=>{e.connecting?e.on("connect",(()=>{clearTimeout(n)})):clearTimeout(n)}))})(h,s,this.config.connectionTimeout),((e,t,r=0)=>{e.setTimeout(r,(()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))}))})(h,s,this.config.requestTimeout),t&&(t.onabort=()=>{h.abort();const e=new Error("Request aborted");e.name="AbortError",s(e)});const p=u.agent;"object"==typeof p&&"keepAlive"in p&&((e,{keepAlive:t,keepAliveMsecs:r})=>{!0===t&&e.on("socket",(e=>{e.setKeepAlive(t,r||0)}))})(h,{keepAlive:p.keepAlive,keepAliveMsecs:p.keepAliveMsecs}),i=yn(h,e,this.config.requestTimeout).catch(n)}))}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then((r=>({...r,[e]:t})))}httpHandlerConfigs(){return this.config??{}}}class vn extends l{constructor(){super(...arguments),this.bufferedBytes=[]}_write(e,t,r){this.bufferedBytes.push(e),r()}}const bn=e=>new Promise(((t,r)=>{const n=new vn;e.pipe(n),e.on("error",(e=>{n.end(),r(e)})),n.on("error",r),n.on("finish",(function(){const e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))})),wn="The stream has already been transformed.",_n=e=>{if(!(e instanceof c)){throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${e?.__proto__?.constructor?.name||e}`)}let t=!1;const r=async()=>{if(t)throw new Error(wn);return t=!0,await bn(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();if(void 0===e||Buffer.isEncoding(e))return tn(t.buffer,t.byteOffset,t.byteLength).toString(e);return new n(e).decode(t)},transformToWebStream:()=>{if(t)throw new Error(wn);if(null!==e.readableFlowing)throw new Error("The stream has been consumed by other callbacks.");if("function"!=typeof c.toWeb)throw new Error("Readable.toWeb() is not supported. Please make sure you are using Node.js >= 17.0.0, or polyfill is available.");return t=!0,c.toWeb(e)}})},Sn=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return un.mutate(e);if(!e)return un.mutate(new Uint8Array);const r=t.streamCollector(e);return un.mutate(await r)};class En{constructor(){this.middlewareStack=Jr()}}const An="***SensitiveInformation***",kn=e=>{switch(e){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${e}"`)}},xn=Math.ceil(2**127*(2-2**-23)),Cn=e=>{const t=(e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&Fn.warn(Kn(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}})(e);if(void 0!==t&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>xn)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},Rn=e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}},On=e=>Tn(e,32),Nn=e=>Tn(e,16),In=e=>Tn(e,8),Tn=(e,t)=>{const r=Rn(e);if(void 0!==r&&Pn(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},Pn=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},Bn=(e,t)=>{if(null==e){if(t)throw new TypeError(`Expected a non-null value for ${t}`);throw new TypeError("Expected a non-null value")}return e},Dn=e=>{if(null==e)return;if("object"==typeof e&&!Array.isArray(e))return e;const t=Array.isArray(e)?"array":typeof e;throw new TypeError(`Expected object, got ${t}: ${e}`)},$n=e=>{if(null!=e){if("string"==typeof e)return e;if(["boolean","number","bigint"].includes(typeof e))return Fn.warn(Kn(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}},Ln=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,jn=e=>{const t=e.match(Ln);if(null===t||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},Mn=e=>On("string"==typeof e?jn(e):e),Un=e=>Nn("string"==typeof e?jn(e):e),Kn=e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"),Fn={warn:console.warn},Hn=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],zn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Vn(e){const t=e.getUTCFullYear(),r=e.getUTCMonth(),n=e.getUTCDay(),i=e.getUTCDate(),s=e.getUTCHours(),o=e.getUTCMinutes(),a=e.getUTCSeconds(),c=s<10?`0${s}`:`${s}`,l=o<10?`0${o}`:`${o}`,u=a<10?`0${a}`:`${a}`;return`${Hn[n]}, ${i<10?`0${i}`:`${i}`} ${zn[r]} ${t} ${c}:${l}:${u} GMT`}const qn=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),Gn=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=qn.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,i,s,o,a,c,l,u]=t,h=Un(ci(n)),f=si(i,"month",1,12),p=si(s,"day",1,31),d=Zn(h,f,p,{hours:o,minutes:a,seconds:c,fractionalMilliseconds:l});return"Z"!=u.toUpperCase()&&d.setTime(d.getTime()-ai(u)),d},Wn=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Xn=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Jn=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),Yn=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-7231 date-times must be expressed as strings");let t=Wn.exec(e);if(t){const[e,r,n,i,s,o,a,c]=t;return Zn(Un(ci(i)),ti(n),si(r,"day",1,31),{hours:s,minutes:o,seconds:a,fractionalMilliseconds:c})}if(t=Xn.exec(e),t){const[e,r,n,i,s,o,a,c]=t;return ei(Zn(Qn(i),ti(n),si(r,"day",1,31),{hours:s,minutes:o,seconds:a,fractionalMilliseconds:c}))}if(t=Jn.exec(e),t){const[e,r,n,i,s,o,a,c]=t;return Zn(Un(ci(c)),ti(r),si(n.trimLeft(),"day",1,31),{hours:i,minutes:s,seconds:o,fractionalMilliseconds:a})}throw new TypeError("Invalid RFC-7231 date-time value")},Zn=(e,t,r,n)=>{const i=t-1;return ni(e,i,r),new Date(Date.UTC(e,i,r,si(n.hours,"hour",0,23),si(n.minutes,"minute",0,59),si(n.seconds,"seconds",0,60),oi(n.fractionalMilliseconds)))},Qn=e=>{const t=(new Date).getUTCFullYear(),r=100*Math.floor(t/100)+Un(ci(e));return r<t?r+100:r},ei=e=>e.getTime()-(new Date).getTime()>15768e8?new Date(Date.UTC(e.getUTCFullYear()-100,e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())):e,ti=e=>{const t=zn.indexOf(e);if(t<0)throw new TypeError(`Invalid month: ${e}`);return t+1},ri=[31,28,31,30,31,30,31,31,30,31,30,31],ni=(e,t,r)=>{let n=ri[t];if(1===t&&ii(e)&&(n=29),r>n)throw new TypeError(`Invalid day for ${zn[t]} in ${e}: ${r}`)},ii=e=>e%4==0&&(e%100!=0||e%400==0),si=(e,t,r,n)=>{const i=(e=>In("string"==typeof e?jn(e):e))(ci(e));if(i<r||i>n)throw new TypeError(`${t} must be between ${r} and ${n}, inclusive`);return i},oi=e=>null==e?0:1e3*(e=>Cn("string"==typeof e?jn(e):e))("0."+e),ai=e=>{const t=e[0];let r=1;if("+"==t)r=1;else{if("-"!=t)throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);r=-1}return r*(60*Number(e.substring(1,3))+Number(e.substring(4,6)))*60*1e3},ci=e=>{let t=0;for(;t<e.length-1&&"0"===e.charAt(t);)t++;return 0===t?e:e.slice(t)};class li extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,li.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const ui=(e,t={})=>{Object.entries(t).filter((([,e])=>void 0!==e)).forEach((([t,r])=>{null!=e[t]&&""!==e[t]||(e[t]=r)}));const r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e},hi=e=>({output:t,parsedBody:r,errorCode:n})=>{(({output:e,parsedBody:t,exceptionCtor:r,errorCode:n})=>{const i=fi(e),s=i.httpStatusCode?i.httpStatusCode+"":void 0,o=new r({name:t?.code||t?.Code||n||s||"UnknownError",$fault:"client",$metadata:i});throw ui(o,t)})({output:t,parsedBody:r,exceptionCtor:e,errorCode:n})},fi=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),pi=e=>{switch(e){case"standard":case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};let di=!1;const mi=e=>{e&&!di&&parseInt(e.substring(1,e.indexOf(".")))<14&&(di=!0)},yi=e=>{const t=[];for(const r in Tr){const n=Tr[r];void 0!==e[n]&&t.push({algorithmId:()=>n,checksumConstructor:()=>e[n]})}return{_checksumAlgorithms:t,addChecksumAlgorithm(e){this._checksumAlgorithms.push(e)},checksumAlgorithms(){return this._checksumAlgorithms}}},gi=e=>{const t={};return e.checksumAlgorithms().forEach((e=>{t[e.algorithmId()]=e.checksumConstructor()})),t},vi=e=>{let t=e.retryStrategy;return{setRetryStrategy(e){t=e},retryStrategy:()=>t}},bi=e=>{const t={};return t.retryStrategy=e.retryStrategy(),t},wi=e=>({...yi(e),...vi(e)}),_i=e=>({...gi(e),...bi(e)});function Si(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}const Ei=e=>{const t="#text";for(const r in e)e.hasOwnProperty(r)&&void 0!==e[r][t]?e[r]=e[r][t]:"object"==typeof e[r]&&null!==e[r]&&(e[r]=Ei(e[r]));return e},Ai=function(){const e=Object.getPrototypeOf(this).constructor,t=new(Function.bind.apply(String,[null,...arguments]));return Object.setPrototypeOf(t,e.prototype),t};function ki(e,t,r){let n,i,s;if(void 0===t&&void 0===r)n={},s=e;else{if(n=e,"function"==typeof t)return i=t,s=r,Ci(n,i,s);s=t}for(const e of Object.keys(s))Array.isArray(s[e])?Ri(n,null,s,e):n[e]=s[e];return n}Ai.prototype=Object.create(String.prototype,{constructor:{value:Ai,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(Ai,String);const xi=(e,t)=>{const r={};for(const n in t)Ri(r,e,t,n);return r},Ci=(e,t,r)=>ki(e,Object.entries(r).reduce(((e,[r,n])=>(Array.isArray(n)?e[r]=n:e[r]="function"==typeof n?[t,n()]:[t,n],e)),{})),Ri=(e,t,r,n)=>{if(null!==t){let i=r[n];"function"==typeof i&&(i=[,i]);const[s=Oi,o=Ni,a=n]=i;return void(("function"==typeof s&&s(t[a])||"function"!=typeof s&&s)&&(e[n]=o(t[a])))}let[i,s]=r[n];if("function"==typeof s){let t;const r=void 0===i&&null!=(t=s()),o="function"==typeof i&&!!i(void 0)||"function"!=typeof i&&!!i;r?e[n]=t:o&&(e[n]=s())}else{const t=void 0===i&&null!=s,r="function"==typeof i&&!!i(s)||"function"!=typeof i&&!!i;(t||r)&&(e[n]=s)}},Oi=e=>null!=e,Ni=e=>e,Ii=(e,t,r,n,i,s)=>{if(null==t||void 0===t[r])throw new Error("No value provided for input HTTP label: "+r+".");{const t=n();if(t.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");e=e.replace(i,s?t.split("/").map((e=>Si(e))).join("/"):Si(t))}return e},Ti=e=>{if(null==e)return{};if(Array.isArray(e))return e.filter((e=>null!=e));if("object"==typeof e){const t={};for(const r of Object.keys(e))null!=e[r]&&(t[r]=Ti(e[r]));return t}return e};const Pi={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},Bi=e=>({applyToStack:e=>{e.add(((e,t)=>async r=>{const{request:n}=r;if($r.isInstance(n)&&!n.headers["content-length"]){const e="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";"function"!=typeof t?.logger?.warn||t.logger instanceof Gr?console.warn(e):t.logger.warn(e)}return e({...r})}),Pi)}}),Di=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),$i=(e,t)=>Di(e,t).then((e=>t.utf8Encoder(e))),Li={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},ji=e=>({applyToStack:t=>{t.addRelativeTo((e=>t=>async r=>{const n=await t(r),{response:i}=n;if(!Lr.isInstance(i))return n;const{statusCode:s,body:o}=i;if(s<200||s>=300)return n;const a=await Di(o,e),c=await $i(a,e);if(0===a.length){const e=new Error("S3 aborted request");throw e.name="InternalError",e}return c&&c.match("<Error>")&&(i.statusCode=400),i.body=a,n})(e),Li)}});const Mi={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Ui=e=>({applyToStack:e=>{e.add((e=>async t=>{const{input:{Bucket:r}}=t;if("string"==typeof r&&!("string"==typeof(n=r)&&0===n.indexOf("arn:")&&n.split(":").length>=6)&&r.indexOf("/")>=0){const e=new Error(`Bucket name shouldn't contain '/', received '${r}'`);throw e.name="InvalidBucketName",e}var n;return e({...t})}),Mi)}});class Ki extends Error{constructor(e,t=!0){super(e),this.tryNextLink=t,this.name="ProviderError",Object.setPrototypeOf(this,Ki.prototype)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class Fi extends Ki{constructor(e,t=!0){super(e,t),this.tryNextLink=t,this.name="CredentialsProviderError",Object.setPrototypeOf(this,Fi.prototype)}}class Hi extends Ki{constructor(e,t=!0){super(e,t),this.tryNextLink=t,this.name="TokenProviderError",Object.setPrototypeOf(this,Hi.prototype)}}const zi=(...e)=>async()=>{if(0===e.length)throw new Ki("No providers in chain");let t;for(const r of e)try{return await r()}catch(e){if(t=e,e?.tryNextLink)continue;throw e}throw t},Vi=(e,t,r)=>{let n,i,s,o=!1;const a=async()=>{i||(i=e());try{n=await i,s=!0,o=!1}finally{i=void 0}return n};return void 0===t?async e=>(s&&!e?.forceRefresh||(n=await a()),n):async e=>(s&&!e?.forceRefresh||(n=await a()),o?n:r&&!r(n)?(o=!0,n):t(n)?(await a(),n):n)};var qi={},Gi=function(e,t){return Gi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},Gi(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wi=function(){return Wi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Wi.apply(this,arguments)};function Xi(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ji(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Yi(e){return this instanceof Yi?(this.v=e,this):new Yi(e)}var Zi=Object.freeze({__proto__:null,get __assign(){return Wi},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:Yi(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof Yi?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(i[e](t))}catch(e){u(s[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=Xi(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}},__await:Yi,__awaiter:function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},__createBinding:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},__decorate:function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},__exportStar:function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])},__extends:function(e,t){function r(){this.constructor=e}Gi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__generator:function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param:function(e,t){return function(r,n){t(r,n,e)}},__read:Ji,__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ji(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:Xi}),Qi=F(Zi),es={},ts={};var rs=Object.freeze({__proto__:null,fromUtf8:e=>"function"==typeof TextEncoder?function(e){return(new TextEncoder).encode(e)}(e):(e=>{const t=[];for(let r=0,n=e.length;r<n;r++){const n=e.charCodeAt(r);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192,63&n|128);else if(r+1<e.length&&55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))){const i=65536+((1023&n)<<10)+(1023&e.charCodeAt(++r));t.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else t.push(n>>12|224,n>>6&63|128,63&n|128)}return Uint8Array.from(t)})(e),toUtf8:e=>"function"==typeof TextDecoder?function(e){return new TextDecoder("utf-8").decode(e)}(e):(e=>{let t="";for(let r=0,n=e.length;r<n;r++){const n=e[r];if(n<128)t+=String.fromCharCode(n);else if(192<=n&&n<224){const i=e[++r];t+=String.fromCharCode((31&n)<<6|63&i)}else if(240<=n&&n<365){const i="%"+[n,e[++r],e[++r],e[++r]].map((e=>e.toString(16))).join("%");t+=decodeURIComponent(i)}else t+=String.fromCharCode((15&n)<<12|(63&e[++r])<<6|63&e[++r])}return t})(e)}),ns=F(rs);Object.defineProperty(ts,"__esModule",{value:!0}),ts.convertToBuffer=void 0;var is=ns,ss="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:is.fromUtf8;ts.convertToBuffer=function(e){return e instanceof Uint8Array?e:"string"==typeof e?ss(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)};var os={};Object.defineProperty(os,"__esModule",{value:!0}),os.isEmptyData=void 0,os.isEmptyData=function(e){return"string"==typeof e?0===e.length:0===e.byteLength};var as={};Object.defineProperty(as,"__esModule",{value:!0}),as.numToUint8=void 0,as.numToUint8=function(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])};var cs={};Object.defineProperty(cs,"__esModule",{value:!0}),cs.uint32ArrayFrom=void 0,cs.uint32ArrayFrom=function(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uint32ArrayFrom=e.numToUint8=e.isEmptyData=e.convertToBuffer=void 0;var t=ts;Object.defineProperty(e,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var r=os;Object.defineProperty(e,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var n=as;Object.defineProperty(e,"numToUint8",{enumerable:!0,get:function(){return n.numToUint8}});var i=cs;Object.defineProperty(e,"uint32ArrayFrom",{enumerable:!0,get:function(){return i.uint32ArrayFrom}})}(es);var ls,us,hs={};function fs(){return us||(us=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AwsCrc32=e.Crc32=e.crc32=void 0;var t=Qi,r=es;e.crc32=function(e){return(new n).update(e).digest()};var n=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var r,n;try{for(var s=t.__values(e),o=s.next();!o.done;o=s.next()){var a=o.value;this.checksum=this.checksum>>>8^i[255&(this.checksum^a)]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();e.Crc32=n;var i=(0,r.uint32ArrayFrom)([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),s=function(){if(ls)return hs;ls=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.AwsCrc32=void 0;var e=Qi,t=es,r=fs(),n=function(){function n(){this.crc32=new r.Crc32}return n.prototype.update=function(e){(0,t.isEmptyData)(e)||this.crc32.update((0,t.convertToBuffer)(e))},n.prototype.digest=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,(0,t.numToUint8)(this.crc32.digest())]}))}))},n.prototype.reset=function(){this.crc32=new r.Crc32},n}();return hs.AwsCrc32=n,hs}();Object.defineProperty(e,"AwsCrc32",{enumerable:!0,get:function(){return s.AwsCrc32}})}(qi)),qi}var ps=fs();const ds={},ms={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),ds[e]=t,ms[t]=e}function ys(e){let t="";for(let r=0;r<e.byteLength;r++)t+=ds[e[r]];return t}class gs{constructor(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let r=7,n=Math.abs(Math.round(e));r>-1&&n>0;r--,n/=256)t[r]=n;return e<0&&vs(t),new gs(t)}valueOf(){const e=this.bytes.slice(0),t=128&e[0];return t&&vs(e),parseInt(ys(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function vs(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}class bs{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){const t=[];for(const r of Object.keys(e)){const n=this.fromUtf8(r);t.push(Uint8Array.from([n.byteLength]),n,this.formatHeaderValue(e[r]))}const r=new Uint8Array(t.reduce(((e,t)=>e+t.byteLength),0));let n=0;for(const e of t)r.set(e,n),n+=e.byteLength;return r}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const s=new Uint8Array(i.buffer);return s.set(e.value,3),s;case"string":const o=this.fromUtf8(e.value),a=new DataView(new ArrayBuffer(3+o.byteLength));a.setUint8(0,7),a.setUint16(1,o.byteLength,!1);const c=new Uint8Array(a.buffer);return c.set(o,3),c;case"timestamp":const l=new Uint8Array(9);return l[0]=8,l.set(gs.fromNumber(e.value.valueOf()).bytes,1),l;case"uuid":if(!Ns.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const u=new Uint8Array(17);return u[0]=9,u.set(function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){const n=e.slice(r,r+2).toLowerCase();if(!(n in ms))throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`);t[r/2]=ms[n]}return t}(e.value.replace(/\-/g,"")),1),u}}parse(e){const t={};let r=0;for(;r<e.byteLength;){const n=e.getUint8(r++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,n));switch(r+=n,e.getUint8(r++)){case 0:t[i]={type:_s,value:!0};break;case 1:t[i]={type:_s,value:!1};break;case 2:t[i]={type:Ss,value:e.getInt8(r++)};break;case 3:t[i]={type:Es,value:e.getInt16(r,!1)},r+=2;break;case 4:t[i]={type:As,value:e.getInt32(r,!1)},r+=4;break;case 5:t[i]={type:ks,value:new gs(new Uint8Array(e.buffer,e.byteOffset+r,8))},r+=8;break;case 6:const n=e.getUint16(r,!1);r+=2,t[i]={type:xs,value:new Uint8Array(e.buffer,e.byteOffset+r,n)},r+=n;break;case 7:const s=e.getUint16(r,!1);r+=2,t[i]={type:Cs,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,s))},r+=s;break;case 8:t[i]={type:Rs,value:new Date(new gs(new Uint8Array(e.buffer,e.byteOffset+r,8)).valueOf())},r+=8;break;case 9:const o=new Uint8Array(e.buffer,e.byteOffset+r,16);r+=16,t[i]={type:Os,value:`${ys(o.subarray(0,4))}-${ys(o.subarray(4,6))}-${ys(o.subarray(6,8))}-${ys(o.subarray(8,10))}-${ys(o.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return t}}var ws;!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(ws||(ws={}));const _s="boolean",Ss="byte",Es="short",As="integer",ks="long",xs="binary",Cs="string",Rs="timestamp",Os="uuid",Ns=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Is{constructor(e,t){this.headerMarshaller=new bs(e,t),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),t=this.isEndOfStream;return{getMessage:()=>e,isEndOfStream:()=>t}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const t=this.isEndOfStream;return{getMessages:()=>e,isEndOfStream:()=>t}}encode({headers:e,body:t}){const r=this.headerMarshaller.format(e),n=r.byteLength+t.byteLength+16,i=new Uint8Array(n),s=new DataView(i.buffer,i.byteOffset,i.byteLength),o=new ps.Crc32;return s.setUint32(0,n,!1),s.setUint32(4,r.byteLength,!1),s.setUint32(8,o.update(i.subarray(0,8)).digest(),!1),i.set(r,12),i.set(t,r.byteLength+12),s.setUint32(n-4,o.update(i.subarray(8,n-4)).digest(),!1),i}decode(e){const{headers:t,body:r}=function({byteLength:e,byteOffset:t,buffer:r}){if(e<16)throw new Error("Provided message too short to accommodate event stream message overhead");const n=new DataView(r,t,e),i=n.getUint32(0,!1);if(e!==i)throw new Error("Reported message length does not match received message length");const s=n.getUint32(4,!1),o=n.getUint32(8,!1),a=n.getUint32(e-4,!1),c=(new ps.Crc32).update(new Uint8Array(r,t,8));if(o!==c.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(r,t+8,e-12)),a!==c.digest())throw new Error(`The message checksum (${c.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(r,t+8+4,s),body:new Uint8Array(r,t+8+4+s,i-s-16)}}(e);return{headers:this.headerMarshaller.parse(t),body:r}}formatHeaders(e){return this.headerMarshaller.format(e)}}class Ts{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.decoder.decode(e);yield t}}}class Ps{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=this.options.encoder.encode(e);yield t}this.options.includeEndFrame&&(yield new Uint8Array(0))}}class Bs{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=await this.options.deserializer(e);void 0!==t&&(yield t)}}}class Ds{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.serializer(e);yield t}}}const $s=e=>{if("function"==typeof e)return e;const t=Promise.resolve(e);return()=>t},Ls="X-Amz-Date",js="X-Amz-Signature",Ms="X-Amz-Security-Token",Us="authorization",Ks=Ls.toLowerCase(),Fs=[Us,Ks,"date"],Hs=js.toLowerCase(),zs="x-amz-content-sha256",Vs=Ms.toLowerCase(),qs={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},Gs=/^proxy-/,Ws=/^sec-/,Xs="AWS4-HMAC-SHA256",Js="AWS4-HMAC-SHA256-PAYLOAD",Ys="aws4_request",Zs={},Qs=[],eo=(e,t,r)=>`${e}/${t}/${r}/${Ys}`,to=(e,t,r)=>{const n=new e(t);return n.update(cn(r)),n.digest()},ro=({headers:e},t,r)=>{const n={};for(const i of Object.keys(e).sort()){if(null==e[i])continue;const s=i.toLowerCase();(s in qs||t?.has(s)||Gs.test(s)||Ws.test(s))&&(!r||r&&!r.has(s))||(n[s]=e[i].trim().replace(/\s+/g," "))}return n},no=async({headers:e,body:t},r)=>{for(const t of Object.keys(e))if(t.toLowerCase()===zs)return e[t];if(null==t)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if("string"==typeof t||ArrayBuffer.isView(t)||en(t)){const e=new r;return e.update(cn(t)),ys(await e.digest())}return"UNSIGNED-PAYLOAD"},io=({headers:e,query:t,...r})=>({...r,headers:{...e},query:t?so(t):void 0}),so=e=>Object.keys(e).reduce(((t,r)=>{const n=e[r];return{...t,[r]:Array.isArray(n)?[...n]:n}}),{}),oo=e=>{e="function"==typeof e.clone?e.clone():io(e);for(const t of Object.keys(e.headers))Fs.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},ao=e=>"number"==typeof e?new Date(1e3*e):"string"==typeof e?Number(e)?new Date(1e3*Number(e)):new Date(e):e;class co{constructor({applyChecksum:e,credentials:t,region:r,service:n,sha256:i,uriEscapePath:s=!0}){this.headerMarshaller=new bs(ln,an),this.service=n,this.sha256=i,this.uriEscapePath=s,this.applyChecksum="boolean"!=typeof e||e,this.regionProvider=$s(r),this.credentialProvider=$s(t)}async presign(e,t={}){const{signingDate:r=new Date,expiresIn:n=3600,unsignableHeaders:i,unhoistableHeaders:s,signableHeaders:o,signingRegion:a,signingService:c}=t,l=await this.credentialProvider();this.validateResolvedCredentials(l);const u=a??await this.regionProvider(),{longDate:h,shortDate:f}=lo(r);if(n>604800)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const p=eo(f,u,c??this.service),d=((e,t={})=>{const{headers:r,query:n={}}="function"==typeof e.clone?e.clone():io(e);for(const e of Object.keys(r)){const i=e.toLowerCase();"x-amz-"!==i.slice(0,6)||t.unhoistableHeaders?.has(i)||(n[e]=r[e],delete r[e])}return{...e,headers:r,query:n}})(oo(e),{unhoistableHeaders:s});l.sessionToken&&(d.query[Ms]=l.sessionToken),d.query["X-Amz-Algorithm"]=Xs,d.query["X-Amz-Credential"]=`${l.accessKeyId}/${p}`,d.query[Ls]=h,d.query["X-Amz-Expires"]=n.toString(10);const m=ro(d,i,o);return d.query["X-Amz-SignedHeaders"]=uo(m),d.query[js]=await this.getSignature(h,p,this.getSigningKey(l,u,f,c),this.createCanonicalRequest(d,m,await no(e,this.sha256))),d}async sign(e,t){return"string"==typeof e?this.signString(e,t):e.headers&&e.payload?this.signEvent(e,t):e.message?this.signMessage(e,t):this.signRequest(e,t)}async signEvent({headers:e,payload:t},{signingDate:r=new Date,priorSignature:n,signingRegion:i,signingService:s}){const o=i??await this.regionProvider(),{shortDate:a,longDate:c}=lo(r),l=eo(a,o,s??this.service),u=await no({headers:{},body:t},this.sha256),h=new this.sha256;h.update(e);const f=ys(await h.digest()),p=[Js,c,l,n,f,u].join("\n");return this.signString(p,{signingDate:r,signingRegion:o,signingService:s})}async signMessage(e,{signingDate:t=new Date,signingRegion:r,signingService:n}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:t,signingRegion:r,signingService:n,priorSignature:e.priorSignature}).then((t=>({message:e.message,signature:t})))}async signString(e,{signingDate:t=new Date,signingRegion:r,signingService:n}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const s=r??await this.regionProvider(),{shortDate:o}=lo(t),a=new this.sha256(await this.getSigningKey(i,s,o,n));return a.update(cn(e)),ys(await a.digest())}async signRequest(e,{signingDate:t=new Date,signableHeaders:r,unsignableHeaders:n,signingRegion:i,signingService:s}={}){const o=await this.credentialProvider();this.validateResolvedCredentials(o);const a=i??await this.regionProvider(),c=oo(e),{longDate:l,shortDate:u}=lo(t),h=eo(u,a,s??this.service);c.headers[Ks]=l,o.sessionToken&&(c.headers[Vs]=o.sessionToken);const f=await no(c,this.sha256);!((e,t)=>{e=e.toLowerCase();for(const r of Object.keys(t))if(e===r.toLowerCase())return!0;return!1})(zs,c.headers)&&this.applyChecksum&&(c.headers[zs]=f);const p=ro(c,n,r),d=await this.getSignature(l,h,this.getSigningKey(o,a,u,s),this.createCanonicalRequest(c,p,f));return c.headers[Us]=`${Xs} Credential=${o.accessKeyId}/${h}, SignedHeaders=${uo(p)}, Signature=${d}`,c}createCanonicalRequest(e,t,r){const n=Object.keys(t).sort();return`${e.method}\n${this.getCanonicalPath(e)}\n${(({query:e={}})=>{const t=[],r={};for(const n of Object.keys(e).sort()){if(n.toLowerCase()===Hs)continue;t.push(n);const i=e[n];"string"==typeof i?r[n]=`${fn(n)}=${fn(i)}`:Array.isArray(i)&&(r[n]=i.slice(0).reduce(((e,t)=>e.concat([`${fn(n)}=${fn(t)}`])),[]).sort().join("&"))}return t.map((e=>r[e])).filter((e=>e)).join("&")})(e)}\n${n.map((e=>`${e}:${t[e]}`)).join("\n")}\n\n${n.join(";")}\n${r}`}async createStringToSign(e,t,r){const n=new this.sha256;n.update(cn(r));const i=await n.digest();return`${Xs}\n${e}\n${t}\n${ys(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const r of e.split("/"))0!==r?.length&&"."!==r&&(".."===r?t.pop():t.push(r));const r=`${e?.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&e?.endsWith("/")?"/":""}`;return encodeURIComponent(r).replace(/%2F/g,"/")}return e}async getSignature(e,t,r,n){const i=await this.createStringToSign(e,t,n),s=new this.sha256(await r);return s.update(cn(i)),ys(await s.digest())}getSigningKey(e,t,r,n){return(async(e,t,r,n,i)=>{const s=`${r}:${n}:${i}:${ys(await to(e,t.secretAccessKey,t.accessKeyId))}:${t.sessionToken}`;if(s in Zs)return Zs[s];for(Qs.push(s);Qs.length>50;)delete Zs[Qs.shift()];let o=`AWS4${t.secretAccessKey}`;for(const t of[r,n,i,Ys])o=await to(e,o,t);return Zs[s]=o})(this.sha256,e,r,t,n||this.service)}validateResolvedCredentials(e){if("object"!=typeof e||"string"!=typeof e.accessKeyId||"string"!=typeof e.secretAccessKey)throw new Error("Resolved credential object is not valid")}}const lo=e=>{const t=(r=e,ao(r).toISOString().replace(/\.\d{3}Z$/,"Z")).replace(/[\-:]/g,"");var r;return{longDate:t,shortDate:t.slice(0,8)}},uo=e=>Object.keys(e).sort().join(";"),ho=e=>{const t=e.credentials?fo(e.credentials):e.credentialDefaultProvider(e),{signingEscapePath:r=!0,systemClockOffset:n=e.systemClockOffset||0,sha256:i}=e;let s;return s=e.signer?$s(e.signer):e.regionInfoProvider?()=>$s(e.region)().then((async t=>[await e.regionInfoProvider(t,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},t])).then((([n,s])=>{const{signingRegion:o,signingService:a}=n;e.signingRegion=e.signingRegion||o||s,e.signingName=e.signingName||a||e.serviceId;const c={...e,credentials:t,region:e.signingRegion,service:e.signingName,sha256:i,uriEscapePath:r};return new(e.signerConstructor||co)(c)})):async n=>{const s=(n=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await $s(e.region)(),properties:{}},n)).signingRegion,o=n.signingName;e.signingRegion=e.signingRegion||s,e.signingName=e.signingName||o||e.serviceId;const a={...e,credentials:t,region:e.signingRegion,service:e.signingName,sha256:i,uriEscapePath:r};return new(e.signerConstructor||co)(a)},{...e,systemClockOffset:n,signingEscapePath:r,credentials:t,signer:s}},fo=e=>"function"==typeof e?Vi(e,(e=>void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5),(e=>void 0!==e.expiration)):$s(e),po=e=>new Date(Date.now()+e),mo=(e,t)=>{const r=Date.parse(e);return((e,t)=>Math.abs(po(t).getTime()-e)>=3e5)(r,t)?r-Date.now():t},yo=e=>Lr.isInstance(e)?e.headers?.date??e.headers?.Date:void 0,go={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},vo=e=>({applyToStack:t=>{t.addRelativeTo((e=>(t,r)=>async function(n){if(!$r.isInstance(n.request))return t(n);const i=r.endpointV2?.properties?.authSchemes?.[0],s="sigv4a"===i?.name?i?.signingRegionSet?.join(","):void 0,o=await e.signer(i),a=await t({...n,request:await o.sign(n.request,{signingDate:po(e.systemClockOffset),signingRegion:s||r.signing_region,signingService:r.signing_service})}).catch((t=>{const r=t.ServerTime??yo(t.$response);throw r&&(e.systemClockOffset=mo(r,e.systemClockOffset)),t})),c=yo(a.response);return c&&(e.systemClockOffset=mo(c,e.systemClockOffset)),a})(e),go)}});function bo(e){return{...e,customUserAgent:"string"==typeof e.customUserAgent?[[e.customUserAgent]]:e.customUserAgent}}var wo={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],version:"1.1"};let _o=wo,So="";const Eo=(e,t="")=>{_o=e,So=t},Ao=()=>So,ko=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),xo=e=>ko.test(e)||e.startsWith("[")&&e.endsWith("]"),Co="endpoints";function Ro(e){return"object"!=typeof e||null==e?e:"ref"in e?`$${Ro(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(Ro).join(", ")})`:JSON.stringify(e,null,2)}class Oo extends Error{constructor(e){super(e),this.name="EndpointError"}}const No=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Io=(e,t=!1)=>{if(!t)return No.test(e);const r=e.split(".");for(const e of r)if(!Io(e))return!1;return!0},To=(e,t=!1)=>{if(t){for(const t of e.split("."))if(!To(t))return!1;return!0}return!!Io(e)&&(!(e.length<3||e.length>63)&&(e===e.toLowerCase()&&!xo(e)))};var Po=Object.freeze({__proto__:null,getUserAgentPrefix:Ao,isVirtualHostableS3Bucket:To,parseArn:e=>{const t=e.split(":");if(t.length<6)return null;const[r,n,i,s,o,...a]=t;return"arn"!==r||""===n||""===i||""===a[0]?null:{partition:n,service:i,region:s,accountId:o,resourceId:a[0].includes("/")?a[0].split("/"):a}},partition:e=>{const{partitions:t}=_o;for(const r of t){const{regions:t,outputs:n}=r;for(const[r,i]of Object.entries(t))if(r===e)return{...n,...i}}for(const r of t){const{regionRegex:t,outputs:n}=r;if(new RegExp(t).test(e))return{...n}}const r=t.find((e=>"aws"===e.id));if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},setPartitionInfo:Eo,useDefaultPartitionInfo:()=>{Eo(wo,"")}});const Bo=(e,t)=>(e=>{const t=e.split("."),r=[];for(const n of t){const t=n.indexOf("[");if(-1!==t){if(n.indexOf("]")!==n.length-1)throw new Oo(`Path: '${e}' does not end with ']'`);const i=n.slice(t+1,-1);if(Number.isNaN(parseInt(i)))throw new Oo(`Invalid array index: '${i}' in path: '${e}'`);0!==t&&r.push(n.slice(0,t)),r.push(i)}else r.push(n)}return r})(t).reduce(((r,n)=>{if("object"!=typeof r)throw new Oo(`Index '${n}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(r)?r[parseInt(n)]:r[n]}),e);var Do;!function(e){e.AAAA="AAAA",e.A="A"}(Do||(Do={}));const $o={[Ir.HTTP]:80,[Ir.HTTPS]:443};var Lo=Object.freeze({__proto__:null,aws:Po,booleanEquals:(e,t)=>e===t,getAttr:Bo,isSet:e=>null!=e,isValidHostLabel:Io,not:e=>!e,parseURL:e=>{const t=(()=>{try{if(e instanceof URL)return e;if("object"==typeof e&&"hostname"in e){const{hostname:t,port:r,protocol:n="",path:i="",query:s={}}=e,o=new URL(`${n}//${t}${r?`:${r}`:""}${i}`);return o.search=Object.entries(s).map((([e,t])=>`${e}=${t}`)).join("&"),o}return new URL(e)}catch(e){return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;const r=t.href,{host:n,hostname:i,pathname:s,protocol:o,search:a}=t;if(a)return null;const c=o.slice(0,-1);if(!Object.values(Ir).includes(c))return null;const l=xo(i);return{scheme:c,authority:`${n}${r.includes(`${n}:${$o[c]}`)||"string"==typeof e&&e.includes(`${n}:${$o[c]}`)?`:${$o[c]}`:""}`,path:s,normalizedPath:s.endsWith("/")?s:`${s}/`,isIp:l}},stringEquals:(e,t)=>e===t,substring:(e,t,r,n)=>t>=r||e.length<r?null:n?e.substring(e.length-r,e.length-t):e.substring(t,r),uriEncode:e=>encodeURIComponent(e).replace(/[!*'()]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))});const jo=(e,t)=>{const r=[],n={...t.endpointParams,...t.referenceRecord};let i=0;for(;i<e.length;){const t=e.indexOf("{",i);if(-1===t){r.push(e.slice(i));break}r.push(e.slice(i,t));const s=e.indexOf("}",t);if(-1===s){r.push(e.slice(t));break}"{"===e[t+1]&&"}"===e[s+1]&&(r.push(e.slice(t+1,s)),i=s+2);const o=e.substring(t+1,s);if(o.includes("#")){const[e,t]=o.split("#");r.push(Bo(n[e],t))}else r.push(n[o]);i=s+1}return r.join("")},Mo=(e,t,r)=>{if("string"==typeof e)return jo(e,r);if(e.fn)return Uo(e,r);if(e.ref)return(({ref:e},t)=>({...t.endpointParams,...t.referenceRecord}[e]))(e,r);throw new Oo(`'${t}': ${String(e)} is not a string, function or reference.`)},Uo=({fn:e,argv:t},r)=>{const n=t.map((e=>["boolean","number"].includes(typeof e)?e:Mo(e,"arg",r)));return e.split(".").reduce(((e,t)=>e[t]),Lo)(...n)},Ko=({assign:e,...t},r)=>{if(e&&e in r.referenceRecord)throw new Oo(`'${e}' is already defined in Reference Record.`);const n=Uo(t,r);return r.logger?.debug?.(Co,`evaluateCondition: ${Ro(t)} = ${Ro(n)}`),{result:""===n||!!n,...null!=e&&{toAssign:{name:e,value:n}}}},Fo=(e=[],t)=>{const r={};for(const n of e){const{result:e,toAssign:i}=Ko(n,{...t,referenceRecord:{...t.referenceRecord,...r}});if(!e)return{result:e};i&&(r[i.name]=i.value,t.logger?.debug?.(Co,`assign: ${i.name} := ${Ro(i.value)}`))}return{result:!0,referenceRecord:r}},Ho=(e,t)=>Object.entries(e).reduce(((e,[r,n])=>({...e,[r]:n.map((e=>{const n=Mo(e,"Header value entry",t);if("string"!=typeof n)throw new Oo(`Header '${r}' value '${n}' is not a string`);return n}))})),{}),zo=(e,t)=>{if(Array.isArray(e))return e.map((e=>zo(e,t)));switch(typeof e){case"string":return jo(e,t);case"object":if(null===e)throw new Oo(`Unexpected endpoint property: ${e}`);return Vo(e,t);case"boolean":return e;default:throw new Oo("Unexpected endpoint property type: "+typeof e)}},Vo=(e,t)=>Object.entries(e).reduce(((e,[r,n])=>({...e,[r]:zo(n,t)})),{}),qo=(e,t)=>{const r=Mo(e,"Endpoint URL",t);if("string"==typeof r)try{return new URL(r)}catch(e){throw console.error(`Failed to construct URL with ${r}`,e),e}throw new Oo("Endpoint URL must be a string, got "+typeof r)},Go=(e,t)=>{const{conditions:r,endpoint:n}=e,{result:i,referenceRecord:s}=Fo(r,t);if(!i)return;const o={...t,referenceRecord:{...t.referenceRecord,...s}},{url:a,properties:c,headers:l}=n;return t.logger?.debug?.(Co,`Resolving endpoint from template: ${Ro(n)}`),{...null!=l&&{headers:Ho(l,o)},...null!=c&&{properties:Vo(c,o)},url:qo(a,o)}},Wo=(e,t)=>{const{conditions:r,error:n}=e,{result:i,referenceRecord:s}=Fo(r,t);if(i)throw new Oo(Mo(n,"Error",{...t,referenceRecord:{...t.referenceRecord,...s}}))},Xo=(e,t)=>{const{conditions:r,rules:n}=e,{result:i,referenceRecord:s}=Fo(r,t);if(i)return Jo(n,{...t,referenceRecord:{...t.referenceRecord,...s}})},Jo=(e,t)=>{for(const r of e)if("endpoint"===r.type){const e=Go(r,t);if(e)return e}else if("error"===r.type)Wo(r,t);else{if("tree"!==r.type)throw new Oo(`Unknown endpoint rule: ${r}`);{const e=Xo(r,t);if(e)return e}}throw new Oo("Rules evaluation failed")},Yo=(e,t)=>{const{endpointParams:r,logger:n}=t,{parameters:i,rules:s}=e;t.logger?.debug?.(`${Co} Initial EndpointParams: ${Ro(r)}`);const o=Object.entries(i).filter((([,e])=>null!=e.default)).map((([e,t])=>[e,t.default]));if(o.length>0)for(const[e,t]of o)r[e]=r[e]??t;const a=Object.entries(i).filter((([,e])=>e.required)).map((([e])=>e));for(const e of a)if(null==r[e])throw new Oo(`Missing required parameter: '${e}'`);const c=Jo(s,{endpointParams:r,logger:n,referenceRecord:{}});if(t.endpointParams?.Endpoint)try{const e=new URL(t.endpointParams.Endpoint),{protocol:r,port:n}=e;c.url.protocol=r,c.url.port=n}catch(e){}return t.logger?.debug?.(`${Co} Resolved endpoint: ${Ro(c)}`),c},Zo="user-agent",Qo="x-amz-user-agent",ea=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,ta=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,ra=e=>{const t=e[0].split("/").map((e=>e.replace(ea,"-"))).join("/"),r=e[1]?.replace(ta,"-"),n=t.indexOf("/"),i=t.substring(0,n);let s=t.substring(n+1);return"api"===i&&(s=s.toLowerCase()),[i,s,r].filter((e=>e&&e.length>0)).reduce(((e,t,r)=>{switch(r){case 0:return t;case 1:return`${e}/${t}`;default:return`${e}#${t}`}}),"")},na={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},ia=e=>({applyToStack:t=>{var r;t.add((r=e,(e,t)=>async n=>{const{request:i}=n;if(!$r.isInstance(i))return e(n);const{headers:s}=i,o=t?.userAgent?.map(ra)||[],a=(await r.defaultUserAgentProvider()).map(ra),c=r?.customUserAgent?.map(ra)||[],l=Ao(),u=(l?[l]:[]).concat([...a,...o,...c]).join(" "),h=[...a.filter((e=>e.startsWith("aws-sdk-"))),...c].join(" ");return"browser"!==r.runtime?(h&&(s[Qo]=s[Qo]?`${s[Zo]} ${h}`:h),s[Zo]=u):s[Qo]=u,e({...n,request:i})}),na)}});var sa;!function(e){e.ENV="env",e.CONFIG="shared config entry"}(sa||(sa={}));const oa=(e,t,r)=>{if(t in e){if("true"===e[t])return!0;if("false"===e[t])return!1;throw new Error(`Cannot load ${r} "${t}". Expected "true" or "false", got ${e[t]}.`)}},aa={environmentVariableSelector:e=>oa(e,"AWS_USE_DUALSTACK_ENDPOINT",sa.ENV),configFileSelector:e=>oa(e,"use_dualstack_endpoint",sa.CONFIG),default:!1},ca={environmentVariableSelector:e=>oa(e,"AWS_USE_FIPS_ENDPOINT",sa.ENV),configFileSelector:e=>oa(e,"use_fips_endpoint",sa.CONFIG),default:!1},la={environmentVariableSelector:e=>e.AWS_REGION,configFileSelector:e=>e.region,default:()=>{throw new Error("Region is missing")}},ua={preferredFile:"credentials"},ha=e=>"string"==typeof e&&(e.startsWith("fips-")||e.endsWith("-fips")),fa=e=>ha(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e,pa=e=>{const{region:t,useFipsEndpoint:r}=e;if(!t)throw new Error("Region is missing");return{...e,region:async()=>{if("string"==typeof t)return fa(t);const e=await t();return fa(e)},useFipsEndpoint:async()=>{const e="string"==typeof t?t:await t();return!!ha(e)||("function"!=typeof r?Promise.resolve(!!r):r())}}},da="content-length";const ma={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},ya=e=>({applyToStack:t=>{var r;t.add((r=e.bodyLengthChecker,e=>async t=>{const n=t.request;if($r.isInstance(n)){const{body:e,headers:t}=n;if(e&&-1===Object.keys(t).map((e=>e.toLowerCase())).indexOf(da))try{const t=r(e);n.headers={...n.headers,[da]:String(t)}}catch(e){}}return e({...t,request:n})}),ma)}}),ga=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,va=/(\d+\.){3}\d+/,ba=/\.\./,wa=e=>ga.test(e)&&!va.test(e)&&!ba.test(e),_a=e=>{const[t,r,n,i,s,o]=e.split(":"),a="arn"===t&&e.split(":").length>=6,c=5===[t,r,n,s,o].filter(Boolean).length;if(a&&!c)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return!!("arn"===t&&r&&n&&s&&o)},Sa=(e,t,r)=>{const n=async()=>{const n=r[e]??r[t];return"function"==typeof n?n():n};return"endpoint"===e||"endpoint"===t?async()=>{const e=await n();if(e&&"object"==typeof e){if("url"in e)return e.url.href;if("hostname"in e){const{protocol:t,hostname:r,port:n,path:i}=e;return`${t}//${r}${n?":"+n:""}${i}`}}return e}:n},Ea=async(e,t,r,n)=>{const i=await Aa(e,t,r);if("function"!=typeof r.endpointProvider)throw new Error("config.endpointProvider is not set.");return r.endpointProvider(i,n)},Aa=async(e,t,r)=>{const n={},i=t?.getEndpointParameterInstructions?.()||{};for(const[t,s]of Object.entries(i))switch(s.type){case"staticContextParams":n[t]=s.value;break;case"contextParams":n[t]=e[s.name];break;case"clientContextParams":case"builtInParams":n[t]=await Sa(s.name,t,r)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(s))}return 0===Object.keys(i).length&&Object.assign(n,r),"s3"===String(r.serviceId).toLowerCase()&&await(async e=>{const t=e?.Bucket||"";if("string"==typeof e.Bucket&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),_a(t)){if(!0===e.ForcePathStyle)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!wa(t)||-1!==t.indexOf(".")&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e})(n),n};const ka=e=>{if("string"==typeof e)return ka(new URL(e));const{hostname:t,pathname:r,port:n,protocol:i,search:s}=e;let o;return s&&(o=function(e){const t={};if(e=e.replace(/^\?/,""))for(const r of e.split("&")){let[e,n=null]=r.split("=");e=decodeURIComponent(e),n&&(n=decodeURIComponent(n)),e in t?Array.isArray(t[e])?t[e].push(n):t[e]=[t[e],n]:t[e]=n}return t}(s)),{hostname:t,port:n?parseInt(n):void 0,protocol:i,path:r,query:o}},xa=e=>"object"==typeof e?"url"in e?ka(e.url):e:ka(e),Ca={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},Ra={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function Oa(e,t,r){return{applyToStack:n=>{n.add(((e,t)=>(r,n)=>async n=>{const{response:i}=await r(n);try{return{response:i,output:await t(i,e)}}catch(e){if(Object.defineProperty(e,"$response",{value:i}),!("$metadata"in e)){const t="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";e.message+="\n  "+t}throw e}})(e,r),Ca),n.add(((e,t)=>(r,n)=>async i=>{const s=n.endpointV2?.url&&e.urlParser?async()=>e.urlParser(n.endpointV2.url):e.endpoint;if(!s)throw new Error("No valid endpoint provider available.");const o=await t(i.input,{...e,endpoint:s});return r({...i,request:o})})(e,t),Ra)}}}const Na={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Ra.name},Ia=(e,t)=>({applyToStack:r=>{r.addRelativeTo((({config:e,instructions:t})=>(r,n)=>async i=>{const s=await Ea(i.input,{getEndpointParameterInstructions:()=>t},{...e},n);n.endpointV2=s,n.authSchemes=s.properties?.authSchemes;const o=n.authSchemes?.[0];return o&&(n.signing_region=o.signingRegion,n.signing_service=o.signingName),r({...i})})({config:e,instructions:t}),Na)}}),Ta=e=>{const t=e.tls??!0,{endpoint:r}=e,n=null!=r?async()=>xa(await $s(r)()):void 0,i=!!r;return{...e,endpoint:n,tls:t,isCustomEndpoint:i,useDualstackEndpoint:$s(e.useDualstackEndpoint??!1),useFipsEndpoint:$s(e.useFipsEndpoint??!1)}};var Pa;!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(Pa||(Pa={}));const Ba=Pa.STANDARD,Da=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],$a=["TimeoutError","RequestTimeout","RequestTimeoutException"],La=[500,502,503,504],ja=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],Ma=e=>429===e.$metadata?.httpStatusCode||Da.includes(e.name)||1==e.$retryable?.throttling,Ua=e=>$a.includes(e.name)||ja.includes(e?.code||"")||La.includes(e.$metadata?.httpStatusCode||0);class Ka{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise((e=>setTimeout(e,t)))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp)return void(this.lastTimestamp=e);const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),Ma(e)){const e=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=e,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(e),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const r=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(2*e)/2;if(this.requestCount++,t>this.lastTxRateBucket){const e=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(e*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}}const Fa=({retryDelay:e,retryCount:t,retryCost:r})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(2e4,e),getRetryCost:()=>r});class Ha{constructor(e){this.maxAttempts=e,this.mode=Pa.STANDARD,this.capacity=500,this.retryBackoffStrategy=(()=>{let e=100;return{computeNextBackoffDelay:t=>Math.floor(Math.min(2e4,Math.random()*2**t*e)),setDelayBase:t=>{e=t}}})(),this.maxAttemptsProvider="function"==typeof e?e:async()=>e}async acquireInitialRetryToken(e){return Fa({retryDelay:100,retryCount:0})}async refreshRetryTokenForRetry(e,t){const r=await this.getMaxAttempts();if(this.shouldRetry(e,t,r)){const r=t.errorType;this.retryBackoffStrategy.setDelayBase("THROTTLING"===r?500:100);const n=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),i=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,n):n,s=this.getCapacityCost(r);return this.capacity-=s,Fa({retryDelay:i,retryCount:e.getRetryCount()+1,retryCost:s})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(500,this.capacity+(e.getRetryCost()??1))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch(e){return console.warn("Max attempts provider could not resolve. Using default of 3"),3}}shouldRetry(e,t,r){return e.getRetryCount()+1<r&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return"TRANSIENT"===e?10:5}isRetryableError(e){return"THROTTLING"===e||"TRANSIENT"===e}}class za{constructor(e,t){this.maxAttemptsProvider=e,this.mode=Pa.ADAPTIVE;const{rateLimiter:r}=t??{};this.rateLimiter=r??new Ka,this.standardRetryStrategy=new Ha(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}var Va,qa=new Uint8Array(16);function Ga(){if(!Va&&!(Va="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Va(qa)}var Wa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Xa=[],Ja=0;Ja<256;++Ja)Xa.push((Ja+256).toString(16).substr(1));function Ya(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Xa[e[t+0]]+Xa[e[t+1]]+Xa[e[t+2]]+Xa[e[t+3]]+"-"+Xa[e[t+4]]+Xa[e[t+5]]+"-"+Xa[e[t+6]]+Xa[e[t+7]]+"-"+Xa[e[t+8]]+Xa[e[t+9]]+"-"+Xa[e[t+10]]+Xa[e[t+11]]+Xa[e[t+12]]+Xa[e[t+13]]+Xa[e[t+14]]+Xa[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&Wa.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r}function Za(e,t,r){var n=(e=e||{}).random||(e.rng||Ga)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return Ya(n)}const Qa=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):"string"==typeof e?new Error(e):new Error(`AWS SDK error wrapper for ${e}`),ec="AWS_MAX_ATTEMPTS",tc="max_attempts",rc={environmentVariableSelector:e=>{const t=e[ec];if(!t)return;const r=parseInt(t);if(Number.isNaN(r))throw new Error(`Environment variable ${ec} mast be a number, got "${t}"`);return r},configFileSelector:e=>{const t=e[tc];if(!t)return;const r=parseInt(t);if(Number.isNaN(r))throw new Error(`Shared config file entry ${tc} mast be a number, got "${t}"`);return r},default:3},nc=e=>{const{retryStrategy:t}=e,r=$s(e.maxAttempts??3);return{...e,maxAttempts:r,retryStrategy:async()=>{if(t)return t;return await $s(e.retryMode)()===Pa.ADAPTIVE?new za(r):new Ha(r)}}},ic={environmentVariableSelector:e=>e.AWS_RETRY_MODE,configFileSelector:e=>e.retry_mode,default:Ba},sc=e=>void 0!==e.acquireInitialRetryToken&&void 0!==e.refreshRetryTokenForRetry&&void 0!==e.recordSuccess,oc=e=>{const t={errorType:ac(e)},r=uc(e.$response);return r&&(t.retryAfterHint=r),t},ac=e=>Ma(e)?"THROTTLING":Ua(e)?"TRANSIENT":(e=>{if(void 0!==e.$metadata?.httpStatusCode){const t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ua(e)}return!1})(e)?"SERVER_ERROR":"CLIENT_ERROR",cc={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},lc=e=>({applyToStack:t=>{t.add((e=>(t,r)=>async n=>{let i=await e.retryStrategy();const s=await e.maxAttempts();if(!sc(i))return i?.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",i.mode]]),i.retry(t,n);{let e=await i.acquireInitialRetryToken(r.partition_id),o=new Error,a=0,c=0;const{request:l}=n;for($r.isInstance(l)&&(l.headers["amz-sdk-invocation-id"]=Za());;)try{$r.isInstance(l)&&(l.headers["amz-sdk-request"]=`attempt=${a+1}; max=${s}`);const{response:r,output:o}=await t(n);return i.recordSuccess(e),o.$metadata.attempts=a+1,o.$metadata.totalRetryDelay=c,{response:r,output:o}}catch(t){const r=oc(t);o=Qa(t);try{e=await i.refreshRetryTokenForRetry(e,r)}catch(e){throw o.$metadata||(o.$metadata={}),o.$metadata.attempts=a+1,o.$metadata.totalRetryDelay=c,o}a=e.getRetryCount();const n=e.getRetryDelay();c+=n,await new Promise((e=>setTimeout(e,n)))}}})(e),cc)}}),uc=e=>{if(!Lr.isInstance(e))return;const t=Object.keys(e.headers).find((e=>"retry-after"===e.toLowerCase()));if(!t)return;const r=e.headers[t],n=Number(r);if(!Number.isNaN(n))return new Date(1e3*n);return new Date(r)};var hc="3.423.0";var fc="3.423.0";class pc extends li{constructor(e){super(e),Object.setPrototypeOf(this,pc.prototype)}}let dc=class e extends pc{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),this.name="ExpiredTokenException",this.$fault="client",Object.setPrototypeOf(this,e.prototype)}};class mc extends pc{constructor(e){super({name:"MalformedPolicyDocumentException",$fault:"client",...e}),this.name="MalformedPolicyDocumentException",this.$fault="client",Object.setPrototypeOf(this,mc.prototype)}}class yc extends pc{constructor(e){super({name:"PackedPolicyTooLargeException",$fault:"client",...e}),this.name="PackedPolicyTooLargeException",this.$fault="client",Object.setPrototypeOf(this,yc.prototype)}}class gc extends pc{constructor(e){super({name:"RegionDisabledException",$fault:"client",...e}),this.name="RegionDisabledException",this.$fault="client",Object.setPrototypeOf(this,gc.prototype)}}class vc extends pc{constructor(e){super({name:"IDPRejectedClaimException",$fault:"client",...e}),this.name="IDPRejectedClaimException",this.$fault="client",Object.setPrototypeOf(this,vc.prototype)}}class bc extends pc{constructor(e){super({name:"InvalidIdentityTokenException",$fault:"client",...e}),this.name="InvalidIdentityTokenException",this.$fault="client",Object.setPrototypeOf(this,bc.prototype)}}class wc extends pc{constructor(e){super({name:"IDPCommunicationErrorException",$fault:"client",...e}),this.name="IDPCommunicationErrorException",this.$fault="client",Object.setPrototypeOf(this,wc.prototype)}}const _c=e=>({...e,...e.SecretAccessKey&&{SecretAccessKey:An}}),Sc=e=>({...e,...e.Credentials&&{Credentials:_c(e.Credentials)}}),Ec=e=>({...e,...e.WebIdentityToken&&{WebIdentityToken:An}}),Ac=e=>({...e,...e.Credentials&&{Credentials:_c(e.Credentials)}});var kc={},xc={};!function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+t+"]["+(t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",n=new RegExp("^"+r+"$");e.isExist=function(e){return void 0!==e},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,r){if(t){const n=Object.keys(t),i=n.length;for(let s=0;s<i;s++)e[n[s]]="strict"===r?[t[n[s]]]:t[n[s]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(e){const t=n.exec(e);return!(null==t)},e.getAllMatches=function(e,t){const r=[];let n=t.exec(e);for(;n;){const i=[];i.startIndex=t.lastIndex-n[0].length;const s=n.length;for(let e=0;e<s;e++)i.push(n[e]);r.push(i),n=t.exec(e)}return r},e.nameRegexp=r}(xc);const Cc=xc,Rc={allowBooleanAttributes:!1,unpairedTags:[]};function Oc(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function Nc(e,t){const r=t;for(;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{const n=e.substr(r,t-r);if(t>5&&"xml"===n)return jc("InvalidXml","XML declaration allowed only at the start of the document.",Uc(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function Ic(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&(r--,0===r))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}kc.validate=function(e,t){t=Object.assign({},Rc,t);const r=[];let n=!1,i=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let o=0;o<e.length;o++)if("<"===e[o]&&"?"===e[o+1]){if(o+=2,o=Nc(e,o),o.err)return o}else{if("<"!==e[o]){if(Oc(e[o]))continue;return jc("InvalidChar","char '"+e[o]+"' is not expected.",Uc(e,o))}{let a=o;if(o++,"!"===e[o]){o=Ic(e,o);continue}{let c=!1;"/"===e[o]&&(c=!0,o++);let l="";for(;o<e.length&&">"!==e[o]&&" "!==e[o]&&"\t"!==e[o]&&"\n"!==e[o]&&"\r"!==e[o];o++)l+=e[o];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),o--),s=l,!Cc.isName(s)){let t;return t=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",jc("InvalidTag",t,Uc(e,o))}const u=Bc(e,o);if(!1===u)return jc("InvalidAttr","Attributes for '"+l+"' have open quote.",Uc(e,o));let h=u.value;if(o=u.index,"/"===h[h.length-1]){const r=o-h.length;h=h.substring(0,h.length-1);const i=$c(h,t);if(!0!==i)return jc(i.err.code,i.err.msg,Uc(e,r+i.err.line));n=!0}else if(c){if(!u.tagClosed)return jc("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",Uc(e,o));if(h.trim().length>0)return jc("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",Uc(e,a));{const t=r.pop();if(l!==t.tagName){let r=Uc(e,t.tagStartPos);return jc("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+r.line+", col "+r.col+") instead of closing tag '"+l+"'.",Uc(e,a))}0==r.length&&(i=!0)}}else{const s=$c(h,t);if(!0!==s)return jc(s.err.code,s.err.msg,Uc(e,o-h.length+s.err.line));if(!0===i)return jc("InvalidXml","Multiple possible root nodes found.",Uc(e,o));-1!==t.unpairedTags.indexOf(l)||r.push({tagName:l,tagStartPos:a}),n=!0}for(o++;o<e.length;o++)if("<"===e[o]){if("!"===e[o+1]){o++,o=Ic(e,o);continue}if("?"!==e[o+1])break;if(o=Nc(e,++o),o.err)return o}else if("&"===e[o]){const t=Lc(e,o);if(-1==t)return jc("InvalidChar","char '&' is not expected.",Uc(e,o));o=t}else if(!0===i&&!Oc(e[o]))return jc("InvalidXml","Extra text at the end",Uc(e,o));"<"===e[o]&&o--}}}var s;return n?1==r.length?jc("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",Uc(e,r[0].tagStartPos)):!(r.length>0)||jc("InvalidXml","Invalid '"+JSON.stringify(r.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):jc("InvalidXml","Start tag expected.",1)};const Tc='"',Pc="'";function Bc(e,t){let r="",n="",i=!1;for(;t<e.length;t++){if(e[t]===Tc||e[t]===Pc)""===n?n=e[t]:n!==e[t]||(n="");else if(">"===e[t]&&""===n){i=!0;break}r+=e[t]}return""===n&&{value:r,index:t,tagClosed:i}}const Dc=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function $c(e,t){const r=Cc.getAllMatches(e,Dc),n={};for(let e=0;e<r.length;e++){if(0===r[e][1].length)return jc("InvalidAttr","Attribute '"+r[e][2]+"' has no space in starting.",Kc(r[e]));if(void 0!==r[e][3]&&void 0===r[e][4])return jc("InvalidAttr","Attribute '"+r[e][2]+"' is without value.",Kc(r[e]));if(void 0===r[e][3]&&!t.allowBooleanAttributes)return jc("InvalidAttr","boolean attribute '"+r[e][2]+"' is not allowed.",Kc(r[e]));const i=r[e][2];if(!Mc(i))return jc("InvalidAttr","Attribute '"+i+"' is an invalid name.",Kc(r[e]));if(n.hasOwnProperty(i))return jc("InvalidAttr","Attribute '"+i+"' is repeated.",Kc(r[e]));n[i]=1}return!0}function Lc(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let r=/\d/;for("x"===e[t]&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(r))break}return-1}(e,++t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(";"===e[t])break;return-1}return t}function jc(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function Mc(e){return Cc.isName(e)}function Uc(e,t){const r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function Kc(e){return e.startIndex+e[1].length}var Fc={};const Hc={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}};Fc.buildOptions=function(e){return Object.assign({},Hc,e)},Fc.defaultOptions=Hc;var zc=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}};const Vc=xc;function qc(e,t){let r="";for(;t<e.length&&"'"!==e[t]&&'"'!==e[t];t++)r+=e[t];if(r=r.trim(),-1!==r.indexOf(" "))throw new Error("External entites are not supported");const n=e[t++];let i="";for(;t<e.length&&e[t]!==n;t++)i+=e[t];return[r,i,t]}function Gc(e,t){return"!"===e[t+1]&&"-"===e[t+2]&&"-"===e[t+3]}function Wc(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7]}function Xc(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8]}function Jc(e,t){return"!"===e[t+1]&&"A"===e[t+2]&&"T"===e[t+3]&&"T"===e[t+4]&&"L"===e[t+5]&&"I"===e[t+6]&&"S"===e[t+7]&&"T"===e[t+8]}function Yc(e,t){return"!"===e[t+1]&&"N"===e[t+2]&&"O"===e[t+3]&&"T"===e[t+4]&&"A"===e[t+5]&&"T"===e[t+6]&&"I"===e[t+7]&&"O"===e[t+8]&&"N"===e[t+9]}function Zc(e){if(Vc.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}var Qc=function(e,t){const r={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let n=1,i=!1,s=!1,o="";for(;t<e.length;t++)if("<"!==e[t]||s)if(">"===e[t]){if(s?"-"===e[t-1]&&"-"===e[t-2]&&(s=!1,n--):n--,0===n)break}else"["===e[t]?i=!0:o+=e[t];else{if(i&&Wc(e,t))t+=7,[entityName,val,t]=qc(e,t+1),-1===val.indexOf("&")&&(r[Zc(entityName)]={regx:RegExp(`&${entityName};`,"g"),val:val});else if(i&&Xc(e,t))t+=8;else if(i&&Jc(e,t))t+=8;else if(i&&Yc(e,t))t+=9;else{if(!Gc)throw new Error("Invalid DOCTYPE");s=!0}n++,o=""}if(0!==n)throw new Error("Unclosed DOCTYPE")}return{entities:r,i:t}};const el=/^[-+]?0x[a-fA-F0-9]+$/,tl=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const rl={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};const nl=xc,il=zc,sl=Qc,ol=function(e,t={}){if(t=Object.assign({},rl,t),!e||"string"!=typeof e)return e;let r=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(r))return e;if(t.hex&&el.test(r))return Number.parseInt(r,16);{const n=tl.exec(r);if(n){const i=n[1],s=n[2];let o=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e;return e}(n[3]);const a=n[4]||n[6];if(!t.leadingZeros&&s.length>0&&i&&"."!==r[2])return e;if(!t.leadingZeros&&s.length>0&&!i&&"."!==r[1])return e;{const n=Number(r),c=""+n;return-1!==c.search(/[eE]/)||a?t.eNotation?n:e:-1!==r.indexOf(".")?"0"===c&&""===o||c===o||i&&c==="-"+o?n:e:s?o===c||i+o===c?n:e:r===c||r===i+c?n:e}}return e}};"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,nl.nameRegexp);function al(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function cl(e,t,r,n,i,s,o){if(void 0!==e&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));const n=this.options.tagValueProcessor(t,e,r,i,s);if(null==n)return e;if(typeof n!=typeof e||n!==e)return n;if(this.options.trimValues)return wl(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?wl(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function ll(e){if(this.options.removeNSPrefix){const t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}const ul=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function hl(e,t,r){if(!this.options.ignoreAttributes&&"string"==typeof e){const r=nl.getAllMatches(e,ul),n=r.length,i={};for(let e=0;e<n;e++){const n=this.resolveNameSpace(r[e][1]);let s=r[e][4],o=this.options.attributeNamePrefix+n;if(n.length)if(this.options.transformAttributeName&&(o=this.options.transformAttributeName(o)),"__proto__"===o&&(o="#__proto__"),void 0!==s){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);const e=this.options.attributeValueProcessor(n,s,t);i[o]=null==e?s:typeof e!=typeof s||e!==s?e:wl(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[o]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=i,e}return i}}const fl=function(e){e=e.replace(/\r\n?/g,"\n");const t=new il("!xml");let r=t,n="",i="";for(let s=0;s<e.length;s++){if("<"===e[s])if("/"===e[s+1]){const t=gl(e,">",s,"Closing Tag is not closed.");let o=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){const e=o.indexOf(":");-1!==e&&(o=o.substr(e+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),r&&(n=this.saveTextToParentTag(n,r,i));const a=i.substring(i.lastIndexOf(".")+1);if(o&&-1!==this.options.unpairedTags.indexOf(o))throw new Error(`Unpaired tag can not be used as closing tag: </${o}>`);let c=0;a&&-1!==this.options.unpairedTags.indexOf(a)?(c=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):c=i.lastIndexOf("."),i=i.substring(0,c),r=this.tagsNodeStack.pop(),n="",s=t}else if("?"===e[s+1]){let t=vl(e,s,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,i),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new il(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,i,t.tagName)),this.addChild(r,e,i)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){const t=gl(e,"--\x3e",s+4,"Comment is not closed.");if(this.options.commentPropName){const o=e.substring(s+4,t-2);n=this.saveTextToParentTag(n,r,i),r.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}s=t}else if("!D"===e.substr(s+1,2)){const t=sl(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){const t=gl(e,"]]>",s,"CDATA is not closed.")-2,o=e.substring(s+9,t);if(n=this.saveTextToParentTag(n,r,i),this.options.cdataPropName)r.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]);else{let e=this.parseTextData(o,r.tagname,i,!0,!1,!0);null==e&&(e=""),r.add(this.options.textNodeName,e)}s=t+2}else{let o=vl(e,s,this.options.removeNSPrefix),a=o.tagName,c=o.tagExp,l=o.attrExpPresent,u=o.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),r&&n&&"!xml"!==r.tagname&&(n=this.saveTextToParentTag(n,r,i,!1));const h=r;if(h&&-1!==this.options.unpairedTags.indexOf(h.tagname)&&(r=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),a!==t.tagname&&(i+=i?"."+a:a),this.isItStopNode(this.options.stopNodes,i,a)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)s=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(a))s=o.closeIndex;else{const r=this.readStopNodeData(e,a,u+1);if(!r)throw new Error(`Unexpected end of ${a}`);s=r.i,t=r.tagContent}const n=new il(a);a!==c&&l&&(n[":@"]=this.buildAttributesMap(c,i,a)),t&&(t=this.parseTextData(t,a,i,!0,l,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),n.add(this.options.textNodeName,t),this.addChild(r,n,i)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),c=a):c=c.substr(0,c.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));const e=new il(a);a!==c&&l&&(e[":@"]=this.buildAttributesMap(c,i,a)),this.addChild(r,e,i),i=i.substr(0,i.lastIndexOf("."))}else{const e=new il(a);this.tagsNodeStack.push(r),a!==c&&l&&(e[":@"]=this.buildAttributesMap(c,i,a)),this.addChild(r,e,i),r=e}n="",s=u}}else n+=e[s]}return t.child};function pl(e,t,r){const n=this.options.updateTag(t.tagname,r,t[":@"]);!1===n||("string"==typeof n?(t.tagname=n,e.addChild(t)):e.addChild(t))}const dl=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){const r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function ml(e,t,r,n){return e&&(void 0===n&&(n=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,r,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,n))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function yl(e,t,r){const n="*."+r;for(const r in e){const i=e[r];if(n===i||t===i)return!0}return!1}function gl(e,t,r,n){const i=e.indexOf(t,r);if(-1===i)throw new Error(n);return i+t.length-1}function vl(e,t,r,n=">"){const i=function(e,t,r=">"){let n,i="";for(let s=t;s<e.length;s++){let t=e[s];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else if(t===r[0]){if(!r[1])return{data:i,index:s};if(e[s+1]===r[1])return{data:i,index:s}}else"\t"===t&&(t=" ");i+=t}}(e,t+1,n);if(!i)return;let s=i.data;const o=i.index,a=s.search(/\s/);let c=s,l=!0;if(-1!==a&&(c=s.substr(0,a).replace(/\s\s*$/,""),s=s.substr(a+1)),r){const e=c.indexOf(":");-1!==e&&(c=c.substr(e+1),l=c!==i.data.substr(e+1))}return{tagName:c,tagExp:s,closeIndex:o,attrExpPresent:l}}function bl(e,t,r){const n=r;let i=1;for(;r<e.length;r++)if("<"===e[r])if("/"===e[r+1]){const s=gl(e,">",r,`${t} is not closed`);if(e.substring(r+2,s).trim()===t&&(i--,0===i))return{tagContent:e.substring(n,r),i:s};r=s}else if("?"===e[r+1]){r=gl(e,"?>",r+1,"StopNode is not closed.")}else if("!--"===e.substr(r+1,3)){r=gl(e,"--\x3e",r+3,"StopNode is not closed.")}else if("!["===e.substr(r+1,2)){r=gl(e,"]]>",r,"StopNode is not closed.")-2}else{const n=vl(e,r,">");if(n){(n&&n.tagName)===t&&"/"!==n.tagExp[n.tagExp.length-1]&&i++,r=n.closeIndex}}}function wl(e,t,r){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&ol(e,r)}return nl.isExist(e)?e:""}var _l=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=al,this.parseXml=fl,this.parseTextData=cl,this.resolveNameSpace=ll,this.buildAttributesMap=hl,this.isItStopNode=yl,this.replaceEntitiesValue=dl,this.readStopNodeData=bl,this.saveTextToParentTag=ml,this.addChild=pl}},Sl={};function El(e,t,r){let n;const i={};for(let s=0;s<e.length;s++){const o=e[s],a=Al(o);let c="";if(c=void 0===r?a:r+"."+a,a===t.textNodeName)void 0===n?n=o[a]:n+=""+o[a];else{if(void 0===a)continue;if(o[a]){let e=El(o[a],t,c);const r=xl(e,t);o[":@"]?kl(e,o[":@"],c,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==i[a]&&i.hasOwnProperty(a)?(Array.isArray(i[a])||(i[a]=[i[a]]),i[a].push(e)):t.isArray(a,c,r)?i[a]=[e]:i[a]=e}}}return"string"==typeof n?n.length>0&&(i[t.textNodeName]=n):void 0!==n&&(i[t.textNodeName]=n),i}function Al(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const r=t[e];if(":@"!==r)return r}}function kl(e,t,r,n){if(t){const i=Object.keys(t),s=i.length;for(let o=0;o<s;o++){const s=i[o];n.isArray(s,r+"."+s,!0,!0)?e[s]=[t[s]]:e[s]=t[s]}}}function xl(e,t){const{textNodeName:r}=t,n=Object.keys(e).length;return 0===n||!(1!==n||!e[r]&&"boolean"!=typeof e[r]&&0!==e[r])}Sl.prettify=function(e,t){return El(e,t)};const{buildOptions:Cl}=Fc,Rl=_l,{prettify:Ol}=Sl,Nl=kc;var Il=class{constructor(e){this.externalEntities={},this.options=Cl(e)}parse(e,t){if("string"==typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const r=Nl.validate(e,t);if(!0!==r)throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}const r=new Rl(this.options);r.addExternalEntities(this.externalEntities);const n=r.parseXml(e);return this.options.preserveOrder||void 0===n?n:Ol(n,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};function Tl(e,t,r,n){let i="",s=!1;for(let o=0;o<e.length;o++){const a=e[o],c=Pl(a);let l="";if(l=0===r.length?c:`${r}.${c}`,c===t.textNodeName){let e=a[c];Dl(l,t)||(e=t.tagValueProcessor(c,e),e=$l(e,t)),s&&(i+=n),i+=e,s=!1;continue}if(c===t.cdataPropName){s&&(i+=n),i+=`<![CDATA[${a[c][0][t.textNodeName]}]]>`,s=!1;continue}if(c===t.commentPropName){i+=n+`\x3c!--${a[c][0][t.textNodeName]}--\x3e`,s=!0;continue}if("?"===c[0]){const e=Bl(a[":@"],t),r="?xml"===c?"":n;let o=a[c][0][t.textNodeName];o=0!==o.length?" "+o:"",i+=r+`<${c}${o}${e}?>`,s=!0;continue}let u=n;""!==u&&(u+=t.indentBy);const h=n+`<${c}${Bl(a[":@"],t)}`,f=Tl(a[c],t,l,u);-1!==t.unpairedTags.indexOf(c)?t.suppressUnpairedNode?i+=h+">":i+=h+"/>":f&&0!==f.length||!t.suppressEmptyNode?f&&f.endsWith(">")?i+=h+`>${f}${n}</${c}>`:(i+=h+">",f&&""!==n&&(f.includes("/>")||f.includes("</"))?i+=n+t.indentBy+f+n:i+=f,i+=`</${c}>`):i+=h+"/>",s=!0}return i}function Pl(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const r=t[e];if(":@"!==r)return r}}function Bl(e,t){let r="";if(e&&!t.ignoreAttributes)for(let n in e){let i=t.attributeValueProcessor(n,e[n]);i=$l(i,t),!0===i&&t.suppressBooleanAttributes?r+=` ${n.substr(t.attributeNamePrefix.length)}`:r+=` ${n.substr(t.attributeNamePrefix.length)}="${i}"`}return r}function Dl(e,t){let r=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===e||t.stopNodes[n]==="*."+r)return!0;return!1}function $l(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){const n=t.entities[r];e=e.replace(n.regex,n.val)}return e}const Ll=function(e,t){let r="";return t.format&&t.indentBy.length>0&&(r="\n"),Tl(e,t,"",r)},jl={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Ml(e){this.options=Object.assign({},jl,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Fl),this.processTextOrObjNode=Ul,this.options.format?(this.indentate=Kl,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function Ul(e,t,r){const n=this.j2x(e,r+1);return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,n.attrStr,r):this.buildObjectNode(n.val,t,n.attrStr,r)}function Kl(e){return this.options.indentBy.repeat(e)}function Fl(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}Ml.prototype.build=function(e){return this.options.preserveOrder?Ll(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)},Ml.prototype.j2x=function(e,t){let r="",n="";for(let i in e)if(void 0===e[i]);else if(null===e[i])"?"===i[0]?n+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(e[i]instanceof Date)n+=this.buildTextValNode(e[i],i,"",t);else if("object"!=typeof e[i]){const s=this.isAttribute(i);if(s)r+=this.buildAttrPairStr(s,""+e[i]);else if(i===this.options.textNodeName){let t=this.options.tagValueProcessor(i,""+e[i]);n+=this.replaceEntitiesValue(t)}else n+=this.buildTextValNode(e[i],i,"",t)}else if(Array.isArray(e[i])){const r=e[i].length;let s="";for(let o=0;o<r;o++){const r=e[i][o];void 0===r||(null===r?"?"===i[0]?n+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar:"object"==typeof r?this.options.oneListGroup?s+=this.j2x(r,t+1).val:s+=this.processTextOrObjNode(r,i,t):s+=this.buildTextValNode(r,i,"",t))}this.options.oneListGroup&&(s=this.buildObjectNode(s,i,"",t)),n+=s}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const t=Object.keys(e[i]),n=t.length;for(let s=0;s<n;s++)r+=this.buildAttrPairStr(t[s],""+e[i][t[s]])}else n+=this.processTextOrObjNode(e[i],i,t);return{attrStr:r,val:n}},Ml.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},Ml.prototype.buildObjectNode=function(e,t,r,n){if(""===e)return"?"===t[0]?this.indentate(n)+"<"+t+r+"?"+this.tagEndChar:this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let i="</"+t+this.tagEndChar,s="";return"?"===t[0]&&(s="?",i=""),r&&-1===e.indexOf("<")?this.indentate(n)+"<"+t+r+s+">"+e+i:!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===s.length?this.indentate(n)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(n)+"<"+t+r+s+this.tagEndChar+e+this.indentate(n)+i}},Ml.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":`></${e}`,t},Ml.prototype.buildTextValNode=function(e,t,r,n){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(n)+`\x3c!--${e}--\x3e`+this.newLine;if("?"===t[0])return this.indentate(n)+"<"+t+r+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(t,e);return i=this.replaceEntitiesValue(i),""===i?this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+r+">"+i+"</"+t+this.tagEndChar}},Ml.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};var Hl={XMLParser:Il,XMLValidator:kc,XMLBuilder:Ml};const zl=async(e,t)=>{const r={...e,body:await Au(e.body,t)},n=xu(e,r.body);switch(n){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await ql(r);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await Jl(r);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await Yl(r);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await Zl(r);default:const t=r.body;return wu({output:e,parsedBody:t.Error,errorCode:n})}},Vl=async(e,t)=>{const r={...e,body:await Au(e.body,t)},n=xu(e,r.body);switch(n){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await ql(r);case"IDPCommunicationError":case"com.amazonaws.sts#IDPCommunicationErrorException":throw await Gl(r);case"IDPRejectedClaim":case"com.amazonaws.sts#IDPRejectedClaimException":throw await Wl(r);case"InvalidIdentityToken":case"com.amazonaws.sts#InvalidIdentityTokenException":throw await Xl(r);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await Jl(r);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await Yl(r);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await Zl(r);default:const t=r.body;return wu({output:e,parsedBody:t.Error,errorCode:n})}},ql=async(e,t)=>{const r=e.body,n=fu(r.Error),i=new dc({$metadata:bu(e),...n});return ui(i,r)},Gl=async(e,t)=>{const r=e.body,n=pu(r.Error),i=new wc({$metadata:bu(e),...n});return ui(i,r)},Wl=async(e,t)=>{const r=e.body,n=du(r.Error),i=new vc({$metadata:bu(e),...n});return ui(i,r)},Xl=async(e,t)=>{const r=e.body,n=mu(r.Error),i=new bc({$metadata:bu(e),...n});return ui(i,r)},Jl=async(e,t)=>{const r=e.body,n=yu(r.Error),i=new mc({$metadata:bu(e),...n});return ui(i,r)},Yl=async(e,t)=>{const r=e.body,n=gu(r.Error),i=new yc({$metadata:bu(e),...n});return ui(i,r)},Zl=async(e,t)=>{const r=e.body,n=vu(r.Error),i=new gc({$metadata:bu(e),...n});return ui(i,r)},Ql=(e,t)=>{const r={};if(null!=e.RoleArn&&(r.RoleArn=e.RoleArn),null!=e.RoleSessionName&&(r.RoleSessionName=e.RoleSessionName),null!=e.PolicyArns){const t=tu(e.PolicyArns);0===e.PolicyArns?.length&&(r.PolicyArns=[]),Object.entries(t).forEach((([e,t])=>{r[`PolicyArns.${e}`]=t}))}if(null!=e.Policy&&(r.Policy=e.Policy),null!=e.DurationSeconds&&(r.DurationSeconds=e.DurationSeconds),null!=e.Tags){const t=au(e.Tags);0===e.Tags?.length&&(r.Tags=[]),Object.entries(t).forEach((([e,t])=>{r[`Tags.${e}`]=t}))}if(null!=e.TransitiveTagKeys){const t=ou(e.TransitiveTagKeys);0===e.TransitiveTagKeys?.length&&(r.TransitiveTagKeys=[]),Object.entries(t).forEach((([e,t])=>{r[`TransitiveTagKeys.${e}`]=t}))}if(null!=e.ExternalId&&(r.ExternalId=e.ExternalId),null!=e.SerialNumber&&(r.SerialNumber=e.SerialNumber),null!=e.TokenCode&&(r.TokenCode=e.TokenCode),null!=e.SourceIdentity&&(r.SourceIdentity=e.SourceIdentity),null!=e.ProvidedContexts){const t=iu(e.ProvidedContexts);0===e.ProvidedContexts?.length&&(r.ProvidedContexts=[]),Object.entries(t).forEach((([e,t])=>{r[`ProvidedContexts.${e}`]=t}))}return r},eu=(e,t)=>{const r={};if(null!=e.RoleArn&&(r.RoleArn=e.RoleArn),null!=e.RoleSessionName&&(r.RoleSessionName=e.RoleSessionName),null!=e.WebIdentityToken&&(r.WebIdentityToken=e.WebIdentityToken),null!=e.ProviderId&&(r.ProviderId=e.ProviderId),null!=e.PolicyArns){const t=tu(e.PolicyArns);0===e.PolicyArns?.length&&(r.PolicyArns=[]),Object.entries(t).forEach((([e,t])=>{r[`PolicyArns.${e}`]=t}))}return null!=e.Policy&&(r.Policy=e.Policy),null!=e.DurationSeconds&&(r.DurationSeconds=e.DurationSeconds),r},tu=(e,t)=>{const r={};let n=1;for(const t of e){if(null===t)continue;const e=ru(t);Object.entries(e).forEach((([e,t])=>{r[`member.${n}.${e}`]=t})),n++}return r},ru=(e,t)=>{const r={};return null!=e.arn&&(r.arn=e.arn),r},nu=(e,t)=>{const r={};return null!=e.ProviderArn&&(r.ProviderArn=e.ProviderArn),null!=e.ContextAssertion&&(r.ContextAssertion=e.ContextAssertion),r},iu=(e,t)=>{const r={};let n=1;for(const t of e){if(null===t)continue;const e=nu(t);Object.entries(e).forEach((([e,t])=>{r[`member.${n}.${e}`]=t})),n++}return r},su=(e,t)=>{const r={};return null!=e.Key&&(r.Key=e.Key),null!=e.Value&&(r.Value=e.Value),r},ou=(e,t)=>{const r={};let n=1;for(const t of e)null!==t&&(r[`member.${n}`]=t,n++);return r},au=(e,t)=>{const r={};let n=1;for(const t of e){if(null===t)continue;const e=su(t);Object.entries(e).forEach((([e,t])=>{r[`member.${n}.${e}`]=t})),n++}return r},cu=(e,t)=>{const r={};return void 0!==e.AssumedRoleId&&(r.AssumedRoleId=$n(e.AssumedRoleId)),void 0!==e.Arn&&(r.Arn=$n(e.Arn)),r},lu=(e,t)=>{const r={};return void 0!==e.Credentials&&(r.Credentials=hu(e.Credentials)),void 0!==e.AssumedRoleUser&&(r.AssumedRoleUser=cu(e.AssumedRoleUser)),void 0!==e.PackedPolicySize&&(r.PackedPolicySize=Mn(e.PackedPolicySize)),void 0!==e.SourceIdentity&&(r.SourceIdentity=$n(e.SourceIdentity)),r},uu=(e,t)=>{const r={};return void 0!==e.Credentials&&(r.Credentials=hu(e.Credentials)),void 0!==e.SubjectFromWebIdentityToken&&(r.SubjectFromWebIdentityToken=$n(e.SubjectFromWebIdentityToken)),void 0!==e.AssumedRoleUser&&(r.AssumedRoleUser=cu(e.AssumedRoleUser)),void 0!==e.PackedPolicySize&&(r.PackedPolicySize=Mn(e.PackedPolicySize)),void 0!==e.Provider&&(r.Provider=$n(e.Provider)),void 0!==e.Audience&&(r.Audience=$n(e.Audience)),void 0!==e.SourceIdentity&&(r.SourceIdentity=$n(e.SourceIdentity)),r},hu=(e,t)=>{const r={};return void 0!==e.AccessKeyId&&(r.AccessKeyId=$n(e.AccessKeyId)),void 0!==e.SecretAccessKey&&(r.SecretAccessKey=$n(e.SecretAccessKey)),void 0!==e.SessionToken&&(r.SessionToken=$n(e.SessionToken)),void 0!==e.Expiration&&(r.Expiration=Bn(Gn(e.Expiration))),r},fu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},pu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},du=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},mu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},yu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},gu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},vu=(e,t)=>{const r={};return void 0!==e.message&&(r.message=$n(e.message)),r},bu=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),wu=hi(pc),_u=async(e,t,r,n,i)=>{const{hostname:s,protocol:o="https",port:a,path:c}=await e.endpoint(),l={protocol:o,hostname:s,port:a,method:"POST",path:c.endsWith("/")?c.slice(0,-1)+r:c+r,headers:t};return void 0!==n&&(l.hostname=n),void 0!==i&&(l.body=i),new $r(l)},Su={"content-type":"application/x-www-form-urlencoded"},Eu=(e,t)=>((e,t)=>Sn(e,t).then((e=>t.utf8Encoder(e))))(e,t).then((e=>{if(e.length){const t=new Hl.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(e,t)=>""===t.trim()&&t.includes("\n")?"":void 0});t.addEntity("#xD","\r"),t.addEntity("#10","\n");const r=t.parse(e),n="#text",i=Object.keys(r)[0],s=r[i];return s[n]&&(s[i]=s[n],delete s[n]),Ei(s)}return{}})),Au=async(e,t)=>{const r=await Eu(e,t);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},ku=e=>Object.entries(e).map((([e,t])=>Si(e)+"="+Si(t))).join("&"),xu=(e,t)=>void 0!==t.Error?.Code?t.Error.Code:404==e.statusCode?"NotFound":void 0;class Cu extends En{static getEndpointParameterInstructions(){return{UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,Cu.getEndpointParameterInstructions())),this.middlewareStack.use(vo(t));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"STSClient",commandName:"AssumeRoleCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:Sc,[Br]:{service:"AWSSecurityTokenServiceV20110615",operation:"AssumeRole"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const r=Su;let n;return n=ku({...Ql(e),Action:"AssumeRole",Version:"2011-06-15"}),_u(t,r,"/",void 0,n)})(e,t)}deserialize(e,t){return(async(e,t)=>{if(e.statusCode>=300)return zl(e,t);const r=await Eu(e.body,t);let n={};return n=lu(r.AssumeRoleResult),{$metadata:bu(e),...n}})(e,t)}}class Ru extends En{static getEndpointParameterInstructions(){return{UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,Ru.getEndpointParameterInstructions()));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"STSClient",commandName:"AssumeRoleWithWebIdentityCommand",inputFilterSensitiveLog:Ec,outputFilterSensitiveLog:Ac,[Br]:{service:"AWSSecurityTokenServiceV20110615",operation:"AssumeRoleWithWebIdentity"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const r=Su;let n;return n=ku({...eu(e),Action:"AssumeRoleWithWebIdentity",Version:"2011-06-15"}),_u(t,r,"/",void 0,n)})(e,t)}deserialize(e,t){return(async(e,t)=>{if(e.statusCode>=300)return Vl(e,t);const r=await Eu(e.body,t);let n={};return n=uu(r.AssumeRoleWithWebIdentityResult),{$metadata:bu(e),...n}})(e,t)}}const Ou="us-east-1",Nu=e=>"function"!=typeof e?void 0===e?Ou:e:async()=>{try{return await e()}catch(e){return Ou}},Iu=(e,t)=>{let r,n;return async(i,s)=>{if(n=i,!r){const{logger:i,region:s,requestHandler:o}=e;r=new t({logger:i,credentialDefaultProvider:()=>async()=>n,region:Nu(s||e.region),...o?{requestHandler:o}:{}})}const{Credentials:o}=await r.send(new Cu(s));if(!o||!o.AccessKeyId||!o.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRole call with role ${s.RoleArn}`);return{accessKeyId:o.AccessKeyId,secretAccessKey:o.SecretAccessKey,sessionToken:o.SessionToken,expiration:o.Expiration}}},Tu=(e,t)=>{let r;return async n=>{if(!r){const{logger:n,region:i,requestHandler:s}=e;r=new t({logger:n,region:Nu(i||e.region),...s?{requestHandler:s}:{}})}const{Credentials:i}=await r.send(new Ru(n));if(!i||!i.AccessKeyId||!i.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${n.RoleArn}`);return{accessKeyId:i.AccessKeyId,secretAccessKey:i.SecretAccessKey,sessionToken:i.SessionToken,expiration:i.Expiration}}},Pu=()=>async()=>{const e=process.env.AWS_ACCESS_KEY_ID,t=process.env.AWS_SECRET_ACCESS_KEY,r=process.env.AWS_SESSION_TOKEN,n=process.env.AWS_CREDENTIAL_EXPIRATION;if(e&&t)return{accessKeyId:e,secretAccessKey:t,...r&&{sessionToken:r},...n&&{expiration:new Date(n)}};throw new Fi("Unable to find environment variable credentials.")},Bu={},Du=()=>{const{HOME:e,USERPROFILE:t,HOMEPATH:r,HOMEDRIVE:n=`C:${x}`}=process.env;if(e)return e;if(t)return t;if(r)return`${n}${r}`;const i=process&&process.geteuid?`${process.geteuid()}`:"DEFAULT";return Bu[i]||(Bu[i]=D()),Bu[i]},$u="AWS_PROFILE",Lu=e=>e.profile||process.env[$u]||"default",ju=e=>{const t=N("sha1").update(e).digest("hex");return C(Du(),".aws","sso","cache",`${t}.json`)},{readFile:Mu}=v,Uu=async e=>{const t=ju(e),r=await Mu(t,"utf8");return JSON.parse(r)},Ku=()=>process.env.AWS_CONFIG_FILE||C(Du(),".aws","config"),Fu=()=>process.env.AWS_SHARED_CREDENTIALS_FILE||C(Du(),".aws","credentials"),Hu=/^profile\s(["'])?([^\1]+)\1$/,zu=e=>Object.entries(e).filter((([e])=>Hu.test(e))).reduce(((e,[t,r])=>({...e,[Hu.exec(t)[2]]:r})),{...e.default&&{default:e.default}}),Vu=["__proto__","profile __proto__"],qu=e=>{const t={};let r;for(let n of e.split(/\r?\n/)){n=n.split(/(^|\s)[;#]/)[0].trim();if("["===n[0]&&"]"===n[n.length-1]){if(r=n.substring(1,n.length-1),Vu.includes(r))throw new Error(`Found invalid profile name "${r}"`)}else if(r){const e=n.indexOf("="),i=0,s=n.length-1;if(-1!==e&&e!==i&&e!==s){const[i,s]=[n.substring(0,e).trim(),n.substring(e+1).trim()];t[r]=t[r]||{},t[r][i]=s}}}return t},{readFile:Gu}=v,Wu={},Xu=(e,t)=>(Wu[e]&&!t?.ignoreCache||(Wu[e]=Gu(e,"utf8")),Wu[e]),Ju=()=>({}),Yu=async(e={})=>{const{filepath:t=Fu(),configFilepath:r=Ku()}=e,n=await Promise.all([Xu(r,{ignoreCache:e.ignoreCache}).then(qu).then(zu).catch(Ju),Xu(t,{ignoreCache:e.ignoreCache}).then(qu).catch(Ju)]);return{configFile:n[0],credentialsFile:n[1]}},Zu=/^sso-session\s(["'])?([^\1]+)\1$/,Qu=e=>Object.entries(e).filter((([e])=>Zu.test(e))).reduce(((e,[t,r])=>({...e,[Zu.exec(t)[2]]:r})),{}),eh=()=>({}),th=async(e={})=>Xu(e.configFilepath??Ku()).then(qu).then(Qu).catch(eh),rh=async e=>{const t=await Yu(e);return((...e)=>{const t={};for(const r of e)for(const[e,n]of Object.entries(r))void 0!==t[e]?Object.assign(t[e],n):t[e]=n;return t})(t.configFile,t.credentialsFile)};function nh(e){return new Promise(((t,r)=>{const n=f({method:"GET",...e,hostname:e.hostname?.replace(/^\[(.+)\]$/,"$1")});n.on("error",(e=>{r(Object.assign(new Ki("Unable to connect to instance metadata service"),e)),n.destroy()})),n.on("timeout",(()=>{r(new Ki("TimeoutError from instance metadata service")),n.destroy()})),n.on("response",(e=>{const{statusCode:i=400}=e;(i<200||300<=i)&&(r(Object.assign(new Ki("Error response received from instance metadata service"),{statusCode:i})),n.destroy());const s=[];e.on("data",(e=>{s.push(e)})),e.on("end",(()=>{t(o.concat(s)),n.destroy()}))})),n.end()}))}const ih=e=>Boolean(e)&&"object"==typeof e&&"string"==typeof e.AccessKeyId&&"string"==typeof e.SecretAccessKey&&"string"==typeof e.Token&&"string"==typeof e.Expiration,sh=e=>({accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration)}),oh=({maxRetries:e=0,timeout:t=1e3})=>({maxRetries:e,timeout:t}),ah=(e,t)=>{let r=e();for(let n=0;n<t;n++)r=r.catch(e);return r},ch="AWS_CONTAINER_CREDENTIALS_FULL_URI",lh="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",uh="AWS_CONTAINER_AUTHORIZATION_TOKEN",hh=(e={})=>{const{timeout:t,maxRetries:r}=oh(e);return()=>ah((async()=>{const e=await mh(),r=JSON.parse(await fh(t,e));if(!ih(r))throw new Fi("Invalid response received from instance metadata service.");return sh(r)}),r)},fh=async(e,t)=>{process.env[uh]&&(t.headers={...t.headers,Authorization:process.env[uh]});return(await nh({...t,timeout:e})).toString()},ph={localhost:!0,"127.0.0.1":!0},dh={"http:":!0,"https:":!0},mh=async()=>{if(process.env[lh])return{hostname:"169.254.170.2",path:process.env[lh]};if(process.env[ch]){const e=t(process.env[ch]);if(!e.hostname||!(e.hostname in ph))throw new Fi(`${e.hostname} is not a valid container metadata service hostname`,!1);if(!e.protocol||!(e.protocol in dh))throw new Fi(`${e.protocol} is not a valid container metadata service protocol`,!1);return{...e,port:e.port?parseInt(e.port,10):void 0}}throw new Fi(`The container metadata credential provider cannot be used unless the ${lh} or ${ch} environment variable is set`,!1)},yh=e=>{return"function"==typeof e?async()=>await e():(t=e,()=>Promise.resolve(t));var t},gh=({environmentVariableSelector:e,configFileSelector:t,default:r},n={})=>{return Vi(zi((i=e,async()=>{try{const e=i(process.env);if(void 0===e)throw new Error;return e}catch(e){throw new Fi(e.message||`Cannot load config from environment variables with getter: ${i}`)}}),((e,{preferredFile:t="config",...r}={})=>async()=>{const n=Lu(r),{configFile:i,credentialsFile:s}=await Yu(r),o=s[n]||{},a=i[n]||{},c="config"===t?{...o,...a}:{...a,...o};try{const t=e(c);if(void 0===t)throw new Error;return t}catch(t){throw new Fi(t.message||`Cannot load config for profile ${n} in SDK configuration files with getter: ${e}`)}})(t,n),yh(r)));var i};var vh;!function(e){e.IPv4="http://169.254.169.254",e.IPv6="http://[fd00:ec2::254]"}(vh||(vh={}));const bh={environmentVariableSelector:e=>e.AWS_EC2_METADATA_SERVICE_ENDPOINT,configFileSelector:e=>e.ec2_metadata_service_endpoint,default:void 0};var wh;!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(wh||(wh={}));const _h={environmentVariableSelector:e=>e.AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE,configFileSelector:e=>e.ec2_metadata_service_endpoint_mode,default:wh.IPv4},Sh=async()=>ka(await Eh()||await Ah()),Eh=async()=>gh(bh)(),Ah=async()=>{const e=await gh(_h)();switch(e){case wh.IPv4:return vh.IPv4;case wh.IPv6:return vh.IPv6;default:throw new Error(`Unsupported endpoint mode: ${e}. Select from ${Object.values(wh)}`)}},kh=(e,t)=>{const r=300+Math.floor(300*Math.random()),n=new Date(Date.now()+1e3*r);t.warn("Attempting credential expiration extension due to a credential service availability issue. A refresh of these credentials will be attempted after ${new Date(newExpiration)}.\nFor more information, please visit: https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html");const i=e.originalExpiration??e.expiration;return{...e,...i?{originalExpiration:i}:{},expiration:n}},xh="/latest/meta-data/iam/security-credentials/",Ch=(e={})=>((e,t={})=>{const r=t?.logger||console;let n;return async()=>{let t;try{t=await e(),t.expiration&&t.expiration.getTime()<Date.now()&&(t=kh(t,r))}catch(e){if(!n)throw e;r.warn("Credential renew failed: ",e),t=kh(n,r)}return n=t,t}})(Rh(e),{logger:e.logger}),Rh=e=>{let t=!1;const{timeout:r,maxRetries:n}=oh(e),i=async(e,r)=>{const n=(await ah((async()=>{let e;try{e=await Nh(r)}catch(e){throw 401===e.statusCode&&(t=!1),e}return e}),e)).trim();return ah((async()=>{let e;try{e=await Ih(n,r)}catch(e){throw 401===e.statusCode&&(t=!1),e}return e}),e)};return async()=>{const e=await Sh();if(t)return i(n,{...e,timeout:r});{let s;try{s=(await Oh({...e,timeout:r})).toString()}catch(s){if(400===s?.statusCode)throw Object.assign(s,{message:"EC2 Metadata token request returned error"});return("TimeoutError"===s.message||[403,404,405].includes(s.statusCode))&&(t=!0),i(n,{...e,timeout:r})}return i(n,{...e,headers:{"x-aws-ec2-metadata-token":s},timeout:r})}}},Oh=async e=>nh({...e,path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}),Nh=async e=>(await nh({...e,path:xh})).toString(),Ih=async(e,t)=>{const r=JSON.parse((await nh({...t,path:xh+e})).toString());if(!ih(r))throw new Fi("Invalid response received from instance metadata service.");return sh(r)},Th=e=>"string"==typeof e.source_profile&&void 0===e.credential_source,Ph=e=>"string"==typeof e.credential_source&&void 0===e.source_profile,Bh=async(e,t,r,n={})=>{const i=t[e];if(!r.roleAssumer)throw new Fi(`Profile ${e} requires a role to be assumed, but no role assumption callback was provided.`,!1);const{source_profile:s}=i;if(s&&s in n)throw new Fi(`Detected a cycle attempting to resolve credentials for profile ${Lu(r)}. Profiles visited: `+Object.keys(n).join(", "),!1);const o=s?hd(s,t,r,{...n,[s]:!0}):((e,t)=>{const r={EcsContainer:hh,Ec2InstanceMetadata:Ch,Environment:Pu};if(e in r)return r[e]();throw new Fi(`Unsupported credential source in profile ${t}. Got ${e}, expected EcsContainer or Ec2InstanceMetadata or Environment.`)})(i.credential_source,e)(),a={RoleArn:i.role_arn,RoleSessionName:i.role_session_name||`aws-sdk-js-${Date.now()}`,ExternalId:i.external_id,DurationSeconds:parseInt(i.duration_seconds||"3600",10)},{mfa_serial:c}=i;if(c){if(!r.mfaCodeProvider)throw new Fi(`Profile ${e} requires multi-factor authentication, but no MFA code callback was provided.`,!1);a.SerialNumber=c,a.TokenCode=await r.mfaCodeProvider(c)}const l=await o;return r.roleAssumer(l,a)},Dh=async(e,t)=>{const r=t[e];if(!t[e])throw new Fi(`Profile ${e} could not be found in shared credentials file.`);{const t=r.credential_process;if(void 0===t)throw new Fi(`Profile ${e} did not contain credential_process.`);{const r=i(j);try{const{stdout:n}=await r(t);let i;try{i=JSON.parse(n.trim())}catch{throw Error(`Profile ${e} credential_process returned invalid JSON.`)}return((e,t)=>{if(1!==t.Version)throw Error(`Profile ${e} credential_process did not return Version 1.`);if(void 0===t.AccessKeyId||void 0===t.SecretAccessKey)throw Error(`Profile ${e} credential_process returned invalid credentials.`);if(t.Expiration){const r=new Date;if(new Date(t.Expiration)<r)throw Error(`Profile ${e} credential_process returned expired credentials.`)}return{accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,...t.SessionToken&&{sessionToken:t.SessionToken},...t.Expiration&&{expiration:new Date(t.Expiration)}}})(e,i)}catch(e){throw new Fi(e.message)}}}},$h=(e={})=>async()=>{const t=await rh(e);return Dh(Lu(e),t)},Lh=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);var jh="3.423.0";const Mh=({serviceId:e,clientVersion:t})=>{const r=[["aws-sdk-js",t],["ua","2.0"],[`os/${$()}`,L()],["lang/js"],["md/nodejs",`${P.node}`]],n=(()=>{try{return"function"==typeof require&&"undefined"!=typeof module&&require("aws-crt")?["md/crt-avail"]:null}catch(e){return null}})();n&&r.push(n),e&&r.push([`api/${e}`,t]),B.AWS_EXECUTION_ENV&&r.push([`exec-env/${B.AWS_EXECUTION_ENV}`]);const i=gh({environmentVariableSelector:e=>e.AWS_SDK_UA_APP_ID,configFileSelector:e=>e["sdk-ua-app-id"],default:void 0})();let s;return async()=>{if(!s){const e=await i;s=e?[...r,[`app/${e}`]]:[...r]}return s}};class Uh{constructor(e,t){this.algorithmIdentifier=e,this.secret=t,this.reset()}update(e,t){this.hash.update(cn(Kh(e,t)))}digest(){return Promise.resolve(this.hash.digest())}reset(){this.hash=this.secret?I(this.algorithmIdentifier,Kh(this.secret)):N(this.algorithmIdentifier)}}function Kh(e,t){return o.isBuffer(e)?e:"string"==typeof e?rn(e,t):ArrayBuffer.isView(e)?tn(e.buffer,e.byteOffset,e.byteLength):tn(e)}const Fh=e=>{if(!e)return 0;if("string"==typeof e)return Buffer.from(e).length;if("number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.size)return e.size;if("number"==typeof e.start&&"number"==typeof e.end)return e.end+1-e.start;if("string"==typeof e.path||Buffer.isBuffer(e.path))return b(e.path).size;if("number"==typeof e.fd)return w(e.fd).size;throw new Error(`Body Length computation failed for ${e}`)},Hh="required",zh="fn",Vh="argv",qh="ref",Gh="isSet",Wh="tree",Xh="error",Jh="endpoint",Yh="PartitionResult",Zh="getAttr",Qh={[Hh]:!1,type:"String"},ef={[Hh]:!0,default:!1,type:"Boolean"},tf={[qh]:"Endpoint"},rf={[zh]:"booleanEquals",[Vh]:[{[qh]:"UseFIPS"},!0]},nf={[zh]:"booleanEquals",[Vh]:[{[qh]:"UseDualStack"},!0]},sf={},of={[zh]:"booleanEquals",[Vh]:[!0,{[zh]:Zh,[Vh]:[{[qh]:Yh},"supportsFIPS"]}]},af={[qh]:Yh},cf={[zh]:"booleanEquals",[Vh]:[!0,{[zh]:Zh,[Vh]:[af,"supportsDualStack"]}]},lf=[rf],uf=[nf],hf=[{[qh]:"Region"}],ff={version:"1.0",parameters:{Region:Qh,UseDualStack:ef,UseFIPS:ef,Endpoint:Qh},rules:[{conditions:[{[zh]:Gh,[Vh]:[tf]}],type:Wh,rules:[{conditions:lf,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Xh},{conditions:uf,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Xh},{endpoint:{url:tf,properties:sf,headers:sf},type:Jh}]},{conditions:[{[zh]:Gh,[Vh]:hf}],type:Wh,rules:[{conditions:[{[zh]:"aws.partition",[Vh]:hf,assign:Yh}],type:Wh,rules:[{conditions:[rf,nf],type:Wh,rules:[{conditions:[of,cf],type:Wh,rules:[{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:sf,headers:sf},type:Jh}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Xh}]},{conditions:lf,type:Wh,rules:[{conditions:[of],type:Wh,rules:[{conditions:[{[zh]:"stringEquals",[Vh]:["aws-us-gov",{[zh]:Zh,[Vh]:[af,"name"]}]}],endpoint:{url:"https://portal.sso.{Region}.amazonaws.com",properties:sf,headers:sf},type:Jh},{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dnsSuffix}",properties:sf,headers:sf},type:Jh}]},{error:"FIPS is enabled but this partition does not support FIPS",type:Xh}]},{conditions:uf,type:Wh,rules:[{conditions:[cf],type:Wh,rules:[{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:sf,headers:sf},type:Jh}]},{error:"DualStack is enabled but this partition does not support DualStack",type:Xh}]},{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dnsSuffix}",properties:sf,headers:sf},type:Jh}]}]},{error:"Invalid Configuration: Missing Region",type:Xh}]},pf=(e,t={})=>Yo(ff,{endpointParams:e,logger:t.logger}),df="AWS_REGION",mf="AWS_DEFAULT_REGION",yf=["in-region","cross-region","mobile","standard","legacy"],gf={environmentVariableSelector:e=>e.AWS_DEFAULTS_MODE,configFileSelector:e=>e.defaults_mode,default:"legacy"},vf=({region:e=gh(la),defaultsMode:t=gh(gf)}={})=>Vi((async()=>{const r="function"==typeof t?await t():t;switch(r?.toLowerCase()){case"auto":return bf(e);case"in-region":case"cross-region":case"mobile":case"standard":case"legacy":return Promise.resolve(r?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${yf.join(", ")}, got ${r}`)}})),bf=async e=>{if(e){const t="function"==typeof e?await e():e,r=await wf();return r?t===r?"in-region":"cross-region":"standard"}return"standard"},wf=async()=>{if(process.env.AWS_EXECUTION_ENV&&(process.env[df]||process.env[mf]))return process.env[df]??process.env[mf];if(!process.env.AWS_EC2_METADATA_DISABLED)try{const e=await Sh();return(await nh({...e,path:"/latest/meta-data/placement/region"})).toString()}catch(e){}},_f=e=>{mi(process.version);const t=vf(e),r=()=>t().then(pi),n=(e=>({apiVersion:"2019-06-10",base64Decoder:e?.base64Decoder??sn,base64Encoder:e?.base64Encoder??on,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??pf,extensions:e?.extensions??[],logger:e?.logger??new Gr,serviceId:e?.serviceId??"SSO",urlParser:e?.urlParser??ka,utf8Decoder:e?.utf8Decoder??an,utf8Encoder:e?.utf8Encoder??ln}))(e);return{...n,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??Fh,defaultUserAgentProvider:e?.defaultUserAgentProvider??Mh({serviceId:n.serviceId,clientVersion:jh}),maxAttempts:e?.maxAttempts??gh(rc),region:e?.region??gh(la,ua),requestHandler:e?.requestHandler??new gn(r),retryMode:e?.retryMode??gh({...ic,default:async()=>(await r()).retryMode||Ba}),sha256:e?.sha256??Uh.bind(null,"sha256"),streamCollector:e?.streamCollector??bn,useDualstackEndpoint:e?.useDualstackEndpoint??gh(aa),useFipsEndpoint:e?.useFipsEndpoint??gh(ca)}},Sf=e=>{let t=async()=>{if(void 0===e.region)throw new Error("Region is missing from runtimeConfig");const t=e.region;return"string"==typeof t?t:t()};return{setRegion(e){t=e},region:()=>t}},Ef=e=>({region:e.region()});class Af extends Qr{constructor(...[e]){const t=_f(e||{}),r=(n=t,{...n,useDualstackEndpoint:n.useDualstackEndpoint??!1,useFipsEndpoint:n.useFipsEndpoint??!1,defaultSigningName:"awsssoportal"});var n;const i=pa(r),s=Ta(i),o=((e,t)=>{const r={...Sf(e),...wi(e),...Rr(e)};return t.forEach((e=>e.configure(r))),{...e,...Ef(r),..._i(r),...Or(r)}})(bo(nc(s)),e?.extensions||[]);super(o),this.config=o,this.middlewareStack.use(lc(this.config)),this.middlewareStack.use(ya(this.config)),this.middlewareStack.use(Kr(this.config)),this.middlewareStack.use(Hr(this.config)),this.middlewareStack.use(qr(this.config)),this.middlewareStack.use(ia(this.config))}destroy(){super.destroy()}}class kf extends li{constructor(e){super(e),Object.setPrototypeOf(this,kf.prototype)}}let xf=class e extends kf{constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),this.name="InvalidRequestException",this.$fault="client",Object.setPrototypeOf(this,e.prototype)}};class Cf extends kf{constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),this.name="ResourceNotFoundException",this.$fault="client",Object.setPrototypeOf(this,Cf.prototype)}}class Rf extends kf{constructor(e){super({name:"TooManyRequestsException",$fault:"client",...e}),this.name="TooManyRequestsException",this.$fault="client",Object.setPrototypeOf(this,Rf.prototype)}}class Of extends kf{constructor(e){super({name:"UnauthorizedException",$fault:"client",...e}),this.name="UnauthorizedException",this.$fault="client",Object.setPrototypeOf(this,Of.prototype)}}const Nf=e=>({...e,...e.accessToken&&{accessToken:An}}),If=e=>({...e,...e.secretAccessKey&&{secretAccessKey:An},...e.sessionToken&&{sessionToken:An}}),Tf=e=>({...e,...e.roleCredentials&&{roleCredentials:If(e.roleCredentials)}}),Pf=async(e,t)=>{const r={...e,body:await Ff(e.body,t)},n=Hf(e,r.body);switch(n){case"InvalidRequestException":case"com.amazonaws.sso#InvalidRequestException":throw await Df(r);case"ResourceNotFoundException":case"com.amazonaws.sso#ResourceNotFoundException":throw await $f(r);case"TooManyRequestsException":case"com.amazonaws.sso#TooManyRequestsException":throw await Lf(r);case"UnauthorizedException":case"com.amazonaws.sso#UnauthorizedException":throw await jf(r);default:const t=r.body;return Bf({output:e,parsedBody:t,errorCode:n})}},Bf=hi(kf),Df=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{message:$n});Object.assign(r,i);const s=new xf({$metadata:Mf(e),...r});return ui(s,e.body)},$f=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{message:$n});Object.assign(r,i);const s=new Cf({$metadata:Mf(e),...r});return ui(s,e.body)},Lf=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{message:$n});Object.assign(r,i);const s=new Rf({$metadata:Mf(e),...r});return ui(s,e.body)},jf=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{message:$n});Object.assign(r,i);const s=new Of({$metadata:Mf(e),...r});return ui(s,e.body)},Mf=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Uf=e=>!(null==e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size),Kf=(e,t)=>((e,t)=>Sn(e,t).then((e=>t.utf8Encoder(e))))(e,t).then((e=>e.length?JSON.parse(e):{})),Ff=async(e,t)=>{const r=await Kf(e,t);return r.message=r.message??r.Message,r},Hf=(e,t)=>{const r=e=>{let t=e;return"number"==typeof t&&(t=t.toString()),t.indexOf(",")>=0&&(t=t.split(",")[0]),t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},n=((e,t)=>Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase())))(e.headers,"x-amzn-errortype");return void 0!==n?r(e.headers[n]):void 0!==t.code?r(t.code):void 0!==t.__type?r(t.__type):void 0};class zf extends En{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,zf.getEndpointParameterInstructions()));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"SSOClient",commandName:"GetRoleCredentialsCommand",inputFilterSensitiveLog:Nf,outputFilterSensitiveLog:Tf,[Br]:{service:"SWBPortalService",operation:"GetRoleCredentials"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Uf,{"x-amz-sso_bearer_token":e.accessToken}),a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/federation/credentials`,c=ki({role_name:[,Bn(e.roleName,"roleName")],account_id:[,Bn(e.accountId,"accountId")]});return new $r({protocol:n,hostname:r,port:i,method:"GET",headers:o,path:a,query:c,body:void 0})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Pf(e,t);const r=ki({$metadata:Mf(e)}),n=Bn(Dn(await Kf(e.body,t)),"body"),i=xi(n,{roleCredentials:Ti});return Object.assign(r,i),r})(e,t)}}var Vf="3.387.0",qf="required",Gf="fn",Wf="argv",Xf="ref",Jf="PartitionResult",Yf="tree",Zf="error",Qf="endpoint",ep={[qf]:!1,type:"String"},tp={[qf]:!0,default:!1,type:"Boolean"},rp={[Xf]:"Endpoint"},np={[Gf]:"booleanEquals",[Wf]:[{[Xf]:"UseFIPS"},!0]},ip={[Gf]:"booleanEquals",[Wf]:[{[Xf]:"UseDualStack"},!0]},sp={},op={[Gf]:"booleanEquals",[Wf]:[!0,{[Gf]:"getAttr",[Wf]:[{[Xf]:Jf},"supportsFIPS"]}]},ap={[Gf]:"booleanEquals",[Wf]:[!0,{[Gf]:"getAttr",[Wf]:[{[Xf]:Jf},"supportsDualStack"]}]},cp=[rp],lp=[np],up=[ip],hp={version:"1.0",parameters:{Region:ep,UseDualStack:tp,UseFIPS:tp,Endpoint:ep},rules:[{conditions:[{[Gf]:"aws.partition",[Wf]:[{[Xf]:"Region"}],assign:Jf}],type:Yf,rules:[{conditions:[{[Gf]:"isSet",[Wf]:cp},{[Gf]:"parseURL",[Wf]:cp,assign:"url"}],type:Yf,rules:[{conditions:lp,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Zf},{type:Yf,rules:[{conditions:up,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Zf},{endpoint:{url:rp,properties:sp,headers:sp},type:Qf}]}]},{conditions:[np,ip],type:Yf,rules:[{conditions:[op,ap],type:Yf,rules:[{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:sp,headers:sp},type:Qf}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Zf}]},{conditions:lp,type:Yf,rules:[{conditions:[op],type:Yf,rules:[{type:Yf,rules:[{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dnsSuffix}",properties:sp,headers:sp},type:Qf}]}]},{error:"FIPS is enabled but this partition does not support FIPS",type:Zf}]},{conditions:up,type:Yf,rules:[{conditions:[ap],type:Yf,rules:[{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:sp,headers:sp},type:Qf}]},{error:"DualStack is enabled but this partition does not support DualStack",type:Zf}]},{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dnsSuffix}",properties:sp,headers:sp},type:Qf}]}]},fp=(e,t={})=>Yo(hp,{endpointParams:e,logger:t.logger}),pp=e=>{mi(process.version);const t=vf(e),r=()=>t().then(pi),n=(e=>({apiVersion:"2019-06-10",base64Decoder:e?.base64Decoder??sn,base64Encoder:e?.base64Encoder??on,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??fp,logger:e?.logger??new Gr,serviceId:e?.serviceId??"SSO OIDC",urlParser:e?.urlParser??ka,utf8Decoder:e?.utf8Decoder??an,utf8Encoder:e?.utf8Encoder??ln}))(e);return{...n,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??Fh,defaultUserAgentProvider:e?.defaultUserAgentProvider??Mh({serviceId:n.serviceId,clientVersion:Vf}),maxAttempts:e?.maxAttempts??gh(rc),region:e?.region??gh(la,ua),requestHandler:e?.requestHandler??new gn(r),retryMode:e?.retryMode??gh({...ic,default:async()=>(await r()).retryMode||Ba}),sha256:e?.sha256??Uh.bind(null,"sha256"),streamCollector:e?.streamCollector??bn,useDualstackEndpoint:e?.useDualstackEndpoint??gh(aa),useFipsEndpoint:e?.useFipsEndpoint??gh(ca)}},dp=class extends Qr{constructor(...[e]){const t=pp(e||{}),r=(n=t,{...n,useDualstackEndpoint:n.useDualstackEndpoint??!1,useFipsEndpoint:n.useFipsEndpoint??!1,defaultSigningName:"awsssooidc"});var n;const i=pa(r),s=Ta(i),o=bo(nc(s));super(o),this.config=o,this.middlewareStack.use(lc(this.config)),this.middlewareStack.use(ya(this.config)),this.middlewareStack.use(Kr(this.config)),this.middlewareStack.use(Hr(this.config)),this.middlewareStack.use(qr(this.config)),this.middlewareStack.use(ia(this.config))}destroy(){super.destroy()}},mp=class e extends li{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},yp=class e extends mp{constructor(t){super({name:"AccessDeniedException",$fault:"client",...t}),this.name="AccessDeniedException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},gp=class e extends mp{constructor(t){super({name:"AuthorizationPendingException",$fault:"client",...t}),this.name="AuthorizationPendingException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},vp=class e extends mp{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),this.name="ExpiredTokenException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},bp=class e extends mp{constructor(t){super({name:"InternalServerException",$fault:"server",...t}),this.name="InternalServerException",this.$fault="server",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},wp=class e extends mp{constructor(t){super({name:"InvalidClientException",$fault:"client",...t}),this.name="InvalidClientException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},_p=class e extends mp{constructor(t){super({name:"InvalidGrantException",$fault:"client",...t}),this.name="InvalidGrantException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Sp=class e extends mp{constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),this.name="InvalidRequestException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ep=class e extends mp{constructor(t){super({name:"InvalidScopeException",$fault:"client",...t}),this.name="InvalidScopeException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ap=class e extends mp{constructor(t){super({name:"SlowDownException",$fault:"client",...t}),this.name="SlowDownException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},kp=class e extends mp{constructor(t){super({name:"UnauthorizedClientException",$fault:"client",...t}),this.name="UnauthorizedClientException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},xp=class e extends mp{constructor(t){super({name:"UnsupportedGrantTypeException",$fault:"client",...t}),this.name="UnsupportedGrantTypeException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Cp=class e extends mp{constructor(t){super({name:"InvalidClientMetadataException",$fault:"client",...t}),this.name="InvalidClientMetadataException",this.$fault="client",Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Rp=async(e,t)=>{const r={...e,body:await qp(e.body,t)},n=Gp(e,r.body);switch(n){case"AccessDeniedException":case"com.amazonaws.ssooidc#AccessDeniedException":throw await Tp(r);case"AuthorizationPendingException":case"com.amazonaws.ssooidc#AuthorizationPendingException":throw await Pp(r);case"ExpiredTokenException":case"com.amazonaws.ssooidc#ExpiredTokenException":throw await Bp(r);case"InternalServerException":case"com.amazonaws.ssooidc#InternalServerException":throw await Dp(r);case"InvalidClientException":case"com.amazonaws.ssooidc#InvalidClientException":throw await $p(r);case"InvalidGrantException":case"com.amazonaws.ssooidc#InvalidGrantException":throw await jp(r);case"InvalidRequestException":case"com.amazonaws.ssooidc#InvalidRequestException":throw await Mp(r);case"InvalidScopeException":case"com.amazonaws.ssooidc#InvalidScopeException":throw await Up(r);case"SlowDownException":case"com.amazonaws.ssooidc#SlowDownException":throw await Kp(r);case"UnauthorizedClientException":case"com.amazonaws.ssooidc#UnauthorizedClientException":throw await Fp(r);case"UnsupportedGrantTypeException":case"com.amazonaws.ssooidc#UnsupportedGrantTypeException":throw await Hp(r);default:const t=r.body;return Ip({output:e,parsedBody:t,errorCode:n})}},Op=async(e,t)=>{const r={...e,body:await qp(e.body,t)},n=Gp(e,r.body);switch(n){case"InternalServerException":case"com.amazonaws.ssooidc#InternalServerException":throw await Dp(r);case"InvalidClientMetadataException":case"com.amazonaws.ssooidc#InvalidClientMetadataException":throw await Lp(r);case"InvalidRequestException":case"com.amazonaws.ssooidc#InvalidRequestException":throw await Mp(r);case"InvalidScopeException":case"com.amazonaws.ssooidc#InvalidScopeException":throw await Up(r);default:const t=r.body;return Ip({output:e,parsedBody:t,errorCode:n})}},Np=async(e,t)=>{const r={...e,body:await qp(e.body,t)},n=Gp(e,r.body);switch(n){case"InternalServerException":case"com.amazonaws.ssooidc#InternalServerException":throw await Dp(r);case"InvalidClientException":case"com.amazonaws.ssooidc#InvalidClientException":throw await $p(r);case"InvalidRequestException":case"com.amazonaws.ssooidc#InvalidRequestException":throw await Mp(r);case"SlowDownException":case"com.amazonaws.ssooidc#SlowDownException":throw await Kp(r);case"UnauthorizedClientException":case"com.amazonaws.ssooidc#UnauthorizedClientException":throw await Fp(r);default:const t=r.body;return Ip({output:e,parsedBody:t,errorCode:n})}},Ip=hi(mp),Tp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new yp({$metadata:zp(e),...r});return ui(s,e.body)},Pp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new gp({$metadata:zp(e),...r});return ui(s,e.body)},Bp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new vp({$metadata:zp(e),...r});return ui(s,e.body)},Dp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new bp({$metadata:zp(e),...r});return ui(s,e.body)},$p=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new wp({$metadata:zp(e),...r});return ui(s,e.body)},Lp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new Cp({$metadata:zp(e),...r});return ui(s,e.body)},jp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new _p({$metadata:zp(e),...r});return ui(s,e.body)},Mp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new Sp({$metadata:zp(e),...r});return ui(s,e.body)},Up=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new Ep({$metadata:zp(e),...r});return ui(s,e.body)},Kp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new Ap({$metadata:zp(e),...r});return ui(s,e.body)},Fp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new kp({$metadata:zp(e),...r});return ui(s,e.body)},Hp=async(e,t)=>{const r=ki({}),n=e.body,i=xi(n,{error:$n,error_description:$n});Object.assign(r,i);const s=new xp({$metadata:zp(e),...r});return ui(s,e.body)},zp=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Vp=(e,t)=>((e,t)=>Sn(e,t).then((e=>t.utf8Encoder(e))))(e,t).then((e=>e.length?JSON.parse(e):{})),qp=async(e,t)=>{const r=await Vp(e,t);return r.message=r.message??r.Message,r},Gp=(e,t)=>{const r=e=>{let t=e;return"number"==typeof t&&(t=t.toString()),t.indexOf(",")>=0&&(t=t.split(",")[0]),t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},n=((e,t)=>Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase())))(e.headers,"x-amzn-errortype");return void 0!==n?r(e.headers[n]):void 0!==t.code?r(t.code):void 0!==t.__type?r(t.__type):void 0},Wp=class e extends En{constructor(e){super(),this.input=e}static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}resolveMiddleware(t,r,n){this.middlewareStack.use(Oa(r,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(r,e.getEndpointParameterInstructions()));const i=t.concat(this.middlewareStack),{logger:s}=r,o={logger:s,clientName:"SSOOIDCClient",commandName:"CreateTokenCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e},{requestHandler:a}=r;return i.resolve((e=>a.handle(e.request,n||{})),o)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=`${s?.endsWith("/")?s.slice(0,-1):s||""}/token`;let a;return a=JSON.stringify(xi(e,{clientId:[],clientSecret:[],code:[],deviceCode:[],grantType:[],redirectUri:[],refreshToken:[],scope:e=>Ti(e)})),new $r({protocol:n,hostname:r,port:i,method:"POST",headers:{"content-type":"application/json"},path:o,body:a})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Rp(e,t);const r=ki({$metadata:zp(e)}),n=Bn(Dn(await Vp(e.body,t)),"body"),i=xi(n,{accessToken:$n,expiresIn:On,idToken:$n,refreshToken:$n,tokenType:$n});return Object.assign(r,i),r})(e,t)}},Xp={CreateTokenCommand:Wp,RegisterClientCommand:class e extends En{constructor(e){super(),this.input=e}static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}resolveMiddleware(t,r,n){this.middlewareStack.use(Oa(r,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(r,e.getEndpointParameterInstructions()));const i=t.concat(this.middlewareStack),{logger:s}=r,o={logger:s,clientName:"SSOOIDCClient",commandName:"RegisterClientCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e},{requestHandler:a}=r;return i.resolve((e=>a.handle(e.request,n||{})),o)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=`${s?.endsWith("/")?s.slice(0,-1):s||""}/client/register`;let a;return a=JSON.stringify(xi(e,{clientName:[],clientType:[],scopes:e=>Ti(e)})),new $r({protocol:n,hostname:r,port:i,method:"POST",headers:{"content-type":"application/json"},path:o,body:a})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Op(e,t);const r=ki({$metadata:zp(e)}),n=Bn(Dn(await Vp(e.body,t)),"body"),i=xi(n,{authorizationEndpoint:$n,clientId:$n,clientIdIssuedAt:Rn,clientSecret:$n,clientSecretExpiresAt:Rn,tokenEndpoint:$n});return Object.assign(r,i),r})(e,t)}},StartDeviceAuthorizationCommand:class e extends En{constructor(e){super(),this.input=e}static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}resolveMiddleware(t,r,n){this.middlewareStack.use(Oa(r,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(r,e.getEndpointParameterInstructions()));const i=t.concat(this.middlewareStack),{logger:s}=r,o={logger:s,clientName:"SSOOIDCClient",commandName:"StartDeviceAuthorizationCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e},{requestHandler:a}=r;return i.resolve((e=>a.handle(e.request,n||{})),o)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=`${s?.endsWith("/")?s.slice(0,-1):s||""}/device_authorization`;let a;return a=JSON.stringify(xi(e,{clientId:[],clientSecret:[],startUrl:[]})),new $r({protocol:n,hostname:r,port:i,method:"POST",headers:{"content-type":"application/json"},path:o,body:a})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Np(e,t);const r=ki({$metadata:zp(e)}),n=Bn(Dn(await Vp(e.body,t)),"body"),i=xi(n,{deviceCode:$n,expiresIn:On,interval:On,userCode:$n,verificationUri:$n,verificationUriComplete:$n});return Object.assign(r,i),r})(e,t)}}};((e,t)=>{for(const r of Object.keys(e)){const n=e[r],i=async function(e,t,r){const i=new n(e);if("function"==typeof t)this.send(i,t);else{if("function"!=typeof r)return this.send(i,t);if("object"!=typeof t)throw new Error("Expected http options but got "+typeof t);this.send(i,t||{},r)}},s=(r[0].toLowerCase()+r.slice(1)).replace(/Command$/,"");t.prototype[s]=i}})(Xp,class extends dp{});const Jp="To refresh this SSO session run 'aws sso login' with the corresponding profile.",Yp={},Zp=(e,t)=>{const r=(e=>{if(Yp[e])return Yp[e];const t=new dp({region:e});return Yp[e]=t,t})(t);return r.send(new Wp({clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:e.refreshToken,grantType:"refresh_token"}))},Qp=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new Hi(`Token is expired. ${Jp}`,!1)},ed=(e,t,r=!1)=>{if(void 0===t)throw new Hi(`Value not present for '${e}' in SSO Token${r?". Cannot refresh":""}. ${Jp}`,!1)},{writeFile:td}=v,rd=new Date(0),nd=(e={})=>async()=>{const t=await rh(e),r=Lu(e),n=t[r];if(!n)throw new Hi(`Profile '${r}' could not be found in shared credentials file.`,!1);if(!n.sso_session)throw new Hi(`Profile '${r}' is missing required property 'sso_session'.`);const i=n.sso_session,s=(await th(e))[i];if(!s)throw new Hi(`Sso session '${i}' could not be found in shared credentials file.`,!1);for(const e of["sso_start_url","sso_region"])if(!s[e])throw new Hi(`Sso session '${i}' is missing required property '${e}'.`,!1);s.sso_start_url;const o=s.sso_region;let a;try{a=await Uu(i)}catch(e){throw new Hi(`The SSO session token associated with profile=${r} was not found or is invalid. ${Jp}`,!1)}ed("accessToken",a.accessToken),ed("expiresAt",a.expiresAt);const{accessToken:c,expiresAt:l}=a,u={token:c,expiration:new Date(l)};if(u.expiration.getTime()-Date.now()>3e5)return u;if(Date.now()-rd.getTime()<3e4)return Qp(u),u;ed("clientId",a.clientId,!0),ed("clientSecret",a.clientSecret,!0),ed("refreshToken",a.refreshToken,!0);try{rd.setTime(Date.now());const e=await Zp(a,o);ed("accessToken",e.accessToken),ed("expiresIn",e.expiresIn);const t=new Date(Date.now()+1e3*e.expiresIn);try{await((e,t)=>{const r=ju(e),n=JSON.stringify(t,null,2);return td(r,n)})(i,{...a,accessToken:e.accessToken,expiresAt:t.toISOString(),refreshToken:e.refreshToken})}catch(e){}return{token:e.accessToken,expiration:t}}catch(e){return Qp(u),u}},id=!1,sd=async({ssoStartUrl:e,ssoSession:t,ssoAccountId:r,ssoRegion:n,ssoRoleName:i,ssoClient:s,profile:o})=>{let a;const c="To refresh this SSO session run aws sso login with the corresponding profile.";if(t)try{const e=await nd({profile:o})();a={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new Fi(e.message,id)}else try{a=await Uu(e)}catch(e){throw new Fi(`The SSO session associated with this profile is invalid. ${c}`,id)}if(new Date(a.expiresAt).getTime()-Date.now()<=0)throw new Fi(`The SSO session associated with this profile has expired. ${c}`,id);const{accessToken:l}=a,u=s||new Af({region:n});let h;try{h=await u.send(new zf({accountId:r,roleName:i,accessToken:l}))}catch(e){throw Fi.from(e,id)}const{roleCredentials:{accessKeyId:f,secretAccessKey:p,sessionToken:d,expiration:m}={}}=h;if(!(f&&p&&d&&m))throw new Fi("SSO returns an invalid temporary credential.",id);return{accessKeyId:f,secretAccessKey:p,sessionToken:d,expiration:new Date(m)}},od=e=>{const{sso_start_url:t,sso_account_id:r,sso_region:n,sso_role_name:i}=e;if(!(t&&r&&n&&i))throw new Fi(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}\nReference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,!1);return e},ad=(e={})=>async()=>{const{ssoStartUrl:t,ssoAccountId:r,ssoRegion:n,ssoRoleName:i,ssoClient:s,ssoSession:o}=e,a=Lu(e);if(t||r||n||i||o){if(t&&r&&n&&i)return sd({ssoStartUrl:t,ssoSession:o,ssoAccountId:r,ssoRegion:n,ssoRoleName:i,ssoClient:s,profile:a});throw new Fi('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"')}{const r=(await rh(e))[a];if(!r)throw new Fi(`Profile ${a} was not found.`);if(!Lh(r))throw new Fi(`Profile ${a} is not configured with SSO credentials.`);if(r?.sso_session){const i=(await th(e))[r.sso_session],s=` configurations in profile ${a} and sso-session ${r.sso_session}`;if(n&&n!==i.sso_region)throw new Fi("Conflicting SSO region"+s,!1);if(t&&t!==i.sso_start_url)throw new Fi("Conflicting SSO start_url"+s,!1);r.sso_region=i.sso_region,r.sso_start_url=i.sso_start_url}const{sso_start_url:i,sso_account_id:o,sso_region:c,sso_role_name:l,sso_session:u}=od(r);return sd({ssoStartUrl:i,ssoSession:u,ssoAccountId:o,ssoRegion:c,ssoRoleName:l,ssoClient:s,profile:a})}},cd=e=>Boolean(e)&&"object"==typeof e&&"string"==typeof e.aws_access_key_id&&"string"==typeof e.aws_secret_access_key&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1,ld=e=>Promise.resolve({accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token}),ud=(e={})=>async()=>{const t=e?.webIdentityTokenFile??process.env.AWS_WEB_IDENTITY_TOKEN_FILE,r=e?.roleArn??process.env.AWS_ROLE_ARN,n=e?.roleSessionName??process.env.AWS_ROLE_SESSION_NAME;if(!t||!r)throw new Fi("Web identity configuration not specified");return(e=>()=>{const{roleArn:t,roleSessionName:r,webIdentityToken:n,providerId:i,policyArns:s,policy:o,durationSeconds:a,roleAssumerWithWebIdentity:c}=e;if(!c)throw new Fi(`Role Arn '${t}' needs to be assumed with web identity, but no role assumption callback was provided.`,!1);return c({RoleArn:t,RoleSessionName:r??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:n,ProviderId:i,PolicyArns:s,Policy:o,DurationSeconds:a})})({...e,webIdentityToken:_(t,{encoding:"ascii"}),roleArn:r,roleSessionName:n})()},hd=async(e,t,r,n={})=>{const i=t[e];if(Object.keys(n).length>0&&cd(i))return ld(i);if(s=i,Boolean(s)&&"object"==typeof s&&"string"==typeof s.role_arn&&["undefined","string"].indexOf(typeof s.role_session_name)>-1&&["undefined","string"].indexOf(typeof s.external_id)>-1&&["undefined","string"].indexOf(typeof s.mfa_serial)>-1&&(Th(s)||Ph(s)))return Bh(e,t,r,n);var s;if(cd(i))return ld(i);if((e=>Boolean(e)&&"object"==typeof e&&"string"==typeof e.web_identity_token_file&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1)(i))return(async(e,t)=>ud({webIdentityTokenFile:e.web_identity_token_file,roleArn:e.role_arn,roleSessionName:e.role_session_name,roleAssumerWithWebIdentity:t.roleAssumerWithWebIdentity})())(i,r);if((e=>Boolean(e)&&"object"==typeof e&&"string"==typeof e.credential_process)(i))return(async(e,t)=>$h({...e,profile:t})())(r,e);if(Lh(i))return(e=>{const{sso_start_url:t,sso_account_id:r,sso_session:n,sso_region:i,sso_role_name:s}=od(e);return ad({ssoStartUrl:t,ssoAccountId:r,ssoSession:n,ssoRegion:i,ssoRoleName:s})()})(i);throw new Fi(`Profile ${e} could not be found or parsed in shared credentials file.`)},fd=(e={})=>Vi(zi(...e.profile||process.env[$u]?[]:[Pu()],ad(e),((e={})=>async()=>{const t=await rh(e);return hd(Lu(e),t,e)})(e),$h(e),ud(e),(e=>process.env[lh]||process.env[ch]?hh(e):process.env.AWS_EC2_METADATA_DISABLED?async()=>{throw new Fi("EC2 Instance Metadata Service access disabled")}:Ch(e))(e),(async()=>{throw new Fi("Could not load credentials from any providers",!1)})),(e=>void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5),(e=>void 0!==e.expiration)),pd="required",dd="type",md="fn",yd="argv",gd="ref",vd="booleanEquals",bd="tree",wd="stringEquals",_d="sigv4",Sd="us-east-1",Ed="endpoint",Ad="https://sts.{Region}.{PartitionResult#dnsSuffix}",kd="error",xd="getAttr",Cd={[pd]:!1,[dd]:"String"},Rd={[pd]:!0,default:!1,[dd]:"Boolean"},Od={[gd]:"Endpoint"},Nd={[md]:"isSet",[yd]:[{[gd]:"Region"}]},Id={[gd]:"Region"},Td={[md]:"aws.partition",[yd]:[Id],assign:"PartitionResult"},Pd={[gd]:"UseFIPS"},Bd={[gd]:"UseDualStack"},Dd={url:"https://sts.amazonaws.com",properties:{authSchemes:[{name:_d,signingName:"sts",signingRegion:Sd}]},headers:{}},$d={},Ld={conditions:[{[md]:wd,[yd]:[Id,"aws-global"]}],[Ed]:Dd,[dd]:Ed},jd={[md]:vd,[yd]:[Pd,!0]},Md={[md]:vd,[yd]:[Bd,!0]},Ud={[md]:vd,[yd]:[!0,{[md]:xd,[yd]:[{[gd]:"PartitionResult"},"supportsFIPS"]}]},Kd={[gd]:"PartitionResult"},Fd={[md]:vd,[yd]:[!0,{[md]:xd,[yd]:[Kd,"supportsDualStack"]}]},Hd=[{[md]:"isSet",[yd]:[Od]}],zd=[jd],Vd=[Md],qd={version:"1.0",parameters:{Region:Cd,UseDualStack:Rd,UseFIPS:Rd,Endpoint:Cd,UseGlobalEndpoint:Rd},rules:[{conditions:[{[md]:vd,[yd]:[{[gd]:"UseGlobalEndpoint"},!0]},{[md]:"not",[yd]:Hd},Nd,Td,{[md]:vd,[yd]:[Pd,false]},{[md]:vd,[yd]:[Bd,false]}],[dd]:bd,rules:[{conditions:[{[md]:wd,[yd]:[Id,"ap-northeast-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"ap-south-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"ap-southeast-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"ap-southeast-2"]}],endpoint:Dd,[dd]:Ed},Ld,{conditions:[{[md]:wd,[yd]:[Id,"ca-central-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"eu-central-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"eu-north-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"eu-west-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"eu-west-2"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"eu-west-3"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"sa-east-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,Sd]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"us-east-2"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"us-west-1"]}],endpoint:Dd,[dd]:Ed},{conditions:[{[md]:wd,[yd]:[Id,"us-west-2"]}],endpoint:Dd,[dd]:Ed},{endpoint:{url:Ad,properties:{authSchemes:[{name:_d,signingName:"sts",signingRegion:"{Region}"}]},headers:$d},[dd]:Ed}]},{conditions:Hd,[dd]:bd,rules:[{conditions:zd,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[dd]:kd},{conditions:Vd,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[dd]:kd},{endpoint:{url:Od,properties:$d,headers:$d},[dd]:Ed}]},{conditions:[Nd],[dd]:bd,rules:[{conditions:[Td],[dd]:bd,rules:[{conditions:[jd,Md],[dd]:bd,rules:[{conditions:[Ud,Fd],[dd]:bd,rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:$d,headers:$d},[dd]:Ed}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[dd]:kd}]},{conditions:zd,[dd]:bd,rules:[{conditions:[Ud],[dd]:bd,rules:[{conditions:[{[md]:wd,[yd]:["aws-us-gov",{[md]:xd,[yd]:[Kd,"name"]}]}],endpoint:{url:"https://sts.{Region}.amazonaws.com",properties:$d,headers:$d},[dd]:Ed},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",properties:$d,headers:$d},[dd]:Ed}]},{error:"FIPS is enabled but this partition does not support FIPS",[dd]:kd}]},{conditions:Vd,[dd]:bd,rules:[{conditions:[Fd],[dd]:bd,rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:$d,headers:$d},[dd]:Ed}]},{error:"DualStack is enabled but this partition does not support DualStack",[dd]:kd}]},Ld,{endpoint:{url:Ad,properties:$d,headers:$d},[dd]:Ed}]}]},{error:"Invalid Configuration: Missing Region",[dd]:kd}]},Gd=(e,t={})=>Yo(qd,{endpointParams:e,logger:t.logger}),Wd=e=>{mi(process.version);const t=vf(e),r=()=>t().then(pi),n=(e=>({apiVersion:"2011-06-15",base64Decoder:e?.base64Decoder??sn,base64Encoder:e?.base64Encoder??on,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??Gd,extensions:e?.extensions??[],logger:e?.logger??new Gr,serviceId:e?.serviceId??"STS",urlParser:e?.urlParser??ka,utf8Decoder:e?.utf8Decoder??an,utf8Encoder:e?.utf8Encoder??ln}))(e);return{...n,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??Fh,credentialDefaultProvider:e?.credentialDefaultProvider??(i=fd,e=>i({roleAssumer:Iu(e,e.stsClientCtor),roleAssumerWithWebIdentity:Tu(e,e.stsClientCtor),...e})),defaultUserAgentProvider:e?.defaultUserAgentProvider??Mh({serviceId:n.serviceId,clientVersion:fc}),maxAttempts:e?.maxAttempts??gh(rc),region:e?.region??gh(la,ua),requestHandler:e?.requestHandler??new gn(r),retryMode:e?.retryMode??gh({...ic,default:async()=>(await r()).retryMode||Ba}),sha256:e?.sha256??Uh.bind(null,"sha256"),streamCollector:e?.streamCollector??bn,useDualstackEndpoint:e?.useDualstackEndpoint??gh(aa),useFipsEndpoint:e?.useFipsEndpoint??gh(ca)};var i};class Xd extends Qr{constructor(...[e]){const t=Wd(e||{}),r=(n=t,{...n,useDualstackEndpoint:n.useDualstackEndpoint??!1,useFipsEndpoint:n.useFipsEndpoint??!1,useGlobalEndpoint:n.useGlobalEndpoint??!1,defaultSigningName:"sts"});var n;const i=pa(r),s=Ta(i),o=((e,t)=>{const r={...Sf(e),...wi(e),...Rr(e)};return t.forEach((e=>e.configure(r))),{...e,...Ef(r),..._i(r),...Or(r)}})(bo(((e,{stsClientCtor:t})=>ho({...e,stsClientCtor:t}))(nc(s),{stsClientCtor:Xd})),e?.extensions||[]);super(o),this.config=o,this.middlewareStack.use(lc(this.config)),this.middlewareStack.use(ya(this.config)),this.middlewareStack.use(Kr(this.config)),this.middlewareStack.use(Hr(this.config)),this.middlewareStack.use(qr(this.config)),this.middlewareStack.use(ia(this.config))}destroy(){super.destroy()}}const Jd=(e,t)=>t?class extends e{constructor(e){super(e);for(const e of t)this.middlewareStack.use(e)}}:e,Yd=(e={},t)=>Iu(e,Jd(Xd,t)),Zd=(e={},t)=>Tu(e,Jd(Xd,t)),Qd={environmentVariableSelector:e=>oa(e,"AWS_S3_USE_ARN_REGION",sa.ENV),configFileSelector:e=>oa(e,"s3_use_arn_region",sa.CONFIG),default:!1};function em(e,t){return async function(r){const{value:n}=r.headers[":message-type"];if("error"===n){const e=new Error(r.headers[":error-message"].value||"UnknownError");throw e.name=r.headers[":error-code"].value,e}if("exception"===n){const n=r.headers[":exception-type"].value,i={[n]:r},s=await e(i);if(s.$unknown){const e=new Error(t(r.body));throw e.name=n,e}throw s[n]}if("event"===n){const t={[r.headers[":event-type"].value]:r},n=await e(t);if(n.$unknown)return;return n}throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}class tm{constructor({utf8Encoder:e,utf8Decoder:t}){this.universalMarshaller=new class{constructor({utf8Encoder:e,utf8Decoder:t}){this.eventStreamCodec=new Is(e,t),this.utfEncoder=e}deserialize(e,t){const r=function(e){let t=0,r=0,n=null,i=null;const s=e=>{if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);t=e,r=4,n=new Uint8Array(e),new DataView(n.buffer).setUint32(0,e,!1)};return{[Symbol.asyncIterator]:async function*(){const o=e[Symbol.asyncIterator]();for(;;){const{value:e,done:a}=await o.next();if(a){if(!t)return;if(t!==r)throw new Error("Truncated event message received.");return void(yield n)}const c=e.length;let l=0;for(;l<c;){if(!n){const t=c-l;i||(i=new Uint8Array(4));const n=Math.min(4-r,t);if(i.set(e.slice(l,l+n),r),r+=n,l+=n,r<4)break;s(new DataView(i.buffer).getUint32(0,!1)),i=null}const o=Math.min(t-r,c-l);n.set(e.slice(l,l+o),r),r+=o,l+=o,t&&t===r&&(yield n,n=null,t=0,r=0)}}}}}(e);return new Bs({messageStream:new Ts({inputStream:r,decoder:this.eventStreamCodec}),deserializer:em(t,this.utfEncoder)})}serialize(e,t){return new Ps({messageStream:new Ds({inputStream:e,serializer:t}),encoder:this.eventStreamCodec,includeEndFrame:!0})}}({utf8Decoder:t,utf8Encoder:e})}deserialize(e,t){const r="function"==typeof e[Symbol.asyncIterator]?e:async function*(e){let t=!1,r=!1;const n=new Array;for(e.on("error",(e=>{if(t||(t=!0),e)throw e})),e.on("data",(e=>{n.push(e)})),e.on("end",(()=>{t=!0}));!r;){const e=await new Promise((e=>setTimeout((()=>e(n.shift())),0)));e&&(yield e),r=t&&0===n.length}}(e);return this.universalMarshaller.deserialize(r,t)}serialize(e,t){return c.from(this.universalMarshaller.serialize(e,t))}}const rm=e=>new tm(e);class nm extends l{constructor(e,t){super(t),this.hash=e}_write(e,t,r){try{this.hash.update(cn(e))}catch(e){return r(e)}r()}}const im=(e,t)=>{if(null!==t.readableFlowing)throw new Error("Unable to calculate hash for flowing readable stream");const r=new e,n=new nm(r);return t.pipe(n),new Promise(((e,i)=>{t.on("error",(e=>{n.end(),i(e)})),n.on("error",i),n.on("finish",(()=>{r.digest().then(e).catch(i)}))}))},sm=null;class om{constructor(e){this.sigv4Signer=new co(e),this.signerOptions=e}async sign(e,t={}){if("*"===t.signingRegion){if("node"!==this.signerOptions.runtime)throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(e,t)}return this.sigv4Signer.sign(e,t)}async presign(e,t={}){if("*"===t.signingRegion){if("node"!==this.signerOptions.runtime)throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(e,t)}return this.sigv4Signer.presign(e,t)}getSigv4aSigner(){if(!this.sigv4aSigner){let e=null;try{if(function(){try{if("function"==typeof require){const e=require,t="@aws-sdk/signature-v4-crt";e.call(null,t),process.emitWarning('The package @aws-sdk/signature-v4-crt has been loaded dynamically.\nTo avoid this warning, please explicitly import the package in your application with:\n\nimport "@aws-sdk/signature-v4-crt"; // ESM\nrequire("@aws-sdk/signature-v4-crt"); // CJS\n\nIn a future version of the AWS SDK for JavaScript (v3), this warning\nwill become an error and dynamic loading will not be available.\n\nSee https://github.com/aws/aws-sdk-js-v3/issues/5229.\n')}}catch(e){}}(),e=sm,"function"!=typeof e)throw new Error}catch(e){throw e.message=`${e.message}\nPlease check if you have installed "@aws-sdk/signature-v4-crt" package explicitly. \nFor more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,e}this.sigv4aSigner=new e({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}}const am="required",cm="type",lm="conditions",um="fn",hm="argv",fm="ref",pm="assign",dm="url",mm="properties",ym="authSchemes",gm="disableDoubleEncoding",vm="signingName",bm="signingRegion",wm="headers",_m=!0,Sm="isSet",Em="tree",Am="booleanEquals",km="error",xm="aws.partition",Cm="stringEquals",Rm="getAttr",Om="name",Nm="substring",Im="hardwareType",Tm="regionPrefix",Pm="bucketAliasSuffix",Bm="outpostId",Dm="isValidHostLabel",$m="not",Lm="parseURL",jm="s3-outposts",Mm="endpoint",Um="aws.isVirtualHostableS3Bucket",Km="s3",Fm="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",Hm="{url#scheme}://{Bucket}.{url#authority}{url#path}",zm="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",Vm="https://{Bucket}.s3.{partitionResult#dnsSuffix}",qm="aws.parseArn",Gm="bucketArn",Wm="arnType",Xm="s3-object-lambda",Jm="accesspoint",Ym="accessPointName",Zm="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",Qm="mrapPartition",ey="outpostType",ty="arnPrefix",ry="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",ny="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",iy="{url#scheme}://{url#authority}{url#path}",sy="https://s3.{partitionResult#dnsSuffix}",oy={[am]:!1,[cm]:"String"},ay={[am]:!0,default:!1,[cm]:"Boolean"},cy={[am]:!1,[cm]:"Boolean"},ly={[um]:Am,[hm]:[{[fm]:"Accelerate"},!0]},uy={[um]:Am,[hm]:[{[fm]:"UseFIPS"},!0]},hy={[um]:Am,[hm]:[{[fm]:"UseDualStack"},!0]},fy={[um]:Sm,[hm]:[{[fm]:"Endpoint"}]},py={[um]:xm,[hm]:[{[fm]:"Region"}],[pm]:"partitionResult"},dy={[um]:Cm,[hm]:[{[um]:Rm,[hm]:[{[fm]:"partitionResult"},Om]},"aws-cn"]},my={[um]:Sm,[hm]:[{[fm]:"Bucket"}]},yy={[fm]:"Bucket"},gy={[fm]:Im},vy={[lm]:[{[um]:$m,[hm]:[fy]}],[km]:"Expected a endpoint to be specified but no endpoint was found",[cm]:km},by={[um]:$m,[hm]:[fy]},wy={[um]:Lm,[hm]:[{[fm]:"Endpoint"}],[pm]:"url"},_y={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:jm,[bm]:"{Region}"}]},Sy={},Ey={[um]:Am,[hm]:[{[fm]:"ForcePathStyle"},!1]},Ay={[um]:Am,[hm]:[{[fm]:"Accelerate"},!1]},ky={[um]:Cm,[hm]:[{[fm]:"Region"},"aws-global"]},xy={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Km,[bm]:"us-east-1"}]},Cy={[um]:$m,[hm]:[ky]},Ry={[um]:Am,[hm]:[{[fm]:"UseGlobalEndpoint"},!0]},Oy={[dm]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[mm]:{[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Km,[bm]:"{Region}"}]},[wm]:{}},Ny={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Km,[bm]:"{Region}"}]},Iy={[um]:Am,[hm]:[{[fm]:"UseGlobalEndpoint"},!1]},Ty={[um]:Am,[hm]:[{[fm]:"UseDualStack"},!1]},Py={[dm]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},By={[um]:Am,[hm]:[{[fm]:"UseFIPS"},!1]},Dy={[dm]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},$y={[dm]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},Ly={[um]:Am,[hm]:[{[um]:Rm,[hm]:[{[fm]:"url"},"isIp"]},!0]},jy={[fm]:"url"},My={[um]:Am,[hm]:[{[um]:Rm,[hm]:[jy,"isIp"]},!1]},Uy={[dm]:Fm,[mm]:Ny,[wm]:{}},Ky={[dm]:Hm,[mm]:Ny,[wm]:{}},Fy={[Mm]:Ky,[cm]:Mm},Hy={[dm]:zm,[mm]:Ny,[wm]:{}},zy={[dm]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},Vy={[km]:"Invalid region: region was not a valid DNS name.",[cm]:km},qy={[fm]:Gm},Gy={[fm]:Wm},Wy={[um]:Rm,[hm]:[qy,"service"]},Xy={[fm]:Ym},Jy={[lm]:[hy],[km]:"S3 Object Lambda does not support Dual-stack",[cm]:km},Yy={[lm]:[ly],[km]:"S3 Object Lambda does not support S3 Accelerate",[cm]:km},Zy={[lm]:[{[um]:Sm,[hm]:[{[fm]:"DisableAccessPoints"}]},{[um]:Am,[hm]:[{[fm]:"DisableAccessPoints"},!0]}],[km]:"Access points are not supported for this operation",[cm]:km},Qy={[lm]:[{[um]:Sm,[hm]:[{[fm]:"UseArnRegion"}]},{[um]:Am,[hm]:[{[fm]:"UseArnRegion"},!1]},{[um]:$m,[hm]:[{[um]:Cm,[hm]:[{[um]:Rm,[hm]:[qy,"region"]},"{Region}"]}]}],[km]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[cm]:km},eg={[um]:Rm,[hm]:[{[fm]:"bucketPartition"},Om]},tg={[um]:Rm,[hm]:[qy,"accountId"]},rg={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Xm,[bm]:"{bucketArn#region}"}]},ng={[km]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[cm]:km},ig={[km]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[cm]:km},sg={[km]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[cm]:km},og={[km]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[cm]:km},ag={[km]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[cm]:km},cg={[km]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[cm]:km},lg={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Km,[bm]:"{bucketArn#region}"}]},ug={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:jm,[bm]:"{bucketArn#region}"}]},hg={[um]:qm,[hm]:[yy]},fg={[dm]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:Ny,[wm]:{}},pg={[dm]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:Ny,[wm]:{}},dg={[dm]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:Ny,[wm]:{}},mg={[dm]:ry,[mm]:Ny,[wm]:{}},yg={[dm]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:Ny,[wm]:{}},gg={[fm]:"UseObjectLambdaEndpoint"},vg={[ym]:[{[gm]:!0,[Om]:"sigv4",[vm]:Xm,[bm]:"{Region}"}]},bg={[dm]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},wg={[dm]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},_g={[dm]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},Sg={[dm]:iy,[mm]:Ny,[wm]:{}},Eg={[dm]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[mm]:Ny,[wm]:{}},Ag=[{[fm]:"Region"}],kg=[yy],xg=[{[um]:Dm,[hm]:[{[fm]:Bm},!1]}],Cg=[{[um]:Cm,[hm]:[{[fm]:Tm},"beta"]}],Rg=[fy,wy],Og=[my],Ng=[py],Ig=[{[um]:Dm,[hm]:[{[fm]:"Region"},!1]}],Tg=[{[um]:Cm,[hm]:[{[fm]:"Region"},"us-east-1"]}],Pg=[{[um]:Cm,[hm]:[Gy,Jm]}],Bg=[{[um]:Rm,[hm]:[qy,"resourceId[1]"],[pm]:Ym},{[um]:$m,[hm]:[{[um]:Cm,[hm]:[Xy,""]}]}],Dg=[hy],$g=[ly],Lg=[{[um]:$m,[hm]:[{[um]:Cm,[hm]:[{[um]:Rm,[hm]:[qy,"region"]},""]}]}],jg=[{[um]:$m,[hm]:[{[um]:Sm,[hm]:[{[um]:Rm,[hm]:[qy,"resourceId[2]"]}]}]}],Mg=[{[um]:xm,[hm]:[{[um]:Rm,[hm]:[qy,"region"]}],[pm]:"bucketPartition"}],Ug=[{[um]:Cm,[hm]:[eg,{[um]:Rm,[hm]:[{[fm]:"partitionResult"},Om]}]}],Kg=[{[um]:Dm,[hm]:[{[um]:Rm,[hm]:[qy,"region"]},!0]}],Fg=[{[um]:Dm,[hm]:[tg,!1]}],Hg=[{[um]:Dm,[hm]:[Xy,!1]}],zg=[uy],Vg=[{[um]:Dm,[hm]:[{[fm]:"Region"},!0]}],qg={version:"1.0",parameters:{Bucket:oy,Region:oy,UseFIPS:ay,UseDualStack:ay,Endpoint:oy,ForcePathStyle:ay,Accelerate:ay,UseGlobalEndpoint:ay,UseObjectLambdaEndpoint:cy,DisableAccessPoints:cy,DisableMultiRegionAccessPoints:ay,UseArnRegion:cy},rules:[{[lm]:[{[um]:Sm,[hm]:Ag}],[cm]:Em,rules:[{[lm]:[ly,uy],error:"Accelerate cannot be used with FIPS",[cm]:km},{[lm]:[hy,fy],error:"Cannot set dual-stack in combination with a custom endpoint.",[cm]:km},{[lm]:[fy,uy],error:"A custom endpoint cannot be combined with FIPS",[cm]:km},{[lm]:[fy,ly],error:"A custom endpoint cannot be combined with S3 Accelerate",[cm]:km},{[lm]:[uy,py,dy],error:"Partition does not support FIPS",[cm]:km},{[lm]:[my,{[um]:Nm,[hm]:[yy,49,50,_m],[pm]:Im},{[um]:Nm,[hm]:[yy,8,12,_m],[pm]:Tm},{[um]:Nm,[hm]:[yy,0,7,_m],[pm]:Pm},{[um]:Nm,[hm]:[yy,32,49,_m],[pm]:Bm},{[um]:xm,[hm]:Ag,[pm]:"regionPartition"},{[um]:Cm,[hm]:[{[fm]:Pm},"--op-s3"]}],[cm]:Em,rules:[{[lm]:xg,[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[gy,"e"]}],[cm]:Em,rules:[{[lm]:Cg,[cm]:Em,rules:[vy,{[lm]:Rg,endpoint:{[dm]:"https://{Bucket}.ec2.{url#authority}",[mm]:_y,[wm]:Sy},[cm]:Mm}]},{endpoint:{[dm]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[mm]:_y,[wm]:Sy},[cm]:Mm}]},{[lm]:[{[um]:Cm,[hm]:[gy,"o"]}],[cm]:Em,rules:[{[lm]:Cg,[cm]:Em,rules:[vy,{[lm]:Rg,endpoint:{[dm]:"https://{Bucket}.op-{outpostId}.{url#authority}",[mm]:_y,[wm]:Sy},[cm]:Mm}]},{endpoint:{[dm]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[mm]:_y,[wm]:Sy},[cm]:Mm}]},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[cm]:km}]},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[cm]:km}]},{[lm]:Og,[cm]:Em,rules:[{[lm]:[fy,{[um]:$m,[hm]:[{[um]:Sm,[hm]:[{[um]:Lm,[hm]:[{[fm]:"Endpoint"}]}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[cm]:km},{[lm]:[Ey,{[um]:Um,[hm]:[yy,false]}],[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Ig,[cm]:Em,rules:[{[lm]:[ly,dy],error:"S3 Accelerate cannot be used in this region",[cm]:km},{[lm]:[hy,uy,Ay,by,ky],endpoint:{[dm]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[hy,uy,Ay,by,Cy,Ry],[cm]:Em,rules:[{endpoint:Oy,[cm]:Mm}]},{[lm]:[hy,uy,Ay,by,Cy,Iy],endpoint:Oy,[cm]:Mm},{[lm]:[Ty,uy,Ay,by,ky],endpoint:{[dm]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,uy,Ay,by,Cy,Ry],[cm]:Em,rules:[{endpoint:Py,[cm]:Mm}]},{[lm]:[Ty,uy,Ay,by,Cy,Iy],endpoint:Py,[cm]:Mm},{[lm]:[hy,By,ly,by,ky],endpoint:{[dm]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[hy,By,ly,by,Cy,Ry],[cm]:Em,rules:[{endpoint:Dy,[cm]:Mm}]},{[lm]:[hy,By,ly,by,Cy,Iy],endpoint:Dy,[cm]:Mm},{[lm]:[hy,By,Ay,by,ky],endpoint:{[dm]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[hy,By,Ay,by,Cy,Ry],[cm]:Em,rules:[{endpoint:$y,[cm]:Mm}]},{[lm]:[hy,By,Ay,by,Cy,Iy],endpoint:$y,[cm]:Mm},{[lm]:[Ty,By,Ay,fy,wy,Ly,ky],endpoint:{[dm]:Fm,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,By,Ay,fy,wy,My,ky],endpoint:{[dm]:Hm,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,By,Ay,fy,wy,Ly,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:Uy,[cm]:Mm},{endpoint:Uy,[cm]:Mm}]},{[lm]:[Ty,By,Ay,fy,wy,My,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:Ky,[cm]:Mm},Fy]},{[lm]:[Ty,By,Ay,fy,wy,Ly,Cy,Iy],endpoint:Uy,[cm]:Mm},{[lm]:[Ty,By,Ay,fy,wy,My,Cy,Iy],endpoint:Ky,[cm]:Mm},{[lm]:[Ty,By,ly,by,ky],endpoint:{[dm]:zm,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,By,ly,by,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:Hy,[cm]:Mm},{endpoint:Hy,[cm]:Mm}]},{[lm]:[Ty,By,ly,by,Cy,Iy],endpoint:Hy,[cm]:Mm},{[lm]:[Ty,By,Ay,by,ky],endpoint:{[dm]:Vm,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,By,Ay,by,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:{[dm]:Vm,[mm]:Ny,[wm]:Sy},[cm]:Mm},{endpoint:zy,[cm]:Mm}]},{[lm]:[Ty,By,Ay,by,Cy,Iy],endpoint:zy,[cm]:Mm}]},Vy]}]},{[lm]:[fy,wy,{[um]:Cm,[hm]:[{[um]:Rm,[hm]:[jy,"scheme"]},"http"]},{[um]:Um,[hm]:[yy,_m]},Ey,By,Ty,Ay],[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Ig,[cm]:Em,rules:[Fy]},Vy]}]},{[lm]:[Ey,{[um]:qm,[hm]:kg,[pm]:Gm}],[cm]:Em,rules:[{[lm]:[{[um]:Rm,[hm]:[qy,"resourceId[0]"],[pm]:Wm},{[um]:$m,[hm]:[{[um]:Cm,[hm]:[Gy,""]}]}],[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[Wy,Xm]}],[cm]:Em,rules:[{[lm]:Pg,[cm]:Em,rules:[{[lm]:Bg,[cm]:Em,rules:[Jy,Yy,{[lm]:Lg,[cm]:Em,rules:[Zy,{[lm]:jg,[cm]:Em,rules:[Qy,{[lm]:Mg,[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Ug,[cm]:Em,rules:[{[lm]:Kg,[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[tg,""]}],error:"Invalid ARN: Missing account id",[cm]:km},{[lm]:Fg,[cm]:Em,rules:[{[lm]:Hg,[cm]:Em,rules:[{[lm]:Rg,endpoint:{[dm]:Zm,[mm]:rg,[wm]:Sy},[cm]:Mm},{[lm]:zg,endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:rg,[wm]:Sy},[cm]:Mm},{endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:rg,[wm]:Sy},[cm]:Mm}]},ng]},ig]},sg]},og]}]}]},ag]},{error:"Invalid ARN: bucket ARN is missing a region",[cm]:km}]},cg]},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[cm]:km}]},{[lm]:Pg,[cm]:Em,rules:[{[lm]:Bg,[cm]:Em,rules:[{[lm]:Lg,[cm]:Em,rules:[{[lm]:Pg,[cm]:Em,rules:[{[lm]:Lg,[cm]:Em,rules:[Zy,{[lm]:jg,[cm]:Em,rules:[Qy,{[lm]:Mg,[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[eg,"{partitionResult#name}"]}],[cm]:Em,rules:[{[lm]:Kg,[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[Wy,Km]}],[cm]:Em,rules:[{[lm]:Fg,[cm]:Em,rules:[{[lm]:Hg,[cm]:Em,rules:[{[lm]:$g,error:"Access Points do not support S3 Accelerate",[cm]:km},{[lm]:[uy,hy],endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:lg,[wm]:Sy},[cm]:Mm},{[lm]:[uy,Ty],endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:lg,[wm]:Sy},[cm]:Mm},{[lm]:[By,hy],endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:lg,[wm]:Sy},[cm]:Mm},{[lm]:[By,Ty,fy,wy],endpoint:{[dm]:Zm,[mm]:lg,[wm]:Sy},[cm]:Mm},{[lm]:[By,Ty],endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:lg,[wm]:Sy},[cm]:Mm}]},ng]},ig]},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[cm]:km}]},sg]},og]}]}]},ag]}]}]},{[lm]:[{[um]:Dm,[hm]:[Xy,_m]}],[cm]:Em,rules:[{[lm]:Dg,error:"S3 MRAP does not support dual-stack",[cm]:km},{[lm]:zg,error:"S3 MRAP does not support FIPS",[cm]:km},{[lm]:$g,error:"S3 MRAP does not support S3 Accelerate",[cm]:km},{[lm]:[{[um]:Am,[hm]:[{[fm]:"DisableMultiRegionAccessPoints"},_m]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[cm]:km},{[lm]:[{[um]:xm,[hm]:Ag,[pm]:Qm}],[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[{[um]:Rm,[hm]:[{[fm]:Qm},Om]},{[um]:Rm,[hm]:[qy,"partition"]}]}],[cm]:Em,rules:[{endpoint:{[dm]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[mm]:{[ym]:[{[gm]:_m,name:"sigv4a",[vm]:Km,signingRegionSet:["*"]}]},[wm]:Sy},[cm]:Mm}]},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[cm]:km}]}]},{error:"Invalid Access Point Name",[cm]:km}]},cg]},{[lm]:[{[um]:Cm,[hm]:[Wy,jm]}],[cm]:Em,rules:[{[lm]:Dg,error:"S3 Outposts does not support Dual-stack",[cm]:km},{[lm]:zg,error:"S3 Outposts does not support FIPS",[cm]:km},{[lm]:$g,error:"S3 Outposts does not support S3 Accelerate",[cm]:km},{[lm]:[{[um]:Sm,[hm]:[{[um]:Rm,[hm]:[qy,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[cm]:km},{[lm]:[{[um]:Rm,[hm]:[qy,"resourceId[1]"],[pm]:Bm}],[cm]:Em,rules:[{[lm]:xg,[cm]:Em,rules:[Qy,{[lm]:Mg,[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Ug,[cm]:Em,rules:[{[lm]:Kg,[cm]:Em,rules:[{[lm]:Fg,[cm]:Em,rules:[{[lm]:[{[um]:Rm,[hm]:[qy,"resourceId[2]"],[pm]:ey}],[cm]:Em,rules:[{[lm]:[{[um]:Rm,[hm]:[qy,"resourceId[3]"],[pm]:Ym}],[cm]:Em,rules:[{[lm]:[{[um]:Cm,[hm]:[{[fm]:ey},Jm]}],[cm]:Em,rules:[{[lm]:Rg,endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[mm]:ug,[wm]:Sy},[cm]:Mm},{endpoint:{[dm]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[mm]:ug,[wm]:Sy},[cm]:Mm}]},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[cm]:km}]},{error:"Invalid ARN: expected an access point name",[cm]:km}]},{error:"Invalid ARN: Expected a 4-component resource",[cm]:km}]},ig]},sg]},og]}]}]},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[cm]:km}]},{error:"Invalid ARN: The Outpost Id was not set",[cm]:km}]},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[cm]:km}]},{error:"Invalid ARN: No ARN type specified",[cm]:km}]},{[lm]:[{[um]:Nm,[hm]:[yy,0,4,false],[pm]:ty},{[um]:Cm,[hm]:[{[fm]:ty},"arn:"]},{[um]:$m,[hm]:[{[um]:Sm,[hm]:[hg]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[cm]:km},{[lm]:[{[um]:Am,[hm]:[{[fm]:"ForcePathStyle"},_m]},hg],error:"Path-style addressing cannot be used with ARN buckets",[cm]:km},{[lm]:[{[um]:"uriEncode",[hm]:kg,[pm]:"uri_encoded_bucket"}],[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:[Ay],[cm]:Em,rules:[{[lm]:[hy,by,uy,ky],endpoint:{[dm]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[hy,by,uy,Cy,Ry],[cm]:Em,rules:[{endpoint:fg,[cm]:Mm}]},{[lm]:[hy,by,uy,Cy,Iy],endpoint:fg,[cm]:Mm},{[lm]:[Ty,by,uy,ky],endpoint:{[dm]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,by,uy,Cy,Ry],[cm]:Em,rules:[{endpoint:pg,[cm]:Mm}]},{[lm]:[Ty,by,uy,Cy,Iy],endpoint:pg,[cm]:Mm},{[lm]:[hy,by,By,ky],endpoint:{[dm]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[hy,by,By,Cy,Ry],[cm]:Em,rules:[{endpoint:dg,[cm]:Mm}]},{[lm]:[hy,by,By,Cy,Iy],endpoint:dg,[cm]:Mm},{[lm]:[Ty,fy,wy,By,ky],endpoint:{[dm]:ry,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,fy,wy,By,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:mg,[cm]:Mm},{endpoint:mg,[cm]:Mm}]},{[lm]:[Ty,fy,wy,By,Cy,Iy],endpoint:mg,[cm]:Mm},{[lm]:[Ty,by,By,ky],endpoint:{[dm]:ny,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[Ty,by,By,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:{[dm]:ny,[mm]:Ny,[wm]:Sy},[cm]:Mm},{endpoint:yg,[cm]:Mm}]},{[lm]:[Ty,by,By,Cy,Iy],endpoint:yg,[cm]:Mm}]},{error:"Path-style addressing cannot be used with S3 Accelerate",[cm]:km}]}]}]},{[lm]:[{[um]:Sm,[hm]:[gg]},{[um]:Am,[hm]:[gg,_m]}],[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Vg,[cm]:Em,rules:[Jy,Yy,{[lm]:Rg,endpoint:{[dm]:iy,[mm]:vg,[wm]:Sy},[cm]:Mm},{[lm]:zg,endpoint:{[dm]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[mm]:vg,[wm]:Sy},[cm]:Mm},{endpoint:{[dm]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[mm]:vg,[wm]:Sy},[cm]:Mm}]},Vy]}]},{[lm]:[{[um]:$m,[hm]:Og}],[cm]:Em,rules:[{[lm]:Ng,[cm]:Em,rules:[{[lm]:Vg,[cm]:Em,rules:[{[lm]:[uy,hy,by,ky],endpoint:{[dm]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[uy,hy,by,Cy,Ry],[cm]:Em,rules:[{endpoint:bg,[cm]:Mm}]},{[lm]:[uy,hy,by,Cy,Iy],endpoint:bg,[cm]:Mm},{[lm]:[uy,Ty,by,ky],endpoint:{[dm]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[uy,Ty,by,Cy,Ry],[cm]:Em,rules:[{endpoint:wg,[cm]:Mm}]},{[lm]:[uy,Ty,by,Cy,Iy],endpoint:wg,[cm]:Mm},{[lm]:[By,hy,by,ky],endpoint:{[dm]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[By,hy,by,Cy,Ry],[cm]:Em,rules:[{endpoint:_g,[cm]:Mm}]},{[lm]:[By,hy,by,Cy,Iy],endpoint:_g,[cm]:Mm},{[lm]:[By,Ty,fy,wy,ky],endpoint:{[dm]:iy,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[By,Ty,fy,wy,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:Sg,[cm]:Mm},{endpoint:Sg,[cm]:Mm}]},{[lm]:[By,Ty,fy,wy,Cy,Iy],endpoint:Sg,[cm]:Mm},{[lm]:[By,Ty,by,ky],endpoint:{[dm]:sy,[mm]:xy,[wm]:Sy},[cm]:Mm},{[lm]:[By,Ty,by,Cy,Ry],[cm]:Em,rules:[{[lm]:Tg,endpoint:{[dm]:sy,[mm]:Ny,[wm]:Sy},[cm]:Mm},{endpoint:Eg,[cm]:Mm}]},{[lm]:[By,Ty,by,Cy,Iy],endpoint:Eg,[cm]:Mm}]},Vy]}]}]},{error:"A region must be set when sending requests to S3.",[cm]:km}]},Gg=(e,t={})=>Yo(qg,{endpointParams:e,logger:t.logger}),Wg=e=>{mi(process.version);const t=vf(e),r=()=>t().then(pi),n=(e=>({apiVersion:"2006-03-01",base64Decoder:e?.base64Decoder??sn,base64Encoder:e?.base64Encoder??on,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??Gg,extensions:e?.extensions??[],getAwsChunkedEncodingStream:e?.getAwsChunkedEncodingStream??hn,logger:e?.logger??new Gr,sdkStreamMixin:e?.sdkStreamMixin??_n,serviceId:e?.serviceId??"S3",signerConstructor:e?.signerConstructor??om,signingEscapePath:e?.signingEscapePath??!1,urlParser:e?.urlParser??ka,useArnRegion:e?.useArnRegion??!1,utf8Decoder:e?.utf8Decoder??an,utf8Encoder:e?.utf8Encoder??ln}))(e);return{...n,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??Fh,credentialDefaultProvider:e?.credentialDefaultProvider??(i=fd,e=>i({roleAssumer:Yd(e),roleAssumerWithWebIdentity:Zd(e),...e})),defaultUserAgentProvider:e?.defaultUserAgentProvider??Mh({serviceId:n.serviceId,clientVersion:hc}),eventStreamSerdeProvider:e?.eventStreamSerdeProvider??rm,maxAttempts:e?.maxAttempts??gh(rc),md5:e?.md5??Uh.bind(null,"md5"),region:e?.region??gh(la,ua),requestHandler:e?.requestHandler??new gn(r),retryMode:e?.retryMode??gh({...ic,default:async()=>(await r()).retryMode||Ba}),sha1:e?.sha1??Uh.bind(null,"sha1"),sha256:e?.sha256??Uh.bind(null,"sha256"),streamCollector:e?.streamCollector??bn,streamHasher:e?.streamHasher??im,useArnRegion:e?.useArnRegion??gh(Qd),useDualstackEndpoint:e?.useDualstackEndpoint??gh(aa),useFipsEndpoint:e?.useFipsEndpoint??gh(ca)};var i};class Xg{constructor(e){this.value=e}toString(){return(""+this.value).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#x0D;").replace(/\n/g,"&#x0A;").replace(/\u0085/g,"&#x85;").replace(/\u2028/,"&#x2028;")}}class Jg{static of(e,t,r){const n=new Jg(e);return void 0!==t&&n.addChildNode(new Xg(t)),void 0!==r&&n.withName(r),n}constructor(e,t=[]){this.name=e,this.children=t,this.attributes={}}withName(e){return this.name=e,this}addAttribute(e,t){return this.attributes[e]=t,this}addChildNode(e){return this.children.push(e),this}removeAttribute(e){return delete this.attributes[e],this}toString(){const e=Boolean(this.children.length);let t=`<${this.name}`;const r=this.attributes;for(const e of Object.keys(r)){const i=r[e];null!=i&&(t+=` ${e}="${n=""+i,n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}"`)}var n;return t+(e?`>${this.children.map((e=>e.toString())).join("")}</${this.name}>`:"/>")}}class Yg extends li{constructor(e){super(e),Object.setPrototypeOf(this,Yg.prototype)}}var Zg,Qg,ev,tv;!function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(Zg||(Zg={})),function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.ObjectSizeGreaterThan?t.ObjectSizeGreaterThan(e.ObjectSizeGreaterThan):void 0!==e.ObjectSizeLessThan?t.ObjectSizeLessThan(e.ObjectSizeLessThan):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(Qg||(Qg={})),function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.AccessPointArn?t.AccessPointArn(e.AccessPointArn):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(ev||(ev={})),function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(tv||(tv={}));class rv extends Yg{constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),this.name="InvalidObjectState",this.$fault="client",Object.setPrototypeOf(this,rv.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class nv extends Yg{constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),this.name="NoSuchKey",this.$fault="client",Object.setPrototypeOf(this,nv.prototype)}}const iv=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:An}}),sv=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:An}}),ov=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:An},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:An}}),av=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:An},...e.SSEKMSKeyId&&{SSEKMSKeyId:An},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:An}}),cv=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:An}}),lv=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:An}}),uv=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:An},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:An}}),hv=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:An},...e.SSEKMSKeyId&&{SSEKMSKeyId:An},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:An}});var fv;!function(e){e.visit=(e,t)=>void 0!==e.Records?t.Records(e.Records):void 0!==e.Stats?t.Stats(e.Stats):void 0!==e.Progress?t.Progress(e.Progress):void 0!==e.Cont?t.Cont(e.Cont):void 0!==e.End?t.End(e.End):t._(e.$unknown[0],e.$unknown[1])}(fv||(fv={}));const pv=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:An}}),dv=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:An}}),mv=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body),i=r.body;return Sv({output:e,parsedBody:i,errorCode:n})},yv=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body),i=r.body;return Sv({output:e,parsedBody:i,errorCode:n})},gv=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return vv(e,t);const r=ki({$metadata:Ov(e),DeleteMarker:[()=>void 0!==e.headers["x-amz-delete-marker"],()=>kn(e.headers["x-amz-delete-marker"])],AcceptRanges:[,e.headers["accept-ranges"]],Expiration:[,e.headers["x-amz-expiration"]],Restore:[,e.headers["x-amz-restore"]],LastModified:[()=>void 0!==e.headers["last-modified"],()=>Bn(Yn(e.headers["last-modified"]))],ContentLength:[()=>void 0!==e.headers["content-length"],()=>{return t=e.headers["content-length"],Rn("string"==typeof t?jn(t):t);var t}],ETag:[,e.headers.etag],ChecksumCRC32:[,e.headers["x-amz-checksum-crc32"]],ChecksumCRC32C:[,e.headers["x-amz-checksum-crc32c"]],ChecksumSHA1:[,e.headers["x-amz-checksum-sha1"]],ChecksumSHA256:[,e.headers["x-amz-checksum-sha256"]],MissingMeta:[()=>void 0!==e.headers["x-amz-missing-meta"],()=>Mn(e.headers["x-amz-missing-meta"])],VersionId:[,e.headers["x-amz-version-id"]],CacheControl:[,e.headers["cache-control"]],ContentDisposition:[,e.headers["content-disposition"]],ContentEncoding:[,e.headers["content-encoding"]],ContentLanguage:[,e.headers["content-language"]],ContentRange:[,e.headers["content-range"]],ContentType:[,e.headers["content-type"]],Expires:[()=>void 0!==e.headers.expires,()=>Bn(Yn(e.headers.expires))],WebsiteRedirectLocation:[,e.headers["x-amz-website-redirect-location"]],ServerSideEncryption:[,e.headers["x-amz-server-side-encryption"]],SSECustomerAlgorithm:[,e.headers["x-amz-server-side-encryption-customer-algorithm"]],SSECustomerKeyMD5:[,e.headers["x-amz-server-side-encryption-customer-key-md5"]],SSEKMSKeyId:[,e.headers["x-amz-server-side-encryption-aws-kms-key-id"]],BucketKeyEnabled:[()=>void 0!==e.headers["x-amz-server-side-encryption-bucket-key-enabled"],()=>kn(e.headers["x-amz-server-side-encryption-bucket-key-enabled"])],StorageClass:[,e.headers["x-amz-storage-class"]],RequestCharged:[,e.headers["x-amz-request-charged"]],ReplicationStatus:[,e.headers["x-amz-replication-status"]],PartsCount:[()=>void 0!==e.headers["x-amz-mp-parts-count"],()=>Mn(e.headers["x-amz-mp-parts-count"])],TagCount:[()=>void 0!==e.headers["x-amz-tagging-count"],()=>Mn(e.headers["x-amz-tagging-count"])],ObjectLockMode:[,e.headers["x-amz-object-lock-mode"]],ObjectLockRetainUntilDate:[()=>void 0!==e.headers["x-amz-object-lock-retain-until-date"],()=>Bn(Gn(e.headers["x-amz-object-lock-retain-until-date"]))],ObjectLockLegalHoldStatus:[,e.headers["x-amz-object-lock-legal-hold"]],Metadata:[,Object.keys(e.headers).filter((e=>e.startsWith("x-amz-meta-"))).reduce(((t,r)=>(t[r.substring(11)]=e.headers[r],t)),{})]}),n=e.body;return t.sdkStreamMixin(n),r.Body=n,r},vv=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body);switch(n){case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await Ev(r);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await Av(r);default:const t=r.body;return Sv({output:e,parsedBody:t,errorCode:n})}},bv=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body),i=r.body;return Sv({output:e,parsedBody:i,errorCode:n})},wv=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body),i=r.body;return Sv({output:e,parsedBody:i,errorCode:n})},_v=async(e,t)=>{const r={...e,body:await Tv(e.body,t)},n=Pv(e,r.body),i=r.body;return Sv({output:e,parsedBody:i,errorCode:n})},Sv=hi(Yg),Ev=async(e,t)=>{const r=ki({}),n=e.body;void 0!==n.AccessTier&&(r.AccessTier=$n(n.AccessTier)),void 0!==n.StorageClass&&(r.StorageClass=$n(n.StorageClass));const i=new rv({$metadata:Ov(e),...r});return ui(i,e.body)},Av=async(e,t)=>{const r=ki({});e.body;const n=new nv({$metadata:Ov(e),...r});return ui(n,e.body)},kv=(e,t)=>{const r=new Jg("CompletedMultipartUpload");if(null!=e.Parts){xv(e.Parts).map((e=>{e=e.withName("Part"),r.addChildNode(e)}))}return r},xv=(e,t)=>e.filter((e=>null!=e)).map((e=>{const t=((e,t)=>{const r=new Jg("CompletedPart");if(null!=e.ETag){const t=Jg.of("ETag",e.ETag).withName("ETag");r.addChildNode(t)}if(null!=e.ChecksumCRC32){const t=Jg.of("ChecksumCRC32",e.ChecksumCRC32).withName("ChecksumCRC32");r.addChildNode(t)}if(null!=e.ChecksumCRC32C){const t=Jg.of("ChecksumCRC32C",e.ChecksumCRC32C).withName("ChecksumCRC32C");r.addChildNode(t)}if(null!=e.ChecksumSHA1){const t=Jg.of("ChecksumSHA1",e.ChecksumSHA1).withName("ChecksumSHA1");r.addChildNode(t)}if(null!=e.ChecksumSHA256){const t=Jg.of("ChecksumSHA256",e.ChecksumSHA256).withName("ChecksumSHA256");r.addChildNode(t)}if(null!=e.PartNumber){const t=Jg.of("PartNumber",String(e.PartNumber)).withName("PartNumber");r.addChildNode(t)}return r})(e);return t.withName("member")})),Cv=(e,t)=>{const r=new Jg("Tagging");if(null!=e.TagSet){const t=Rv(e.TagSet),n=new Jg("TagSet");t.map((e=>{n.addChildNode(e)})),r.addChildNode(n)}return r},Rv=(e,t)=>e.filter((e=>null!=e)).map((e=>{const t=((e,t)=>{const r=new Jg("Tag");if(null!=e.Key){const t=Jg.of("ObjectKey",e.Key).withName("Key");r.addChildNode(t)}if(null!=e.Value){const t=Jg.of("Value",e.Value).withName("Value");r.addChildNode(t)}return r})(e);return t.withName("Tag")})),Ov=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Nv=e=>!(null==e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size),Iv=(e,t)=>((e,t)=>Sn(e,t).then((e=>t.utf8Encoder(e))))(e,t).then((e=>{if(e.length){const t=new Hl.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(e,t)=>""===t.trim()&&t.includes("\n")?"":void 0});t.addEntity("#xD","\r"),t.addEntity("#10","\n");const r=t.parse(e),n="#text",i=Object.keys(r)[0],s=r[i];return s[n]&&(s[i]=s[n],delete s[n]),Ei(s)}return{}})),Tv=async(e,t)=>{const r=await Iv(e,t);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},Pv=(e,t)=>void 0!==t?.Code?t.Code:404==e.statusCode?"NotFound":void 0;const Bv={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},Dv=e=>({applyToStack:t=>{var r;t.add((r=e,e=>async t=>{let n={...t.input};const i=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const e of i){const t=n[e.target];if(t){const i=ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):"string"==typeof t?r.utf8Decoder(t):new Uint8Array(t),s=r.base64Encoder(i),o=new r.md5;o.update(i),n={...n,[e.target]:s,[e.hash]:r.base64Encoder(await o.digest())}}}return e({...t,input:n})}),Bv)}});class $v extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,$v.getEndpointParameterInstructions())),this.middlewareStack.use(ji(t)),this.middlewareStack.use(Dv(t));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"CompleteMultipartUploadCommand",inputFilterSensitiveLog:sv,outputFilterSensitiveLog:iv,[Br]:{service:"AmazonS3",operation:"CompleteMultipartUpload"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"content-type":"application/xml","x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-checksum-crc32c":e.ChecksumCRC32C,"x-amz-checksum-sha1":e.ChecksumSHA1,"x-amz-checksum-sha256":e.ChecksumSHA256,"x-amz-request-payer":e.RequestPayer,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"x-amz-server-side-encryption-customer-algorithm":e.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":e.SSECustomerKey,"x-amz-server-side-encryption-customer-key-md5":e.SSECustomerKeyMD5});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({"x-id":[,"CompleteMultipartUpload"],uploadId:[,Bn(e.UploadId,"UploadId")]});let l,u;return void 0!==e.MultipartUpload&&(l=kv(e.MultipartUpload)),void 0!==e.MultipartUpload&&(u=kv(e.MultipartUpload),u=u.withName("CompleteMultipartUpload"),l='<?xml version="1.0" encoding="UTF-8"?>',u.addAttribute("xmlns","http://s3.amazonaws.com/doc/2006-03-01/"),l+=u.toString()),new $r({protocol:n,hostname:r,port:i,method:"POST",headers:o,path:a,query:c,body:l})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return mv(e,t);const r=ki({$metadata:Ov(e),Expiration:[,e.headers["x-amz-expiration"]],ServerSideEncryption:[,e.headers["x-amz-server-side-encryption"]],VersionId:[,e.headers["x-amz-version-id"]],SSEKMSKeyId:[,e.headers["x-amz-server-side-encryption-aws-kms-key-id"]],BucketKeyEnabled:[()=>void 0!==e.headers["x-amz-server-side-encryption-bucket-key-enabled"],()=>kn(e.headers["x-amz-server-side-encryption-bucket-key-enabled"])],RequestCharged:[,e.headers["x-amz-request-charged"]]}),n=Bn(Dn(await Iv(e.body,t)),"body");return void 0!==n.Bucket&&(r.Bucket=$n(n.Bucket)),void 0!==n.ChecksumCRC32&&(r.ChecksumCRC32=$n(n.ChecksumCRC32)),void 0!==n.ChecksumCRC32C&&(r.ChecksumCRC32C=$n(n.ChecksumCRC32C)),void 0!==n.ChecksumSHA1&&(r.ChecksumSHA1=$n(n.ChecksumSHA1)),void 0!==n.ChecksumSHA256&&(r.ChecksumSHA256=$n(n.ChecksumSHA256)),void 0!==n.ETag&&(r.ETag=$n(n.ETag)),void 0!==n.Key&&(r.Key=$n(n.Key)),void 0!==n.Location&&(r.Location=$n(n.Location)),r})(e,t)}}class Lv extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,Lv.getEndpointParameterInstructions())),this.middlewareStack.use(Dv(t));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"CreateMultipartUploadCommand",inputFilterSensitiveLog:av,outputFilterSensitiveLog:ov,[Br]:{service:"AmazonS3",operation:"CreateMultipartUpload"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"x-amz-acl":e.ACL,"cache-control":e.CacheControl,"content-disposition":e.ContentDisposition,"content-encoding":e.ContentEncoding,"content-language":e.ContentLanguage,"content-type":e.ContentType,expires:[()=>Nv(e.Expires),()=>Vn(e.Expires).toString()],"x-amz-grant-full-control":e.GrantFullControl,"x-amz-grant-read":e.GrantRead,"x-amz-grant-read-acp":e.GrantReadACP,"x-amz-grant-write-acp":e.GrantWriteACP,"x-amz-server-side-encryption":e.ServerSideEncryption,"x-amz-storage-class":e.StorageClass,"x-amz-website-redirect-location":e.WebsiteRedirectLocation,"x-amz-server-side-encryption-customer-algorithm":e.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":e.SSECustomerKey,"x-amz-server-side-encryption-customer-key-md5":e.SSECustomerKeyMD5,"x-amz-server-side-encryption-aws-kms-key-id":e.SSEKMSKeyId,"x-amz-server-side-encryption-context":e.SSEKMSEncryptionContext,"x-amz-server-side-encryption-bucket-key-enabled":[()=>Nv(e.BucketKeyEnabled),()=>e.BucketKeyEnabled.toString()],"x-amz-request-payer":e.RequestPayer,"x-amz-tagging":e.Tagging,"x-amz-object-lock-mode":e.ObjectLockMode,"x-amz-object-lock-retain-until-date":[()=>Nv(e.ObjectLockRetainUntilDate),()=>(e.ObjectLockRetainUntilDate.toISOString().split(".")[0]+"Z").toString()],"x-amz-object-lock-legal-hold":e.ObjectLockLegalHoldStatus,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"x-amz-checksum-algorithm":e.ChecksumAlgorithm,...void 0!==e.Metadata&&Object.keys(e.Metadata).reduce(((t,r)=>(t[`x-amz-meta-${r.toLowerCase()}`]=e.Metadata[r],t)),{})});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({uploads:[,""],"x-id":[,"CreateMultipartUpload"]});return new $r({protocol:n,hostname:r,port:i,method:"POST",headers:o,path:a,query:c,body:void 0})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return yv(e,t);const r=ki({$metadata:Ov(e),AbortDate:[()=>void 0!==e.headers["x-amz-abort-date"],()=>Bn(Yn(e.headers["x-amz-abort-date"]))],AbortRuleId:[,e.headers["x-amz-abort-rule-id"]],ServerSideEncryption:[,e.headers["x-amz-server-side-encryption"]],SSECustomerAlgorithm:[,e.headers["x-amz-server-side-encryption-customer-algorithm"]],SSECustomerKeyMD5:[,e.headers["x-amz-server-side-encryption-customer-key-md5"]],SSEKMSKeyId:[,e.headers["x-amz-server-side-encryption-aws-kms-key-id"]],SSEKMSEncryptionContext:[,e.headers["x-amz-server-side-encryption-context"]],BucketKeyEnabled:[()=>void 0!==e.headers["x-amz-server-side-encryption-bucket-key-enabled"],()=>kn(e.headers["x-amz-server-side-encryption-bucket-key-enabled"])],RequestCharged:[,e.headers["x-amz-request-charged"]],ChecksumAlgorithm:[,e.headers["x-amz-checksum-algorithm"]]}),n=Bn(Dn(await Iv(e.body,t)),"body");return void 0!==n.Bucket&&(r.Bucket=$n(n.Bucket)),void 0!==n.Key&&(r.Key=$n(n.Key)),void 0!==n.UploadId&&(r.UploadId=$n(n.UploadId)),r})(e,t)}}var jv,Mv;!function(e){e.MD5="MD5",e.CRC32="CRC32",e.CRC32C="CRC32C",e.SHA1="SHA1",e.SHA256="SHA256"}(jv||(jv={})),function(e){e.HEADER="header",e.TRAILER="trailer"}(Mv||(Mv={}));const Uv=[jv.CRC32,jv.CRC32C,jv.SHA1,jv.SHA256],Kv=[jv.CRC32,jv.CRC32C,jv.SHA1,jv.SHA256],Fv=e=>e===jv.MD5?"content-md5":`x-amz-checksum-${e.toLowerCase()}`,Hv=e=>void 0!==e&&"string"!=typeof e&&!ArrayBuffer.isView(e)&&!en(e);var zv,Vv,qv={},Gv={};function Wv(){return Vv||(Vv=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AwsCrc32c=e.Crc32c=e.crc32c=void 0;var t=Qi,r=es;e.crc32c=function(e){return(new n).update(e).digest()};var n=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var r,n;try{for(var s=t.__values(e),o=s.next();!o.done;o=s.next()){var a=o.value;this.checksum=this.checksum>>>8^i[255&(this.checksum^a)]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();e.Crc32c=n;var i=(0,r.uint32ArrayFrom)([0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697]),s=function(){if(zv)return Gv;zv=1,Object.defineProperty(Gv,"__esModule",{value:!0}),Gv.AwsCrc32c=void 0;var e=Qi,t=es,r=Wv(),n=function(){function n(){this.crc32c=new r.Crc32c}return n.prototype.update=function(e){(0,t.isEmptyData)(e)||this.crc32c.update((0,t.convertToBuffer)(e))},n.prototype.digest=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,(0,t.numToUint8)(this.crc32c.digest())]}))}))},n.prototype.reset=function(){this.crc32c=new r.Crc32c},n}();return Gv.AwsCrc32c=n,Gv}();Object.defineProperty(e,"AwsCrc32c",{enumerable:!0,get:function(){return s.AwsCrc32c}})}(qv)),qv}var Xv=Wv();const Jv=(e,t)=>({[jv.MD5]:t.md5,[jv.CRC32]:ps.AwsCrc32,[jv.CRC32C]:Xv.AwsCrc32c,[jv.SHA1]:t.sha1,[jv.SHA256]:t.sha256}[e]),Yv=(e,t)=>{const r=new e;return r.update(cn(t||"")),r.digest()},Zv=(e,t)=>r=>async n=>{if(!$r.isInstance(n.request))return r(n);const{request:i}=n,{body:s,headers:o}=i,{base64Encoder:a,streamHasher:c}=e,{input:l,requestChecksumRequired:u,requestAlgorithmMember:h}=t,f=((e,{requestChecksumRequired:t,requestAlgorithmMember:r})=>{if(!r||!e[r])return t?jv.MD5:void 0;const n=e[r];if(!Uv.includes(n))throw new Error(`The checksum algorithm "${n}" is not supported by the client. Select one of ${Uv}.`);return n})(l,{requestChecksumRequired:u,requestAlgorithmMember:h});let p=s,d=o;if(f){const t=Fv(f),r=Jv(f,e);if(Hv(s)){const{getAwsChunkedEncodingStream:n,bodyLengthChecker:i}=e;p=n(s,{base64Encoder:a,bodyLengthChecker:i,checksumLocationName:t,checksumAlgorithmFn:r,streamHasher:c}),d={...o,"content-encoding":o["content-encoding"]?`${o["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":o["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":t},delete d["content-length"]}else if(!((e,t)=>{const r=e.toLowerCase();for(const e of Object.keys(t))if(r===e.toLowerCase())return!0;return!1})(t,o)){const e=await Yv(r,s);d={...o,[t]:a(e)}}}return await r({...n,request:{...i,headers:d,body:p}})};function Qv(e){const t=new u;return t.push(e),t.push(null),t}const eb=async(e,{streamHasher:t,checksumAlgorithmFn:r,base64Encoder:n})=>{const i=Hv(e)?t(r,e):Yv(r,e);return n(await i)},tb=async(e,{config:t,responseAlgorithms:r})=>{const n=((e=[])=>{const t=[];for(const r of Kv)e.includes(r)&&Uv.includes(r)&&t.push(r);return t})(r),{body:i,headers:s}=e;for(const e of n){const r=Fv(e),n=s[r];if(n){const s=Jv(e,t),{streamHasher:o,base64Encoder:a}=t,c=await eb(i,{streamHasher:o,checksumAlgorithmFn:s,base64Encoder:a});if(c===n)break;throw new Error(`Checksum mismatch: expected "${c}" but received "${n}" in response header "${r}".`)}}},rb={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},nb={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},ib=(e,t)=>({applyToStack:r=>{r.add(Zv(e,t),nb),r.addRelativeTo(((e,t)=>r=>async n=>{if(!$r.isInstance(n.request))return r(n);const i=n.input,s=await r(n),o=s.response;let a;const{requestValidationModeMember:c,responseAlgorithms:l}=t;if(c&&"ENABLED"===i[c]){const t=Hv(o.body);t&&(a=await e.streamCollector(o.body),o.body=Qv(a)),await tb(s.response,{config:e,responseAlgorithms:l}),t&&a&&(o.body=Qv(a))}return s})(e,t),rb)}});class sb extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,sb.getEndpointParameterInstructions())),this.middlewareStack.use(Dv(t)),this.middlewareStack.use(ib(t,{input:this.input,requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC32","CRC32C","SHA256","SHA1"]}));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"GetObjectCommand",inputFilterSensitiveLog:lv,outputFilterSensitiveLog:cv,[Br]:{service:"AmazonS3",operation:"GetObject"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"if-match":e.IfMatch,"if-modified-since":[()=>Nv(e.IfModifiedSince),()=>Vn(e.IfModifiedSince).toString()],"if-none-match":e.IfNoneMatch,"if-unmodified-since":[()=>Nv(e.IfUnmodifiedSince),()=>Vn(e.IfUnmodifiedSince).toString()],range:e.Range,"x-amz-server-side-encryption-customer-algorithm":e.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":e.SSECustomerKey,"x-amz-server-side-encryption-customer-key-md5":e.SSECustomerKeyMD5,"x-amz-request-payer":e.RequestPayer,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"x-amz-checksum-mode":e.ChecksumMode});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({"x-id":[,"GetObject"],"response-cache-control":[,e.ResponseCacheControl],"response-content-disposition":[,e.ResponseContentDisposition],"response-content-encoding":[,e.ResponseContentEncoding],"response-content-language":[,e.ResponseContentLanguage],"response-content-type":[,e.ResponseContentType],"response-expires":[()=>void 0!==e.ResponseExpires,()=>Vn(e.ResponseExpires).toString()],versionId:[,e.VersionId],partNumber:[()=>void 0!==e.PartNumber,()=>e.PartNumber.toString()]});return new $r({protocol:n,hostname:r,port:i,method:"GET",headers:o,path:a,query:c,body:void 0})})(e,t)}deserialize(e,t){return gv(e,t)}}class ob extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,ob.getEndpointParameterInstructions())),this.middlewareStack.use(Bi()),this.middlewareStack.use(Dv(t)),this.middlewareStack.use(ib(t,{input:this.input,requestAlgorithmMember:"ChecksumAlgorithm",requestChecksumRequired:!1}));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"PutObjectCommand",inputFilterSensitiveLog:hv,outputFilterSensitiveLog:uv,[Br]:{service:"AmazonS3",operation:"PutObject"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"content-type":e.ContentType||"application/octet-stream","x-amz-acl":e.ACL,"cache-control":e.CacheControl,"content-disposition":e.ContentDisposition,"content-encoding":e.ContentEncoding,"content-language":e.ContentLanguage,"content-length":[()=>Nv(e.ContentLength),()=>e.ContentLength.toString()],"content-md5":e.ContentMD5,"x-amz-sdk-checksum-algorithm":e.ChecksumAlgorithm,"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-checksum-crc32c":e.ChecksumCRC32C,"x-amz-checksum-sha1":e.ChecksumSHA1,"x-amz-checksum-sha256":e.ChecksumSHA256,expires:[()=>Nv(e.Expires),()=>Vn(e.Expires).toString()],"x-amz-grant-full-control":e.GrantFullControl,"x-amz-grant-read":e.GrantRead,"x-amz-grant-read-acp":e.GrantReadACP,"x-amz-grant-write-acp":e.GrantWriteACP,"x-amz-server-side-encryption":e.ServerSideEncryption,"x-amz-storage-class":e.StorageClass,"x-amz-website-redirect-location":e.WebsiteRedirectLocation,"x-amz-server-side-encryption-customer-algorithm":e.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":e.SSECustomerKey,"x-amz-server-side-encryption-customer-key-md5":e.SSECustomerKeyMD5,"x-amz-server-side-encryption-aws-kms-key-id":e.SSEKMSKeyId,"x-amz-server-side-encryption-context":e.SSEKMSEncryptionContext,"x-amz-server-side-encryption-bucket-key-enabled":[()=>Nv(e.BucketKeyEnabled),()=>e.BucketKeyEnabled.toString()],"x-amz-request-payer":e.RequestPayer,"x-amz-tagging":e.Tagging,"x-amz-object-lock-mode":e.ObjectLockMode,"x-amz-object-lock-retain-until-date":[()=>Nv(e.ObjectLockRetainUntilDate),()=>(e.ObjectLockRetainUntilDate.toISOString().split(".")[0]+"Z").toString()],"x-amz-object-lock-legal-hold":e.ObjectLockLegalHoldStatus,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,...void 0!==e.Metadata&&Object.keys(e.Metadata).reduce(((t,r)=>(t[`x-amz-meta-${r.toLowerCase()}`]=e.Metadata[r],t)),{})});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({"x-id":[,"PutObject"]});let l,u;return void 0!==e.Body&&(l=e.Body),void 0!==e.Body&&(u=e.Body,l=u),new $r({protocol:n,hostname:r,port:i,method:"PUT",headers:o,path:a,query:c,body:l})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return bv(e,t);const r=ki({$metadata:Ov(e),Expiration:[,e.headers["x-amz-expiration"]],ETag:[,e.headers.etag],ChecksumCRC32:[,e.headers["x-amz-checksum-crc32"]],ChecksumCRC32C:[,e.headers["x-amz-checksum-crc32c"]],ChecksumSHA1:[,e.headers["x-amz-checksum-sha1"]],ChecksumSHA256:[,e.headers["x-amz-checksum-sha256"]],ServerSideEncryption:[,e.headers["x-amz-server-side-encryption"]],VersionId:[,e.headers["x-amz-version-id"]],SSECustomerAlgorithm:[,e.headers["x-amz-server-side-encryption-customer-algorithm"]],SSECustomerKeyMD5:[,e.headers["x-amz-server-side-encryption-customer-key-md5"]],SSEKMSKeyId:[,e.headers["x-amz-server-side-encryption-aws-kms-key-id"]],SSEKMSEncryptionContext:[,e.headers["x-amz-server-side-encryption-context"]],BucketKeyEnabled:[()=>void 0!==e.headers["x-amz-server-side-encryption-bucket-key-enabled"],()=>kn(e.headers["x-amz-server-side-encryption-bucket-key-enabled"])],RequestCharged:[,e.headers["x-amz-request-charged"]]});return await Sn(e.body,t),r})(e,t)}}class ab extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,ab.getEndpointParameterInstructions())),this.middlewareStack.use(ib(t,{input:this.input,requestAlgorithmMember:"ChecksumAlgorithm",requestChecksumRequired:!0}));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"PutObjectTaggingCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e,[Br]:{service:"AmazonS3",operation:"PutObjectTagging"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"content-type":"application/xml","content-md5":e.ContentMD5,"x-amz-sdk-checksum-algorithm":e.ChecksumAlgorithm,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"x-amz-request-payer":e.RequestPayer});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({tagging:[,""],versionId:[,e.VersionId]});let l,u;return void 0!==e.Tagging&&(l=Cv(e.Tagging)),void 0!==e.Tagging&&(u=Cv(e.Tagging),l='<?xml version="1.0" encoding="UTF-8"?>',u.addAttribute("xmlns","http://s3.amazonaws.com/doc/2006-03-01/"),l+=u.toString()),new $r({protocol:n,hostname:r,port:i,method:"PUT",headers:o,path:a,query:c,body:l})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return wv(e,t);const r=ki({$metadata:Ov(e),VersionId:[,e.headers["x-amz-version-id"]]});return await Sn(e.body,t),r})(e,t)}}class cb extends En{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,t,r){this.middlewareStack.use(Oa(t,this.serialize,this.deserialize)),this.middlewareStack.use(Ia(t,cb.getEndpointParameterInstructions())),this.middlewareStack.use(Dv(t)),this.middlewareStack.use(ib(t,{input:this.input,requestAlgorithmMember:"ChecksumAlgorithm",requestChecksumRequired:!1}));const n=e.concat(this.middlewareStack),{logger:i}=t,s={logger:i,clientName:"S3Client",commandName:"UploadPartCommand",inputFilterSensitiveLog:dv,outputFilterSensitiveLog:pv,[Br]:{service:"AmazonS3",operation:"UploadPart"}},{requestHandler:o}=t;return n.resolve((e=>o.handle(e.request,r||{})),s)}serialize(e,t){return(async(e,t)=>{const{hostname:r,protocol:n="https",port:i,path:s}=await t.endpoint(),o=ki({},Nv,{"content-type":"application/octet-stream","content-length":[()=>Nv(e.ContentLength),()=>e.ContentLength.toString()],"content-md5":e.ContentMD5,"x-amz-sdk-checksum-algorithm":e.ChecksumAlgorithm,"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-checksum-crc32c":e.ChecksumCRC32C,"x-amz-checksum-sha1":e.ChecksumSHA1,"x-amz-checksum-sha256":e.ChecksumSHA256,"x-amz-server-side-encryption-customer-algorithm":e.SSECustomerAlgorithm,"x-amz-server-side-encryption-customer-key":e.SSECustomerKey,"x-amz-server-side-encryption-customer-key-md5":e.SSECustomerKeyMD5,"x-amz-request-payer":e.RequestPayer,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner});let a=`${s?.endsWith("/")?s.slice(0,-1):s||""}/{Key+}`;a=Ii(a,e,"Bucket",(()=>e.Bucket),"{Bucket}",!1),a=Ii(a,e,"Key",(()=>e.Key),"{Key+}",!0);const c=ki({"x-id":[,"UploadPart"],partNumber:[null!=Bn(e.PartNumber,"PartNumber"),()=>e.PartNumber.toString()],uploadId:[,Bn(e.UploadId,"UploadId")]});let l,u;return void 0!==e.Body&&(l=e.Body),void 0!==e.Body&&(u=e.Body,l=u),new $r({protocol:n,hostname:r,port:i,method:"PUT",headers:o,path:a,query:c,body:l})})(e,t)}deserialize(e,t){return(async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return _v(e,t);const r=ki({$metadata:Ov(e),ServerSideEncryption:[,e.headers["x-amz-server-side-encryption"]],ETag:[,e.headers.etag],ChecksumCRC32:[,e.headers["x-amz-checksum-crc32"]],ChecksumCRC32C:[,e.headers["x-amz-checksum-crc32c"]],ChecksumSHA1:[,e.headers["x-amz-checksum-sha1"]],ChecksumSHA256:[,e.headers["x-amz-checksum-sha256"]],SSECustomerAlgorithm:[,e.headers["x-amz-server-side-encryption-customer-algorithm"]],SSECustomerKeyMD5:[,e.headers["x-amz-server-side-encryption-customer-key-md5"]],SSEKMSKeyId:[,e.headers["x-amz-server-side-encryption-aws-kms-key-id"]],BucketKeyEnabled:[()=>void 0!==e.headers["x-amz-server-side-encryption-bucket-key-enabled"],()=>kn(e.headers["x-amz-server-side-encryption-bucket-key-enabled"])],RequestCharged:[,e.headers["x-amz-request-charged"]]});return await Sn(e.body,t),r})(e,t)}}class lb{constructor(){this.onabort=null,this._aborted=!1,Object.defineProperty(this,"_aborted",{value:!1,writable:!0})}get aborted(){return this._aborted}abort(){this._aborted=!0,this.onabort&&(this.onabort(this),this.onabort=null)}}class ub{constructor(){this.signal=new lb}abort(){this.signal.abort()}}const hb={lstatSync:()=>{},runtime:"node",lstatSync:b},fb=e=>{if(null==e)return 0;if("string"==typeof e&&(e=Buffer.from(e)),"number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.length)return e.length;if("number"==typeof e.size)return e.size;if("string"==typeof e.path)try{return hb.lstatSync(e.path).size}catch(e){return}};async function*pb(e,t){let r=1,n=0,i=t;for(;i<e.byteLength;)yield{partNumber:r,data:e.slice(n,i)},r+=1,n=i,i=n+t;yield{partNumber:r,data:e.slice(n),lastPart:!0}}async function*db(e,t,r){let n=1;const i={chunks:[],length:0};for await(const s of r(e))for(i.chunks.push(s),i.length+=s.length;i.length>=t;){const e=i.chunks.length>1?o.concat(i.chunks):i.chunks[0];yield{partNumber:n,data:e.slice(0,t)},i.chunks=[e.slice(t)],i.length=i.chunks[0].length,n+=1}yield{partNumber:n,data:o.concat(i.chunks),lastPart:!0}}async function*mb(e){for await(const t of e)yield o.from(t)}async function*yb(e){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield o.from(r)}}catch(e){throw e}finally{t.releaseLock()}}const gb=5242880;class vb extends y{constructor(e){super(),this.MAX_PARTS=1e4,this.queueSize=4,this.partSize=gb,this.leavePartsOnError=!1,this.tags=[],this.concurrentUploaders=[],this.uploadedParts=[],this.isMultiPart=!0,this.queueSize=e.queueSize||this.queueSize,this.partSize=e.partSize||this.partSize,this.leavePartsOnError=e.leavePartsOnError||this.leavePartsOnError,this.tags=e.tags||this.tags,this.client=e.client,this.params=e.params,this.__validateInput(),this.totalBytes=fb(this.params.Body),this.bytesUploadedSoFar=0,this.abortController=e.abortController??new ub}async abort(){this.abortController.abort()}async done(){return await Promise.race([this.__doMultipartUpload(),this.__abortTimeout(this.abortController.signal)])}on(e,t){return this.uploadEvent=e,super.on(e,t)}async __uploadUsingPut(e){this.isMultiPart=!1;const t={...this.params,Body:e.data},r=this.client.config,n=r.requestHandler,i=n instanceof y?n:null,s=t=>{this.bytesUploadedSoFar=t.loaded,this.totalBytes=t.total,this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:e.partNumber,Key:this.params.Key,Bucket:this.params.Bucket})};null!==i&&i.on("xhr.upload.progress",s);const o=await Promise.all([this.client.send(new ob(t)),r?.endpoint?.()]),a=o[0];let c=o[1];if(c||(c=xa(await Ea(t,ob,{...r}))),!c)throw new Error('Could not resolve endpoint from S3 "client.config.endpoint()" nor EndpointsV2.');null!==i&&i.off("xhr.upload.progress",s);const l=this.params.Key.split("/").map((e=>Si(e))).join("/"),u=Si(this.params.Bucket),h=(()=>{const e=c.hostname.startsWith(`${u}.`);return this.client.config.forcePathStyle?`${c.protocol}//${c.hostname}/${u}/${l}`:e?`${c.protocol}//${c.hostname}/${l}`:`${c.protocol}//${u}.${c.hostname}/${l}`})();this.singleUploadResult={...a,Bucket:this.params.Bucket,Key:this.params.Key,Location:h};const f=fb(e.data);this.__notifyProgress({loaded:f,total:f,part:1,Key:this.params.Key,Bucket:this.params.Bucket})}async __createMultipartUpload(){if(!this.createMultiPartPromise){const e={...this.params,Body:void 0};this.createMultiPartPromise=this.client.send(new Lv(e))}return this.createMultiPartPromise}async __doConcurrentUpload(e){for await(const t of e){if(this.uploadedParts.length>this.MAX_PARTS)throw new Error(`Exceeded ${this.MAX_PARTS} as part of the upload to ${this.params.Key} and ${this.params.Bucket}.`);try{if(this.abortController.signal.aborted)return;if(1===t.partNumber&&t.lastPart)return await this.__uploadUsingPut(t);if(!this.uploadId){const{UploadId:e}=await this.__createMultipartUpload();if(this.uploadId=e,this.abortController.signal.aborted)return}const e=fb(t.data)||0,r=this.client.config.requestHandler,n=r instanceof y?r:null;let i=0;const s=(r,n)=>{(Number(n.query.partNumber)||-1)===t.partNumber&&(r.total&&e&&(this.bytesUploadedSoFar+=r.loaded-i,i=r.loaded),this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:t.partNumber,Key:this.params.Key,Bucket:this.params.Bucket}))};null!==n&&n.on("xhr.upload.progress",s);const o=await this.client.send(new cb({...this.params,UploadId:this.uploadId,Body:t.data,PartNumber:t.partNumber}));if(null!==n&&n.off("xhr.upload.progress",s),this.abortController.signal.aborted)return;if(!o.ETag)throw new Error(`Part ${t.partNumber} is missing ETag in UploadPart response. Missing Bucket CORS configuration for ETag header?`);this.uploadedParts.push({PartNumber:t.partNumber,ETag:o.ETag,...o.ChecksumCRC32&&{ChecksumCRC32:o.ChecksumCRC32},...o.ChecksumCRC32C&&{ChecksumCRC32C:o.ChecksumCRC32C},...o.ChecksumSHA1&&{ChecksumSHA1:o.ChecksumSHA1},...o.ChecksumSHA256&&{ChecksumSHA256:o.ChecksumSHA256}}),null===n&&(this.bytesUploadedSoFar+=e),this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:t.partNumber,Key:this.params.Key,Bucket:this.params.Bucket})}catch(e){if(!this.uploadId)throw e;if(this.leavePartsOnError)throw e}}}async __doMultipartUpload(){const e=((e,t)=>{if(e instanceof o)return pb(e,t);if(e instanceof c)return db(e,t,mb);if(e instanceof String||"string"==typeof e||e instanceof Uint8Array)return pb(o.from(e),t);if("function"==typeof e.stream)return db(e.stream(),t,yb);if(e instanceof ReadableStream)return db(e,t,yb);throw new Error("Body Data is unsupported format, expected data to be one of: string | Uint8Array | Buffer | Readable | ReadableStream | Blob;.")})(this.params.Body,this.partSize);for(let t=0;t<this.queueSize;t++){const t=this.__doConcurrentUpload(e);this.concurrentUploaders.push(t)}if(await Promise.all(this.concurrentUploaders),this.abortController.signal.aborted)throw Object.assign(new Error("Upload aborted."),{name:"AbortError"});let t;if(this.isMultiPart){this.uploadedParts.sort(((e,t)=>e.PartNumber-t.PartNumber));const e={...this.params,Body:void 0,UploadId:this.uploadId,MultipartUpload:{Parts:this.uploadedParts}};t=await this.client.send(new $v(e))}else t=this.singleUploadResult;return this.tags.length&&await this.client.send(new ab({...this.params,Tagging:{TagSet:this.tags}})),t}__notifyProgress(e){this.uploadEvent&&this.emit(this.uploadEvent,e)}async __abortTimeout(e){return new Promise(((t,r)=>{e.onabort=()=>{const e=new Error("Upload aborted.");e.name="AbortError",r(e)}}))}__validateInput(){if(!this.params)throw new Error("InputError: Upload requires params to be passed to upload.");if(!this.client)throw new Error("InputError: Upload requires a AWS client to do uploads with.");if(this.partSize<gb)throw new Error(`EntityTooSmall: Your proposed upload partsize [${this.partSize}] is smaller than the minimum allowed size [5242880] (5MB)`);if(this.queueSize<1)throw new Error("Queue size: Must have at least one uploading queue.")}}var bb={};m.listenerCount;var wb=function(e){return(process&&process.version?process.version:"v5.0.0").split(".")[0].replace("v","")<6?new Buffer(e):Buffer.from(e)};function _b(e,t){"string"==typeof e||e instanceof String?e=wb(e):("number"==typeof e||e instanceof Number)&&(e=wb([e]));for(var r=e.length,n=t=t||this.length-r;n>=0;n--){for(var i=!1,s=0;s<r;s++)if(this[n+s]!=e[s]){i=!0;break}if(!i)return n}return-1}Buffer.prototype.indexOf||(Buffer.prototype.indexOf=function(e,t){t=t||0,"string"==typeof e||e instanceof String?e=wb(e):("number"==typeof e||e instanceof Number)&&(e=wb([e]));for(var r=e.length,n=t;n<=this.length-r;n++){for(var i=!1,s=0;s<r;s++)if(this[n+s]!=e[s]){i=!0;break}if(!i)return n}return-1}),Buffer.prototype.lastIndexOf?-1===wb("ABC").lastIndexOf("ABC")&&(Buffer.prototype.lastIndexOf=_b):Buffer.prototype.lastIndexOf=_b,function(e,t){if(!e.setImmediate){var r,n,i,s,o,a=1,c={},l=!1,u=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,r=function(e){var t=u.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(s+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[a]=i,r(a),a++},h.clearImmediate=f}function f(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var r=c[e];if(r){l=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{f(e),l=!1}}}}}("undefined"==typeof self?U:self);var Sb={exports:{}},Eb=Ab;function Ab(e){if(!(this instanceof Ab))return new Ab(e);this.value=e}function kb(e,t,r){var n=[],i=[],s=!0;return function e(o){var a=r?xb(o):o,c={},l={node:a,node_:o,path:[].concat(n),parent:i.slice(-1)[0],key:n.slice(-1)[0],isRoot:0===n.length,level:n.length,circular:null,update:function(e){l.isRoot||(l.parent.node[l.key]=e),l.node=e},delete:function(){delete l.parent.node[l.key]},remove:function(){Array.isArray(l.parent.node)?l.parent.node.splice(l.key,1):delete l.parent.node[l.key]},before:function(e){c.before=e},after:function(e){c.after=e},pre:function(e){c.pre=e},post:function(e){c.post=e},stop:function(){s=!1}};if(!s)return l;if("object"==typeof a&&null!==a){l.isLeaf=0==Object.keys(a).length;for(var u=0;u<i.length;u++)if(i[u].node_===o){l.circular=i[u];break}}else l.isLeaf=!0;l.notLeaf=!l.isLeaf,l.notRoot=!l.isRoot;var h=t.call(l,l.node);if(void 0!==h&&l.update&&l.update(h),c.before&&c.before.call(l,l.node),"object"==typeof l.node&&null!==l.node&&!l.circular){i.push(l);var f=Object.keys(l.node);f.forEach((function(t,i){n.push(t),c.pre&&c.pre.call(l,l.node[t],t);var s=e(l.node[t]);r&&Object.hasOwnProperty.call(l.node,t)&&(l.node[t]=s.node),s.isLast=i==f.length-1,s.isFirst=0==i,c.post&&c.post.call(l,s),n.pop()})),i.pop()}return c.after&&c.after.call(l,l.node),l}(e).node}function xb(e){var t;return"object"==typeof e&&null!==e?(t=Array.isArray(e)?[]:e instanceof Date?new Date(e):e instanceof Boolean?new Boolean(e):e instanceof Number?new Number(e):e instanceof String?new String(e):Object.create(Object.getPrototypeOf(e)),Object.keys(e).forEach((function(r){t[r]=e[r]})),t):e}Ab.prototype.get=function(e){for(var t=this.value,r=0;r<e.length;r++){var n=e[r];if(!Object.hasOwnProperty.call(t,n)){t=void 0;break}t=t[n]}return t},Ab.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var i=e[n];Object.hasOwnProperty.call(r,i)||(r[i]={}),r=r[i]}return r[e[n]]=t,t},Ab.prototype.map=function(e){return kb(this.value,e,!0)},Ab.prototype.forEach=function(e){return this.value=kb(this.value,e,!1),this.value},Ab.prototype.reduce=function(e,t){var r=1===arguments.length,n=r?this.value:t;return this.forEach((function(t){this.isRoot&&r||(n=e.call(this,n,t))})),n},Ab.prototype.deepEqual=function(e){if(1!==arguments.length)throw new Error("deepEqual requires exactly one object to compare against");var t=!0,r=e;return this.forEach((function(n){var i=function(){t=!1}.bind(this);if(!this.isRoot){if("object"!=typeof r)return i();r=r[this.key]}var s=r;this.post((function(){r=s}));var o=function(e){return Object.prototype.toString.call(e)};if(this.circular)Ab(e).get(this.circular.path)!==s&&i();else if(typeof s!=typeof n)i();else if(null===s||null===n||void 0===s||void 0===n)s!==n&&i();else if(s.__proto__!==n.__proto__)i();else if(s===n);else if("function"==typeof s)s instanceof RegExp?s.toString()!=n.toString()&&i():s!==n&&i();else if("object"==typeof s)if("[object Arguments]"===o(n)||"[object Arguments]"===o(s))o(s)!==o(n)&&i();else if(s instanceof Date||n instanceof Date)s instanceof Date&&n instanceof Date&&s.getTime()===n.getTime()||i();else{var a=Object.keys(s),c=Object.keys(n);if(a.length!==c.length)return i();for(var l=0;l<a.length;l++){var u=a[l];Object.hasOwnProperty.call(n,u)||i()}}})),t},Ab.prototype.paths=function(){var e=[];return this.forEach((function(t){e.push(this.path)})),e},Ab.prototype.nodes=function(){var e=[];return this.forEach((function(t){e.push(this.node)})),e},Ab.prototype.clone=function(){var e=[],t=[];return function r(n){for(var i=0;i<e.length;i++)if(e[i]===n)return t[i];if("object"==typeof n&&null!==n){var s=xb(n);return e.push(n),t.push(s),Object.keys(n).forEach((function(e){s[e]=r(n[e])})),e.pop(),t.pop(),s}return n}(this.value)},Object.keys(Ab.prototype).forEach((function(e){Ab[e]=function(t){var r=[].slice.call(arguments,1),n=Ab(t);return n[e].apply(n,r)}}));var Cb=Eb,Rb=m.EventEmitter,Ob=Nb;function Nb(e){var t=Nb.saw(e,{}),r=e.call(t.handlers,t);return void 0!==r&&(t.handlers=r),t.record(),t.chain()}Nb.light=function(e){var t=Nb.saw(e,{}),r=e.call(t.handlers,t);return void 0!==r&&(t.handlers=r),t.chain()},Nb.saw=function(e,t){var r=new Rb;return r.handlers=t,r.actions=[],r.chain=function(){var e=Cb(r.handlers).map((function(t){if(this.isRoot)return t;var n=this.path;"function"==typeof t&&this.update((function(){return r.actions.push({path:n,args:[].slice.call(arguments)}),e}))}));return process.nextTick((function(){r.emit("begin"),r.next()})),e},r.pop=function(){return r.actions.shift()},r.next=function(){var e=r.pop();if(e){if(!e.trap){var t=r.handlers;e.path.forEach((function(e){t=t[e]})),t.apply(r.handlers,e.args)}}else r.emit("end")},r.nest=function(t){var n=[].slice.call(arguments,1),i=!0;if("boolean"==typeof t){i=t;t=n.shift()}var s=Nb.saw(e,{}),o=e.call(s.handlers,s);void 0!==o&&(s.handlers=o),void 0!==r.step&&s.record(),t.apply(s.chain(),n),!1!==i&&s.on("end",r.next)},r.record=function(){!function(e){e.step=0,e.pop=function(){return e.actions[e.step++]},e.trap=function(t,r){var n=Array.isArray(t)?t:[t];e.actions.push({path:n,step:e.step,cb:r,trap:!0})},e.down=function(t){var r=(Array.isArray(t)?t:[t]).join("/"),n=e.actions.slice(e.step).map((function(t){return!(t.trap&&t.step<=e.step)&&t.path.join("/")==r})).indexOf(!0);n>=0?e.step+=n:e.step=e.actions.length;var i=e.actions[e.step-1];i&&i.trap?(e.step=i.step,i.cb()):e.next()},e.jump=function(t){e.step=t,e.next()}}(r)},["trap","down","jump"].forEach((function(e){r[e]=function(){throw new Error("To use the trap, down and jump features, please call record() first to start recording actions.")}})),r};var Ib=Tb;function Tb(e){if(!(this instanceof Tb))return new Tb(e);this.buffers=e||[],this.length=this.buffers.reduce((function(e,t){return e+t.length}),0)}Tb.prototype.push=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw new TypeError("Tried to push a non-buffer");for(e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.push(t),this.length+=t.length}return this.length},Tb.prototype.unshift=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw new TypeError("Tried to unshift a non-buffer");for(e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.unshift(t),this.length+=t.length}return this.length},Tb.prototype.copy=function(e,t,r,n){return this.slice(r,n).copy(e,t,0,n-r)},Tb.prototype.splice=function(e,t){var r=this.buffers,n=e>=0?e:this.length-e,i=[].slice.call(arguments,2);(void 0===t||t>this.length-n)&&(t=this.length-n);for(e=0;e<i.length;e++)this.length+=i[e].length;for(var s=new Tb,o=0,a=0;a<r.length&&o+r[a].length<n;a++)o+=r[a].length;if(n-o>0){var c=n-o;if(c+t<r[a].length){s.push(r[a].slice(c,c+t));var l=r[a],u=new Buffer(c);for(e=0;e<c;e++)u[e]=l[e];var h=new Buffer(l.length-c-t);for(e=c+t;e<l.length;e++)h[e-t-c]=l[e];if(i.length>0){var f=i.slice();f.unshift(u),f.push(h),r.splice.apply(r,[a,1].concat(f)),a+=f.length,i=[]}else r.splice(a,1,u,h),a+=2}else s.push(r[a].slice(c)),r[a]=r[a].slice(0,c),a++}for(i.length>0&&(r.splice.apply(r,[a,0].concat(i)),a+=i.length);s.length<t;){var p=r[a],d=p.length,m=Math.min(d,t-s.length);m===d?(s.push(p),r.splice(a,1)):(s.push(p.slice(0,m)),r[a]=r[a].slice(m))}return this.length-=s.length,s},Tb.prototype.slice=function(e,t){var r=this.buffers;void 0===t&&(t=this.length),void 0===e&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=0;i<r.length&&n+r[i].length<=e;i++)n+=r[i].length;for(var s=new Buffer(t-e),o=0,a=i;o<t-e&&a<r.length;a++){var c=r[a].length,l=0===o?e-n:0,u=o+c>=t-e?Math.min(l+(t-e)-o,c):c;r[a].copy(s,o,l,u),o+=u-l}return s},Tb.prototype.pos=function(e){if(e<0||e>=this.length)throw new Error("oob");for(var t=e,r=0,n=null;;){if(t<(n=this.buffers[r]).length)return{buf:r,offset:t};t-=n.length,r++}},Tb.prototype.get=function(e){var t=this.pos(e);return this.buffers[t.buf].get(t.offset)},Tb.prototype.set=function(e,t){var r=this.pos(e);return this.buffers[r.buf].set(r.offset,t)},Tb.prototype.indexOf=function(e,t){if("string"==typeof e)e=new Buffer(e);else if(!(e instanceof Buffer))throw new Error("Invalid type for a search string");if(!e.length)return 0;if(!this.length)return-1;var r,n=0,i=0,s=0,o=0;if(t){var a=this.pos(t);n=a.buf,i=a.offset,o=t}for(;;){for(;i>=this.buffers[n].length;)if(i=0,++n>=this.buffers.length)return-1;if(this.buffers[n][i]==e[s]){if(0==s&&(r={i:n,j:i,pos:o}),++s==e.length)return r.pos}else 0!=s&&(n=r.i,i=r.j,o=r.pos,s=0);i++,o++}},Tb.prototype.toBuffer=function(){return this.slice()},Tb.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)};var Pb=function(e){function t(e,t){var n=r.store,i=e.split(".");i.slice(0,-1).forEach((function(e){void 0===n[e]&&(n[e]={}),n=n[e]}));var s=i[i.length-1];return 1==arguments.length?n[s]:n[s]=t}var r={get:function(e){return t(e)},set:function(e,r){return t(e,r)},store:e||{}};return r};!function(e,t){var r=Ob,n=m.EventEmitter,i=Ib,s=Pb,o=a.Stream;function c(e){for(var t=0,r=0;r<e.length;r++)t+=Math.pow(256,r)*e[r];return t}function l(e){for(var t=0,r=0;r<e.length;r++)t+=Math.pow(256,e.length-r-1)*e[r];return t}function u(e){var t=l(e);return 128==(128&e[0])&&(t-=Math.pow(256,e.length)),t}function h(e){var t=c(e);return 128==(128&e[e.length-1])&&(t-=Math.pow(256,e.length)),t}function f(e){var t={};return[1,2,4,8].forEach((function(r){var n=8*r;t["word"+n+"le"]=t["word"+n+"lu"]=e(r,c),t["word"+n+"ls"]=e(r,h),t["word"+n+"be"]=t["word"+n+"bu"]=e(r,l),t["word"+n+"bs"]=e(r,u)})),t.word8=t.word8u=t.word8be,t.word8s=t.word8bs,t}t=e.exports=function(e,r){if(Buffer.isBuffer(e))return t.parse(e);var n=t.stream();return e&&e.pipe?e.pipe(n):e&&(e.on(r||"data",(function(e){n.write(e)})),e.on("end",(function(){n.end()}))),n},t.stream=function(e){if(e)return t.apply(null,arguments);var a=null;function c(e,t,r){a={bytes:e,skip:r,cb:function(e){a=null,t(e)}},u()}var l=null;function u(){if(a)if("function"==typeof a)a();else{var e,t=l+a.bytes;if(p.length>=t)null==l?(e=p.splice(0,t),a.skip||(e=e.slice())):(a.skip||(e=p.slice(l,t)),l=t),a.skip?a.cb():a.cb(e)}else y&&(m=!0)}var h=r.light((function(e){function t(){m||e.next()}var r=f((function(e,r){return function(n){c(e,(function(e){d.set(n,r(e)),t()}))}}));return r.tap=function(t){e.nest(t,d.store)},r.into=function(t,r){d.get(t)||d.set(t,{});var n=d;d=s(n.get(t)),e.nest((function(){r.apply(this,arguments),this.tap((function(){d=n}))}),d.store)},r.flush=function(){d.store={},t()},r.loop=function(r){var n=!1;e.nest(!1,(function i(){this.vars=d.store,r.call(this,(function(){n=!0,t()}),d.store),this.tap(function(){n?e.next():i.call(this)}.bind(this))}),d.store)},r.buffer=function(e,r){"string"==typeof r&&(r=d.get(r)),c(r,(function(r){d.set(e,r),t()}))},r.skip=function(e){"string"==typeof e&&(e=d.get(e)),c(e,(function(){t()}))},r.scan=function(e,r){if("string"==typeof r)r=new Buffer(r);else if(!Buffer.isBuffer(r))throw new Error("search must be a Buffer or a string");var n=0;a=function(){var i=p.indexOf(r,l+n),s=i-l-n;-1!==i?(a=null,null!=l?(d.set(e,p.slice(l,l+n+s)),l+=n+s+r.length):(d.set(e,p.slice(0,n+s)),p.splice(0,n+s+r.length)),t(),u()):s=Math.max(p.length-r.length-l-n,0),n+=s},u()},r.peek=function(t){l=0,e.nest((function(){t.call(this,d.store),this.tap((function(){l=null}))}))},r}));h.writable=!0;var p=i();h.write=function(e){p.push(e),u()};var d=s(),m=!1,y=!1;return h.end=function(){y=!0},h.pipe=o.prototype.pipe,Object.getOwnPropertyNames(n.prototype).forEach((function(e){h[e]=n.prototype[e]})),h},t.parse=function(e){var t=f((function(i,s){return function(o){if(r+i<=e.length){var a=e.slice(r,r+i);r+=i,n.set(o,s(a))}else n.set(o,null);return t}})),r=0,n=s();return t.vars=n.store,t.tap=function(e){return e.call(t,n.store),t},t.into=function(e,r){n.get(e)||n.set(e,{});var i=n;return n=s(i.get(e)),r.call(t,n.store),n=i,t},t.loop=function(e){for(var r=!1,i=function(){r=!0};!1===r;)e.call(t,i,n.store);return t},t.buffer=function(i,s){"string"==typeof s&&(s=n.get(s));var o=e.slice(r,Math.min(e.length,r+s));return r+=s,n.set(i,o),t},t.skip=function(e){return"string"==typeof e&&(e=n.get(e)),r+=e,t},t.scan=function(i,s){if("string"==typeof s)s=new Buffer(s);else if(!Buffer.isBuffer(s))throw new Error("search must be a Buffer or a string");n.set(i,null);for(var o=0;o+r<=e.length-s.length+1;o++){for(var a=0;a<s.length&&e[r+o+a]===s[a];a++);if(a===s.length)break}return n.set(i,e.slice(r,r+o)),r+=o+s.length,t},t.peek=function(e){var i=r;return e.call(t,n.store),r=i,t},t.flush=function(){return n.store={},t},t.eof=function(){return r>=e.length},t}}(Sb,Sb.exports);var Bb,Db,$b,Lb=Sb.exports,jb={exports:{}},Mb={exports:{}};function Ub(){if(Bb)return Mb.exports;Bb=1;var e=function(){return void 0===this}();if(e)Mb.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var t={}.hasOwnProperty,r={}.toString,n={}.constructor.prototype,i=function(e){var r=[];for(var n in e)t.call(e,n)&&r.push(n);return r};Mb.exports={isArray:function(e){try{return"[object Array]"===r.call(e)}catch(e){return!1}},keys:i,names:i,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return n}},isES5:e,propertyIsWritable:function(){return!0}}}return Mb.exports}function Kb(){if($b)return Db;$b=1;var e,t=Ub(),r="undefined"==typeof navigator,n={e:{}},i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==U||void 0!==U?U:null;function s(){try{var t=e;return e=null,t.apply(this,arguments)}catch(e){return n.e=e,n}}function o(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function a(e,r,n){if(o(e))return e;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return t.defineProperty(e,r,i),e}var c=function(){var e=[Array.prototype,Object.prototype,Function.prototype],r=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(t.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var i=[],s=Object.create(null);null!=e&&!r(e);){var o;try{o=n(e)}catch(e){return i}for(var a=0;a<o.length;++a){var c=o[a];if(!s[c]){s[c]=!0;var l=Object.getOwnPropertyDescriptor(e,c);null!=l&&null==l.get&&null==l.set&&i.push(c)}}e=t.getPrototypeOf(e)}return i}}var i={}.hasOwnProperty;return function(t){if(r(t))return[];var n=[];e:for(var s in t)if(i.call(t,s))n.push(s);else{for(var o=0;o<e.length;++o)if(i.call(e[o],s))continue e;n.push(s)}return n}}(),l=/this\s*\.\s*\S+\s*=/;var u=/^[a-z$_][a-z$_0-9]*$/i;function h(e){try{return e+""}catch(e){return"[no string representation]"}}function f(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function p(e){return f(e)&&t.propertyIsWritable(e,"stack")}var d="stack"in new Error?function(e){return p(e)?e:new Error(h(e))}:function(e){if(p(e))return e;try{throw new Error(h(e))}catch(e){return e}};function m(e){return{}.toString.call(e)}var y=function(e){return t.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var g="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};y=function(e){return t.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?g(e):null}}var v="undefined"!=typeof process&&"[object process]"===m(process).toLowerCase(),b="undefined"!=typeof process&&void 0!==process.env;var w={isClass:function(e){try{if("function"==typeof e){var r=t.names(e.prototype),n=t.isES5&&r.length>1,i=r.length>0&&!(1===r.length&&"constructor"===r[0]),s=l.test(e+"")&&t.names(e).length>0;if(n||i||s)return!0}return!1}catch(e){return!1}},isIdentifier:function(e){return u.test(e)},inheritedDataKeys:c,getDataPropertyOrDefault:function(e,r,n){if(!t.isES5)return{}.hasOwnProperty.call(e,r)?e[r]:void 0;var i=Object.getOwnPropertyDescriptor(e,r);return null!=i?null==i.get&&null==i.set?i.value:n:void 0},thrower:function(e){throw e},isArray:t.isArray,asArray:y,notEnumerableProp:a,isPrimitive:o,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:f,canEvaluate:r,errorObj:n,tryCatch:function(t){return e=t,s},inherits:function(e,t){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}return n.prototype=t.prototype,e.prototype=new n,e.prototype},withAppended:function(e,t){var r,n=e.length,i=new Array(n+1);for(r=0;r<n;++r)i[r]=e[r];return i[r]=t,i},maybeWrapAsError:function(e){return o(e)?new Error(h(e)):e},toFastProperties:function(e){return e},filledRange:function(e,t,r){for(var n=new Array(e),i=0;i<e;++i)n[i]=t+i+r;return n},toString:h,canAttachTrace:p,ensureErrorObject:d,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{a(e,"isOperational",!0)}catch(e){}},classString:m,copyDescriptors:function(e,r,n){for(var i=t.names(e),s=0;s<i.length;++s){var o=i[s];if(n(o))try{t.defineProperty(r,o,t.getDescriptor(e,o))}catch(e){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:v,hasEnvVariables:b,env:function(e){return b?process.env[e]:void 0},global:i,getNativePromise:function(){if("function"==typeof Promise)try{var e=new Promise((function(){}));if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}},domainBind:function(e,t){return e.bind(t)}};w.isRecentNode=w.isNode&&function(){var e=process.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),w.isNode&&w.toFastProperties(process);try{throw new Error}catch(e){w.lastLineError=e}return Db=w}var Fb,Hb,zb,Vb,qb,Gb,Wb,Xb,Jb,Yb,Zb,Qb,ew,tw,rw,nw,iw,sw,ow,aw,cw,lw,uw,hw,fw,pw,dw,mw,yw,gw,vw,bw,ww,_w,Sw,Ew,Aw,kw,xw,Cw,Rw,Ow,Nw,Iw,Tw,Pw,Bw,Dw,$w,Lw,jw,Mw,Uw,Kw,Fw,Hw,zw,Vw,qw,Gw,Ww,Xw,Jw,Yw,Zw={exports:{}};function Qw(){if(Hb)return Fb;Hb=1;var e,t=Kb(),r=t.getNativePromise();if(t.isNode&&"undefined"==typeof MutationObserver){var n=U.setImmediate,i=process.nextTick;e=t.isRecentNode?function(e){n.call(U,e)}:function(e){i.call(process,e)}}else if("function"==typeof r&&"function"==typeof r.resolve){var s=r.resolve();e=function(e){s.then(e)}}else e="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var e=document.createElement("div"),t={attributes:!0},r=!1,n=document.createElement("div");new MutationObserver((function(){e.classList.toggle("foo"),r=!1})).observe(n,t);return function(i){var s=new MutationObserver((function(){s.disconnect(),i()}));s.observe(e,t),r||(r=!0,n.classList.toggle("foo"))}}();return Fb=e}function e_(){if(qb)return Zw.exports;var e;qb=1;try{throw new Error}catch(t){e=t}var t=Qw(),r=function(){if(Vb)return zb;function e(e){this._capacity=e,this._length=0,this._front=0}return Vb=1,e.prototype._willBeOverCapacity=function(e){return this._capacity<e},e.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},e.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var i=this._front+n-3;this._checkCapacity(n);var s=this._capacity-1;this[i+0&s]=e,this[i+1&s]=t,this[i+2&s]=r,this._length=n},e.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},e.prototype.length=function(){return this._length},e.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},e.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,i){for(var s=0;s<i;++s)r[s+n]=e[s+t],e[s+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},zb=e}(),n=Kb();function i(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=t}function s(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()}function o(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()}function a(e){this._normalQueue._pushOne(e),this._queueTick()}return i.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},i.prototype.hasCustomScheduler=function(){return this._customScheduler},i.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},i.prototype.disableTrampolineIfNecessary=function(){n.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},i.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},i.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},n.hasDevTools?(i.prototype.invokeLater=function(e,t,r){this._trampolineEnabled?s.call(this,e,t,r):this._schedule((function(){setTimeout((function(){e.call(t,r)}),100)}))},i.prototype.invoke=function(e,t,r){this._trampolineEnabled?o.call(this,e,t,r):this._schedule((function(){e.call(t,r)}))},i.prototype.settlePromises=function(e){this._trampolineEnabled?a.call(this,e):this._schedule((function(){e._settlePromises()}))}):(i.prototype.invokeLater=s,i.prototype.invoke=o,i.prototype.settlePromises=a),i.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var r=e.shift(),n=e.shift();t.call(r,n)}else t._settlePromises()}},i.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},Zw.exports=i,Zw.exports.firstLineError=e,Zw.exports}function t_(){if(Wb)return Gb;Wb=1;var e,t,r=Ub(),n=r.freeze,i=Kb(),s=i.inherits,o=i.notEnumerableProp;function a(e,t){function r(n){if(!(this instanceof r))return new r(n);o(this,"message","string"==typeof n?n:t),o(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return s(r,Error),r}var c=a("Warning","warning"),l=a("CancellationError","cancellation error"),u=a("TimeoutError","timeout error"),h=a("AggregateError","aggregate error");try{e=TypeError,t=RangeError}catch(r){e=a("TypeError","type error"),t=a("RangeError","range error")}for(var f="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),p=0;p<f.length;++p)"function"==typeof Array.prototype[f[p]]&&(h.prototype[f[p]]=Array.prototype[f[p]]);r.defineProperty(h.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),h.prototype.isOperational=!0;var d=0;function m(e){if(!(this instanceof m))return new m(e);o(this,"name","OperationalError"),o(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(o(this,"message",e.message),o(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}h.prototype.toString=function(){var e=Array(4*d+1).join(" "),t="\n"+e+"AggregateError of:\n";d++,e=Array(4*d+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),s=0;s<i.length;++s)i[s]=e+i[s];t+=(n=i.join("\n"))+"\n"}return d--,t},s(m,Error);var y=Error.__BluebirdErrorTypes__;return y||(y=n({CancellationError:l,TimeoutError:u,OperationalError:m,RejectionError:m,AggregateError:h}),r.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),Gb={Error:Error,TypeError:e,RangeError:t,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:c}}function r_(){return Jb||(Jb=1,Xb=function(e,t){var r=Kb(),n=r.errorObj,i=r.isObject;var s={}.hasOwnProperty;return function(o,a){if(i(o)){if(o instanceof e)return o;var c=function(e){try{return function(e){return e.then}(e)}catch(e){return n.e=e,n}}(o);if(c===n){a&&a._pushContext();var l=e.reject(c.e);return a&&a._popContext(),l}if("function"==typeof c){if(function(e){try{return s.call(e,"_promise0")}catch(e){return!1}}(o)){l=new e(t);return o._then(l._fulfill,l._reject,void 0,l,null),l}return function(i,s,o){var a=new e(t),c=a;o&&o._pushContext();a._captureStackTrace(),o&&o._popContext();var l=!0,u=r.tryCatch(s).call(i,h,f);l=!1,a&&u===n&&(a._rejectCallback(u.e,!0,!0),a=null);function h(e){a&&(a._resolveCallback(e),a=null)}function f(e){a&&(a._rejectCallback(e,l,!0),a=null)}return c}(o,c,a)}}return o}}),Xb}function n_(){return rw||(rw=1,tw=function(e,t){var r,n,i,s=e._getDomain,o=e._async,a=t_().Warning,c=Kb(),l=c.canAttachTrace,u=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,p=null,d=null,m=!1,y=!(0==c.env("BLUEBIRD_DEBUG")||!c.env("BLUEBIRD_DEBUG")&&"development"!==c.env("NODE_ENV")),g=!(0==c.env("BLUEBIRD_WARNINGS")||!y&&!c.env("BLUEBIRD_WARNINGS")),v=!(0==c.env("BLUEBIRD_LONG_STACK_TRACES")||!y&&!c.env("BLUEBIRD_LONG_STACK_TRACES")),b=0!=c.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(g||!!c.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),o.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){K("rejectionHandled",r,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),K("unhandledRejection",n,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,r){return L(e,t,r||this)},e.onPossiblyUnhandledRejection=function(e){var t=s();n="function"==typeof e?null===t?e:c.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=s();r="function"==typeof e?null===t?e:c.domainBind(t,e):void 0};var w=function(){};e.longStackTraces=function(){if(o.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!X.longStackTraces&&H()){var r=e.prototype._captureStackTrace,n=e.prototype._attachExtraTrace;X.longStackTraces=!0,w=function(){if(o.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=r,e.prototype._attachExtraTrace=n,t.deactivateLongStackTraces(),o.enableTrampoline(),X.longStackTraces=!1},e.prototype._captureStackTrace=D,e.prototype._attachExtraTrace=$,t.activateLongStackTraces(),o.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return X.longStackTraces&&H()};var _=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return c.global.dispatchEvent(e),function(e,t){var r=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!c.global.dispatchEvent(r)}}if("function"==typeof Event){e=new Event("CustomEvent");return c.global.dispatchEvent(e),function(e,t){var r=new Event(e.toLowerCase(),{cancelable:!0});return r.detail=t,!c.global.dispatchEvent(r)}}return(e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),c.global.dispatchEvent(e),function(e,t){var r=document.createEvent("CustomEvent");return r.initCustomEvent(e.toLowerCase(),!1,!0,t),!c.global.dispatchEvent(r)}}catch(e){}return function(){return!1}}(),S=c.isNode?function(){return process.emit.apply(process,arguments)}:c.global?function(e){var t="on"+e.toLowerCase(),r=c.global[t];return!!r&&(r.apply(c.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function E(e,t){return{promise:t}}var A={promiseCreated:E,promiseFulfilled:E,promiseRejected:E,promiseResolved:E,promiseCancelled:E,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:E},k=function(e){var t=!1;try{t=S.apply(null,arguments)}catch(e){o.throwLater(e),t=!0}var r=!1;try{r=_(e,A[e].apply(null,arguments))}catch(e){o.throwLater(e),r=!0}return r||t};function x(){return!1}function C(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+c.toString(e));n._attachCancellationCallback(e)}))}catch(e){return e}}function R(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?c.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function O(){return this._onCancelField}function N(e){this._onCancelField=e}function I(){this._cancellationParent=void 0,this._onCancelField=void 0}function T(e,t){if(0!=(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&w()),"warnings"in t){var r=t.warnings;X.warnings=!!r,b=X.warnings,c.isObject(r)&&"wForgottenReturn"in r&&(b=!!r.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!X.cancellation){if(o.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=I,e.prototype._propagateFrom=T,e.prototype._onCancel=O,e.prototype._setOnCancel=N,e.prototype._attachCancellationCallback=R,e.prototype._execute=C,P=T,X.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!X.monitoring?(X.monitoring=!0,e.prototype._fireEvent=k):!t.monitoring&&X.monitoring&&(X.monitoring=!1,e.prototype._fireEvent=x)),e},e.prototype._fireEvent=x,e.prototype._execute=function(e,t,r){try{e(t,r)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var P=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function B(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function D(){this._trace=new G(this._peekContext())}function $(e,t){if(l(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=M(e);c.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),c.notEnumerableProp(e,"__stackCleaned__",!0)}}}function L(t,r,n){if(X.warnings){var i,s=new a(t);if(r)n._attachExtraTrace(s);else if(X.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(s);else{var o=M(s);s.stack=o.message+"\n"+o.stack.join("\n")}k("warning",s)||U(s,"",!0)}}function j(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],i="    (No stack trace)"===n||p.test(n),s=i&&z(n);i&&!s&&(m&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function M(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||p.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:j(t)}}function U(e,t,r){if("undefined"!=typeof console){var n;if(c.isObject(e)){var s=e.stack;n=t+d(s,e)}else n=t+String(e);"function"==typeof i?i(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function K(e,t,r,n){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(e){o.throwLater(e)}"unhandledRejection"===e?k(e,r,n)||i||U(r,"Unhandled rejection "):k(e,n)}function F(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():c.toString(e);if(/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){var t=41;if(e.length<t)return e;return e.substr(0,t-3)+"..."}(t)+">, no stack trace)"}function H(){return"function"==typeof W}var z=function(){return!1},V=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function q(e){var t=e.match(V);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function G(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);W(this,G),t>32&&this.uncycle()}c.inherits(G,Error),t.CapturedTrace=G,G.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},n=0,i=this;void 0!==i;++n)t.push(i),i=i._parent;for(n=(e=this._length=n)-1;n>=0;--n){var s=t[n].stack;void 0===r[s]&&(r[s]=n)}for(n=0;n<e;++n){var o=r[t[n].stack];if(void 0!==o&&o!==n){o>0&&(t[o-1]._parent=void 0,t[o-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var a=n>0?t[n-1]:this;o<e-1?(a._parent=t[o+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var c=a._length+1,l=n-2;l>=0;--l)t[l]._length=c,c++;return}}}},G.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=M(e),r=t.message,n=[t.stack],i=this;void 0!==i;)n.push(j(i.stack.split("\n"))),i=i._parent;!function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],i=t.length-1,s=t[i],o=-1,a=n.length-1;a>=0;--a)if(n[a]===s){o=a;break}for(a=o;a>=0;--a){var c=n[a];if(t[i]!==c)break;t.pop(),i--}t=n}}(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),c.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),c.notEnumerableProp(e,"__stackCleaned__",!0)}};var W=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():F(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,p=e,d=t;var r=Error.captureStackTrace;return z=function(e){return u.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return p=/@/,d=t,m=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){n="stack"in e}return!("stack"in i)&&n&&"number"==typeof Error.stackTraceLimit?(p=e,d=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6}):(d=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?F(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(i=function(e){console.warn(e)},c.isNode&&process.stderr.isTTY?i=function(e,t){var r=t?"[33m":"[31m";console.warn(r+e+"[0m\n")}:c.isNode||"string"!=typeof(new Error).stack||(i=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var X={warnings:g,longStackTraces:!1,cancellation:!1,monitoring:!1};return v&&e.longStackTraces(),{longStackTraces:function(){return X.longStackTraces},warnings:function(){return X.warnings},cancellation:function(){return X.cancellation},monitoring:function(){return X.monitoring},propagateFromFunction:function(){return P},boundValueFunction:function(){return B},checkForgottenReturns:function(e,t,r,n,i){if(void 0===e&&null!==t&&b){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&n._bitField))return;r&&(r+=" ");var s="",o="";if(t._trace){for(var a=t._trace.stack.split("\n"),c=j(a),l=c.length-1;l>=0;--l){var u=c[l];if(!h.test(u)){var p=u.match(f);p&&(s="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0){var d=c[0];for(l=0;l<a.length;++l)if(a[l]===d){l>0&&(o="\n"+a[l-1]);break}}}var m="a promise was created in a "+r+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+o;n._warn(m,!0,t)}},setBounds:function(e,t){if(H()){for(var r,n,i=e.stack.split("\n"),s=t.stack.split("\n"),o=-1,a=-1,c=0;c<i.length;++c){if(l=q(i[c])){r=l.fileName,o=l.line;break}}for(c=0;c<s.length;++c){var l;if(l=q(s[c])){n=l.fileName,a=l.line;break}}o<0||a<0||!r||!n||r!==n||o>=a||(z=function(e){if(u.test(e))return!0;var t=q(e);return!!(t&&t.fileName===r&&o<=t.line&&t.line<=a)})}},warn:L,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),L(r)},CapturedTrace:G,fireDomEvent:_,fireGlobalEvent:S}}),tw}function i_(){if(cw)return aw;cw=1;var e=Kb(),t=e.maybeWrapAsError,r=t_().OperationalError,n=Ub();var i=/^(?:name|message|stack|cause)$/;function s(t){var s;if(function(e){return e instanceof Error&&n.getPrototypeOf(e)===Error.prototype}(t)){(s=new r(t)).name=t.name,s.message=t.message,s.stack=t.stack;for(var o=n.keys(t),a=0;a<o.length;++a){var c=o[a];i.test(c)||(s[c]=t[c])}return s}return e.markAsOriginatingFromRejection(t),t}return aw=function(e,r){return function(n,i){if(null!==e){if(n){var o=s(t(n));e._attachExtraTrace(o),e._reject(o)}else if(r){for(var a=arguments.length,c=new Array(Math.max(a-1,0)),l=1;l<a;++l)c[l-1]=arguments[l];e._fulfill(c)}else e._fulfill(i);e=null}}},aw}function s_(){return vw||(vw=1,gw=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},s=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},o=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return s.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}),gw}function o_(){return Sw||(Sw=1,_w=function(e,t,r,n,i,s){var o=e._getDomain,a=Kb(),c=a.tryCatch,l=a.errorObj,u=e._async;function h(e,t,r,n){this.constructor$(e),this._promise._captureStackTrace();var s=o();this._callback=null===s?t:a.domainBind(s,t),this._preservedValues=n===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],u.invoke(this._asyncInit,this,void 0)}function f(t,n,i,s){if("function"!=typeof n)return r("expecting a function but got "+a.classString(n));var o=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+a.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(i.concurrency)));o=i.concurrency}return new h(t,n,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,s).promise()}a.inherits(h,t),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,r){var i=this._values,o=this.length(),a=this._preservedValues,u=this._limit;if(r<0){if(i[r=-1*r-1]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return i[r]=t,this._queue.push(r),!1;null!==a&&(a[r]=t);var h=this._promise,f=this._callback,p=h._boundValue();h._pushContext();var d=c(f).call(p,t,r,o),m=h._popContext();if(s.checkForgottenReturns(d,m,null!==a?"Promise.filter":"Promise.map",h),d===l)return this._reject(d.e),!0;var y=n(d,this._promise);if(y instanceof e){var g=(y=y._target())._bitField;if(0==(50397184&g))return u>=1&&this._inFlight++,i[r]=y,y._proxy(this,-1*(r+1)),!1;if(0==(33554432&g))return 0!=(16777216&g)?(this._reject(y._reason()),!0):(this._cancel(),!0);d=y._value()}i[r]=d}return++this._totalResolved>=o&&(null!==a?this._filter(i,a):this._resolve(i),!0)},h.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),i=0,s=0;s<r;++s)e[s]&&(n[i++]=t[s]);n.length=i,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return f(this,e,t,null)},e.map=function(e,t,r,n){return f(e,t,r,n)}}),_w}function a_(){return xw||(xw=1,kw=function(e,t,r,n,i,s){var o=Kb(),a=t_().TypeError,c=Kb().inherits,l=o.errorObj,u=o.tryCatch,h={};function f(e){setTimeout((function(){throw e}),0)}function p(t,n){var s=0,o=t.length,a=new e(i);return function i(){if(s>=o)return a._fulfill();var c=function(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(t[s++]);if(c instanceof e&&c._isDisposable()){try{c=r(c._getDisposer().tryDispose(n),t.promise)}catch(e){return f(e)}if(c instanceof e)return c._then(i,f,null,null,null)}i()}(),a}function d(e,t,r){this._data=e,this._promise=t,this._context=r}function m(e,t,r){this.constructor$(e,t,r)}function y(e){return d.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function g(e){this.length=e,this.promise=null,this[e-1]=null}d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},d.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==h?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},d.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(m,d),m.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},g.prototype._resultCancelled=function(){for(var t=this.length,r=0;r<t;++r){var n=this[r];n instanceof e&&n.cancel()}},e.using=function(){var n=arguments.length;if(n<2)return t("you must pass at least 2 arguments to Promise.using");var i,a=arguments[n-1];if("function"!=typeof a)return t("expecting a function but got "+o.classString(a));var c=!0;2===n&&Array.isArray(arguments[0])?(n=(i=arguments[0]).length,c=!1):(i=arguments,n--);for(var h=new g(n),f=0;f<n;++f){var m=i[f];if(d.isDisposer(m)){var v=m;(m=m.promise())._setDisposable(v)}else{var b=r(m);b instanceof e&&(m=b._then(y,null,null,{resources:h,index:f},void 0))}h[f]=m}var w=new Array(h.length);for(f=0;f<w.length;++f)w[f]=e.resolve(h[f]).reflect();var _=e.all(w).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return l.e=r.error(),l;if(!r.isFulfilled())return void _.cancel();e[t]=r.value()}S._pushContext(),a=u(a);var n=c?a.apply(void 0,e):a(e),i=S._popContext();return s.checkForgottenReturns(n,i,"Promise.using",S),n})),S=_.lastly((function(){var t=new e.PromiseInspection(_);return p(h,t)}));return h.promise=S,S._setOnCancel(h),S},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new m(e,this,n());throw new a}}),kw}function c_(){return Rw||(Rw=1,Cw=function(e,t,r){var n=Kb(),i=e.TimeoutError;function s(e){this.handle=e}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var o=function(e){return a(+this).thenReturn(e)},a=e.delay=function(n,i){var a,c;return void 0!==i?(a=e.resolve(i)._then(o,null,null,n,void 0),r.cancellation()&&i instanceof e&&a._setOnCancel(i)):(a=new e(t),c=setTimeout((function(){a._fulfill()}),+n),r.cancellation()&&a._setOnCancel(new s(c)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};e.prototype.delay=function(e){return a(e,this)};function c(e){return clearTimeout(this.handle),e}function l(e){throw clearTimeout(this.handle),e}e.prototype.timeout=function(e,t){var o,a;e=+e;var u=new s(setTimeout((function(){o.isPending()&&function(e,t,r){var s;s="string"!=typeof t?t instanceof Error?t:new i("operation timed out"):new i(t),n.markAsOriginatingFromRejection(s),e._attachExtraTrace(s),e._reject(s),null!=r&&r.cancel()}(o,t,a)}),e));return r.cancellation()?(a=this.then(),(o=a._then(c,l,void 0,u,void 0))._setOnCancel(u)):o=this._then(c,l,void 0,u,void 0),o}}),Cw}function l_(){return Nw||(Nw=1,Ow=function(e,t,r,n,i,s){var o=t_().TypeError,a=Kb(),c=a.errorObj,l=a.tryCatch,u=[];function h(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly((function(){return c})),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(r))._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(u):u,this._yieldedPromise=null,this._cancellationPhase=!1}a.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},h.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var r=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(t.e,!1);var i=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(i);var s=n(i,this._promise);if(s instanceof e||(s=function(t,r,i){for(var s=0;s<r.length;++s){i._pushContext();var o=l(r[s])(t);if(i._popContext(),o===c){i._pushContext();var a=e.reject(c.e);return i._popContext(),a}var u=n(o,i);if(u instanceof e)return u}return null}(s,this._yieldHandlers,this._promise),null!==s)){var a=(s=s._target())._bitField;0==(50397184&a)?(this._yieldedPromise=s,s._proxy(this,null)):0!=(33554432&a)?e._async.invoke(this._promiseFulfilled,this,s._value()):0!=(16777216&a)?e._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()}else this._promiseRejected(new o("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",i)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(e,t){if("function"!=typeof e)throw new o("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=h,i=(new Error).stack;return function(){var t=e.apply(this,arguments),s=new n(void 0,void 0,r,i),o=s.promise();return s._generator=t,s._promiseFulfilled(void 0),o}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new o("expecting a function but got "+a.classString(e));u.push(e)},e.spawn=function(r){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof r)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new h(r,this),i=n.promise();return n._run(e.spawn),i}}),Ow}function u_(){return Bw||(Bw=1,Pw=function(e,t){var r={},n=Kb(),i=i_(),s=n.withAppended,o=n.maybeWrapAsError,a=n.canEvaluate,c=t_().TypeError,l={__isPromisified__:!0},u=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(e){return n.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function f(e){return!u.test(e)}function p(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function d(e,t,r){var i=n.getDataPropertyOrDefault(e,t+r,l);return!!i&&p(i)}function m(e,t,r,i){for(var s=n.inheritedDataKeys(e),o=[],a=0;a<s.length;++a){var l=s[a],u=e[l],f=i===h||h(l);"function"!=typeof u||p(u)||d(e,l,t)||!i(l,u,e,f)||o.push(l,u)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var i=e[n];if(r.test(i))for(var s=i.replace(r,""),o=0;o<e.length;o+=2)if(e[o]===s)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(o,t,r),o}var y;y=function(a,c,l,u,h,f){var p=Math.max(0,function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0}(u)-1),d=function(e){for(var t=[e],r=Math.max(0,e-1-3),n=e-1;n>=r;--n)t.push(n);for(n=e+1;n<=3;++n)t.push(n);return t}(p),m="string"==typeof a||c===r;function y(e){var t,r=(t=e,n.filledRange(t,"_arg","")).join(", "),i=e>0?", ":"";return(m?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===c?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",r).replace(", ",i)}var g="string"==typeof a?"this != null ? this['"+a+"'] : fn":"fn",v="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+f+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",function(){for(var e="",t=0;t<d.length;++t)e+="case "+d[t]+":"+y(d[t]);return e+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",m?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",g);return v=v.replace("Parameters",function(e){return n.filledRange(Math.max(e,3),"_arg","")}(p)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",v)(e,u,c,s,o,i,n.tryCatch,n.errorObj,n.notEnumerableProp,t)};var g=a?y:function(a,c,l,u,h,f){var p=function(){return this}(),d=a;function m(){var n=c;c===r&&(n=this);var l=new e(t);l._captureStackTrace();var u="string"==typeof d&&this!==p?this[d]:a,h=i(l,f);try{u.apply(n,s(arguments,h))}catch(e){l._rejectCallback(o(e),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof d&&(a=u),n.notEnumerableProp(m,"__isPromisified__",!0),m};function v(e,t,i,s,o){for(var a=new RegExp(t.replace(/([$])/,"\\$")+"$"),c=m(e,t,a,i),l=0,u=c.length;l<u;l+=2){var h=c[l],f=c[l+1],p=h+t;if(s===g)e[p]=g(h,r,h,f,t,o);else{var d=s(f,(function(){return g(h,r,h,f,t,o)}));n.notEnumerableProp(d,"__isPromisified__",!0),e[p]=d}}return n.toFastProperties(e),e}e.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+n.classString(e));if(p(e))return e;var i=function(e,t,r){return g(e,t,void 0,e,null,r)}(e,void 0===(t=Object(t)).context?r:t.context,!!t.multiArgs);return n.copyDescriptors(e,i,f),i},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,i=t.suffix;"string"!=typeof i&&(i="Async");var s=t.filter;"function"!=typeof s&&(s=h);var o=t.promisifier;if("function"!=typeof o&&(o=g),!n.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=n.inheritedDataKeys(e),l=0;l<a.length;++l){var u=e[a[l]];"constructor"!==a[l]&&n.isClass(u)&&(v(u.prototype,i,s,o,r),v(u,i,s,o,r))}return v(e,i,s,o,r)}}),Pw}function h_(){return $w||($w=1,Dw=function(e,t,r,n){var i,s=Kb(),o=s.isObject,a=Ub();"function"==typeof Map&&(i=Map);var c=function(){var e=0,t=0;function r(r,n){this[e]=r,this[e+t]=n,e++}return function(n){t=n.size,e=0;var i=new Array(2*n.size);return n.forEach(r,i),i}}();function l(e){var t,r=!1;if(void 0!==i&&e instanceof i)t=c(e),r=!0;else{var n=a.keys(e),s=n.length;t=new Array(2*s);for(var o=0;o<s;++o){var l=n[o];t[o]=e[l],t[o+s]=l}}this.constructor$(t),this._isMap=r,this._init$(void 0,-3)}function u(t){var i,s=r(t);return o(s)?(i=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new l(s).promise(),s instanceof e&&i._propagateFrom(s,2),i):n("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(l,t),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new i,r=e.length/2|0,n=0;n<r;++n){var s=e[r+n],o=e[n];t.set(s,o)}return t}(this._values);else{r={};for(var n=this.length(),s=0,o=this.length();s<o;++s)r[this._values[s+n]]=this._values[s]}return this._resolve(r),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return u(this)},e.props=function(e){return u(e)}}),Dw}function f_(){return jw||(jw=1,Lw=function(e,t,r,n){var i=Kb();function s(o,a){var c=r(o);if(c instanceof e)return function(e){return e.then((function(t){return s(t,e)}))}(c);if(null===(o=i.asArray(o)))return n("expecting an array or an iterable object but got "+i.classString(o));var l=new e(t);void 0!==a&&l._propagateFrom(a,3);for(var u=l._fulfill,h=l._reject,f=0,p=o.length;f<p;++f){var d=o[f];(void 0!==d||f in o)&&e.cast(d)._then(u,h,void 0,l,null)}return l}e.race=function(e){return s(e,void 0)},e.prototype.race=function(){return s(this,void 0)}}),Lw}!function(e){e.exports=function(){var t=function(){return new f("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new C.PromiseInspection(this._target())},n=function(e){return C.reject(new f(e))};function i(){}var s,o={},a=Kb();s=a.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},a.notEnumerableProp(C,"_getDomain",s);var c=Ub(),l=e_(),u=new l;c.defineProperty(C,"_async",{value:u});var h=t_(),f=C.TypeError=h.TypeError;C.RangeError=h.RangeError;var p=C.CancellationError=h.CancellationError;C.TimeoutError=h.TimeoutError,C.OperationalError=h.OperationalError,C.RejectionError=h.OperationalError,C.AggregateError=h.AggregateError;var d=function(){},m={},y={},g=r_()(C,d),v=(Zb||(Zb=1,Yb=function(e,t,r,n,i){var s=Kb();function o(r){var n=this._promise=new e(t);r instanceof e&&n._propagateFrom(r,3),n._setOnCancel(this),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.isArray,s.inherits(o,i),o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function t(i,o){var a=r(this._values,this._promise);if(a instanceof e){var c=(a=a._target())._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,o);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===o?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{}}}(o));else{var l=n("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(l,!1)}},o.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,s=!1,o=null,a=0;a<n;++a){var c=r(t[a],i);o=c instanceof e?(c=c._target())._bitField:null,s?null!==o&&c.suppressUnhandledRejections():null!==o?0==(50397184&o)?(c._proxy(this,a),this._values[a]=c):s=0!=(33554432&o)?this._promiseFulfilled(c._value(),a):0!=(16777216&o)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):s=this._promiseFulfilled(c,a)}s||i._setAsyncGuaranteed()},o.prototype._isResolved=function(){return null===this._values},o.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},o.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},o.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},o.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseCancelled=function(){return this._cancel(),!0},o.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},o.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var r=0;r<t.length;++r)t[r]instanceof e&&t[r].cancel()}},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(e){return e},o}),Yb)(C,d,g,n,i),b=(ew||(ew=1,Qb=function(e){var t=!1,r=[];function n(){this._trace=new n.CapturedTrace(i())}function i(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},n.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},n.CapturedTrace=null,n.create=function(){if(t)return new n},n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var r=e.prototype._pushContext,s=e.prototype._popContext,o=e._peekContext,a=e.prototype._peekContext,c=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=s,e._peekContext=o,e.prototype._peekContext=a,e.prototype._promiseCreated=c,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},n}),Qb)(C),w=b.create,_=n_()(C,b);_.CapturedTrace;var S=(iw||(iw=1,nw=function(e,t){var r=Kb(),n=e.CancellationError,i=r.errorObj;function s(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function o(e){this.finallyHandler=e}function a(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function c(){return u.call(this,this.promise._target()._settledValue())}function l(e){if(!a(this,e))return i.e=e,i}function u(r){var s=this.promise,u=this.handler;if(!this.called){this.called=!0;var h=this.isFinallyHandler()?u.call(s._boundValue()):u.call(s._boundValue(),r);if(void 0!==h){s._setReturnedNonUndefined();var f=t(h,s);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var p=new n("late cancellation observer");return s._attachExtraTrace(p),i.e=p,i}f.isPending()&&f._attachCancellationCallback(new o(this))}return f._then(c,l,void 0,this,void 0)}}}return s.isRejected()?(a(this),i.e=r,i):(a(this),r)}return s.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){a(this.finallyHandler)},e.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new s(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,u,u)},e.prototype.tap=function(e){return this._passThrough(e,1,u)},s}),nw)(C,g),E=(ow||(ow=1,sw=function(e){var t=Kb(),r=Ub().keys,n=t.tryCatch,i=t.errorObj;return function(s,o,a){return function(c){var l=a._boundValue();e:for(var u=0;u<s.length;++u){var h=s[u];if(h===Error||null!=h&&h.prototype instanceof Error){if(c instanceof h)return n(o).call(l,c)}else if("function"==typeof h){var f=n(h).call(l,c);if(f===i)return f;if(f)return n(o).call(l,c)}else if(t.isObject(c)){for(var p=r(h),d=0;d<p.length;++d){var m=p[d];if(h[m]!=c[m])continue e}return n(o).call(l,c)}}return e}}}),sw)(y),A=i_(),k=a.errorObj,x=a.tryCatch;function C(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==d&&(!function(e,t){if("function"!=typeof t)throw new f("expecting a function but got "+a.classString(t));if(e.constructor!==C)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}(this,e),this._resolveFromExecutor(e)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function R(e){this.promise._resolveCallback(e)}function O(e){this.promise._rejectCallback(e,!1)}function N(e){var t=new C(d);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return C.prototype.toString=function(){return"[object Promise]"},C.prototype.caught=C.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,i=new Array(t-1),s=0;for(r=0;r<t-1;++r){var o=arguments[r];if(!a.isObject(o))return n("expecting an object but got A catch statement predicate "+a.classString(o));i[s++]=o}return i.length=s,e=arguments[r],this.then(void 0,E(i,e,this))}return this.then(void 0,e)},C.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},C.prototype.then=function(e,t){if(_.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+a.classString(e);arguments.length>1&&(r+=", "+a.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},C.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},C.prototype.spread=function(e){return"function"!=typeof e?n("expecting a function but got "+a.classString(e)):this.all()._then(e,void 0,void 0,m,void 0)},C.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},C.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new v(this).promise()},C.prototype.error=function(e){return this.caught(a.originatesFromRejection,e)},C.getNewLibraryCopy=e.exports,C.is=function(e){return e instanceof C},C.fromNode=C.fromCallback=function(e){var t=new C(d);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=x(e)(A(t,r));return n===k&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},C.all=function(e){return new v(e).promise()},C.cast=function(e){var t=g(e);return t instanceof C||((t=new C(d))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},C.resolve=C.fulfilled=C.cast,C.reject=C.rejected=function(e){var t=new C(d);return t._captureStackTrace(),t._rejectCallback(e,!0),t},C.setScheduler=function(e){if("function"!=typeof e)throw new f("expecting a function but got "+a.classString(e));return u.setScheduler(e)},C.prototype._then=function(e,t,r,n,i){var o=void 0!==i,c=o?i:new C(d),l=this._target(),h=l._bitField;o||(c._propagateFrom(this,3),c._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&h)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,c));var f=s();if(0!=(50397184&h)){var m,y,g=l._settlePromiseCtx;0!=(33554432&h)?(y=l._rejectionHandler0,m=e):0!=(16777216&h)?(y=l._fulfillmentHandler0,m=t,l._unsetRejectionIsUnhandled()):(g=l._settlePromiseLateCancellationObserver,y=new p("late cancellation observer"),l._attachExtraTrace(y),m=t),u.invoke(g,l,{handler:null===f?m:"function"==typeof m&&a.domainBind(f,m),promise:c,receiver:n,value:y})}else l._addCallbacks(e,t,c,n,f);return c},C.prototype._length=function(){return 65535&this._bitField},C.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},C.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},C.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},C.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},C.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},C.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},C.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},C.prototype._isFinal=function(){return(4194304&this._bitField)>0},C.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},C.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},C.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},C.prototype._setAsyncGuaranteed=function(){u.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},C.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==o)return void 0===t&&this._isBound()?this._boundValue():t},C.prototype._promiseAt=function(e){return this[4*e-4+2]},C.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},C.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},C.prototype._boundValue=function(){},C.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,n=e._promise0,i=e._receiverAt(0);void 0===i&&(i=o),this._addCallbacks(t,r,n,i,null)},C.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),i=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=o),this._addCallbacks(r,n,i,s,null)},C.prototype._addCallbacks=function(e,t,r,n,i){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=null===i?e:a.domainBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=null===i?t:a.domainBind(i,t));else{var o=4*s-4;this[o+2]=r,this[o+3]=n,"function"==typeof e&&(this[o+0]=null===i?e:a.domainBind(i,e)),"function"==typeof t&&(this[o+1]=null===i?t:a.domainBind(i,t))}return this._setLength(s+1),s},C.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},C.prototype._resolveCallback=function(e,r){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(t(),!1);var n=g(e,this);if(!(n instanceof C))return this._fulfill(e);r&&this._propagateFrom(n,2);var i=n._target();if(i!==this){var s=i._bitField;if(0==(50397184&s)){var o=this._length();o>0&&i._migrateCallback0(this);for(var a=1;a<o;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&s))this._fulfill(i._value());else if(0!=(16777216&s))this._reject(i._reason());else{var c=new p("late cancellation observer");i._attachExtraTrace(c),this._reject(c)}}else this._reject(t())}},C.prototype._rejectCallback=function(e,t,r){var n=a.ensureErrorObject(e),i=n===e;if(!i&&!r&&_.warnings()){var s="a promise was rejected with a non-error: "+a.classString(e);this._warn(s,!0)}this._attachExtraTrace(n,!!t&&i),this._reject(e)},C.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)},C.prototype._settlePromiseFromHandler=function(e,t,r,n){var i=n._bitField;if(0==(65536&i)){var s;n._pushContext(),t===m?r&&"number"==typeof r.length?s=x(e).apply(this._boundValue(),r):(s=k).e=new f("cannot .spread() a non-array: "+a.classString(r)):s=x(e).call(t,r);var o=n._popContext();0==(65536&(i=n._bitField))&&(s===y?n._reject(r):s===k?n._rejectCallback(s.e,!1):(_.checkForgottenReturns(s,o,"",n,this),n._resolveCallback(s)))}},C.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},C.prototype._followee=function(){return this._rejectionHandler0},C.prototype._setFollowee=function(e){this._rejectionHandler0=e},C.prototype._settlePromise=function(e,t,n,s){var o=e instanceof C,a=this._bitField,c=0!=(134217728&a);0!=(65536&a)?(o&&e._invokeInternalOnCancel(),n instanceof S&&n.isFinallyHandler()?(n.cancelPromise=e,x(t).call(n,s)===k&&e._reject(k.e)):t===r?e._fulfill(r.call(n)):n instanceof i?n._promiseCancelled(e):o||e instanceof v?e._cancel():n.cancel()):"function"==typeof t?o?(c&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,s,e)):t.call(n,s,e):n instanceof i?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(s,e):n._promiseRejected(s,e)):o&&(c&&e._setAsyncGuaranteed(),0!=(33554432&a)?e._fulfill(s):e._reject(s))},C.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,n=e.receiver,i=e.value;"function"==typeof t?r instanceof C?this._settlePromiseFromHandler(t,n,i,r):t.call(n,i,r):r instanceof C&&r._reject(i)},C.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},C.prototype._settlePromise0=function(e,t,r){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,i,t)},C.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},C.prototype._fulfill=function(e){var r=this._bitField;if(!((117506048&r)>>>16)){if(e===this){var n=t();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&r)>0&&(0!=(134217728&r)?this._settlePromises():u.settlePromises(this))}},C.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return u.fatalError(e,a.isNode);(65535&t)>0?u.settlePromises(this):this._ensurePossibleRejectionHandled()}},C.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var n=this._fulfillmentHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},C.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var n=this._rejectionHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},C.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},C.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},C.defer=C.pending=function(){return _.deprecated("Promise.defer","new Promise"),{promise:new C(d),resolve:R,reject:O}},a.notEnumerableProp(C,"_makeSelfResolutionError",t),(uw||(uw=1,lw=function(e,t,r,n,i){var s=Kb(),o=s.tryCatch;e.method=function(r){if("function"!=typeof r)throw new e.TypeError("expecting a function but got "+s.classString(r));return function(){var n=new e(t);n._captureStackTrace(),n._pushContext();var s=o(r).apply(this,arguments),a=n._popContext();return i.checkForgottenReturns(s,a,"Promise.method",n),n._resolveFromSyncValue(s),n}},e.attempt=e.try=function(r){if("function"!=typeof r)return n("expecting a function but got "+s.classString(r));var a,c=new e(t);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];a=s.isArray(l)?o(r).apply(u,l):o(r).call(u,l)}else a=o(r)();var h=c._popContext();return i.checkForgottenReturns(a,h,"Promise.try",c),c._resolveFromSyncValue(a),c},e.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}),lw)(C,d,g,n,_),(fw||(fw=1,hw=function(e,t,r,n){var i=!1,s=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(s,s,null,this,e)},a=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},c=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(s){i||(i=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var l=r(s),u=new e(t);u._propagateFrom(this,1);var h=this._target();if(u._setBoundTo(l),l instanceof e){var f={promiseRejectionQueued:!1,promise:u,target:h,bindingPromise:l};h._then(t,o,void 0,u,f),l._then(a,c,void 0,u,f),u._setOnCancel(l)}else u._resolveCallback(h);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}),hw)(C,d,g,_),(dw||(dw=1,pw=function(e,t,r,n){var i=Kb(),s=i.tryCatch,o=i.errorObj,a=e._async;e.prototype.break=e.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),a.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=s(e).call(this._boundValue());n===o&&(this._attachExtraTrace(n.e),a.throwLater(n.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),a.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}),pw)(C,v,n,_),(yw||(yw=1,mw=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,(function(){throw t}))},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];return n instanceof e&&n.suppressUnhandledRejections(),this.caught(r,(function(){return n}))}}),mw)(C),s_()(C),(ww||(ww=1,bw=function(e,t,r,n,i,s){var o,a=Kb(),c=a.canEvaluate,l=a.tryCatch,u=a.errorObj;if(c){for(var h=function(e){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,e))},f=function(e){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,e))},p=function(t){for(var r=new Array(t),n=0;n<r.length;++n)r[n]="this.p"+(n+1);var s=r.join(" = ")+" = null;",o="var promise;\n"+r.map((function(e){return"                                                         \n\t                promise = "+e+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "})).join("\n"),a=r.join(", "),c="Holder$"+t,h="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return h=h.replace(/\[TheName\]/g,c).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,a).replace(/\[TheProperties\]/g,s).replace(/\[CancellationCode\]/g,o),new Function("tryCatch","errorObj","Promise","async",h)(l,u,e,i)},d=[],m=[],y=[],g=0;g<8;++g)d.push(p(g+1)),m.push(h(g+1)),y.push(f(g+1));o=function(e){this._reject(e)}}e.join=function(){var i,l=arguments.length-1;if(l>0&&"function"==typeof arguments[l]&&(i=arguments[l],l<=8&&c)){(S=new e(n))._captureStackTrace();for(var u=new(0,d[l-1])(i),h=m,f=0;f<l;++f){var p=r(arguments[f],S);if(p instanceof e){var g=(p=p._target())._bitField;0==(50397184&g)?(p._then(h[f],o,void 0,S,u),y[f](p,u),u.asyncNeeded=!1):0!=(33554432&g)?h[f].call(S,p._value(),u):0!=(16777216&g)?S._reject(p._reason()):S._cancel()}else h[f].call(S,p,u)}if(!S._isFateSealed()){if(u.asyncNeeded){var v=s();null!==v&&(u.fn=a.domainBind(v,u.fn))}S._setAsyncGuaranteed(),S._setOnCancel(u)}return S}for(var b=arguments.length,w=new Array(b),_=0;_<b;++_)w[_]=arguments[_];i&&w.pop();var S=new t(w).promise();return void 0!==i?S.spread(i):S}}),bw)(C,v,g,d,u,s),C.Promise=C,C.version="3.4.7",o_()(C,v,n,g,d,_),function(){if(Aw)return Ew;Aw=1;var e=Object.create;if(e){var t=e(null),r=e(null);t[" size"]=r[" size"]=0}return Ew=function(e){var n,i,s=Kb(),o=s.canEvaluate,a=s.isIdentifier,c=function(e){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,e))(h)},l=function(e){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",e))},u=function(e,t,r){var n=r[e];if("function"!=typeof n){if(!a(e))return null;if(n=t(e),r[e]=n,r[" size"]++,r[" size"]>512){for(var i=Object.keys(r),s=0;s<256;++s)delete r[i[s]];r[" size"]=i.length-256}}return n};function h(t,r){var n;if(null!=t&&(n=t[r]),"function"!=typeof n){var i="Object "+s.classString(t)+" has no method '"+s.toString(r)+"'";throw new e.TypeError(i)}return n}function f(e){return h(e,this.pop()).apply(e,this)}function p(e){return e[this]}function d(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}n=function(e){return u(e,c,t)},i=function(e){return u(e,l,r)},e.prototype.call=function(e){for(var t=arguments.length,r=new Array(Math.max(t-1,0)),i=1;i<t;++i)r[i-1]=arguments[i];if(o){var s=n(e);if(null!==s)return this._then(s,void 0,void 0,r,void 0)}return r.push(e),this._then(f,void 0,void 0,r,void 0)},e.prototype.get=function(e){var t;if("number"==typeof e)t=d;else if(o){var r=i(e);t=null!==r?r:p}else t=p;return this._then(t,void 0,void 0,e,void 0)}},Ew}()(C),a_()(C,n,g,w,d,_),c_()(C,d,_),l_()(C,n,d,g,i,_),(Tw||(Tw=1,Iw=function(e){var t=Kb(),r=e._async,n=t.tryCatch,i=t.errorObj;function s(e,s){if(!t.isArray(e))return o.call(this,e,s);var a=n(s).apply(this._boundValue(),[null].concat(e));a===i&&r.throwLater(a.e)}function o(e,t){var s=this._boundValue(),o=void 0===e?n(t).call(s,null):n(t).call(s,null,e);o===i&&r.throwLater(o.e)}function a(e,t){if(!e){var s=new Error(e+"");s.cause=e,e=s}var o=n(t).call(this._boundValue(),e);o===i&&r.throwLater(o.e)}e.prototype.asCallback=e.prototype.nodeify=function(e,t){if("function"==typeof e){var r=o;void 0!==t&&Object(t).spread&&(r=s),this._then(r,a,void 0,this,e)}return this}}),Iw)(C),u_()(C,d),h_()(C,v,g,n),f_()(C,d,g,n),(Uw||(Uw=1,Mw=function(e,t,r,n,i,s){var o=e._getDomain,a=Kb(),c=a.tryCatch;function l(t,r,n,s){this.constructor$(t);var c=o();this._fn=null===c?r:a.domainBind(c,r),void 0!==n&&(n=e.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=s===i?Array(this._length):0===s?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function u(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function h(e,t,n,i){return"function"!=typeof t?r("expecting a function but got "+a.classString(t)):new l(e,t,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var r=n(this.value,this.array._promise);return r instanceof e?(this.array._currentCancellable=r,r._then(p,void 0,void 0,this,void 0)):p.call(this,r)}function p(t){var r,n=this.array,i=n._promise,o=c(n._fn);i._pushContext(),(r=void 0!==n._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(n._currentCancellable=r);var a=i._popContext();return s.checkForgottenReturns(r,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}a.inherits(l,t),l.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},l.prototype._iterate=function(t){var r,n;this._values=t;var i=t.length;if(void 0!==this._initialValue?(r=this._initialValue,n=0):(r=e.resolve(t[0]),n=1),this._currentCancellable=r,!r.isRejected())for(;n<i;++n){var s={accum:null,value:t[n],index:n,length:i,array:this};r=r._then(f,void 0,void 0,s,void 0)}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(u,u,void 0,r,this)},e.prototype.reduce=function(e,t){return h(this,e,t,null)},e.reduce=function(e,t,r,n){return h(e,t,r,n)}}),Mw)(C,v,n,g,d,_),(Fw||(Fw=1,Kw=function(e,t,r){var n=e.PromiseInspection;function i(e){this.constructor$(e)}Kb().inherits(i,t),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var r=new n;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},i.prototype._promiseRejected=function(e,t){var r=new n;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},e.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},e.prototype.settle=function(){return e.settle(this)}}),Kw)(C,v,_),(zw||(zw=1,Hw=function(e,t,r){var n=Kb(),i=t_().RangeError,s=t_().AggregateError,o=n.isArray,a={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(e),i=n.promise();return n.setHowMany(t),n.init(),i}n.inherits(c,t),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=o(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(a),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new s,t=this.length();t<this._values.length;++t)this._values[t]!==a&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return l(e,t)},e.prototype.some=function(e){return l(this,e)},e._SomePromiseArray=c}),Hw)(C,v,n),(qw||(qw=1,Vw=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,i){return r(e,n,i,t)}}),Vw)(C,d),(Ww||(Ww=1,Gw=function(e,t){var r=e.reduce,n=e.all;function i(){return n(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(i,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(i,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}),Gw)(C,d),(Jw||(Jw=1,Xw=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}),Xw)(C),a.toFastProperties(C),a.toFastProperties(C.prototype),N({a:1}),N({b:2}),N({c:3}),N(1),N((function(){})),N(void 0),N(!1),N(new C(d)),_.setBounds(l.firstLineError,a.lastLineError),C}}(jb),"undefined"!=typeof Promise&&(Yw=Promise);var p_=(0,jb.exports)();p_.noConflict=function(){try{Promise===p_&&(Promise=Yw)}catch(e){}return p_};var d_=p_,m_=s.Buffer;void 0===m_.from&&(m_.from=function(e,t,r){return new m_(e,t,r)},m_.alloc=m_.from);var y_,g_,v_,b_,w_,__=m_,S_={exports:{}},E_={exports:{}};function A_(){if(y_)return E_.exports;return y_=1,"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?E_.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,s,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,r)}));case 4:return process.nextTick((function(){e.call(null,t,r,n)}));default:for(i=new Array(o-1),s=0;s<i.length;)i[s++]=arguments[s];return process.nextTick((function(){e.apply(null,i)}))}}}:E_.exports=process,E_.exports}function k_(){return w_?b_:(w_=1,b_=a)}var x_,C_={exports:{}};function R_(){return x_||(x_=1,function(e,t){var r=s,n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(C_,C_.exports)),C_.exports}var O_,N_={};function I_(){if(O_)return N_;function e(e){return Object.prototype.toString.call(e)}return O_=1,N_.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},N_.isBoolean=function(e){return"boolean"==typeof e},N_.isNull=function(e){return null===e},N_.isNullOrUndefined=function(e){return null==e},N_.isNumber=function(e){return"number"==typeof e},N_.isString=function(e){return"string"==typeof e},N_.isSymbol=function(e){return"symbol"==typeof e},N_.isUndefined=function(e){return void 0===e},N_.isRegExp=function(t){return"[object RegExp]"===e(t)},N_.isObject=function(e){return"object"==typeof e&&null!==e},N_.isDate=function(t){return"[object Date]"===e(t)},N_.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},N_.isFunction=function(e){return"function"==typeof e},N_.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},N_.isBuffer=s.Buffer.isBuffer,N_}var T_,P_={exports:{}},B_={exports:{}};try{var D_=require("util");if("function"!=typeof D_.inherits)throw"";P_.exports=D_.inherits}catch(Am){P_.exports=(T_||(T_=1,"function"==typeof Object.create?B_.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:B_.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),B_.exports)}var $_,L_,j_,M_,U_,K_,F_,H_,z_,V_=P_.exports,q_={exports:{}};function G_(){return $_||($_=1,function(e){var t=R_().Buffer,n=r;e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return t.alloc(0);if(1===this.length)return this.head.data;for(var r,n,i,s=t.allocUnsafe(e>>>0),o=this.head,a=0;o;)r=o.data,n=s,i=a,r.copy(n,i),a+=o.data.length,o=o.next;return s},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})}(q_)),q_.exports}function W_(){if(j_)return L_;j_=1;var e=A_();function t(e,t){e.emit("error",t)}return L_={destroy:function(r,n){var i=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return s||o?(n?n(r):!r||this._writableState&&this._writableState.errorEmitted||e.nextTick(t,this,r),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,(function(r){!n&&r?(e.nextTick(t,i,r),i._writableState&&(i._writableState.errorEmitted=!0)):n&&n(r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}}function X_(){if(F_)return K_;F_=1;var e=A_();function t(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}K_=d;var n,i=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:e.nextTick;d.WritableState=p;var s=Object.create(I_());s.inherits=V_;var o={deprecate:U_?M_:(U_=1,M_=r.deprecate)},a=k_(),c=R_().Buffer,l=U.Uint8Array||function(){};var u,h=W_();function f(){}function p(r,s){n=n||J_(),r=r||{};var o=s instanceof n;this.objectMode=!!r.objectMode,o&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var a=r.highWaterMark,c=r.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:o&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===r.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,r){var n=t._writableState,s=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),r)!function(t,r,n,i,s){--r.pendingcb,n?(e.nextTick(s,i),e.nextTick(w,t,r),t._writableState.errorEmitted=!0,t.emit("error",i)):(s(i),t._writableState.errorEmitted=!0,t.emit("error",i),w(t,r))}(t,n,s,r,o);else{var a=v(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||g(t,n),s?i(y,t,n,a,o):y(t,n,a,o)}}(s,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}function d(e){if(n=n||J_(),!(u.call(d,this)||this instanceof n))return new d(e);this._writableState=new p(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function m(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function y(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),w(e,t)}function g(e,r){r.bufferProcessing=!0;var n=r.bufferedRequest;if(e._writev&&n&&n.next){var i=r.bufferedRequestCount,s=new Array(i),o=r.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)s[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;s.allBuffers=c,m(e,r,!0,r.length,s,"",o.finish),r.pendingcb++,r.lastBufferedRequest=null,o.next?(r.corkedRequestsFree=o.next,o.next=null):r.corkedRequestsFree=new t(r),r.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,u=n.encoding,h=n.callback;if(m(e,r,!1,r.objectMode?1:l.length,l,u,h),n=n.next,r.bufferedRequestCount--,r.writing)break}null===n&&(r.lastBufferedRequest=null)}r.bufferedRequest=n,r.bufferProcessing=!1}function v(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),w(e,t)}))}function w(t,r){var n=v(r);return n&&(!function(t,r){r.prefinished||r.finalCalled||("function"==typeof t._final?(r.pendingcb++,r.finalCalled=!0,e.nextTick(b,t,r)):(r.prefinished=!0,t.emit("prefinish")))}(t,r),0===r.pendingcb&&(r.finished=!0,t.emit("finish"))),n}return s.inherits(d,a),p.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(p.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(d,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===d&&(e&&e._writableState instanceof p)}})):u=function(e){return e instanceof this},d.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},d.prototype.write=function(t,r,n){var i,s=this._writableState,o=!1,a=!s.objectMode&&(i=t,c.isBuffer(i)||i instanceof l);return a&&!c.isBuffer(t)&&(t=function(e){return c.from(e)}(t)),"function"==typeof r&&(n=r,r=null),a?r="buffer":r||(r=s.defaultEncoding),"function"!=typeof n&&(n=f),s.ended?function(t,r){var n=new Error("write after end");t.emit("error",n),e.nextTick(r,n)}(this,n):(a||function(t,r,n,i){var s=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||r.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),e.nextTick(i,o),s=!1),s}(this,s,t,n))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,a,n,i,s);return l}(this,s,a,t,r,n)),o},d.prototype.cork=function(){this._writableState.corked++},d.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||g(this,e))},d.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),d.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},d.prototype._writev=null,d.prototype.end=function(t,r,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,r=null):"function"==typeof r&&(n=r,r=null),null!=t&&this.write(t,r),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,r,n){r.ending=!0,w(t,r),n&&(r.finished?e.nextTick(n):t.once("finish",n));r.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),d.prototype.destroy=h.destroy,d.prototype._undestroy=h.undestroy,d.prototype._destroy=function(e,t){this.end(),t(e)},K_}function J_(){if(z_)return H_;z_=1;var e=A_(),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};H_=c;var r=Object.create(I_());r.inherits=V_;var n=aS(),i=X_();r.inherits(c,n);for(var s=t(i.prototype),o=0;o<s.length;o++){var a=s[o];c.prototype[a]||(c.prototype[a]=i.prototype[a])}function c(e){if(!(this instanceof c))return new c(e);n.call(this,e),i.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",l)}function l(){this.allowHalfOpen||this._writableState.ended||e.nextTick(u,this)}function u(e){e.end()}return Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)},H_}var Y_,Z_,Q_,eS,tS,rS,nS,iS,sS={};function oS(){if(Y_)return sS;Y_=1;var e=R_().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(r){var n;switch(this.encoding=function(r){var n=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(r);if("string"!=typeof n&&(e.isEncoding===t||!t(r)))throw new Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=s,this.end=o,n=4;break;case"utf8":this.fillLast=i,n=4;break;case"base64":this.text=a,this.end=c,n=3;break;default:return this.write=l,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(n)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function s(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function o(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function a(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return sS.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},r.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var s=n(t[i]);if(s>=0)return s>0&&(e.lastNeed=s-1),s;if(--i<r||-2===s)return 0;if(s=n(t[i]),s>=0)return s>0&&(e.lastNeed=s-2),s;if(--i<r||-2===s)return 0;if(s=n(t[i]),s>=0)return s>0&&(2===s?s=0:e.lastNeed=s-3),s;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},sS}function aS(){if(Q_)return Z_;Q_=1;var e=A_();Z_=g;var t,n=function(){if(v_)return g_;v_=1;var e={}.toString;return g_=Array.isArray||function(t){return"[object Array]"==e.call(t)}}();g.ReadableState=y,m.EventEmitter;var i=function(e,t){return e.listeners(t).length},s=k_(),o=R_().Buffer,a=U.Uint8Array||function(){};var c=Object.create(I_());c.inherits=V_;var l=r,u=void 0;u=l&&l.debuglog?l.debuglog("stream"):function(){};var h,f=G_(),p=W_();c.inherits(g,s);var d=["error","close","destroy","pause","resume"];function y(e,r){e=e||{};var n=r instanceof(t=t||J_());this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=oS().StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function g(e){if(t=t||J_(),!(this instanceof g))return new g(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function v(e,t,r,n,i){var s,c=e._readableState;null===t?(c.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,S(e)}(e,c)):(i||(s=function(e,t){var r;n=t,o.isBuffer(n)||n instanceof a||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(c,t)),s?e.emit("error",s):c.objectMode||t&&t.length>0?("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),n?c.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):b(e,c,t,!0):c.ended?e.emit("error",new Error("stream.push() after EOF")):(c.reading=!1,c.decoder&&!r?(t=c.decoder.write(t),c.objectMode||0!==t.length?b(e,c,t,!1):A(e,c)):b(e,c,t,!1))):n||(c.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(c)}function b(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&S(e)),A(e,t)}Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.push(null),t(e)},g.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=o.from(e,t),t=""),r=!0),v(this,e,t,!1,r)},g.prototype.unshift=function(e){return v(this,e,null,!0,!1)},g.prototype.isPaused=function(){return!1===this._readableState.flowing},g.prototype.setEncoding=function(e){return h||(h=oS().StringDecoder),this._readableState.decoder=new h(e),this._readableState.encoding=e,this};var w=8388608;function _(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function S(t){var r=t._readableState;r.needReadable=!1,r.emittedReadable||(u("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?e.nextTick(E,t):E(t))}function E(e){u("emit readable"),e.emit("readable"),R(e)}function A(t,r){r.readingMore||(r.readingMore=!0,e.nextTick(k,t,r))}function k(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(u("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function x(e){u("readable nexttick read 0"),e.read(0)}function C(e,t){t.reading||(u("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var s=r.data,o=e>s.length?s.length:e;if(o===s.length?i+=s:i+=s.slice(0,e),0===(e-=o)){o===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(o));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=o.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var s=n.data,a=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,a),0===(e-=a)){a===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function N(t){var r=t._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,e.nextTick(I,r,t))}function I(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function T(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}return g.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):S(this),null;if(0===(e=_(e,t))&&t.ended)return 0===t.length&&N(this),null;var n,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=_(r,t))),null===(n=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&N(this)),null!==n&&this.emit("data",n),n},g.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},g.prototype.pipe=function(t,r){var s=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,u("pipe count=%d opts=%j",o.pipesCount,r);var a=(!r||!1!==r.end)&&t!==process.stdout&&t!==process.stderr?l:v;function c(e,r){u("onunpipe"),e===s&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,u("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",m),t.removeListener("unpipe",c),s.removeListener("end",l),s.removeListener("end",v),s.removeListener("data",d),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function l(){u("onend"),t.end()}o.endEmitted?e.nextTick(a):s.once("end",a),t.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,R(e))}}(s);t.on("drain",h);var f=!1;var p=!1;function d(e){u("ondata"),p=!1,!1!==t.write(e)||p||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==T(o.pipes,t))&&!f&&(u("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,p=!0),s.pause())}function m(e){u("onerror",e),v(),t.removeListener("error",m),0===i(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",g),v()}function g(){u("onfinish"),t.removeListener("close",y),v()}function v(){u("unpipe"),s.unpipe(t)}return s.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(t,"error",m),t.once("close",y),t.once("finish",g),t.emit("pipe",s),o.flowing||(u("pipe resume"),s.resume()),t},g.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,r);return this}var o=T(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},g.prototype.on=function(t,r){var n=s.prototype.on.call(this,t,r);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&S(this):e.nextTick(x,this))}return n},g.prototype.addListener=g.prototype.on,g.prototype.resume=function(){var t=this._readableState;return t.flowing||(u("resume"),t.flowing=!0,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(C,t,r))}(this,t)),this},g.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},g.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<d.length;s++)e.on(d[s],this.emit.bind(this,d[s]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(g.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),g._fromList=O,Z_}function cS(){if(tS)return eS;tS=1,eS=n;var e=J_(),t=Object.create(I_());function r(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(t){if(!(this instanceof n))return new n(t);e.call(this,t),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",i)}function i(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){s(e,t,r)})):s(this,null,null)}function s(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}return t.inherits=V_,t.inherits(n,e),n.prototype.push=function(t,r){return this._transformState.needTransform=!1,e.prototype.push.call(this,t,r)},n.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},n.prototype._destroy=function(t,r){var n=this;e.prototype._destroy.call(this,t,(function(e){r(e),n.emit("close")}))},eS}function lS(){return iS||(iS=1,function(e,t){var r=a;"disable"===process.env.READABLE_STREAM&&r?(e.exports=r,(t=e.exports=r.Readable).Readable=r.Readable,t.Writable=r.Writable,t.Duplex=r.Duplex,t.Transform=r.Transform,t.PassThrough=r.PassThrough,t.Stream=r):((t=e.exports=aS()).Stream=r||t,t.Readable=t,t.Writable=X_(),t.Duplex=J_(),t.Transform=cS(),t.PassThrough=function(){if(nS)return rS;nS=1,rS=r;var e=cS(),t=Object.create(I_());function r(t){if(!(this instanceof r))return new r(t);e.call(this,t)}return t.inherits=V_,t.inherits(r,e),r.prototype._transform=function(e,t,r){r(null,e)},rS}())}(S_,S_.exports)),S_.exports}var uS=a,hS=d_,fS=r,pS=__;function dS(){if(!(this instanceof dS))return new dS;uS.Duplex.call(this,{decodeStrings:!1,objectMode:!0}),this.buffer=pS.from("");var e=this;e.on("finish",(function(){e.finished=!0,e.emit("chunk",!1)}))}uS.Writable&&uS.Writable.prototype.destroy||(uS=lS()),fS.inherits(dS,uS.Duplex),dS.prototype._write=function(e,t,r){this.buffer=pS.concat([this.buffer,e]),this.cb=r,this.emit("chunk")},dS.prototype.stream=function(e,t){var r,n=uS.PassThrough(),i=this;function s(){if("function"==typeof i.cb){var e=i.cb;return i.cb=void 0,e()}}function o(){var a;if(i.buffer&&i.buffer.length){if("number"==typeof e)a=i.buffer.slice(0,e),i.buffer=i.buffer.slice(e),e-=a.length,r=!e;else{var c=i.buffer.indexOf(e);if(-1!==c)i.match=c,t&&(c+=e.length),a=i.buffer.slice(0,c),i.buffer=i.buffer.slice(c),r=!0;else{var l=i.buffer.length-e.length;l<=0?s():(a=i.buffer.slice(0,l),i.buffer=i.buffer.slice(l))}}a&&n.write(a,(function(){(0===i.buffer.length||e.length&&i.buffer.length<=e.length)&&s()}))}if(r)i.removeListener("chunk",o),n.end();else if(i.finished)return i.removeListener("chunk",o),void i.emit("error",new Error("FILE_ENDED"))}return i.on("chunk",o),o(),n},dS.prototype.pull=function(e,t){if(0===e)return hS.resolve("");if(!isNaN(e)&&this.buffer.length>e){var r=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),hS.resolve(r)}var n,i,s=pS.from(""),o=this,a=uS.Transform();return a._transform=function(e,t,r){s=pS.concat([s,e]),r()},new hS((function(r,c){if(n=c,i=function(e){o.__emittedError=e,c(e)},o.finished)return c(new Error("FILE_ENDED"));o.once("error",i),o.stream(e,t).on("error",c).pipe(a).on("finish",(function(){r(s)})).on("error",c)})).finally((function(){o.removeListener("error",n),o.removeListener("error",i)}))},dS.prototype._read=function(){};var mS=dS,yS=a,gS=r;function vS(){if(!(this instanceof vS))return new vS;yS.Transform.call(this)}yS.Writable&&yS.Writable.prototype.destroy||(yS=lS()),gS.inherits(vS,yS.Transform),vS.prototype._transform=function(e,t,r){r()};var bS=vS,wS=d_,_S=a,SS=__;_S.Writable&&_S.Writable.prototype.destroy||(_S=lS());var ES=function(e){return new wS((function(t,r){var n=[],i=_S.Transform().on("finish",(function(){t(SS.concat(n))})).on("error",r);i._transform=function(e,t,r){n.push(e),r()},e.on("error",r).pipe(i)}))},AS=Lb,kS=function(e,t){for(var r;!r&&e&&e.length;){var n=AS.parse(e).word16lu("signature").word16lu("partsize").word64lu("uncompressedSize").word64lu("compressedSize").word64lu("offset").word64lu("disknum").vars;1===n.signature?r=n:e=e.slice(n.partsize+4)}return r=r||{},4294967295===t.compressedSize&&(t.compressedSize=r.compressedSize),4294967295===t.uncompressedSize&&(t.uncompressedSize=r.uncompressedSize),4294967295===t.offsetToLocalFileHeader&&(t.offsetToLocalFileHeader=r.offset),r},xS=function(e,t){const r=31&e,n=e>>5&15,i=1980+(e>>9&127),s=t?2*(31&t):0,o=t?t>>5&63:0,a=t?t>>11:0;return new Date(Date.UTC(i,n-1,r,a,o,s))},CS=r,RS=S,OS=a,NS=Lb,IS=d_,TS=mS,PS=bS,BS=ES,DS=kS,$S=__,LS=xS;OS.Writable&&OS.Writable.prototype.destroy||(OS=lS());var jS=$S.alloc(4);function MS(e){if(!(this instanceof MS))return new MS(e);var t=this;t._opts=e||{verbose:!1},TS.call(t,t._opts),t.on("finish",(function(){t.emit("end"),t.emit("close")})),t._readRecord().catch((function(e){t.__emittedError&&t.__emittedError===e||t.emit("error",e)}))}jS.writeUInt32LE(101010256,0),CS.inherits(MS,TS),MS.prototype._readRecord=function(){var e=this;return e.pull(4).then((function(t){if(0!==t.length){var r=t.readUInt32LE(0);if(875721283===r)return e._readCrxHeader();if(67324752===r)return e._readFile();if(33639248===r)return e.reachedCD=!0,e._readCentralDirectoryFileHeader();if(101010256===r)return e._readEndOfCentralDirectoryRecord();if(e.reachedCD){return e.pull(jS,!0).then((function(){return e._readEndOfCentralDirectoryRecord()}))}e.emit("error",new Error("invalid signature: 0x"+r.toString(16)))}}))},MS.prototype._readCrxHeader=function(){var e=this;return e.pull(12).then((function(t){return e.crxHeader=NS.parse(t).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars,e.pull(e.crxHeader.pubKeyLength+e.crxHeader.signatureLength)})).then((function(t){return e.crxHeader.publicKey=t.slice(0,e.crxHeader.pubKeyLength),e.crxHeader.signature=t.slice(e.crxHeader.pubKeyLength),e.emit("crx-header",e.crxHeader),e._readRecord()}))},MS.prototype._readFile=function(){var e=this;return e.pull(26).then((function(t){var r=NS.parse(t).word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return r.lastModifiedDateTime=LS(r.lastModifiedDate,r.lastModifiedTime),e.crxHeader&&(r.crxHeader=e.crxHeader),e.pull(r.fileNameLength).then((function(t){var n=t.toString("utf8"),i=OS.PassThrough(),s=!1;return i.autodrain=function(){s=!0;var e=i.pipe(PS());return e.promise=function(){return new IS((function(t,r){e.on("finish",t),e.on("error",r)}))},e},i.buffer=function(){return BS(i)},i.path=n,i.props={},i.props.path=n,i.props.pathBuffer=t,i.props.flags={isUnicode:0!=(2048&r.flags)},i.type=0===r.uncompressedSize&&/[\/\\]$/.test(n)?"Directory":"File",e._opts.verbose&&("Directory"===i.type?console.log("   creating:",n):"File"===i.type&&(0===r.compressionMethod?console.log(" extracting:",n):console.log("  inflating:",n))),e.pull(r.extraFieldLength).then((function(t){var o=DS(t,r);i.vars=r,i.extra=o,e._opts.forceStream?e.push(i):(e.emit("entry",i),(e._readableState.pipesCount||e._readableState.pipes&&e._readableState.pipes.length)&&e.push(i)),e._opts.verbose&&console.log({filename:n,vars:r,extra:o});var a,c=!(8&r.flags)||r.compressedSize>0;i.__autodraining=s;var l=r.compressionMethod&&!s?RS.createInflateRaw():OS.PassThrough();return c?(i.size=r.uncompressedSize,a=r.compressedSize):(a=$S.alloc(4)).writeUInt32LE(134695760,0),new IS((function(t,r){e.stream(a).pipe(l).on("error",(function(t){e.emit("error",t)})).pipe(i).on("finish",(function(){return c?e._readRecord().then(t).catch(r):e._processDataDescriptor(i).then(t).catch(r)}))}))}))}))}))},MS.prototype._processDataDescriptor=function(e){var t=this;return t.pull(16).then((function(r){var n=NS.parse(r).word32lu("dataDescriptorSignature").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").vars;return e.size=n.uncompressedSize,t._readRecord()}))},MS.prototype._readCentralDirectoryFileHeader=function(){var e=this;return e.pull(42).then((function(t){var r=NS.parse(t).word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return e.pull(r.fileNameLength).then((function(t){return r.fileName=t.toString("utf8"),e.pull(r.extraFieldLength)})).then((function(t){return e.pull(r.fileCommentLength)})).then((function(t){return e._readRecord()}))}))},MS.prototype._readEndOfCentralDirectoryRecord=function(){var e=this;return e.pull(18).then((function(t){var r=NS.parse(t).word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars;return e.pull(r.commentLength).then((function(t){t=t.toString("utf8"),e.end(),e.push(null)}))}))},MS.prototype.promise=function(){var e=this;return new IS((function(t,r){e.on("finish",t),e.on("error",r)}))};var US=MS,KS={exports:{}},FS=lS();function HS(e,t,r){void 0===r&&(r=t,t=e,e=null),FS.Duplex.call(this,e),"function"!=typeof r.read&&(r=new FS.Readable(e).wrap(r)),this._writable=t,this._readable=r,this._waiting=!1;var n=this;t.once("finish",(function(){n.end()})),this.once("finish",(function(){t.end()})),r.on("readable",(function(){n._waiting&&(n._waiting=!1,n._read())})),r.once("end",(function(){n.push(null)})),e&&void 0!==e.bubbleErrors&&!e.bubbleErrors||(t.on("error",(function(e){n.emit("error",e)})),r.on("error",(function(e){n.emit("error",e)})))}HS.prototype=Object.create(FS.Duplex.prototype,{constructor:{value:HS}}),HS.prototype._write=function(e,t,r){this._writable.write(e,t,r)},HS.prototype._read=function(){for(var e,t=0;null!==(e=this._readable.read());)this.push(e),t++;0===t&&(this._waiting=!0)},KS.exports=function(e,t,r){return new HS(e,t,r)},KS.exports.DuplexWrapper=HS;var zS=KS.exports,VS=a,qS=US,GS=zS,WS=ES;VS.Writable&&VS.Writable.prototype.destroy||(VS=lS());var XS=function(e,t){var r,n=VS.PassThrough({objectMode:!0}),i=VS.PassThrough(),s=VS.Transform({objectMode:!0}),o=e instanceof RegExp?e:e&&new RegExp(e);s._transform=function(e,t,n){if(r||o&&!o.exec(e.path))return e.autodrain(),n();r=!0,a.emit("entry",e),e.on("error",(function(e){i.emit("error",e)})),e.pipe(i).on("error",(function(e){n(e)})).on("finish",(function(e){n(null,e)}))},n.pipe(qS(t)).on("error",(function(e){i.emit("error",e)})).pipe(s).on("error",Object).on("finish",(function(){r?i.end():i.emit("error",new Error("PATTERN_NOT_FOUND"))}));var a=GS(n,i);return a.buffer=function(){return WS(i)},a},JS={},YS=QS,ZS=a.Stream;function QS(){ZS.call(this)}function eE(e,t,r){return e instanceof Error||(e=new Error(e)),e.code=e.code||t,e.path=e.path||r.path,e.fstream_type=e.fstream_type||r.type,e.fstream_path=e.fstream_path||r.path,r._path!==r.path&&(e.fstream_unc_path=e.fstream_unc_path||r._path),r.linkpath&&(e.fstream_linkpath=e.fstream_linkpath||r.linkpath),e.fstream_class=e.fstream_class||r.constructor.name,e.fstream_stack=e.fstream_stack||(new Error).stack.split(/\n/).slice(3).map((function(e){return e.replace(/^ {4}at /,"")})),e}V_(QS,ZS),QS.prototype.on=function(e,t){return"ready"===e&&this.ready?process.nextTick(t.bind(this)):ZS.prototype.on.call(this,e,t),this},QS.prototype.abort=function(){this._aborted=!0,this.emit("abort")},QS.prototype.destroy=function(){},QS.prototype.warn=function(e,t){var r=this,n=eE(e,t,r);r.listeners("warn")?r.emit("warn",n):console.error("%s %s\npath = %s\nsyscall = %s\nfstream_type = %s\nfstream_path = %s\nfstream_unc_path = %s\nfstream_class = %s\nfstream_stack =\n%s\n",t||"UNKNOWN",n.stack,n.path,n.syscall,n.fstream_type,n.fstream_path,n.fstream_unc_path,n.fstream_class,n.fstream_stack.join("\n"))},QS.prototype.info=function(e,t){this.emit("info",e,t)},QS.prototype.error=function(e,t,r){var n=eE(e,t,this);if(r)throw n;this.emit("error",n)};var tE=E,rE=process.cwd,nE=null,iE=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return nE||(nE=rE.call(process)),nE};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var sE=process.chdir;process.chdir=function(e){nE=null,sE.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,sE)}var oE=function(e){tE.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,r,n){e.open(t,tE.O_WRONLY|tE.O_SYMLINK,r,(function(t,i){t?n&&n(t):e.fchmod(i,r,(function(t){e.close(i,(function(e){n&&n(t||e)}))}))}))},e.lchmodSync=function(t,r){var n,i=e.openSync(t,tE.O_WRONLY|tE.O_SYMLINK,r),s=!0;try{n=e.fchmodSync(i,r),s=!1}finally{if(s)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return n}}(e);e.lutimes||function(e){tE.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,r,n,i){e.open(t,tE.O_SYMLINK,(function(t,s){t?i&&i(t):e.futimes(s,r,n,(function(t){e.close(s,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,r,n){var i,s=e.openSync(t,tE.O_SYMLINK),o=!0;try{i=e.futimesSync(s,r,n),o=!1}finally{if(o)try{e.closeSync(s)}catch(e){}else e.closeSync(s)}return i}):e.futimes&&(e.lutimes=function(e,t,r,n){n&&process.nextTick(n)},e.lutimesSync=function(){})}(e);e.chown=n(e.chown),e.fchown=n(e.fchown),e.lchown=n(e.lchown),e.chmod=t(e.chmod),e.fchmod=t(e.fchmod),e.lchmod=t(e.lchmod),e.chownSync=i(e.chownSync),e.fchownSync=i(e.fchownSync),e.lchownSync=i(e.lchownSync),e.chmodSync=r(e.chmodSync),e.fchmodSync=r(e.fchmodSync),e.lchmodSync=r(e.lchmodSync),e.stat=s(e.stat),e.fstat=s(e.fstat),e.lstat=s(e.lstat),e.statSync=o(e.statSync),e.fstatSync=o(e.fstatSync),e.lstatSync=o(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,r){r&&process.nextTick(r)},e.lchmodSync=function(){});e.chown&&!e.lchown&&(e.lchown=function(e,t,r,n){n&&process.nextTick(n)},e.lchownSync=function(){});"win32"===iE&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function r(r,n,i){var s=Date.now(),o=0;t(r,n,(function a(c){if(c&&("EACCES"===c.code||"EPERM"===c.code||"EBUSY"===c.code)&&Date.now()-s<6e4)return setTimeout((function(){e.stat(n,(function(e,s){e&&"ENOENT"===e.code?t(r,n,a):i(c)}))}),o),void(o<100&&(o+=10));i&&i(c)}))}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.rename));function t(t){return t?function(r,n,i){return t.call(e,r,n,(function(e){a(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function r(t){return t?function(r,n){try{return t.call(e,r,n)}catch(e){if(!a(e))throw e}}:t}function n(t){return t?function(r,n,i,s){return t.call(e,r,n,i,(function(e){a(e)&&(e=null),s&&s.apply(this,arguments)}))}:t}function i(t){return t?function(r,n,i){try{return t.call(e,r,n,i)}catch(e){if(!a(e))throw e}}:t}function s(t){return t?function(r,n,i){function s(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),i&&i.apply(this,arguments)}return"function"==typeof n&&(i=n,n=null),n?t.call(e,r,n,s):t.call(e,r,s)}:t}function o(t){return t?function(r,n){var i=n?t.call(e,r,n):t.call(e,r);return i&&(i.uid<0&&(i.uid+=4294967296),i.gid<0&&(i.gid+=4294967296)),i}:t}function a(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}e.read="function"!=typeof e.read?e.read:function(t){function r(r,n,i,s,o,a){var c;if(a&&"function"==typeof a){var l=0;c=function(u,h,f){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,r,n,i,s,o,c);a.apply(this,arguments)}}return t.call(e,r,n,i,s,o,c)}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(c=e.readSync,function(t,r,n,i,s){for(var o=0;;)try{return c.call(e,t,r,n,i,s)}catch(e){if("EAGAIN"===e.code&&o<10){o++;continue}throw e}});var c};var aE=a.Stream,cE=function(e){return{ReadStream:function t(r,n){if(!(this instanceof t))return new t(r,n);aE.call(this);var i=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,n=n||{};for(var s=Object.keys(n),o=0,a=s.length;o<a;o++){var c=s[o];this[c]=n[c]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick((function(){i._read()}));e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()}))},WriteStream:function t(r,n){if(!(this instanceof t))return new t(r,n);aE.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var i=Object.keys(n),s=0,o=i.length;s<o;s++){var a=i[s];this[a]=n[a]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}};var lE=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:uE(e)};else t=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})),t},uE=Object.getPrototypeOf||function(e){return e.__proto__};var hE,fE,pE=g,dE=oE,mE=cE,yE=lE,gE=r;function vE(e,t){Object.defineProperty(e,hE,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(hE=Symbol.for("graceful-fs.queue"),fE=Symbol.for("graceful-fs.previous")):(hE="___graceful-fs.queue",fE="___graceful-fs.previous");var bE=function(){};if(gE.debuglog?bE=gE.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(bE=function(){var e=gE.format.apply(gE,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!pE[hE]){var wE=U[hE]||[];vE(pE,wE),pE.close=function(e){function t(t,r){return e.call(pE,t,(function(e){e||kE(),"function"==typeof r&&r.apply(this,arguments)}))}return Object.defineProperty(t,fE,{value:e}),t}(pE.close),pE.closeSync=function(e){function t(t){e.apply(pE,arguments),kE()}return Object.defineProperty(t,fE,{value:e}),t}(pE.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){bE(pE[hE]),A.equal(pE[hE].length,0)}))}U[hE]||vE(U,pE[hE]);var _E,SE=EE(yE(pE));function EE(e){dE(e),e.gracefulify=EE,e.createReadStream=function(t,r){return new e.ReadStream(t,r)},e.createWriteStream=function(t,r){return new e.WriteStream(t,r)};var t=e.readFile;e.readFile=function(e,r,n){"function"==typeof r&&(n=r,r=null);return function e(r,n,i,s){return t(r,n,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):AE([e,[r,n,i],t,s||Date.now(),Date.now()])}))}(e,r,n)};var r=e.writeFile;e.writeFile=function(e,t,n,i){"function"==typeof n&&(i=n,n=null);return function e(t,n,i,s,o){return r(t,n,i,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof s&&s.apply(this,arguments):AE([e,[t,n,i,s],r,o||Date.now(),Date.now()])}))}(e,t,n,i)};var n=e.appendFile;n&&(e.appendFile=function(e,t,r,i){"function"==typeof r&&(i=r,r=null);return function e(t,r,i,s,o){return n(t,r,i,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof s&&s.apply(this,arguments):AE([e,[t,r,i,s],n,o||Date.now(),Date.now()])}))}(e,t,r,i)});var i=e.copyFile;i&&(e.copyFile=function(e,t,r,n){"function"==typeof r&&(n=r,r=0);return function e(t,r,n,s,o){return i(t,r,n,(function(i){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?"function"==typeof s&&s.apply(this,arguments):AE([e,[t,r,n,s],i,o||Date.now(),Date.now()])}))}(e,t,r,n)});var s=e.readdir;e.readdir=function(e,t,r){"function"==typeof t&&(r=t,t=null);var n=o.test(process.version)?function(e,t,r,n){return s(e,i(e,t,r,n))}:function(e,t,r,n){return s(e,t,i(e,t,r,n))};return n(e,t,r);function i(e,t,r,i){return function(s,o){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?(o&&o.sort&&o.sort(),"function"==typeof r&&r.call(this,s,o)):AE([n,[e,t,r],s,i||Date.now(),Date.now()])}}};var o=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var a=mE(e);f=a.ReadStream,p=a.WriteStream}var c=e.ReadStream;c&&(f.prototype=Object.create(c.prototype),f.prototype.open=function(){var e=this;m(e.path,e.flags,e.mode,(function(t,r){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r),e.read())}))});var l=e.WriteStream;l&&(p.prototype=Object.create(l.prototype),p.prototype.open=function(){var e=this;m(e.path,e.flags,e.mode,(function(t,r){t?(e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return f},set:function(e){f=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return p},set:function(e){p=e},enumerable:!0,configurable:!0});var u=f;Object.defineProperty(e,"FileReadStream",{get:function(){return u},set:function(e){u=e},enumerable:!0,configurable:!0});var h=p;function f(e,t){return this instanceof f?(c.apply(this,arguments),this):f.apply(Object.create(f.prototype),arguments)}function p(e,t){return this instanceof p?(l.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var d=e.open;function m(e,t,r,n){return"function"==typeof r&&(n=r,r=null),function e(t,r,n,i,s){return d(t,r,n,(function(o,a){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof i&&i.apply(this,arguments):AE([e,[t,r,n,i],o,s||Date.now(),Date.now()])}))}(e,t,r,n)}return e.open=m,e}function AE(e){bE("ENQUEUE",e[0].name,e[1]),pE[hE].push(e),xE()}function kE(){for(var e=Date.now(),t=0;t<pE[hE].length;++t)pE[hE][t].length>2&&(pE[hE][t][3]=e,pE[hE][t][4]=e);xE()}function xE(){if(clearTimeout(_E),_E=void 0,0!==pE[hE].length){var e=pE[hE].shift(),t=e[0],r=e[1],n=e[2],i=e[3],s=e[4];if(void 0===i)bE("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){bE("TIMEOUT",t.name,r);var o=r.pop();"function"==typeof o&&o.call(null,n)}else{var a=Date.now()-s,c=Math.max(s-i,1);a>=Math.min(1.2*c,100)?(bE("RETRY",t.name,r),t.apply(null,r.concat([i]))):pE[hE].push(e)}void 0===_E&&(_E=setTimeout(xE,0))}}process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!pE.__patched&&(SE=EE(pE),pE.__patched=!0);var CE,RE,OE,NE,IE,TE,PE,BE,DE,$E,LE,jE,ME=function(e){var t,r=["Directory","File","SymbolicLink","Link","BlockDevice","CharacterDevice","FIFO","Socket"];if(e.type&&-1!==r.indexOf(e.type))return e[e.type]=!0,e.type;for(var n=0,i=r.length;n<i;n++){var s=e[t=r[n]]||e["is"+t];if("function"==typeof s&&(s=s.call(e)),s)return e[t]=!0,e.type=t,t}return null};function UE(){if(RE)return CE;RE=1,CE=n;var e=SE,t=V_,r=zE();function n(e){if(!(this instanceof n))throw new Error("LinkReader must be called as constructor.");if(!("Link"===e.type&&e.Link||"SymbolicLink"===e.type&&e.SymbolicLink))throw new Error("Non-link type "+e.type);r.call(this,e)}return t(n,r),n.prototype._stat=function(t){var n=this;e.readlink(n._path,(function(e,i){if(e)return n.error(e);n.linkpath=n.props.linkpath=i,n.emit("linkpath",i),r.prototype._stat.call(n,t)}))},n.prototype._read=function(){var e=this;e._paused||e._ended||(e.emit("end"),e.emit("close"),e._ended=!0)},CE}function KE(){if(NE)return OE;NE=1,OE=s;var e=SE,t=V_,r=k,n=zE(),i=A.ok;function s(e){var t=this;if(!(t instanceof s))throw new Error("DirReader must be called as constructor.");if("Directory"!==e.type||!e.Directory)throw new Error("Non-directory type "+e.type);t.entries=null,t._index=-1,t._paused=!1,t._length=-1,e.sort&&(this.sort=e.sort),n.call(this,e)}return t(s,n),s.prototype._getEntries=function(){var t=this;t._gotEntries||(t._gotEntries=!0,e.readdir(t._path,(function(e,r){if(e)return t.error(e);function n(){t._length=t.entries.length,"function"==typeof t.sort&&(t.entries=t.entries.sort(t.sort.bind(t))),t._read()}t.entries=r,t.emit("entries",r),t._paused?t.once("resume",n):n()})))},s.prototype._read=function(){var t=this;if(!t.entries)return t._getEntries();if(!(t._paused||t._currentEntry||t._aborted))if(t._index++,t._index>=t.entries.length)t._ended||(t._ended=!0,t.emit("end"),t.emit("close"));else{var s=r.resolve(t._path,t.entries[t._index]);i(s!==t._path),i(t.entries[t._index]),t._currentEntry=s,e[t.props.follow?"stat":"lstat"](s,(function(e,i){if(e)return t.error(e);var o=t._proxy||t;i.path=s,i.basename=r.basename(s),i.dirname=r.dirname(s);var a=t.getChildProps.call(o,i);a.path=s,a.basename=r.basename(s),a.dirname=r.dirname(s);var c=n(a,i);t._currentEntry=c,c.on("pause",(function(e){t._paused||c._disowned||t.pause(e)})),c.on("resume",(function(e){t._paused&&!c._disowned&&t.resume(e)})),c.on("stat",(function(e){t.emit("_entryStat",c,e),c._aborted||(c._paused?c.once("resume",(function(){t.emit("entryStat",c,e)})):t.emit("entryStat",c,e))})),c.on("ready",(function e(){if(t._paused)return c.pause(t),t.once("resume",e);"Socket"===c.type?t.emit("socket",c):t.emitEntry(c)}));var l=!1;function u(){l||(l=!0,t.emit("childEnd",c),t.emit("entryEnd",c),t._currentEntry=null,t._paused||t._read())}c.on("close",u),c.on("disown",u),c.on("error",(function(e){c._swallowErrors?(t.warn(e),c.emit("end"),c.emit("close")):t.emit("error",e)})),["child","childEnd","warn"].forEach((function(e){c.on(e,t.emit.bind(t,e))}))}))}},s.prototype.disown=function(e){e.emit("beforeDisown"),e._disowned=!0,e.parent=e.root=null,e===this._currentEntry&&(this._currentEntry=null),e.emit("disown")},s.prototype.getChildProps=function(){return{depth:this.depth+1,root:this.root||this,parent:this,follow:this.follow,filter:this.filter,sort:this.props.sort,hardlinks:this.props.hardlinks}},s.prototype.pause=function(e){var t=this;t._paused||(e=e||t,t._paused=!0,t._currentEntry&&t._currentEntry.pause&&t._currentEntry.pause(e),t.emit("pause",e))},s.prototype.resume=function(e){var t=this;t._paused&&(e=e||t,t._paused=!1,t.emit("resume",e),t._paused||(t._currentEntry?t._currentEntry.resume&&t._currentEntry.resume(e):t._read()))},s.prototype.emitEntry=function(e){this.emit("entry",e),this.emit("child",e)},OE}function FE(){if(TE)return IE;TE=1,IE=s;var e=SE,t=V_,r=zE(),n={EOF:!0},i={CLOSE:!0};function s(e){var t=this;if(!(t instanceof s))throw new Error("FileReader must be called as constructor.");if(!("Link"===e.type&&e.Link||"File"===e.type&&e.File))throw new Error("Non-file type "+e.type);t._buffer=[],t._bytesEmitted=0,r.call(t,e)}return t(s,r),s.prototype._getStream=function(){var t=this,r=t._stream=e.createReadStream(t._path,t.props);t.props.blksize&&(r.bufferSize=t.props.blksize),r.on("open",t.emit.bind(t,"open")),r.on("data",(function(e){t._bytesEmitted+=e.length,e.length&&(t._paused||t._buffer.length?(t._buffer.push(e),t._read()):t.emit("data",e))})),r.on("end",(function(){t._paused||t._buffer.length?(t._buffer.push(n),t._read()):t.emit("end"),t._bytesEmitted!==t.props.size&&t.error("Didn't get expected byte count\nexpect: "+t.props.size+"\nactual: "+t._bytesEmitted)})),r.on("close",(function(){t._paused||t._buffer.length?(t._buffer.push(i),t._read()):t.emit("close")})),r.on("error",(function(e){t.emit("error",e)})),t._read()},s.prototype._read=function(){var e=this;if(!e._paused){if(!e._stream)return e._getStream();if(e._buffer.length){for(var t=e._buffer,r=0,s=t.length;r<s;r++){var o=t[r];if(o===n?e.emit("end"):o===i?e.emit("close"):e.emit("data",o),e._paused)return void(e._buffer=t.slice(r))}e._buffer.length=0}}},s.prototype.pause=function(e){var t=this;t._paused||(e=e||t,t._paused=!0,t._stream&&t._stream.pause(),t.emit("pause",e))},s.prototype.resume=function(e){var t=this;t._paused&&(e=e||t,t.emit("resume",e),t._paused=!1,t._stream&&t._stream.resume(),t._read())},IE}function HE(){if($E)return DE;$E=1,DE=n;var e=zE(),t=ME,r=SE;function n(t){var r=this;if(!(r instanceof n))throw new Error("ProxyReader must be called as constructor.");r.props=t,r._buffer=[],r.ready=!1,e.call(r,t)}return V_(n,e),n.prototype._stat=function(){var n=this,i=n.props,s=i.follow?"stat":"lstat";r[s](i.path,(function(r,s){var o;o=r||!s?"File":t(s),i[o]=!0,i.type=n.type=o,n._old=s,n._addProxy(e(i,s))}))},n.prototype._addProxy=function(e){var t=this;if(t._proxyTarget)return t.error("proxy already set");t._proxyTarget=e,e._proxy=t,["error","data","end","close","linkpath","entry","entryEnd","child","childEnd","warn","stat"].forEach((function(r){e.on(r,t.emit.bind(t,r))})),t.emit("proxy",e),e.on("ready",(function(){t.ready=!0,t.emit("ready")}));var r=t._buffer;t._buffer.length=0,r.forEach((function(t){e[t[0]].apply(e,t[1])}))},n.prototype.pause=function(){return!!this._proxyTarget&&this._proxyTarget.pause()},n.prototype.resume=function(){return!!this._proxyTarget&&this._proxyTarget.resume()},DE}function zE(){if(jE)return LE;jE=1,LE=l;var e=SE,t=a.Stream,r=V_,n=k,i=ME,s=l.hardLinks={},o=YS;r(l,o);var c=UE();function l(e,t){var r,s,a=this;if(!(a instanceof l))return new l(e,t);switch("string"==typeof e&&(e={path:e}),e.type&&"function"==typeof e.type?s=r=e.type:(r=i(e),s=l),t&&!r&&(e[r=i(t)]=!0,e.type=r),r){case"Directory":s=KE();break;case"Link":case"File":s=FE();break;case"SymbolicLink":s=c;break;case"Socket":s=function(){if(BE)return PE;BE=1,PE=r;var e=V_,t=zE();function r(e){if(!(this instanceof r))throw new Error("SocketReader must be called as constructor.");if("Socket"!==e.type||!e.Socket)throw new Error("Non-socket type "+e.type);t.call(this,e)}return e(r,t),r.prototype._read=function(){var e=this;e._paused||e._ended||(e.emit("end"),e.emit("close"),e._ended=!0)},PE}();break;case null:s=HE()}if(!(a instanceof s))return new s(e);o.call(a),e.path||a.error("Must provide a path",null,!0),a.readable=!0,a.writable=!1,a.type=r,a.props=e,a.depth=e.depth=e.depth||0,a.parent=e.parent||null,a.root=e.root||e.parent&&e.parent.root||a,a._path=a.path=n.resolve(e.path),"win32"===process.platform&&(a.path=a._path=a.path.replace(/\?/g,"_"),a._path.length>=260&&(a._swallowErrors=!0,a._path="\\\\?\\"+a.path.replace(/\//g,"\\"))),a.basename=e.basename=n.basename(a.path),a.dirname=e.dirname=n.dirname(a.path),e.parent=e.root=null,a.size=e.size,a.filter="function"==typeof e.filter?e.filter:null,"alpha"===e.sort&&(e.sort=u),a._stat(t)}function u(e,t){return e===t?0:e.toLowerCase()>t.toLowerCase()?1:e.toLowerCase()<t.toLowerCase()?-1:e>t?1:-1}return l.prototype._stat=function(t){var r=this,n=r.props,o=n.follow?"stat":"lstat";function a(e,t){if(e)return r.error(e);if(Object.keys(t).forEach((function(e){n[e]=t[e]})),void 0!==r.size&&n.size!==r.size)return r.error("incorrect size");r.size=n.size;var o=i(n);if(!1!==n.hardlinks&&"Directory"!==o&&n.nlink&&n.nlink>1){var a=n.dev+":"+n.ino;s[a]!==r._path&&s[a]?(o=r.type=r.props.type="Link",r.Link=r.props.Link=!0,r.linkpath=r.props.linkpath=s[a],r._stat=r._read=c.prototype._read):s[a]=r._path}if(r.type&&r.type!==o&&r.error("Unexpected type: "+o),r.filter){var l=r._proxy||r;if(!r.filter.call(l,l,n))return void(r._disowned||(r.abort(),r.emit("end"),r.emit("close")))}var u=["_stat","stat","ready"],h=0;!function e(){if(r._aborted)return r.emit("end"),void r.emit("close");if(r._paused&&"Directory"!==r.type)r.once("resume",e);else{var t=u[h++];if(!t)return r._read();r.emit(t,n),e()}}()}t?process.nextTick(a.bind(null,null,t)):e[o](r._path,a)},l.prototype.pipe=function(e){var r=this;return"function"==typeof e.add&&r.on("entry",(function(t){!1===e.add(t)&&r.pause()})),t.prototype.pipe.apply(this,arguments)},l.prototype.pause=function(e){this._paused=!0,e=e||this,this.emit("pause",e),this._stream&&this._stream.pause(e)},l.prototype.resume=function(e){this._paused=!1,e=e||this,this.emit("resume",e),this._stream&&this._stream.resume(e),this._read()},l.prototype._read=function(){this.error("Cannot read unknown type: "+this.type)},LE}var VE,qE,GE,WE,XE,JE,YE,ZE,QE,eA,tA,rA={};function nA(){if(VE)return rA;VE=1;var e=k,t="win32"===process.platform,r=g,n=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function i(e){return"function"==typeof e?e:function(){var e;if(n){var t=new Error;e=function(e){e&&(t.message=e.message,r(e=t))}}else e=r;return e;function r(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}if(e.normalize,t)var s=/(.*?)(?:[\/\\]+|$)/g;else s=/(.*?)(?:[\/]+|$)/g;if(t)var o=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else o=/^[\/]*/;return rA.realpathSync=function(n,i){if(n=e.resolve(n),i&&Object.prototype.hasOwnProperty.call(i,n))return i[n];var a,c,l,u,h=n,f={},p={};function d(){var e=o.exec(n);a=e[0].length,c=e[0],l=e[0],u="",t&&!p[l]&&(r.lstatSync(l),p[l]=!0)}for(d();a<n.length;){s.lastIndex=a;var m=s.exec(n);if(u=c,c+=m[0],l=u+m[1],a=s.lastIndex,!(p[l]||i&&i[l]===l)){var y;if(i&&Object.prototype.hasOwnProperty.call(i,l))y=i[l];else{var g=r.lstatSync(l);if(!g.isSymbolicLink()){p[l]=!0,i&&(i[l]=l);continue}var v=null;if(!t){var b=g.dev.toString(32)+":"+g.ino.toString(32);f.hasOwnProperty(b)&&(v=f[b])}null===v&&(r.statSync(l),v=r.readlinkSync(l)),y=e.resolve(u,v),i&&(i[l]=y),t||(f[b]=v)}n=e.resolve(y,n.slice(a)),d()}}return i&&(i[h]=n),n},rA.realpath=function(n,a,c){if("function"!=typeof c&&(c=i(a),a=null),n=e.resolve(n),a&&Object.prototype.hasOwnProperty.call(a,n))return process.nextTick(c.bind(null,null,a[n]));var l,u,h,f,p=n,d={},m={};function y(){var e=o.exec(n);l=e[0].length,u=e[0],h=e[0],f="",t&&!m[h]?r.lstat(h,(function(e){if(e)return c(e);m[h]=!0,g()})):process.nextTick(g)}function g(){if(l>=n.length)return a&&(a[p]=n),c(null,n);s.lastIndex=l;var e=s.exec(n);return f=u,u+=e[0],h=f+e[1],l=s.lastIndex,m[h]||a&&a[h]===h?process.nextTick(g):a&&Object.prototype.hasOwnProperty.call(a,h)?w(a[h]):r.lstat(h,v)}function v(e,n){if(e)return c(e);if(!n.isSymbolicLink())return m[h]=!0,a&&(a[h]=h),process.nextTick(g);if(!t){var i=n.dev.toString(32)+":"+n.ino.toString(32);if(d.hasOwnProperty(i))return b(null,d[i],h)}r.stat(h,(function(e){if(e)return c(e);r.readlink(h,(function(e,r){t||(d[i]=r),b(e,r)}))}))}function b(t,r,n){if(t)return c(t);var i=e.resolve(f,r);a&&(a[n]=i),w(i)}function w(t){n=e.resolve(t,n.slice(l)),y()}y()},rA}function iA(){if(GE)return qE;GE=1,qE=a,a.realpath=a,a.sync=c,a.realpathSync=c,a.monkeypatch=function(){e.realpath=a,e.realpathSync=c},a.unmonkeypatch=function(){e.realpath=t,e.realpathSync=r};var e=g,t=e.realpath,r=e.realpathSync,n=process.version,i=/^v[0-5]\./.test(n),s=nA();function o(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function a(e,r,n){if(i)return t(e,r,n);"function"==typeof r&&(n=r,r=null),t(e,r,(function(t,i){o(t)?s.realpath(e,r,n):n(t,i)}))}function c(e,t){if(i)return r(e,t);try{return r(e,t)}catch(r){if(o(r))return s.realpathSync(e,t);throw r}}return qE}function sA(){if(XE)return WE;XE=1,WE=function(t,r){for(var n=[],i=0;i<t.length;i++){var s=r(t[i],i);e(s)?n.push.apply(n,s):n.push(s)}return n};var e=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};return WE}function oA(){if(QE)return ZE;QE=1;var e=sA(),t=function(){if(YE)return JE;function e(e,n,i){e instanceof RegExp&&(e=t(e,i)),n instanceof RegExp&&(n=t(n,i));var s=r(e,n,i);return s&&{start:s[0],end:s[1],pre:i.slice(0,s[0]),body:i.slice(s[0]+e.length,s[1]),post:i.slice(s[1]+n.length)}}function t(e,t){var r=t.match(e);return r?r[0]:null}function r(e,t,r){var n,i,s,o,a,c=r.indexOf(e),l=r.indexOf(t,c+1),u=c;if(c>=0&&l>0){if(e===t)return[c,l];for(n=[],s=r.length;u>=0&&!a;)u==c?(n.push(u),c=r.indexOf(e,u+1)):1==n.length?a=[n.pop(),l]:((i=n.pop())<s&&(s=i,o=l),l=r.indexOf(t,u+1)),u=c<l&&c>=0?c:l;n.length&&(a=[s,o])}return a}return YE=1,JE=e,e.range=r,JE}();ZE=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return d(function(e){return e.split("\\\\").join(r).split("\\{").join(n).split("\\}").join(i).split("\\,").join(s).split("\\.").join(o)}(e),!0).map(c)};var r="\0SLASH"+Math.random()+"\0",n="\0OPEN"+Math.random()+"\0",i="\0CLOSE"+Math.random()+"\0",s="\0COMMA"+Math.random()+"\0",o="\0PERIOD"+Math.random()+"\0";function a(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function c(e){return e.split(r).join("\\").split(n).join("{").split(i).join("}").split(s).join(",").split(o).join(".")}function l(e){if(!e)return[""];var r=[],n=t("{","}",e);if(!n)return e.split(",");var i=n.pre,s=n.body,o=n.post,a=i.split(",");a[a.length-1]+="{"+s+"}";var c=l(o);return o.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),r.push.apply(r,a),r}function u(e){return"{"+e+"}"}function h(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function p(e,t){return e>=t}function d(r,n){var s=[],o=t("{","}",r);if(!o||/\$$/.test(o.pre))return[r];var c,m=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),y=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),g=m||y,v=o.body.indexOf(",")>=0;if(!g&&!v)return o.post.match(/,.*\}/)?d(r=o.pre+"{"+o.body+i+o.post):[r];if(g)c=o.body.split(/\.\./);else if(1===(c=l(o.body)).length&&1===(c=d(c[0],!1).map(u)).length)return(_=o.post.length?d(o.post,!1):[""]).map((function(e){return o.pre+c[0]+e}));var b,w=o.pre,_=o.post.length?d(o.post,!1):[""];if(g){var S=a(c[0]),E=a(c[1]),A=Math.max(c[0].length,c[1].length),k=3==c.length?Math.abs(a(c[2])):1,x=f;E<S&&(k*=-1,x=p);var C=c.some(h);b=[];for(var R=S;x(R,E);R+=k){var O;if(y)"\\"===(O=String.fromCharCode(R))&&(O="");else if(O=String(R),C){var N=A-O.length;if(N>0){var I=new Array(N+1).join("0");O=R<0?"-"+I+O.slice(1):I+O}}b.push(O)}}else b=e(c,(function(e){return d(e,!1)}));for(var T=0;T<b.length;T++)for(var P=0;P<_.length;P++){var B=w+b[T]+_[P];(!n||g||B)&&s.push(B)}return s}return ZE}function aA(){if(tA)return eA;tA=1,eA=l,l.Minimatch=u;var e=function(){try{return require("path")}catch(e){}}()||{sep:"/"};l.sep=e.sep;var t=l.GLOBSTAR=u.GLOBSTAR={},r=oA(),n={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},i="[^/]",s=i+"*?",o=function(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}("().*{}+?[]^$\\!");var a=/\/+/;function c(e,t){t=t||{};var r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),Object.keys(t).forEach((function(e){r[e]=t[e]})),r}function l(e,t,r){return f(t),r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&new u(t,r).match(e)}function u(t,r){if(!(this instanceof u))return new u(t,r);f(t),r||(r={}),t=t.trim(),r.allowWindowsEscape||"/"===e.sep||(t=t.split(e.sep).join("/")),this.options=r,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.make()}function h(e,t){return t||(t=this instanceof u?this.options:{}),e=void 0===e?this.pattern:e,f(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:r(e)}l.filter=function(e,t){return t=t||{},function(r,n,i){return l(r,e,t)}},l.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return l;var t=l,r=function(r,n,i){return t(r,n,c(e,i))};return(r.Minimatch=function(r,n){return new t.Minimatch(r,c(e,n))}).defaults=function(r){return t.defaults(c(e,r)).Minimatch},r.filter=function(r,n){return t.filter(r,c(e,n))},r.defaults=function(r){return t.defaults(c(e,r))},r.makeRe=function(r,n){return t.makeRe(r,c(e,n))},r.braceExpand=function(r,n){return t.braceExpand(r,c(e,n))},r.match=function(r,n,i){return t.match(r,n,c(e,i))},r},u.defaults=function(e){return l.defaults(e).Minimatch},u.prototype.debug=function(){},u.prototype.make=function(){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)});this.debug(this.pattern,r),r=this.globParts=r.map((function(e){return e.split(a)})),this.debug(this.pattern,r),r=r.map((function(e,t,r){return e.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,r),this.set=r},u.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,s=e.length;i<s&&"!"===e.charAt(i);i++)t=!t,n++;n&&(this.pattern=e.substr(n));this.negate=t},l.braceExpand=function(e,t){return h(e,t)},u.prototype.braceExpand=h;var f=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};u.prototype.parse=function(e,r){f(e);var a=this.options;if("**"===e){if(!a.noglobstar)return t;e="*"}if(""===e)return"";var c,l="",u=!!a.nocase,h=!1,d=[],m=[],y=!1,g=-1,v=-1,b="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",w=this;function _(){if(c){switch(c){case"*":l+=s,u=!0;break;case"?":l+=i,u=!0;break;default:l+="\\"+c}w.debug("clearStateChar %j %j",c,l),c=!1}}for(var S,E=0,A=e.length;E<A&&(S=e.charAt(E));E++)if(this.debug("%s\t%s %s %j",e,E,l,S),h&&o[S])l+="\\"+S,h=!1;else switch(S){case"/":return!1;case"\\":_(),h=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,E,l,S),y){this.debug("  in class"),"!"===S&&E===v+1&&(S="^"),l+=S;continue}w.debug("call clearStateChar %j",c),_(),c=S,a.noext&&_();continue;case"(":if(y){l+="(";continue}if(!c){l+="\\(";continue}d.push({type:c,start:E-1,reStart:l.length,open:n[c].open,close:n[c].close}),l+="!"===c?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,l),c=!1;continue;case")":if(y||!d.length){l+="\\)";continue}_(),u=!0;var k=d.pop();l+=k.close,"!"===k.type&&m.push(k),k.reEnd=l.length;continue;case"|":if(y||!d.length||h){l+="\\|",h=!1;continue}_(),l+="|";continue;case"[":if(_(),y){l+="\\"+S;continue}y=!0,v=E,g=l.length,l+=S;continue;case"]":if(E===v+1||!y){l+="\\"+S,h=!1;continue}var x=e.substring(v+1,E);try{RegExp("["+x+"]")}catch(e){var C=this.parse(x,p);l=l.substr(0,g)+"\\["+C[0]+"\\]",u=u||C[1],y=!1;continue}u=!0,y=!1,l+=S;continue;default:_(),h?h=!1:!o[S]||"^"===S&&y||(l+="\\"),l+=S}y&&(x=e.substr(v+1),C=this.parse(x,p),l=l.substr(0,g)+"\\["+C[0],u=u||C[1]);for(k=d.pop();k;k=d.pop()){var R=l.slice(k.reStart+k.open.length);this.debug("setting tail",l,k),R=R.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,r){return r||(r="\\"),t+t+r+"|"})),this.debug("tail=%j\n   %s",R,R,k,l);var O="*"===k.type?s:"?"===k.type?i:"\\"+k.type;u=!0,l=l.slice(0,k.reStart)+O+"\\("+R}_(),h&&(l+="\\\\");var N=!1;switch(l.charAt(0)){case"[":case".":case"(":N=!0}for(var I=m.length-1;I>-1;I--){var T=m[I],P=l.slice(0,T.reStart),B=l.slice(T.reStart,T.reEnd-8),D=l.slice(T.reEnd-8,T.reEnd),$=l.slice(T.reEnd);D+=$;var L=P.split("(").length-1,j=$;for(E=0;E<L;E++)j=j.replace(/\)[+*?]?/,"");var M="";""===($=j)&&r!==p&&(M="$"),l=P+B+$+M+D}""!==l&&u&&(l="(?=.)"+l);N&&(l=b+l);if(r===p)return[l,u];if(!u)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var U=a.nocase?"i":"";try{var K=new RegExp("^"+l+"$",U)}catch(e){return new RegExp("$.")}return K._glob=e,K._src=l,K};var p={};return l.makeRe=function(e,t){return new u(e,t||{}).makeRe()},u.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var r=this.options,n=r.noglobstar?s:r.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=r.nocase?"i":"",o=e.map((function(e){return e.map((function(e){return e===t?n:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch(e){this.regexp=!1}return this.regexp},l.match=function(e,t,r){var n=new u(t,r=r||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},u.prototype.match=function(t,r){if(void 0===r&&(r=this.partial),this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&r)return!0;var n=this.options;"/"!==e.sep&&(t=t.split(e.sep).join("/")),t=t.split(a),this.debug(this.pattern,"split",t);var i,s,o=this.set;for(this.debug(this.pattern,"set",o),s=t.length-1;s>=0&&!(i=t[s]);s--);for(s=0;s<o.length;s++){var c=o[s],l=t;if(n.matchBase&&1===c.length&&(l=[i]),this.matchOne(l,c,r))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},u.prototype.matchOne=function(e,r,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var s=0,o=0,a=e.length,c=r.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var l,u=r[o],h=e[s];if(this.debug(r,u,h),!1===u)return!1;if(u===t){this.debug("GLOBSTAR",[r,u,h]);var f=s,p=o+1;if(p===c){for(this.debug("** at the end");s<a;s++)if("."===e[s]||".."===e[s]||!i.dot&&"."===e[s].charAt(0))return!1;return!0}for(;f<a;){var d=e[f];if(this.debug("\nglobstar while",e,f,r,p,d),this.matchOne(e.slice(f),r.slice(p),n))return this.debug("globstar found match!",f,a,d),!0;if("."===d||".."===d||!i.dot&&"."===d.charAt(0)){this.debug("dot detected!",e,f,r,p);break}this.debug("globstar swallow a segment, and continue"),f++}return!(!n||(this.debug("\n>>> no match, partial?",e,f,r,p),f!==a))}if("string"==typeof u?(l=h===u,this.debug("string match",u,h,l)):(l=h.match(u),this.debug("pattern match",u,h,l)),!l)return!1}if(s===a&&o===c)return!0;if(s===a)return n;if(o===c)return s===a-1&&""===e[s];throw new Error("wtf?")},eA}var cA,lA={exports:{}};function uA(){if(cA)return lA.exports;function e(e){return"/"===e.charAt(0)}function t(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(t[2]||n)}return cA=1,lA.exports="win32"===process.platform?t:e,lA.exports.posix=e,lA.exports.win32=t,lA.exports}var hA,fA,pA,dA,mA,yA={};function gA(){if(hA)return yA;function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}hA=1,yA.setopts=function(n,o,l){l||(l={});if(l.matchBase&&-1===o.indexOf("/")){if(l.noglobstar)throw new Error("base matching requires globstar");o="**/"+o}n.silent=!!l.silent,n.pattern=o,n.strict=!1!==l.strict,n.realpath=!!l.realpath,n.realpathCache=l.realpathCache||Object.create(null),n.follow=!!l.follow,n.dot=!!l.dot,n.mark=!!l.mark,n.nodir=!!l.nodir,n.nodir&&(n.mark=!0);n.sync=!!l.sync,n.nounique=!!l.nounique,n.nonull=!!l.nonull,n.nosort=!!l.nosort,n.nocase=!!l.nocase,n.stat=!!l.stat,n.noprocess=!!l.noprocess,n.absolute=!!l.absolute,n.fs=l.fs||t,n.maxLength=l.maxLength||1/0,n.cache=l.cache||Object.create(null),n.statCache=l.statCache||Object.create(null),n.symlinks=l.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(a))}(n,l),n.changedCwd=!1;var u=process.cwd();e(l,"cwd")?(n.cwd=r.resolve(l.cwd),n.changedCwd=n.cwd!==u):n.cwd=u;n.root=l.root||r.resolve(n.cwd,"/"),n.root=r.resolve(n.root),"win32"===process.platform&&(n.root=n.root.replace(/\\/g,"/"));n.cwdAbs=i(n.cwd)?n.cwd:c(n,n.cwd),"win32"===process.platform&&(n.cwdAbs=n.cwdAbs.replace(/\\/g,"/"));n.nomount=!!l.nomount,l.nonegate=!0,l.nocomment=!0,l.allowWindowsEscape=!1,n.minimatch=new s(o,l),n.options=n.minimatch.options},yA.ownProp=e,yA.makeAbs=c,yA.finish=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var s=e.matches[n];if(s&&0!==Object.keys(s).length){var a=Object.keys(s);t?r.push.apply(r,a):a.forEach((function(e){r[e]=!0}))}else if(e.nonull){var u=e.minimatch.globSet[n];t?r.push(u):r[u]=!0}}t||(r=Object.keys(r));e.nosort||(r=r.sort(o));if(e.mark){for(n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter((function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[c(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}e.ignore.length&&(r=r.filter((function(t){return!l(e,t)})));e.found=r},yA.mark=function(e,t){var r=c(e,t),n=e.cache[r],i=t;if(n){var s="DIR"===n||Array.isArray(n),o="/"===t.slice(-1);if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==t){var a=c(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i},yA.isIgnored=l,yA.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var t=g,r=k,n=aA(),i=uA(),s=n.Minimatch;function o(e,t){return e.localeCompare(t,"en")}function a(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new s(r,{dot:!0})}return{matcher:new s(e,{dot:!0}),gmatcher:t}}function c(e,t){var n=t;return n="/"===t.charAt(0)?r.join(e.root,t):i(t)||""===t?t:e.changedCwd?r.resolve(e.cwd,t):r.resolve(t),"win32"===process.platform&&(n=n.replace(/\\/g,"/")),n}function l(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}return yA}function vA(){if(mA)return dA;return mA=1,dA=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}},dA}var bA,wA,_A,SA,EA,AA={exports:{}};function kA(){if(bA)return AA.exports;bA=1;var e=vA();function t(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function r(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}return AA.exports=e(t),AA.exports.strict=e(r),t.proto=t((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return t(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return r(this)},configurable:!0})})),AA.exports}function xA(){if(_A)return wA;_A=1;var e=vA(),t=Object.create(null),r=kA();return wA=e((function(e,n){return t[e]?(t[e].push(n),null):(t[e]=[n],function(e){return r((function r(){var n=t[e],i=n.length,s=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}(arguments);try{for(var o=0;o<i;o++)n[o].apply(null,s)}finally{n.length>i?(n.splice(0,i),process.nextTick((function(){r.apply(null,s)}))):delete t[e]}}))}(e))})),wA}function CA(){if(EA)return SA;EA=1,SA=y;var e=iA(),t=aA();t.Minimatch;var r=V_,n=m.EventEmitter,i=k,s=A,o=uA(),a=function(){if(pA)return fA;pA=1,fA=u,u.GlobSync=h;var e=iA(),t=aA();t.Minimatch,CA().Glob;var r=k,n=A,i=uA(),s=gA(),o=s.setopts,a=s.ownProp,c=s.childrenIgnored,l=s.isIgnored;function u(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new h(e,t).found}function h(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof h))return new h(e,t);if(o(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}return h.prototype._finish=function(){if(n.ok(this instanceof h),this.realpath){var t=this;this.matches.forEach((function(r,n){var i=t.matches[n]=Object.create(null);for(var s in r)try{s=t._makeAbs(s),i[e.realpathSync(s,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;i[t._makeAbs(s)]=!0}}))}s.finish(this)},h.prototype._process=function(e,r,s){n.ok(this instanceof h);for(var o,a=0;"string"==typeof e[a];)a++;switch(a){case e.length:return void this._processSimple(e.join("/"),r);case 0:o=null;break;default:o=e.slice(0,a).join("/")}var l,u=e.slice(a);null===o?l=".":i(o)||i(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(o&&i(o)||(o="/"+o),l=o):l=o;var f=this._makeAbs(l);c(this,l)||(u[0]===t.GLOBSTAR?this._processGlobStar(o,l,f,u,r,s):this._processReaddir(o,l,f,u,r,s))},h.prototype._processReaddir=function(e,t,n,i,s,o){var a=this._readdir(n,o);if(a){for(var c=i[0],l=!!this.minimatch.negate,u=c._glob,h=this.dot||"."===u.charAt(0),f=[],p=0;p<a.length;p++)("."!==(y=a[p]).charAt(0)||h)&&(l&&!e?!y.match(c):y.match(c))&&f.push(y);var d=f.length;if(0!==d)if(1!==i.length||this.mark||this.stat)for(i.shift(),p=0;p<d;p++){var m;y=f[p],m=e?[e,y]:[y],this._process(m.concat(i),s,o)}else{this.matches[s]||(this.matches[s]=Object.create(null));for(p=0;p<d;p++){var y=f[p];e&&(y="/"!==e.slice(-1)?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=r.join(this.root,y)),this._emitMatch(s,y)}}}},h.prototype._emitMatch=function(e,t){if(!l(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},h.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[e]=n,n||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},h.prototype._readdir=function(e,t){if(t&&!a(this.symlinks,e))return this._readdirInGlobStar(e);if(a(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},h.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},h.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},h.prototype._processGlobStar=function(e,t,r,n,i,s){var o=this._readdir(r,s);if(o){var a=n.slice(1),c=e?[e]:[],l=c.concat(a);this._process(l,i,!1);var u=o.length;if(!this.symlinks[r]||!s)for(var h=0;h<u;h++)if("."!==o[h].charAt(0)||this.dot){var f=c.concat(o[h],a);this._process(f,i,!0);var p=c.concat(o[h],n);this._process(p,i,!0)}}},h.prototype._processSimple=function(e,t){var n=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),n){if(e&&i(e)&&!this.nomount){var s=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=r.join(this.root,e):(e=r.resolve(this.root,e),s&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},h.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&a(this.cache,t)){var n=this.cache[t];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[t];if(!i){var s;try{s=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{i=this.fs.statSync(t)}catch(e){i=s}else i=s}return this.statCache[t]=i,n=!0,i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||n,(!r||"FILE"!==n)&&n},h.prototype._mark=function(e){return s.mark(this,e)},h.prototype._makeAbs=function(e){return s.makeAbs(this,e)},fA}(),c=gA(),l=c.setopts,u=c.ownProp,h=xA(),f=c.childrenIgnored,p=c.isIgnored,d=kA();function y(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return a(e,t)}return new v(e,t,r)}y.sync=a;var g=y.GlobSync=a.GlobSync;function v(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new g(e,t)}if(!(this instanceof v))return new v(e,t,r);l(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=d(r),this.on("error",r),this.on("end",(function(e){r(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return a();for(var s=!0,o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,a);function a(){--i._processing,i._processing<=0&&(s?process.nextTick((function(){i._finish()})):i._finish())}s=!1}return y.glob=y,y.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}({},t);r.noprocess=!0;var n=new v(e,r).minimatch.set;if(!e)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},y.Glob=v,r(v,n),v.prototype._finish=function(){if(s(this instanceof v),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();c.finish(this),this.emit("end",this.found)}},v.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--e&&t._finish()}},v.prototype._realpathSet=function(t,r){var n=this.matches[t];if(!n)return r();var i=Object.keys(n),s=this,o=i.length;if(0===o)return r();var a=this.matches[t]=Object.create(null);i.forEach((function(n,i){n=s._makeAbs(n),e.realpath(n,s.realpathCache,(function(e,i){e?"stat"===e.syscall?a[n]=!0:s.emit("error",e):a[i]=!0,0==--o&&(s.matches[t]=a,r())}))}))},v.prototype._mark=function(e){return c.mark(this,e)},v.prototype._makeAbs=function(e){return c.makeAbs(this,e)},v.prototype.abort=function(){this.aborted=!0,this.emit("abort")},v.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},v.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},v.prototype._process=function(e,r,n,i){if(s(this instanceof v),s("function"==typeof i),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,r,n,i]);else{for(var a,c=0;"string"==typeof e[c];)c++;switch(c){case e.length:return void this._processSimple(e.join("/"),r,i);case 0:a=null;break;default:a=e.slice(0,c).join("/")}var l,u=e.slice(c);null===a?l=".":o(a)||o(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(a&&o(a)||(a="/"+a),l=a):l=a;var h=this._makeAbs(l);if(f(this,l))return i();u[0]===t.GLOBSTAR?this._processGlobStar(a,l,h,u,r,n,i):this._processReaddir(a,l,h,u,r,n,i)}},v.prototype._processReaddir=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(c,l){return a._processReaddir2(e,t,r,n,i,s,l,o)}))},v.prototype._processReaddir2=function(e,t,r,n,s,o,a,c){if(!a)return c();for(var l=n[0],u=!!this.minimatch.negate,h=l._glob,f=this.dot||"."===h.charAt(0),p=[],d=0;d<a.length;d++){if("."!==(y=a[d]).charAt(0)||f)(u&&!e?!y.match(l):y.match(l))&&p.push(y)}var m=p.length;if(0===m)return c();if(1===n.length&&!this.mark&&!this.stat){this.matches[s]||(this.matches[s]=Object.create(null));for(d=0;d<m;d++){var y=p[d];e&&(y="/"!==e?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=i.join(this.root,y)),this._emitMatch(s,y)}return c()}n.shift();for(d=0;d<m;d++){y=p[d];e&&(y="/"!==e?e+"/"+y:e+y),this._process([y].concat(n),s,o,c)}c()},v.prototype._emitMatch=function(e,t){if(!this.aborted&&!p(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=o(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},v.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,n=h("lstat\0"+e,(function(n,i){if(n&&"ENOENT"===n.code)return t();var s=i&&i.isSymbolicLink();r.symlinks[e]=s,s||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())}));n&&r.fs.lstat(e,n)}},v.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=h("readdir\0"+e+"\0"+t,r))){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e,r);if(u(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}this.fs.readdir(e,function(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}(this,e,r))}},v.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},v.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},v.prototype._processGlobStar=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(c,l){a._processGlobStar2(e,t,r,n,i,s,l,o)}))},v.prototype._processGlobStar2=function(e,t,r,n,i,s,o,a){if(!o)return a();var c=n.slice(1),l=e?[e]:[],u=l.concat(c);this._process(u,i,!1,a);var h=this.symlinks[r],f=o.length;if(h&&s)return a();for(var p=0;p<f;p++){if("."!==o[p].charAt(0)||this.dot){var d=l.concat(o[p],c);this._process(d,i,!0,a);var m=l.concat(o[p],n);this._process(m,i,!0,a)}}a()},v.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,(function(i,s){n._processSimple2(e,t,i,s,r)}))},v.prototype._processSimple2=function(e,t,r,n,s){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return s();if(e&&o(e)&&!this.nomount){var a=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),a&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),s()},v.prototype._stat=function(e,t){var r=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&u(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return t(null,i);if(n&&"FILE"===i)return t()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return t(null,s);var o=s.isDirectory()?"DIR":"FILE";return n&&"FILE"===o?t():t(null,o,s)}var a=this,c=h("stat\0"+r,(function(n,i){if(i&&i.isSymbolicLink())return a.fs.stat(r,(function(n,s){n?a._stat2(e,r,null,i,t):a._stat2(e,r,n,s,t)}));a._stat2(e,r,n,i,t)}));c&&a.fs.lstat(r,c)},v.prototype._stat2=function(e,t,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var s="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,s&&"FILE"===o?i():i(null,o,n)},SA}var RA=jA;jA.sync=HA;var OA=A,NA=k,IA=g,TA=void 0;try{TA=CA()}catch(e){}var PA=parseInt("666",8),BA={nosort:!0,silent:!0},DA=0,$A="win32"===process.platform;function LA(e){if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((function(t){e[t]=e[t]||IA[t],e[t+="Sync"]=e[t]||IA[t]})),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),!0!==e.disableGlob&&void 0===TA)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");e.disableGlob=e.disableGlob||!1,e.glob=e.glob||BA}function jA(e,t,r){"function"==typeof t&&(r=t,t={}),OA(e,"rimraf: missing path"),OA.equal(typeof e,"string","rimraf: path should be a string"),OA.equal(typeof r,"function","rimraf: callback function required"),OA(t,"rimraf: invalid options argument provided"),OA.equal(typeof t,"object","rimraf: options should be object"),LA(t);var n=0,i=null,s=0;if(t.disableGlob||!TA.hasMagic(e))return o(null,[e]);function o(e,o){return e?r(e):0===(s=o.length)?r():void o.forEach((function(e){MA(e,t,(function o(a){if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&n<t.maxBusyTries)return n++,setTimeout((function(){MA(e,t,o)}),100*n);if("EMFILE"===a.code&&DA<t.emfileWait)return setTimeout((function(){MA(e,t,o)}),DA++);"ENOENT"===a.code&&(a=null)}DA=0,function(e){i=i||e,0==--s&&r(i)}(a)}))}))}t.lstat(e,(function(r,n){if(!r)return o(null,[e]);TA(e,t.glob,o)}))}function MA(e,t,r){OA(e),OA(t),OA("function"==typeof r),t.lstat(e,(function(n,i){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&$A&&UA(e,t,n,r),i&&i.isDirectory()?FA(e,t,n,r):void t.unlink(e,(function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return $A?UA(e,t,n,r):FA(e,t,n,r);if("EISDIR"===n.code)return FA(e,t,n,r)}return r(n)})))}))}function UA(e,t,r,n){OA(e),OA(t),OA("function"==typeof n),r&&OA(r instanceof Error),t.chmod(e,PA,(function(i){i?n("ENOENT"===i.code?null:r):t.stat(e,(function(i,s){i?n("ENOENT"===i.code?null:r):s.isDirectory()?FA(e,t,r,n):t.unlink(e,n)}))}))}function KA(e,t,r){OA(e),OA(t),r&&OA(r instanceof Error);try{t.chmodSync(e,PA)}catch(e){if("ENOENT"===e.code)return;throw r}try{var n=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw r}n.isDirectory()?zA(e,t,r):t.unlinkSync(e)}function FA(e,t,r,n){OA(e),OA(t),r&&OA(r instanceof Error),OA("function"==typeof n),t.rmdir(e,(function(i){!i||"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code?i&&"ENOTDIR"===i.code?n(r):n(i):function(e,t,r){OA(e),OA(t),OA("function"==typeof r),t.readdir(e,(function(n,i){if(n)return r(n);var s,o=i.length;if(0===o)return t.rmdir(e,r);i.forEach((function(n){jA(NA.join(e,n),t,(function(n){if(!s)return n?r(s=n):void(0==--o&&t.rmdir(e,r))}))}))}))}(e,t,n)}))}function HA(e,t){var r;if(LA(t=t||{}),OA(e,"rimraf: missing path"),OA.equal(typeof e,"string","rimraf: path should be a string"),OA(t,"rimraf: missing options"),OA.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!TA.hasMagic(e))r=[e];else try{t.lstatSync(e),r=[e]}catch(n){r=TA.sync(e,t.glob)}if(r.length)for(var n=0;n<r.length;n++){e=r[n];try{var i=t.lstatSync(e)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&$A&&KA(e,t,r)}try{i&&i.isDirectory()?zA(e,t,null):t.unlinkSync(e)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return $A?KA(e,t,r):zA(e,t,r);if("EISDIR"!==r.code)throw r;zA(e,t,r)}}}function zA(e,t,r){OA(e),OA(t),r&&OA(r instanceof Error);try{t.rmdirSync(e)}catch(n){if("ENOENT"===n.code)return;if("ENOTDIR"===n.code)throw r;"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code||function(e,t){OA(e),OA(t),t.readdirSync(e).forEach((function(r){HA(NA.join(e,r),t)}));var r=$A?100:1,n=0;for(;;){var i=!0;try{var s=t.rmdirSync(e,t);return i=!1,s}finally{if(++n<r&&i)continue}}}(e,t)}}var VA=k,qA=g,GA=parseInt("0777",8),WA=XA.mkdirp=XA.mkdirP=XA;function XA(e,t,r,n){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var i=t.mode,s=t.fs||qA;void 0===i&&(i=GA),n||(n=null);var o=r||function(){};e=VA.resolve(e),s.mkdir(e,i,(function(r){if(!r)return o(null,n=n||e);if("ENOENT"===r.code){if(VA.dirname(e)===e)return o(r);XA(VA.dirname(e),t,(function(r,n){r?o(r,n):XA(e,t,o,n)}))}else s.stat(e,(function(e,t){e||!t.isDirectory()?o(r,n):o(null,n)}))}))}XA.sync=function e(t,r,n){r&&"object"==typeof r||(r={mode:r});var i=r.mode,s=r.fs||qA;void 0===i&&(i=GA),n||(n=null),t=VA.resolve(t);try{s.mkdirSync(t,i),n=n||t}catch(i){if("ENOENT"===i.code)n=e(VA.dirname(t),r,n),e(t,r,n);else{var o;try{o=s.statSync(t)}catch(e){throw i}if(!o.isDirectory())throw i}}return n};var JA,YA,ZA,QA,ek,tk,rk,nk,ik,sk,ok=function e(t){if(t._collected)return;if(t._paused)return t.on("resume",e.bind(null,t));t._collected=!0,t.pause(),t.on("data",n),t.on("end",n);var r=[];function n(e){"string"==typeof e&&(e=new Buffer(e)),Buffer.isBuffer(e)&&!e.length||r.push(e)}t.on("entry",s);var i=[];function s(t){e(t),i.push(t)}t.on("proxy",(function(e){e.pause()})),t.pipe=(o=t.pipe,function(e){var a=0;return function c(){var l=i[a++];if(!l)return t.removeListener("entry",s),t.removeListener("data",n),t.removeListener("end",n),t.pipe=o,e&&t.pipe(e),r.forEach((function(e){e?t.emit("data",e):t.emit("end")})),void t.resume();l.on("end",c),e?e.add(l):t.emit("entry",l)}(),e});var o};function ak(){if(YA)return JA;YA=1,JA=i;var e=hk(),t=WA,r=k,n=ok;function i(t){var r=this;r instanceof i||r.error("DirWriter must be called as constructor.",null,!0),"Directory"===t.type&&t.Directory||r.error("Non-directory type "+t.type+" "+JSON.stringify(t),null,!0),e.call(this,t)}return V_(i,e),i.prototype._create=function(){var r=this;t(r._path,e.dirmode,(function(e){if(e)return r.error(e);r.ready=!0,r.emit("ready"),r._process()}))},i.prototype.write=function(){return!0},i.prototype.end=function(){this._ended=!0,this._process()},i.prototype.add=function(e){var t=this;return n(e),!t.ready||t._currentEntry?(t._buffer.push(e),!1):t._ended?t.error("add after end"):(t._buffer.push(e),t._process(),0===this._buffer.length)},i.prototype._process=function(){var t=this;if(!t._processing){var n=t._buffer.shift();if(!n)return t.emit("drain"),void(t._ended&&t._finish());t._processing=!0,t.emit("entry",n);var i,s=n;do{if((i=s._path||s.path)===t.root._path||i===t._path||i&&0===i.indexOf(t._path))return t._processing=!1,n._collected&&n.pipe(),t._process();s=s.parent}while(s);var o={parent:t,root:t.root||t,type:n.type,depth:t.depth+1};i=n._path||n.path||n.props.path,n.parent&&(i=i.substr(n.parent._path.length+1)),o.path=r.join(t.path,r.join("/",i)),o.filter=t.filter,Object.keys(n.props).forEach((function(e){o.hasOwnProperty(e)||(o[e]=n.props[e])}));var a=t._currentChild=new e(o);a.on("ready",(function(){n.pipe(a),n.resume()})),a.on("error",(function(e){a._swallowErrors?(t.warn(e),a.emit("end"),a.emit("close")):t.emit("error",e)})),a.on("close",(function(){if(c)return;c=!0,t._currentChild=null,t._processing=!1,t._process()}));var c=!1}},JA}function ck(){if(QA)return ZA;QA=1,ZA=i;var e=SE,t=hk(),r=k,n=RA;function i(e){if(!(this instanceof i))throw new Error("LinkWriter must be called as constructor.");if(!("Link"===e.type&&e.Link||"SymbolicLink"===e.type&&e.SymbolicLink))throw new Error("Non-link type "+e.type);""===e.linkpath&&(e.linkpath="."),e.linkpath||this.error("Need linkpath property to create "+e.type),t.call(this,e)}function s(t,r,i){n(t._path,(function(n){if(n)return t.error(n);!function(t,r,n){e[n](r,t._path,(function(e){if(e){if("ENOENT"!==e.code&&"EACCES"!==e.code&&"EPERM"!==e.code||"win32"!==process.platform)return t.error(e);t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),t.end=t._finish=function(){}}o(t)}))}(t,r,i)}))}function o(e){e.ready=!0,e.emit("ready"),e._ended&&!e._finished&&e._finish()}return V_(i,t),i.prototype._create=function(){var t=this,n="Link"===t.type||"win32"===process.platform,i=n?"link":"symlink",a=n?r.resolve(t.dirname,t.linkpath):t.linkpath;if(n)return s(t,a,i);e.readlink(t._path,(function(e,r){if(r&&r===a)return o(t);s(t,a,i)}))},i.prototype.end=function(){this._ended=!0,this.ready&&(this._finished=!0,this._finish())},ZA}function lk(){if(tk)return ek;tk=1,ek=n;var e=SE,t=hk(),r={};function n(e){var r=this;if(!(r instanceof n))throw new Error("FileWriter must be called as constructor.");if("File"!==e.type||!e.File)throw new Error("Non-file type "+e.type);r._buffer=[],r._bytesWritten=0,t.call(this,e)}return V_(n,t),n.prototype._create=function(){var n=this;if(!n._stream){var i={};n.props.flags&&(i.flags=n.props.flags),i.mode=t.filemode,n._old&&n._old.blksize&&(i.bufferSize=n._old.blksize),n._stream=e.createWriteStream(n._path,i),n._stream.on("open",(function(){n.ready=!0,n._buffer.forEach((function(e){e===r?n._stream.end():n._stream.write(e)})),n.emit("ready"),n.emit("drain")})),n._stream.on("error",(function(e){n.emit("error",e)})),n._stream.on("drain",(function(){n.emit("drain")})),n._stream.on("close",(function(){n._finish()}))}},n.prototype.write=function(e){var t=this;if(t._bytesWritten+=e.length,!t.ready){if(!Buffer.isBuffer(e)&&"string"!=typeof e)throw new Error("invalid write data");return t._buffer.push(e),!1}var r=t._stream.write(e);return!1===r&&t._stream._queue?t._stream._queue.length<=2:r},n.prototype.end=function(e){var t=this;return e&&t.write(e),t.ready?t._stream.end():(t._buffer.push(r),!1)},n.prototype._finish=function(){var e=this;"number"==typeof e.size&&e._bytesWritten!==e.size&&e.error("Did not get expected byte count.\nexpect: "+e.size+"\nactual: "+e._bytesWritten),t.prototype._finish.call(e)},ek}function uk(){if(nk)return rk;nk=1,rk=i;var e=hk(),t=ME,r=ok,n=g;function i(t){var r=this;if(!(r instanceof i))throw new Error("ProxyWriter must be called as constructor.");r.props=t,r._needDrain=!1,e.call(r,t)}return V_(i,e),i.prototype._stat=function(){var r=this,i=r.props,s=i.follow?"stat":"lstat";n[s](i.path,(function(n,s){var o;o=n||!s?"File":t(s),i[o]=!0,i.type=r.type=o,r._old=s,r._addProxy(e(i,s))}))},i.prototype._addProxy=function(e){var t=this;if(t._proxy)return t.error("proxy already set");t._proxy=e,["ready","error","close","pipe","drain","warn"].forEach((function(r){e.on(r,t.emit.bind(t,r))})),t.emit("proxy",e),t._buffer.forEach((function(t){e[t[0]].apply(e,t[1])})),t._buffer.length=0,t._needsDrain&&t.emit("drain")},i.prototype.add=function(e){return r(e),this._proxy?this._proxy.add(e):(this._buffer.push(["add",[e]]),this._needDrain=!0,!1)},i.prototype.write=function(e){return this._proxy?this._proxy.write(e):(this._buffer.push(["write",[e]]),this._needDrain=!0,!1)},i.prototype.end=function(e){return this._proxy?this._proxy.end(e):(this._buffer.push(["end",[e]]),!1)},rk}function hk(){if(sk)return ik;sk=1,ik=f;var e=SE,t=V_,r=RA,n=WA,i=k,s="win32"===process.platform?0:process.umask(),o=ME,a=YS;t(f,a),f.dirmode=parseInt("0777",8)&~s,f.filemode=parseInt("0666",8)&~s;var c=ak(),l=ck(),u=lk(),h=uk();function f(e,t){var r=this;"string"==typeof e&&(e={path:e});var n=f;switch(o(e)){case"Directory":n=c;break;case"File":n=u;break;case"Link":case"SymbolicLink":n=l;break;default:n=h}if(!(r instanceof n))return new n(e);a.call(r),e.path||r.error("Must provide a path",null,!0),r.type=e.type,r.props=e,r.depth=e.depth||0,r.clobber=!1!==e.clobber||e.clobber,r.parent=e.parent||null,r.root=e.root||e.parent&&e.parent.root||r,r._path=r.path=i.resolve(e.path),"win32"===process.platform&&(r.path=r._path=r.path.replace(/\?/g,"_"),r._path.length>=260&&(r._swallowErrors=!0,r._path="\\\\?\\"+r.path.replace(/\//g,"\\"))),r.basename=i.basename(e.path),r.dirname=i.dirname(e.path),r.linkpath=e.linkpath||null,e.parent=e.root=null,r.size=e.size,"string"==typeof e.mode&&(e.mode=parseInt(e.mode,8)),r.readable=!1,r.writable=!0,r._buffer=[],r.ready=!1,r.filter="function"==typeof e.filter?e.filter:null,r._stat(t)}function p(e){n(i.dirname(e._path),f.dirmode,(function(t,r){return t?e.error(t):(e._madeDir=r,e._create())}))}function d(t,r,n,i,s){var o=r.mode,a=r.follow||"SymbolicLink"!==t.type?"chmod":"lchmod";if(!e[a])return s();if("number"!=typeof o)return s();var c=n.mode&parseInt("0777",8);if((o&=parseInt("0777",8))===c)return s();e[a](i,o,s)}function m(t,r,n,i,s){if("win32"===process.platform)return s();if(!process.getuid||0!==process.getuid())return s();if("number"!=typeof r.uid&&"number"!=typeof r.gid)return s();if(n.uid===r.uid&&n.gid===r.gid)return s();var o=t.props.follow||"SymbolicLink"!==t.type?"chown":"lchown";if(!e[o])return s();"number"!=typeof r.uid&&(r.uid=n.uid),"number"!=typeof r.gid&&(r.gid=n.gid),e[o](i,r.uid,r.gid,s)}function y(t,r,n,i,s){if(!e.utimes||"win32"===process.platform)return s();var o=r.follow||"SymbolicLink"!==t.type?"utimes":"lutimes";if("lutimes"!==o||e[o]||(o="utimes"),!e[o])return s();var a=n.atime,c=n.mtime,l=r.atime,u=r.mtime;if(void 0===l&&(l=a),void 0===u&&(u=c),v(l)||(l=new Date(l)),v(u)||(l=new Date(u)),l.getTime()===a.getTime()&&u.getTime()===c.getTime())return s();e[o](i,l,u,s)}function g(t,r,n){var s=t._madeDir,o=i.dirname(r);!function(t,r,n){var i={};Object.keys(t.props).forEach((function(e){i[e]=t.props[e],"mode"===e&&"Directory"!==t.type&&(i[e]=i[e]|parseInt("0111",8))}));var s=3,o=null;function a(e){if(!o)return e?n(o=e):0==--s?n():void 0}e.stat(r,(function(e,s){if(e)return n(o=e);d(t,i,s,r,a),m(t,i,s,r,a),y(t,i,s,r,a)}))}(t,o,(function(e){return e?n(e):o===s?n():void g(t,o,n)}))}function v(e){return"object"==typeof e&&"[object Date]"===function(e){return Object.prototype.toString.call(e)}(e)}return f.prototype._create=function(){var t=this;e[t.props.follow?"stat":"lstat"](t._path,(function(e){if(e)return t.warn("Cannot create "+t._path+"\nUnsupported type: "+t.type,"ENOTSUP");t._finish()}))},f.prototype._stat=function(t){var n=this,i=n.props.follow?"stat":"lstat",s=n._proxy||n;function a(e,t){return n.filter&&!n.filter.call(s,s,t)?(n._aborted=!0,n.emit("end"),void n.emit("close")):e||!t?p(n):(n._old=t,o(t)!==n.type||"File"===n.type&&t.nlink>1?r(n._path,(function(e){if(e)return n.error(e);n._old=null,p(n)})):void p(n))}t?a(null,t):e[i](n._path,a)},f.prototype._finish=function(){var t=this;if(t._finishing);else{t._finishing=!0;var r=0,n=null,i=!1;if(t._old)t._old.atime=new Date(0),t._old.mtime=new Date(0),o(t._old);else{var s=t.props.follow?"stat":"lstat";e[s](t._path,(function(e,r){if(e)return"ENOENT"!==e.code||"Link"!==t.type&&"SymbolicLink"!==t.type||"win32"!==process.platform?t.error(e):(t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),void(t.end=t._finish=function(){}));o(t._old=r)}))}}function o(e){r+=3,d(t,t.props,e,t._path,a("chmod")),m(t,t.props,e,t._path,a("chown")),y(t,t.props,e,t._path,a("utimes"))}function a(e){return function(s){if(!n){if(s)return s.fstream_finish_call=e,t.error(n=s);if(!(--r>0||i)){if(i=!0,!t._madeDir)return o();g(t,t._path,o)}}function o(e){if(e)return e.fstream_finish_call="setupMadeDir",t.error(e);t.emit("end"),t.emit("close")}}}},f.prototype.pipe=function(){this.error("Can't pipe from writable stream")},f.prototype.add=function(){this.error("Can't add to non-Directory type")},f.prototype.write=function(){return!0},ik}!function(e){e.Abstract=YS,e.Reader=zE(),e.Writer=hk(),e.File={Reader:FE(),Writer:lk()},e.Dir={Reader:KE(),Writer:ak()},e.Link={Reader:UE(),Writer:ck()},e.Proxy={Reader:HE(),Writer:uk()},e.Reader.Dir=e.DirReader=e.Dir.Reader,e.Reader.File=e.FileReader=e.File.Reader,e.Reader.Link=e.LinkReader=e.Link.Reader,e.Reader.Proxy=e.ProxyReader=e.Proxy.Reader,e.Writer.Dir=e.DirWriter=e.Dir.Writer,e.Writer.File=e.FileWriter=e.File.Writer,e.Writer.Link=e.LinkWriter=e.Link.Writer,e.Writer.Proxy=e.ProxyWriter=e.Proxy.Writer,e.collect=ok}(JS);var fk=function(e){e.path=mk.resolve(mk.normalize(e.path));var t=new pk(e),r=new yk.Writable({objectMode:!0});r._write=function(t,r,n){if("Directory"==t.type)return n();var i=mk.join(e.path,t.path);if(0!=i.indexOf(e.path))return n();const s=e.getWriter?e.getWriter({path:i}):dk({path:i});t.pipe(s).on("error",n).on("close",n)};var n=gk(t,r);return t.once("crx-header",(function(e){n.crxHeader=e})),t.pipe(r).on("finish",(function(){n.emit("close")})),n.promise=function(){return new vk((function(e,t){n.on("close",e),n.on("error",t)}))},n},pk=US,dk=JS.Writer,mk=k,yk=a,gk=zS,vk=d_;var bk={exports:{}};!function(e){var t=function(e){var r=1e7,n=7,i=9007199254740992,s=p(i),o="0123456789abcdefghijklmnopqrstuvwxyz",a="function"==typeof BigInt;function c(e,t,r,n){return void 0===e?c[0]:void 0!==t&&(10!=+t||r)?q(e,t,r,n):Y(e)}function l(e,t){this.value=e,this.sign=t,this.isSmall=!1}function u(e){this.value=e,this.sign=e<0,this.isSmall=!0}function h(e){this.value=e}function f(e){return-i<e&&e<i}function p(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function d(e){m(e);var t=e.length;if(t<4&&I(e,s)<0)switch(t){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*r;default:return e[0]+(e[1]+e[2]*r)*r}return e}function m(e){for(var t=e.length;0===e[--t];);e.length=t+1}function y(e){for(var t=new Array(e),r=-1;++r<e;)t[r]=0;return t}function g(e){return e>0?Math.floor(e):Math.ceil(e)}function v(e,t){var n,i,s=e.length,o=t.length,a=new Array(s),c=0,l=r;for(i=0;i<o;i++)c=(n=e[i]+t[i]+c)>=l?1:0,a[i]=n-c*l;for(;i<s;)c=(n=e[i]+c)===l?1:0,a[i++]=n-c*l;return c>0&&a.push(c),a}function b(e,t){return e.length>=t.length?v(e,t):v(t,e)}function w(e,t){var n,i,s=e.length,o=new Array(s),a=r;for(i=0;i<s;i++)n=e[i]-a+t,t=Math.floor(n/a),o[i]=n-t*a,t+=1;for(;t>0;)o[i++]=t%a,t=Math.floor(t/a);return o}function _(e,t){var n,i,s=e.length,o=t.length,a=new Array(s),c=0,l=r;for(n=0;n<o;n++)(i=e[n]-c-t[n])<0?(i+=l,c=1):c=0,a[n]=i;for(n=o;n<s;n++){if(!((i=e[n]-c)<0)){a[n++]=i;break}i+=l,a[n]=i}for(;n<s;n++)a[n]=e[n];return m(a),a}function S(e,t,n){var i,s,o=e.length,a=new Array(o),c=-t,h=r;for(i=0;i<o;i++)s=e[i]+c,c=Math.floor(s/h),s%=h,a[i]=s<0?s+h:s;return"number"==typeof(a=d(a))?(n&&(a=-a),new u(a)):new l(a,n)}function E(e,t){var n,i,s,o,a=e.length,c=t.length,l=y(a+c),u=r;for(s=0;s<a;++s){o=e[s];for(var h=0;h<c;++h)n=o*t[h]+l[s+h],i=Math.floor(n/u),l[s+h]=n-i*u,l[s+h+1]+=i}return m(l),l}function A(e,t){var n,i,s=e.length,o=new Array(s),a=r,c=0;for(i=0;i<s;i++)n=e[i]*t+c,c=Math.floor(n/a),o[i]=n-c*a;for(;c>0;)o[i++]=c%a,c=Math.floor(c/a);return o}function k(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function x(e,t){var r=Math.max(e.length,t.length);if(r<=30)return E(e,t);r=Math.ceil(r/2);var n=e.slice(r),i=e.slice(0,r),s=t.slice(r),o=t.slice(0,r),a=x(i,o),c=x(n,s),l=x(b(i,n),b(o,s)),u=b(b(a,k(_(_(l,a),c),r)),k(c,2*r));return m(u),u}function C(e,t,n){return new l(e<r?A(t,e):E(t,p(e)),n)}function R(e){var t,n,i,s,o=e.length,a=y(o+o),c=r;for(i=0;i<o;i++){n=0-(s=e[i])*s;for(var l=i;l<o;l++)t=s*e[l]*2+a[i+l]+n,n=Math.floor(t/c),a[i+l]=t-n*c;a[i+o]=n}return m(a),a}function O(e,t){var n,i,s,o,a=e.length,c=y(a),l=r;for(s=0,n=a-1;n>=0;--n)s=(o=s*l+e[n])-(i=g(o/t))*t,c[n]=0|i;return[c,0|s]}function N(e,t){var n,i=Y(t);if(a)return[new h(e.value/i.value),new h(e.value%i.value)];var s,o=e.value,f=i.value;if(0===f)throw new Error("Cannot divide by zero");if(e.isSmall)return i.isSmall?[new u(g(o/f)),new u(o%f)]:[c[0],e];if(i.isSmall){if(1===f)return[e,c[0]];if(-1==f)return[e.negate(),c[0]];var v=Math.abs(f);if(v<r){s=d((n=O(o,v))[0]);var b=n[1];return e.sign&&(b=-b),"number"==typeof s?(e.sign!==i.sign&&(s=-s),[new u(s),new u(b)]):[new l(s,e.sign!==i.sign),new u(b)]}f=p(v)}var w=I(o,f);if(-1===w)return[c[0],e];if(0===w)return[c[e.sign===i.sign?1:-1],c[0]];n=o.length+f.length<=200?function(e,t){var n,i,s,o,a,c,l,u=e.length,h=t.length,f=r,p=y(t.length),m=t[h-1],g=Math.ceil(f/(2*m)),v=A(e,g),b=A(t,g);for(v.length<=u&&v.push(0),b.push(0),m=b[h-1],i=u-h;i>=0;i--){for(n=f-1,v[i+h]!==m&&(n=Math.floor((v[i+h]*f+v[i+h-1])/m)),s=0,o=0,c=b.length,a=0;a<c;a++)s+=n*b[a],l=Math.floor(s/f),o+=v[i+a]-(s-l*f),s=l,o<0?(v[i+a]=o+f,o=-1):(v[i+a]=o,o=0);for(;0!==o;){for(n-=1,s=0,a=0;a<c;a++)(s+=v[i+a]-f+b[a])<0?(v[i+a]=s+f,s=0):(v[i+a]=s,s=1);o+=s}p[i]=n}return v=O(v,g)[0],[d(p),d(v)]}(o,f):function(e,t){for(var n,i,s,o,a,c=e.length,l=t.length,u=[],h=[],f=r;c;)if(h.unshift(e[--c]),m(h),I(h,t)<0)u.push(0);else{s=h[(i=h.length)-1]*f+h[i-2],o=t[l-1]*f+t[l-2],i>l&&(s=(s+1)*f),n=Math.ceil(s/o);do{if(I(a=A(t,n),h)<=0)break;n--}while(n);u.push(n),h=_(h,a)}return u.reverse(),[d(u),d(h)]}(o,f),s=n[0];var S=e.sign!==i.sign,E=n[1],k=e.sign;return"number"==typeof s?(S&&(s=-s),s=new u(s)):s=new l(s,S),"number"==typeof E?(k&&(E=-E),E=new u(E)):E=new l(E,k),[s,E]}function I(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function T(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function P(e,r){for(var n,i,s,o=e.prev(),a=o,c=0;a.isEven();)a=a.divide(2),c++;e:for(i=0;i<r.length;i++)if(!e.lesser(r[i])&&!(s=t(r[i]).modPow(a,e)).isUnit()&&!s.equals(o)){for(n=c-1;0!=n;n--){if((s=s.square().mod(e)).isUnit())return!1;if(s.equals(o))continue e}return!1}return!0}l.prototype=Object.create(c.prototype),u.prototype=Object.create(c.prototype),h.prototype=Object.create(c.prototype),l.prototype.add=function(e){var t=Y(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,n=t.value;return t.isSmall?new l(w(r,Math.abs(n)),this.sign):new l(b(r,n),this.sign)},l.prototype.plus=l.prototype.add,u.prototype.add=function(e){var t=Y(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var n=t.value;if(t.isSmall){if(f(r+n))return new u(r+n);n=p(Math.abs(n))}return new l(w(n,Math.abs(r)),r<0)},u.prototype.plus=u.prototype.add,h.prototype.add=function(e){return new h(this.value+Y(e).value)},h.prototype.plus=h.prototype.add,l.prototype.subtract=function(e){var t=Y(e);if(this.sign!==t.sign)return this.add(t.negate());var r=this.value,n=t.value;return t.isSmall?S(r,Math.abs(n),this.sign):function(e,t,r){var n;return I(e,t)>=0?n=_(e,t):(n=_(t,e),r=!r),"number"==typeof(n=d(n))?(r&&(n=-n),new u(n)):new l(n,r)}(r,n,this.sign)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(e){var t=Y(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var n=t.value;return t.isSmall?new u(r-n):S(n,Math.abs(r),r>=0)},u.prototype.minus=u.prototype.subtract,h.prototype.subtract=function(e){return new h(this.value-Y(e).value)},h.prototype.minus=h.prototype.subtract,l.prototype.negate=function(){return new l(this.value,!this.sign)},u.prototype.negate=function(){var e=this.sign,t=new u(-this.value);return t.sign=!e,t},h.prototype.negate=function(){return new h(-this.value)},l.prototype.abs=function(){return new l(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},h.prototype.abs=function(){return new h(this.value>=0?this.value:-this.value)},l.prototype.multiply=function(e){var t,n,i,s=Y(e),o=this.value,a=s.value,u=this.sign!==s.sign;if(s.isSmall){if(0===a)return c[0];if(1===a)return this;if(-1===a)return this.negate();if((t=Math.abs(a))<r)return new l(A(o,t),u);a=p(t)}return n=o.length,i=a.length,new l(-.012*n-.012*i+15e-6*n*i>0?x(o,a):E(o,a),u)},l.prototype.times=l.prototype.multiply,u.prototype._multiplyBySmall=function(e){return f(e.value*this.value)?new u(e.value*this.value):C(Math.abs(e.value),p(Math.abs(this.value)),this.sign!==e.sign)},l.prototype._multiplyBySmall=function(e){return 0===e.value?c[0]:1===e.value?this:-1===e.value?this.negate():C(Math.abs(e.value),this.value,this.sign!==e.sign)},u.prototype.multiply=function(e){return Y(e)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,h.prototype.multiply=function(e){return new h(this.value*Y(e).value)},h.prototype.times=h.prototype.multiply,l.prototype.square=function(){return new l(R(this.value),!1)},u.prototype.square=function(){var e=this.value*this.value;return f(e)?new u(e):new l(R(p(Math.abs(this.value))),!1)},h.prototype.square=function(e){return new h(this.value*this.value)},l.prototype.divmod=function(e){var t=N(this,e);return{quotient:t[0],remainder:t[1]}},h.prototype.divmod=u.prototype.divmod=l.prototype.divmod,l.prototype.divide=function(e){return N(this,e)[0]},h.prototype.over=h.prototype.divide=function(e){return new h(this.value/Y(e).value)},u.prototype.over=u.prototype.divide=l.prototype.over=l.prototype.divide,l.prototype.mod=function(e){return N(this,e)[1]},h.prototype.mod=h.prototype.remainder=function(e){return new h(this.value%Y(e).value)},u.prototype.remainder=u.prototype.mod=l.prototype.remainder=l.prototype.mod,l.prototype.pow=function(e){var t,r,n,i=Y(e),s=this.value,o=i.value;if(0===o)return c[1];if(0===s)return c[0];if(1===s)return c[1];if(-1===s)return i.isEven()?c[1]:c[-1];if(i.sign)return c[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&f(t=Math.pow(s,o)))return new u(g(t));for(r=this,n=c[1];!0&o&&(n=n.times(r),--o),0!==o;)o/=2,r=r.square();return n},u.prototype.pow=l.prototype.pow,h.prototype.pow=function(e){var t=Y(e),r=this.value,n=t.value,i=BigInt(0),s=BigInt(1),o=BigInt(2);if(n===i)return c[1];if(r===i)return c[0];if(r===s)return c[1];if(r===BigInt(-1))return t.isEven()?c[1]:c[-1];if(t.isNegative())return new h(i);for(var a=this,l=c[1];(n&s)===s&&(l=l.times(a),--n),n!==i;)n/=o,a=a.square();return l},l.prototype.modPow=function(e,t){if(e=Y(e),(t=Y(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=c[1],n=this.mod(t);for(e.isNegative()&&(e=e.multiply(c[-1]),n=n.modInv(t));e.isPositive();){if(n.isZero())return c[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t)}return r},h.prototype.modPow=u.prototype.modPow=l.prototype.modPow,l.prototype.compareAbs=function(e){var t=Y(e),r=this.value,n=t.value;return t.isSmall?1:I(r,n)},u.prototype.compareAbs=function(e){var t=Y(e),r=Math.abs(this.value),n=t.value;return t.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},h.prototype.compareAbs=function(e){var t=this.value,r=Y(e).value;return(t=t>=0?t:-t)===(r=r>=0?r:-r)?0:t>r?1:-1},l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Y(e),r=this.value,n=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:I(r,n)*(this.sign?-1:1)},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Y(e),r=this.value,n=t.value;return t.isSmall?r==n?0:r>n?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},u.prototype.compareTo=u.prototype.compare,h.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,r=Y(e).value;return t===r?0:t>r?1:-1},h.prototype.compareTo=h.prototype.compare,l.prototype.equals=function(e){return 0===this.compare(e)},h.prototype.eq=h.prototype.equals=u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals,l.prototype.notEquals=function(e){return 0!==this.compare(e)},h.prototype.neq=h.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals,l.prototype.greater=function(e){return this.compare(e)>0},h.prototype.gt=h.prototype.greater=u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater,l.prototype.lesser=function(e){return this.compare(e)<0},h.prototype.lt=h.prototype.lesser=u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser,l.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},h.prototype.geq=h.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals,l.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},h.prototype.leq=h.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals,l.prototype.isEven=function(){return 0==(1&this.value[0])},u.prototype.isEven=function(){return 0==(1&this.value)},h.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},l.prototype.isOdd=function(){return 1==(1&this.value[0])},u.prototype.isOdd=function(){return 1==(1&this.value)},h.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},l.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},h.prototype.isPositive=u.prototype.isPositive,l.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},h.prototype.isNegative=u.prototype.isNegative,l.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},h.prototype.isUnit=function(){return this.abs().value===BigInt(1)},l.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},h.prototype.isZero=function(){return this.value===BigInt(0)},l.prototype.isDivisibleBy=function(e){var t=Y(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},h.prototype.isDivisibleBy=u.prototype.isDivisibleBy=l.prototype.isDivisibleBy,l.prototype.isPrime=function(r){var n=T(this);if(n!==e)return n;var i=this.abs(),s=i.bitLength();if(s<=64)return P(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*s.toJSNumber(),a=Math.ceil(!0===r?2*Math.pow(o,2):o),c=[],l=0;l<a;l++)c.push(t(l+2));return P(i,c)},h.prototype.isPrime=u.prototype.isPrime=l.prototype.isPrime,l.prototype.isProbablePrime=function(r,n){var i=T(this);if(i!==e)return i;for(var s=this.abs(),o=r===e?5:r,a=[],c=0;c<o;c++)a.push(t.randBetween(2,s.minus(2),n));return P(s,a)},h.prototype.isProbablePrime=u.prototype.isProbablePrime=l.prototype.isProbablePrime,l.prototype.modInv=function(e){for(var r,n,i,s=t.zero,o=t.one,a=Y(e),c=this.abs();!c.isZero();)r=a.divide(c),n=s,i=a,s=o,a=c,o=n.subtract(r.multiply(o)),c=i.subtract(r.multiply(c));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(e)),this.isNegative()?s.negate():s},h.prototype.modInv=u.prototype.modInv=l.prototype.modInv,l.prototype.next=function(){var e=this.value;return this.sign?S(e,1,this.sign):new l(w(e,1),this.sign)},u.prototype.next=function(){var e=this.value;return e+1<i?new u(e+1):new l(s,!1)},h.prototype.next=function(){return new h(this.value+BigInt(1))},l.prototype.prev=function(){var e=this.value;return this.sign?new l(w(e,1),!0):S(e,1,this.sign)},u.prototype.prev=function(){var e=this.value;return e-1>-i?new u(e-1):new l(s,!0)},h.prototype.prev=function(){return new h(this.value-BigInt(1))};for(var B=[1];2*B[B.length-1]<=r;)B.push(2*B[B.length-1]);var D=B.length,$=B[D-1];function L(e){return Math.abs(e)<=r}function j(e,r,n){r=Y(r);for(var i=e.isNegative(),s=r.isNegative(),o=i?e.not():e,a=s?r.not():r,c=0,l=0,u=null,h=null,f=[];!o.isZero()||!a.isZero();)c=(u=N(o,$))[1].toJSNumber(),i&&(c=$-1-c),l=(h=N(a,$))[1].toJSNumber(),s&&(l=$-1-l),o=u[0],a=h[0],f.push(n(c,l));for(var p=0!==n(i?1:0,s?1:0)?t(-1):t(0),d=f.length-1;d>=0;d-=1)p=p.multiply($).add(t(f[d]));return p}l.prototype.shiftLeft=function(e){var t=Y(e).toJSNumber();if(!L(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;t>=D;)r=r.multiply($),t-=D-1;return r.multiply(B[t])},h.prototype.shiftLeft=u.prototype.shiftLeft=l.prototype.shiftLeft,l.prototype.shiftRight=function(e){var t,r=Y(e).toJSNumber();if(!L(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=D;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(t=N(n,$))[1].isNegative()?t[0].prev():t[0],r-=D-1}return(t=N(n,B[r]))[1].isNegative()?t[0].prev():t[0]},h.prototype.shiftRight=u.prototype.shiftRight=l.prototype.shiftRight,l.prototype.not=function(){return this.negate().prev()},h.prototype.not=u.prototype.not=l.prototype.not,l.prototype.and=function(e){return j(this,e,(function(e,t){return e&t}))},h.prototype.and=u.prototype.and=l.prototype.and,l.prototype.or=function(e){return j(this,e,(function(e,t){return e|t}))},h.prototype.or=u.prototype.or=l.prototype.or,l.prototype.xor=function(e){return j(this,e,(function(e,t){return e^t}))},h.prototype.xor=u.prototype.xor=l.prototype.xor;var M=1<<30,U=(r&-r)*(r&-r)|M;function K(e){var t=e.value,n="number"==typeof t?t|M:"bigint"==typeof t?t|BigInt(M):t[0]+t[1]*r|U;return n&-n}function F(e,r){if(r.compareTo(e)<=0){var n=F(e,r.square(r)),i=n.p,s=n.e,o=i.multiply(r);return o.compareTo(e)<=0?{p:o,e:2*s+1}:{p:i,e:2*s}}return{p:t(1),e:0}}function H(e,t){return e=Y(e),t=Y(t),e.greater(t)?e:t}function z(e,t){return e=Y(e),t=Y(t),e.lesser(t)?e:t}function V(e,t){if(e=Y(e).abs(),t=Y(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,i=c[1];e.isEven()&&t.isEven();)r=z(K(e),K(t)),e=e.divide(r),t=t.divide(r),i=i.multiply(r);for(;e.isEven();)e=e.divide(K(e));do{for(;t.isEven();)t=t.divide(K(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e)}while(!t.isZero());return i.isUnit()?e:e.multiply(i)}l.prototype.bitLength=function(){var e=this;return e.compareTo(t(0))<0&&(e=e.negate().subtract(t(1))),0===e.compareTo(t(0))?t(0):t(F(e,t(2)).e).add(t(1))},h.prototype.bitLength=u.prototype.bitLength=l.prototype.bitLength;var q=function(e,t,r,n){r=r||o,e=String(e),n||(e=e.toLowerCase(),r=r.toLowerCase());var i,s=e.length,a=Math.abs(t),c={};for(i=0;i<r.length;i++)c[r[i]]=i;for(i=0;i<s;i++){if("-"!==(h=e[i])&&(h in c&&c[h]>=a)){if("1"===h&&1===a)continue;throw new Error(h+" is not a valid digit in base "+t+".")}}t=Y(t);var l=[],u="-"===e[0];for(i=u?1:0;i<e.length;i++){var h;if((h=e[i])in c)l.push(Y(c[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var f=i;do{i++}while(">"!==e[i]&&i<e.length);l.push(Y(e.slice(f+1,i)))}}return G(l,t,u)};function G(e,t,r){var n,i=c[0],s=c[1];for(n=e.length-1;n>=0;n--)i=i.add(e[n].times(s)),s=s.times(t);return r?i.negate():i}function W(e,r){if((r=t(r)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(r.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var i=!1;if(e.isNegative()&&r.isPositive()&&(i=!0,e=e.abs()),r.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var s,o=[],a=e;a.isNegative()||a.compareAbs(r)>=0;){s=a.divmod(r),a=s.quotient;var c=s.remainder;c.isNegative()&&(c=r.minus(c).abs(),a=a.next()),o.push(c.toJSNumber())}return o.push(a.toJSNumber()),{value:o.reverse(),isNegative:i}}function X(e,t,r){var n=W(e,t);return(n.isNegative?"-":"")+n.value.map((function(e){return function(e,t){return e<(t=t||o).length?t[e]:"<"+e+">"}(e,r)})).join("")}function J(e){if(f(+e)){var t=+e;if(t===g(t))return a?new h(BigInt(t)):new u(t);throw new Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var i=e.split(/e/i);if(i.length>2)throw new Error("Invalid integer: "+i.join("e"));if(2===i.length){var s=i[1];if("+"===s[0]&&(s=s.slice(1)),(s=+s)!==g(s)||!f(s))throw new Error("Invalid integer: "+s+" is not a valid exponent.");var o=i[0],c=o.indexOf(".");if(c>=0&&(s-=o.length-c-1,o=o.slice(0,c)+o.slice(c+1)),s<0)throw new Error("Cannot include negative exponent part for integers");e=o+=new Array(s+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(a)return new h(BigInt(r?"-"+e:e));for(var p=[],d=e.length,y=n,v=d-y;d>0;)p.push(+e.slice(v,d)),(v-=y)<0&&(v=0),d-=y;return m(p),new l(p,r)}function Y(e){return"number"==typeof e?function(e){if(a)return new h(BigInt(e));if(f(e)){if(e!==g(e))throw new Error(e+" is not an integer.");return new u(e)}return J(e.toString())}(e):"string"==typeof e?J(e):"bigint"==typeof e?new h(e):e}l.prototype.toArray=function(e){return W(this,e)},u.prototype.toArray=function(e){return W(this,e)},h.prototype.toArray=function(e){return W(this,e)},l.prototype.toString=function(t,r){if(t===e&&(t=10),10!==t)return X(this,t,r);for(var n,i=this.value,s=i.length,o=String(i[--s]);--s>=0;)n=String(i[s]),o+="0000000".slice(n.length)+n;return(this.sign?"-":"")+o},u.prototype.toString=function(t,r){return t===e&&(t=10),10!=t?X(this,t,r):String(this.value)},h.prototype.toString=u.prototype.toString,h.prototype.toJSON=l.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},l.prototype.valueOf=function(){return parseInt(this.toString(),10)},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,h.prototype.valueOf=h.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Z=0;Z<1e3;Z++)c[Z]=Y(Z),Z>0&&(c[-Z]=Y(-Z));return c.one=c[1],c.zero=c[0],c.minusOne=c[-1],c.max=H,c.min=z,c.gcd=V,c.lcm=function(e,t){return e=Y(e).abs(),t=Y(t).abs(),e.divide(V(e,t)).multiply(t)},c.isInstance=function(e){return e instanceof l||e instanceof u||e instanceof h},c.randBetween=function(e,t,n){e=Y(e),t=Y(t);var i=n||Math.random,s=z(e,t),o=H(e,t).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(i()*o));for(var a=W(o,r).value,l=[],u=!0,h=0;h<a.length;h++){var f=u?a[h]+(h+1<a.length?a[h+1]/r:0):r,p=g(i()*f);l.push(p),p<a[h]&&(u=!1)}return s.add(c.fromArray(l,r,!1))},c.fromArray=function(e,t,r){return G(e.map(Y),Y(t||10),r)},c}();e.hasOwnProperty("exports")&&(e.exports=t)}(bk);var wk,_k=bk.exports,Sk=a;function Ek(e,t){return wk||function(){var e,t,r;for(wk=[],t=0;t<256;t++){for(e=t,r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>=1;wk[t]=e>>>0}}(),e.charCodeAt&&(e=e.charCodeAt(0)),_k(t).shiftRight(8).and(16777215).xor(wk[_k(t).xor(e).and(255)]).value}function Ak(){if(!(this instanceof Ak))return new Ak;this.key0=305419896,this.key1=591751049,this.key2=878082192}Sk.Writable&&Sk.Writable.prototype.destroy||(Sk=lS()),Ak.prototype.update=function(e){this.key0=Ek(e,this.key0),this.key1=_k(this.key0).and(255).and(4294967295).add(this.key1),this.key1=_k(this.key1).multiply(134775813).add(1).and(4294967295).value,this.key2=Ek(_k(this.key1).shiftRight(24).and(255),this.key2)},Ak.prototype.decryptByte=function(e){var t=_k(this.key2).or(2);return e^=_k(t).multiply(_k(1^t)).shiftRight(8).and(255),this.update(e),e},Ak.prototype.stream=function(){var e=Sk.Transform(),t=this;return e._transform=function(e,r,n){for(var i=0;i<e.length;i++)e[i]=t.decryptByte(e[i]);this.push(e),n()},e};var kk=d_,xk=Ak,Ck=mS,Rk=a,Ok=Lb,Nk=S,Ik=kS,Tk=__,Pk=xS;Rk.Writable&&Rk.Writable.prototype.destroy||(Rk=lS());var Bk=Lb,Dk=mS,$k=function(e,t,r,n){var i=Ck(),s=Rk.PassThrough(),o=e.stream(t);return o.pipe(i).on("error",(function(e){s.emit("error",e)})),s.vars=i.pull(30).then((function(e){var t=Ok.parse(e).word32lu("signature").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return t.lastModifiedDateTime=Pk(t.lastModifiedDate,t.lastModifiedTime),i.pull(t.fileNameLength).then((function(e){return t.fileName=e.toString("utf8"),i.pull(t.extraFieldLength)})).then((function(e){var o;return t.extra=Ik(e,t),n&&n.compressedSize&&(t=n),1&t.flags&&(o=i.pull(12).then((function(e){if(!r)throw new Error("MISSING_PASSWORD");var n=xk();String(r).split("").forEach((function(e){n.update(e)}));for(var i=0;i<e.length;i++)e[i]=n.decryptByte(e[i]);t.decrypt=n,t.compressedSize-=12;var s=8&t.flags?t.lastModifiedTime>>8&255:t.crc32>>24&255;if(e[11]!==s)throw new Error("BAD_PASSWORD");return t}))),kk.resolve(o).then((function(){return s.emit("vars",t),t}))}))})),s.vars.then((function(e){var t,r=!(8&e.flags)||e.compressedSize>0,n=e.compressionMethod?Nk.createInflateRaw():Rk.PassThrough();r?(s.size=e.uncompressedSize,t=e.compressedSize):(t=Tk.alloc(4)).writeUInt32LE(134695760,0);var a=i.stream(t);e.decrypt&&(a=a.pipe(e.decrypt.stream())),a.pipe(n).on("error",(function(e){s.emit("error",e)})).pipe(s).on("finish",(function(){o.destroy?o.destroy():o.abort?o.abort():o.close?o.close():o.push?o.push():console.log("warning - unable to close stream")}))})).catch((function(e){s.emit("error",e)})),s},Lk=d_,jk=ES,Mk=kS,Uk=k,Kk=JS.Writer,Fk=xS,Hk=__.alloc(4);Hk.writeUInt32LE(101010256,0);var zk=SE,Vk=d_,qk=function(e,t){var r,n,i,s,o=Dk(),a=Dk(),c=t&&t.tailSize||80;return t&&t.crx&&(n=function(e){var t=e.stream(0).pipe(Dk());return t.pull(4).then((function(e){var r;if(875721283===e.readUInt32LE(0))return t.pull(12).then((function(e){r=Bk.parse(e).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars})).then((function(){return t.pull(r.pubKeyLength+r.signatureLength)})).then((function(e){return r.publicKey=e.slice(0,r.pubKeyLength),r.signature=e.slice(r.pubKeyLength),r.size=16+r.pubKeyLength+r.signatureLength,r}))}))}(e)),e.size().then((function(t){return r=t,e.stream(Math.max(0,t-c)).on("error",(function(e){o.emit("error",e)})).pipe(o),o.pull(Hk)})).then((function(){return Lk.props({directory:o.pull(22),crxHeader:n})})).then((function(t){var n=t.directory;if(i=t.crxHeader&&t.crxHeader.size||0,65535==(s=Bk.parse(n).word32lu("signature").word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars).numberOfRecords||65535==s.numberOfRecords||4294967295==s.offsetToStartOfCentralDirectory){const t=20,n=r-(c-o.match+t),i=Dk();return e.stream(n).pipe(i),i.pull(t).then((function(t){return function(e,t){var r=Bk.parse(t).word32lu("signature").word32lu("diskNumber").word64lu("offsetToStartOfCentralDirectory").word32lu("numberOfDisks").vars;if(117853008!=r.signature)throw new Error("invalid zip64 end of central dir locator signature (0x07064b50): 0x"+r.signature.toString(16));var n=Dk();return e.stream(r.offsetToStartOfCentralDirectory).pipe(n),n.pull(56)}(e,t)})).then((function(e){s=function(e){var t=Bk.parse(e).word32lu("signature").word64lu("sizeOfCentralDirectory").word16lu("version").word16lu("versionsNeededToExtract").word32lu("diskNumber").word32lu("diskStart").word64lu("numberOfRecordsOnDisk").word64lu("numberOfRecords").word64lu("sizeOfCentralDirectory").word64lu("offsetToStartOfCentralDirectory").vars;if(101075792!=t.signature)throw new Error("invalid zip64 end of central dir locator signature (0x06064b50): 0x0"+t.signature.toString(16));return t}(e)}))}s.offsetToStartOfCentralDirectory+=i})).then((function(){if(s.commentLength)return o.pull(s.commentLength).then((function(e){s.comment=e.toString("utf8")}))})).then((function(){return e.stream(s.offsetToStartOfCentralDirectory).pipe(a),s.extract=function(e){if(!e||!e.path)throw new Error("PATH_MISSING");return e.path=Uk.resolve(Uk.normalize(e.path)),s.files.then((function(t){return Lk.map(t,(function(t){if("Directory"!=t.type){var r=Uk.join(e.path,t.path);if(0==r.indexOf(e.path)){var n=e.getWriter?e.getWriter({path:r}):Kk({path:r});return new Lk((function(r,i){t.stream(e.password).on("error",i).pipe(n).on("close",r).on("error",i)}))}}}),{concurrency:e.concurrency>1?e.concurrency:1})}))},s.files=Lk.mapSeries(Array(s.numberOfRecords),(function(){return a.pull(46).then((function(t){var r=Bk.parse(t).word32lu("signature").word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return r.offsetToLocalFileHeader+=i,r.lastModifiedDateTime=Fk(r.lastModifiedDate,r.lastModifiedTime),a.pull(r.fileNameLength).then((function(e){return r.pathBuffer=e,r.path=e.toString("utf8"),r.isUnicode=0!=(2048&r.flags),a.pull(r.extraFieldLength)})).then((function(e){return r.extra=Mk(e,r),a.pull(r.fileCommentLength)})).then((function(t){return r.comment=t,r.type=0===r.uncompressedSize&&/[\/\\]$/.test(r.path)?"Directory":"File",r.stream=function(t){return $k(e,r.offsetToLocalFileHeader,t,r)},r.buffer=function(e){return jk(r.stream(e))},r}))}))})),Lk.props(s)}))},Gk=a;Gk.Writable&&Gk.Writable.prototype.destroy||(Gk=lS());var Wk={buffer:function(e,t){var r={stream:function(t,r){var n=Gk.PassThrough();return n.end(e.slice(t,r)),n},size:function(){return Vk.resolve(e.length)}};return qk(r,t)},file:function(e,t){var r={stream:function(t,r){return zk.createReadStream(e,{start:t,end:r&&t+r})},size:function(){return new Vk((function(t,r){zk.stat(e,(function(e,n){e?r(e):t(n.size)}))}))}};return qk(r,t)},url:function(e,t,r){if("string"==typeof t&&(t={url:t}),!t.url)throw"URL missing";t.headers=t.headers||{};var n={stream:function(r,n){var i=Object.create(t);return i.headers=Object.create(t.headers),i.headers.range="bytes="+r+"-"+(n||""),e(i)},size:function(){return new Vk((function(r,n){var i=e(t);i.on("response",(function(e){i.abort(),e.headers["content-length"]?r(e.headers["content-length"]):n(new Error("Missing content length header"))})).on("error",n)}))}};return qk(n,r)},s3:function(e,t,r){var n={size:function(){return new Vk((function(r,n){e.headObject(t,(function(e,t){e?n(e):r(t.ContentLength)}))}))},stream:function(r,n){var i={};for(var s in t)i[s]=t[s];return i.Range="bytes="+r+"-"+(n||""),e.getObject(i).createReadStream()}};return qk(n,r)},custom:function(e,t){return qk(e,t)}};bb.Parse=US,bb.ParseOne=XS,bb.Extract=fk,bb.Open=Wk;class Xk{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e).slice().buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=Xk.toUint8Array(e),n=Xk.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}static concat(...e){if(Array.isArray(e[0])){const t=e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[1]?this.toView(n,e[1]):n.buffer}return this.concat(e)}}class Jk{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=Xk.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class Yk{static toString(e,t=!1){const r=Xk.toArrayBuffer(e),n=new DataView(r);let i="";for(let e=0;e<r.byteLength;e+=2){const r=n.getUint16(e,t);i+=String.fromCharCode(r)}return i}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class Zk{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const r=Xk.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return Yk.toString(r,!0);case"utf16":case"utf16be":return Yk.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return Yk.fromString(e,!0);case"utf16":case"utf16be":return Yk.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=Xk.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Zk.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Zk.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=Zk.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return Jk.fromString(e);case"utf16":case"utf16be":return Yk.fromString(e);case"utf16le":case"usc2":return Yk.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=Zk.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return Jk.toString(e);case"utf16":case"utf16be":return Yk.toString(e);case"utf16le":case"usc2":return Yk.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=Xk.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=Xk.toUint8Array(e),r=[],n=t.length;for(let e=0;e<n;e++){const n=t[e].toString(16).padStart(2,"0");r.push(n)}return r.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Zk.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return Yk.toString(e,t)}static FromUtf16String(e,t=!1){return Yk.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function Qk(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer}
/*!
 Copyright (c) Peculiar Ventures, LLC
*/function ex(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function tx(e,t,r=-1){const n=r;let i=e,s=0,o=Math.pow(2,t);for(let r=1;r<8;r++){if(e<o){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const o=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);o[s-e-1]=Math.floor(i/r),i-=o[s-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function rx(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function nx(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=ex(r,8),i=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];s[0]&=127;return ex(s,8)-n}function ix(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}
/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function sx(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ox(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function ax(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}Zk.DEFAULT_UTF8_ENCODING="utf8";class cx{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return ox(this.items)}}const lx=[new Uint8Array([1])],ux="0123456789",hx="name",fx="valueHexView",px="isHexOnly",dx="idBlock",mx="tagClass",yx="tagNumber",gx="isConstructed",vx="fromBER",bx="toBER",wx="local",_x="",Sx=new ArrayBuffer(0),Ex=new Uint8Array(0),Ax="EndOfContent",kx="OCTET STRING",xx="BIT STRING";function Cx(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?Xk.toUint8Array(r.valueHex):Ex}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!ax(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Sx)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Zk.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class Rx{constructor({blockLength:e=0,error:t=_x,warnings:r=[],valueBeforeDecode:n=Ex}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=Xk.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Zk.ToHex(this.valueBeforeDecodeView)}}}Rx.NAME="baseBlock";class Ox extends Rx{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Ox.NAME="valueBlock";class Nx extends(Cx(Rx)){constructor({idBlock:e={}}={}){var t,r,n,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?Xk.toUint8Array(e.valueHex):Ex,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Sx}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=tx(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,s=new Uint8Array(i+1);if(s[0]=31|t,!e){for(let e=0;e<i-1;e++)s[e+1]=128|n[e];s[i]=n[i-1]}return s.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=Xk.toUint8Array(e);if(!ax(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&i[0]),this.isHexOnly=!1;const s=31&i[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&i[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=ex(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Nx.NAME="identificationBlock";class Ix extends Rx{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const n=Xk.toUint8Array(e);if(!ax(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const s=127&i[0];if(s>8)return this.error="Too big integer",-1;if(s+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const o=t+1,a=n.subarray(o,o+s);return 0===a[s-1]&&this.warnings.push("Needlessly long encoded length"),this.length=ex(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=tx(this.length,8);if(n.byteLength>127)return this.error="Too big length",Sx;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Ix.NAME="lengthBlock";const Tx={};class Px extends Rx{constructor({name:e=_x,optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new Nx(n),this.lenBlock=new Ix(n),this.valueBlock=i?new i(n):new Ox(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new cx;t||Bx(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?Sx:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():Zk.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${Zk.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;return function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}(this.toBER(),e.toBER())}}function Bx(e){if(e instanceof Tx.Constructed)for(const t of e.valueBlock.value)Bx(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}Px.NAME="BaseBlock";class Dx extends Px{constructor({value:e=_x,...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Dx.NAME="BaseStringBlock";class $x extends(Cx(Ox)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var Lx,jx,Mx,Ux,Kx;$x.NAME="PrimitiveValueBlock";class Fx extends Px{constructor(e={}){super(e,$x),this.idBlock.isConstructed=!1}}function Hx(e,t=0,r=e.length){const n=t;let i=new Px({},Ox);const s=new Rx;if(!ax(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let o=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===o)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=o,r-=i.idBlock.blockLength,o=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===o)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=o,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=Px;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=Tx.EndOfContent;break;case 1:a=Tx.Boolean;break;case 2:a=Tx.Integer;break;case 3:a=Tx.BitString;break;case 4:a=Tx.OctetString;break;case 5:a=Tx.Null;break;case 6:a=Tx.ObjectIdentifier;break;case 10:a=Tx.Enumerated;break;case 12:a=Tx.Utf8String;break;case 13:a=Tx.RelativeObjectIdentifier;break;case 14:a=Tx.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=Tx.Sequence;break;case 17:a=Tx.Set;break;case 18:a=Tx.NumericString;break;case 19:a=Tx.PrintableString;break;case 20:a=Tx.TeletexString;break;case 21:a=Tx.VideotexString;break;case 22:a=Tx.IA5String;break;case 23:a=Tx.UTCTime;break;case 24:a=Tx.GeneralizedTime;break;case 25:a=Tx.GraphicString;break;case 26:a=Tx.VisibleString;break;case 27:a=Tx.GeneralString;break;case 28:a=Tx.UniversalString;break;case 29:a=Tx.CharacterString;break;case 30:a=Tx.BmpString;break;case 31:a=Tx.DATE;break;case 32:a=Tx.TimeOfDay;break;case 33:a=Tx.DateTime;break;case 34:a=Tx.Duration;break;default:{const e=i.idBlock.isConstructed?new Tx.Constructed:new Tx.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=i.idBlock.isConstructed?Tx.Constructed:Tx.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,a),o=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:o,result:i}}function zx(e){if(!e.byteLength){const e=new Px({},Ox);return e.error="Input buffer has zero length",{offset:-1,result:e}}return Hx(Xk.toUint8Array(e).slice(),0,e.byteLength)}Lx=Fx,Tx.Primitive=Lx,Fx.NAME="PRIMITIVE";class Vx extends Ox{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=Xk.toUint8Array(e);if(!ax(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;s=this.isIndefiniteForm,o=r,(s?1:o)>0;){const e=Hx(n,i,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===Ax)break}var s,o;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Ax?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const r=t||new cx;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?Sx:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Vx.NAME="ConstructedValueBlock";class qx extends Px{constructor(e={}){super(e,Vx),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}jx=qx,Tx.Constructed=jx,qx.NAME="CONSTRUCTED";class Gx extends Ox{fromBER(e,t,r){return t}toBER(e){return Sx}}Gx.override="EndOfContentValueBlock";class Wx extends Px{constructor(e={}){super(e,Gx),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Mx=Wx,Tx.EndOfContent=Mx,Wx.NAME=Ax;class Xx extends Px{constructor(e={}){super(e,Ox),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}Ux=Xx,Tx.Null=Ux,Xx.NAME="NULL";class Jx extends(Cx(Ox)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=Xk.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const n=Xk.toUint8Array(e);return ax(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,nx.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Jx.NAME="BooleanValueBlock";let Yx=class extends Px{constructor(e={}){super(e,Jx),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};Kx=Yx,Tx.Boolean=Kx,Yx.NAME="BOOLEAN";class Zx extends(Cx(Vx)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=Vx.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===Ax){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==kx)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?Vx.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}var Qx;Zx.NAME="OctetStringValueBlock";let eC=class e extends Px{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Zx),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=Hx(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?qx.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${Zk.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const t=[];for(const r of this.valueBlock.value)r instanceof e&&t.push(r.valueBlock.valueHexView);return Xk.concat(t)}};Qx=eC,Tx.OctetString=Qx,eC.NAME=kx;class tC extends(Cx(Vx)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=Vx.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===Ax){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==xx)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=Xk.toUint8Array(e);if(!ax(this,i,t,r))return-1;const s=i.subarray(t,t+r);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=s.subarray(1);try{if(e.byteLength){const t=Hx(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,t+r}toBER(e,t){if(this.isConstructed)return Vx.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Sx;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}var rC;tC.NAME="BitStringValueBlock";let nC=class extends Px{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},tC),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return qx.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}};var iC,sC,oC,aC;function cC(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),i=new Uint8Array(t);let s=n.slice(0);const o=s.length-1,a=i.slice(0),c=a.length-1;let l=0;let u=0;for(let e=c<o?o:c;e>=0;e--,u++){if(!0==u<a.length)l=s[o-u]+a[c-u]+r[0];else l=s[o-u]+r[0];if(r[0]=l/10,!0==u>=s.length)s=rx(new Uint8Array([l%10]),s);else s[o-u]=l%10}return r[0]>0&&(s=rx(r,s)),s}function lC(e){if(e>=lx.length)for(let t=lx.length;t<=e;t++){const e=new Uint8Array([0]);let r=lx[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=rx(e,r)),lx.push(r)}return lx[e]}function uC(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0),o=s.length-1,a=i.slice(0),c=a.length-1;let l,u=0;for(let e=c;e>=0;e--,u++)if(l=s[o-u]-a[c-u]-r,!0==l<0)r=1,s[o-u]=l+10;else r=0,s[o-u]=l;if(r>0)for(let e=o-c+1;e>=0;e--,u++){if(l=s[o-u]-r,!(l<0)){r=0,s[o-u]=l;break}r=1,s[o-u]=l+10}return s.slice()}rC=nC,Tx.BitString=rC,nC.NAME=xx;class hC extends(Cx(Ox)){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=nx.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=tx(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=tx(t,8,n),s=new Uint8Array(i);if(128&s[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=this.valueHexView;return 0===s[0]&&0!=(128&s[1])?this.valueHexView=s.subarray(1):0!==n&&s.length<n&&(n-s.length>1&&(n=s.length+1),this.valueHexView=s.subarray(n-s.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let s="",o=!1;for(let o=i.byteLength-1;o>=0;o--){t=i[o];for(let i=0;i<8;i++){if(1==(1&t))if(n===e)r=uC(lC(n),r),s="-";else r=cC(r,lC(n));n++,t>>=1}}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(s+=ux.charAt(r[e]));return!1===o&&(s+=ux.charAt(0)),s}}iC=hC,hC.NAME="IntegerValueBlock",Object.defineProperty(iC.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class fC extends Px{constructor(e={}){super(e,hC),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return sx(),BigInt(this.valueBlock.toString())}static fromBigInt(e){sx();const t=BigInt(e),r=new cx,n=t.toString(16).replace(/^-/,""),i=new Uint8Array(Zk.FromHex(n));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const n=BigInt(`0x${Zk.ToHex(e)}`)+t,s=Xk.toUint8Array(Zk.FromHex(n.toString(16)));s[0]|=128,r.write(s)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new fC({valueHex:r.final()})}convertToDER(){const e=new fC({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new fC({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}sC=fC,Tx.Integer=sC,fC.NAME="INTEGER";class pC extends fC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}oC=pC,Tx.Enumerated=oC,pC.NAME="ENUMERATED";class dC extends(Cx(Ox)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=Xk.toUint8Array(e);if(!ax(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ex(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){sx();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=tx(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Sx;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=Zk.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}dC.NAME="sidBlock";class mC extends Ox{constructor({value:e=_x,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new dC;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,Sx;t.push(n)}return ox(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new dC;if(n>Number.MAX_SAFE_INTEGER){sx();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}mC.NAME="ObjectIdentifierValueBlock";let yC=class extends Px{constructor(e={}){super(e,mC),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};aC=yC,Tx.ObjectIdentifier=aC,yC.NAME="OBJECT IDENTIFIER";class gC extends(Cx(Rx)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=Xk.toUint8Array(e);if(!ax(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ex(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=tx(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Sx;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?Zk.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}gC.NAME="relativeSidBlock";class vC extends Ox{constructor({value:e=_x,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new gC;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,Sx;r.push(n)}return ox(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new gC;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}var bC,wC,_C;vC.NAME="RelativeObjectIdentifierValueBlock";class SC extends Px{constructor(e={}){super(e,vC),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}bC=SC,Tx.RelativeObjectIdentifier=bC,SC.NAME="RelativeObjectIdentifier";class EC extends qx{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}wC=EC,Tx.Sequence=wC,EC.NAME="SEQUENCE";let AC=class extends qx{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};_C=AC,Tx.Set=_C,AC.NAME="SET";class kC extends(Cx(Ox)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=_x}toJSON(){return{...super.toJSON(),value:this.value}}}kC.NAME="StringValueBlock";class xC extends kC{}xC.NAME="SimpleStringValueBlock";class CC extends Dx{constructor({...e}={}){super(e,xC)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,Xk.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}CC.NAME="SIMPLE STRING";class RC extends CC{fromBuffer(e){this.valueBlock.valueHexView=Xk.toUint8Array(e);try{this.valueBlock.value=Zk.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=Zk.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(Zk.FromUtf8String(e)),this.valueBlock.value=e}}var OC,NC,IC,TC,PC,BC,DC,$C,LC,jC,MC,UC,KC,FC,HC,zC,VC,qC,GC;RC.NAME="Utf8StringValueBlock";class WC extends RC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}OC=WC,Tx.Utf8String=OC,WC.NAME="UTF8String";class XC extends CC{fromBuffer(e){this.valueBlock.value=Zk.ToUtf16String(e),this.valueBlock.valueHexView=Xk.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(Zk.FromUtf16String(e))}}XC.NAME="BmpStringValueBlock";class JC extends XC{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}NC=JC,Tx.BmpString=NC,JC.NAME="BMPString";class YC extends CC{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=tx(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const s=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+s]=i[e]}this.valueBlock.value=e}}YC.NAME="UniversalStringValueBlock";class ZC extends YC{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}IC=ZC,Tx.UniversalString=IC,ZC.NAME="UniversalString";class QC extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}TC=QC,Tx.NumericString=TC,QC.NAME="NumericString";class eR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}PC=eR,Tx.PrintableString=PC,eR.NAME="PrintableString";class tR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}BC=tR,Tx.TeletexString=BC,tR.NAME="TeletexString";class rR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}DC=rR,Tx.VideotexString=DC,rR.NAME="VideotexString";class nR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}$C=nR,Tx.IA5String=$C,nR.NAME="IA5String";class iR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}LC=iR,Tx.GraphicString=LC,iR.NAME="GraphicString";class sR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}jC=sR,Tx.VisibleString=jC,sR.NAME="VisibleString";class oR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}MC=oR,Tx.GeneralString=MC,oR.NAME="GeneralString";class aR extends CC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}UC=aR,Tx.CharacterString=UC,aR.NAME="CharacterString";class cR extends sR{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,Xk.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=ix(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=ix(this.month,2),e[2]=ix(this.day,2),e[3]=ix(this.hour,2),e[4]=ix(this.minute,2),e[5]=ix(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}KC=cR,Tx.UTCTime=KC,cR.NAME="UTCTime";class lR extends cR{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",s=0,o=0,a=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(o=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),i=n.substring(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const l=t.exec(i);if(null===l)throw new Error("Wrong input string for conversion");for(let e=1;e<l.length;e++)switch(e){case 1:this.year=parseInt(l[e],10);break;case 2:this.month=parseInt(l[e],10);break;case 3:this.day=parseInt(l[e],10);break;case 4:this.hour=parseInt(l[e],10)+o;break;case 5:this.minute=parseInt(l[e],10)+a;break;case 6:this.second=parseInt(l[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(ix(this.year,4)),e.push(ix(this.month,2)),e.push(ix(this.day,2)),e.push(ix(this.hour,2)),e.push(ix(this.minute,2)),e.push(ix(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(ix(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}FC=lR,Tx.GeneralizedTime=FC,lR.NAME="GeneralizedTime";class uR extends WC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}HC=uR,Tx.DATE=HC,uR.NAME="DATE";class hR extends WC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}zC=hR,Tx.TimeOfDay=zC,hR.NAME="TimeOfDay";class fR extends WC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}VC=fR,Tx.DateTime=VC,fR.NAME="DateTime";class pR extends WC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}qC=pR,Tx.Duration=qC,pR.NAME="Duration";class dR extends WC{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}GC=dR,Tx.TIME=GC,dR.NAME="TIME";class mR{constructor({name:e=_x,optional:t=!1}={}){this.name=e,this.optional=t}}class yR extends mR{constructor({value:e=[],...t}={}){super(t),this.value=e}}class gR extends mR{constructor({value:e=new mR,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}function vR(e,t,r){if(r instanceof yR){for(let n=0;n<r.value.length;n++){if(vR(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(hx)&&(e.name=r.name),e}}if(r instanceof mR)return r.hasOwnProperty(hx)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(dx in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(vx in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(bx in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty(mx))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(yx))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(gx))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!(px in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(fx in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&(e[r.name]=t)),r instanceof Tx.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof gR&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof gR){if(i=vR(e,t.valueBlock.value[o],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&delete e[r.name]),i;n++}if(hx in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n=wx in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(i=vR(e,t.valueBlock.value[o-n],r.valueBlock.value[o]),!1===i.verified){if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&fx in t.valueBlock){const n=Hx(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,_x),r.name&&(delete e[r.name],t.name=r.name)),t}return vR(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}var bR,wR,_R=Object.freeze({__proto__:null,Any:mR,BaseBlock:Px,BaseStringBlock:Dx,BitString:nC,BmpString:JC,Boolean:Yx,CharacterString:aR,Choice:yR,Constructed:qx,DATE:uR,DateTime:fR,Duration:pR,EndOfContent:Wx,Enumerated:pC,GeneralString:oR,GeneralizedTime:lR,GraphicString:iR,HexBlock:Cx,IA5String:nR,Integer:fC,Null:Xx,NumericString:QC,ObjectIdentifier:yC,OctetString:eC,Primitive:Fx,PrintableString:eR,RawData:class{constructor({data:e=Ex}={}){this.dataView=Xk.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=Xk.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=Xk.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}},RelativeObjectIdentifier:SC,Repeated:gR,Sequence:EC,Set:AC,TIME:dR,TeletexString:tR,TimeOfDay:hR,UTCTime:cR,UniversalString:ZC,Utf8String:WC,ValueBlock:Ox,VideotexString:rR,ViewWriter:cx,VisibleString:sR,compareSchema:vR,fromBER:zx,verifySchema:function(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=Hx(Xk.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:vR(r.result,r.result,t)}});!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(bR||(bR={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(wR||(wR={}));const SR={fromASN:e=>e instanceof Xx?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new Xx;const t=zx(e);if(t.result.error)throw new Error(t.result.error);return t.result}},ER={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new fC({value:+e})},AR={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new pC({value:e})},kR={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new nC({valueHex:e})},xR={fromASN:e=>e.valueBlock.toString(),toASN:e=>new yC({value:e})},CR={fromASN:e=>e.valueBlock.value,toASN:e=>new Yx({value:e})},RR={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new eC({valueHex:e})};function OR(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const NR=OR(WC),IR=OR(JC),TR=OR(ZC),PR=OR(QC),BR=OR(eR),DR=OR(tR),$R=OR(rR),LR=OR(nR),jR=OR(iR),MR=OR(sR),UR=OR(oR),KR=OR(aR),FR={fromASN:e=>e.toDate(),toASN:e=>new cR({valueDate:e})},HR={fromASN:e=>e.toDate(),toASN:e=>new lR({valueDate:e})},zR={fromASN:()=>null,toASN:()=>new Xx};function VR(e){switch(e){case wR.Any:return SR;case wR.BitString:return kR;case wR.BmpString:return IR;case wR.Boolean:return CR;case wR.CharacterString:return KR;case wR.Enumerated:return AR;case wR.GeneralString:return UR;case wR.GeneralizedTime:return HR;case wR.GraphicString:return jR;case wR.IA5String:return LR;case wR.Integer:return ER;case wR.Null:return zR;case wR.NumericString:return PR;case wR.ObjectIdentifier:return xR;case wR.OctetString:return RR;case wR.PrintableString:return BR;case wR.TeletexString:return DR;case wR.UTCTime:return FR;case wR.UniversalString:return TR;case wR.Utf8String:return NR;case wR.VideotexString:return $R;case wR.VisibleString:return MR;default:return null}}function qR(e){return"function"==typeof e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||qR(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}function GR(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||GR(r)}return!1}function WR(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const XR=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const r=this.items.get(e);if(!r)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:bR.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){const r=this.items.get(e)||this.createDefault(e),n=[];for(const e in r.items){const i=r.items[e],s=t?e:"";let o;if("number"==typeof i.type){const e=wR[i.type],t=_R[e];if(!t)throw new Error(`Cannot get ASN1 class by name '${e}'`);o=new t({name:s})}else if(qR(i.type)){o=(new i.type).toSchema(s)}else if(i.optional){this.get(i.type).type===bR.Choice?o=new mR({name:s}):(o=this.create(i.type,!1),o.name=s)}else o=new mR({name:s});const a=!!i.optional||void 0!==i.defaultValue;if(i.repeated){o.name="";o=new("set"===i.repeated?AC:EC)({name:"",value:[new gR({name:s,value:o})]})}if(null!==i.context&&void 0!==i.context)if(i.implicit)if("number"==typeof i.type||qR(i.type)){const e=i.repeated?qx:Fx;n.push(new e({name:s,optional:a,idBlock:{tagClass:3,tagNumber:i.context}}))}else{this.cache(i.type);const e=!!i.repeated;let t=e?o:this.get(i.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,n.push(new qx({name:e?"":s,optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:t}))}else n.push(new qx({optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:[o]}));else o.optional=a,n.push(o)}switch(r.type){case bR.Sequence:return new EC({value:n,name:""});case bR.Set:return new AC({value:n,name:""});case bR.Choice:return new yR({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);if(t){return this.items.get(t)||this.findParentSchema(t)}return null}},JR=e=>t=>{let r;XR.has(t)?r=XR.get(t):(r=XR.createDefault(t),XR.set(t,r)),Object.assign(r,e)},YR=e=>(t,r)=>{let n;XR.has(t.constructor)?n=XR.get(t.constructor):(n=XR.createDefault(t.constructor),XR.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=VR(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class ZR extends Error{constructor(){super(...arguments),this.schemas=[]}}class QR{static parse(e,t){const r=zx(e);if(r.result.error)throw new Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){var r;try{if(qR(t)){return(new t).fromASN(e)}const n=XR.get(t);XR.cache(t);let i=n.schema;if(e.constructor===qx&&n.type!==bR.Choice){i=new qx({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const t in n.items)delete e[t]}const s=vR({},e,i);if(!s.verified)throw new ZR(`Data does not match to ${t.name} ASN1 schema. ${s.result.error}`);const o=new t;if(GR(t)){if(!("value"in e.valueBlock)||!Array.isArray(e.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const r=n.itemType;if("number"==typeof r){const n=VR(r);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,(e=>n.fromASN(e)))}return t.from(e.valueBlock.value,(e=>this.fromASN(e,r)))}for(const e in n.items){const t=s.result[e];if(!t)continue;const i=n.items[e],a=i.type;if("number"==typeof a||qR(a)){const n=null!==(r=i.converter)&&void 0!==r?r:qR(a)?new a:null;if(!n)throw new Error("Converter is empty");if(i.repeated)if(i.implicit){const r=new("sequence"===i.repeated?EC:AC);r.valueBlock=t.valueBlock;const s=zx(r.toBER(!1));if(-1===s.offset)throw new Error(`Cannot parse the child item. ${s.result.error}`);if(!("value"in s.result.valueBlock)||!Array.isArray(s.result.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const a=s.result.valueBlock.value;o[e]=Array.from(a,(e=>n.fromASN(e)))}else o[e]=Array.from(t,(e=>n.fromASN(e)));else{let r=t;if(i.implicit){let e;if(qR(a))e=(new a).toSchema("");else{const t=wR[a],r=_R[t];if(!r)throw new Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=zx(e.toBER(!1)).result}o[e]=n.fromASN(r)}}else if(i.repeated){if(!Array.isArray(t))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");o[e]=Array.from(t,(e=>this.fromASN(e,a)))}else o[e]=this.fromASN(t,a)}return o}catch(e){throw e instanceof ZR&&e.schemas.push(t.name),e}}}class eO{static serialize(e){return e instanceof Px?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&"object"==typeof e&&qR(e))return e.toASN();if(!e||"object"!=typeof e)throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,r=XR.get(t);XR.cache(t);let n,i=[];if(r.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if("number"==typeof r.itemType){const n=VR(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)))}else for(const n in r.items){const s=r.items[n],o=e[n];if(void 0===o||s.defaultValue===o||"object"==typeof s.defaultValue&&"object"==typeof o&&WR(this.serialize(s.defaultValue),this.serialize(o)))continue;const a=eO.toAsnItem(s,n,t,o);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!qR(s.type))i.push(new qx({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof Xx?a.valueBeforeDecodeView:a.valueBlock.toBER(),i.push(new Fx({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},...e}))}else i.push(new qx({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else s.repeated?i=i.concat(a):i.push(a)}switch(r.type){case bR.Sequence:n=new EC({value:i});break;case bR.Set:n=new AC({value:i});break;case bR.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const s=e.converter;if(!s)throw new Error(`Property '${t}' doesn't have converter for type ${wR[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>s.toASN(e)));i=new("sequence"===e.repeated?EC:AC)({value:t})}else i=s.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?EC:AC)({value:t})}else i=this.toASN(n);return i}}class tO{static serialize(e){return eO.serialize(e)}static parse(e,t){return QR.parse(e,t)}static toString(e){const t=zx(Xk.isBufferSource(e)?Xk.toArrayBuffer(e):tO.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function rO(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}"function"==typeof SuppressedError&&SuppressedError;class nO extends Error{constructor(e,t){super(t?`${e}. See the inner exception for more details.`:e),this.message=e,this.innerError=t}}class iO extends nO{constructor(e,t,r){super(t,r),this.schema=e}}class sO extends iO{constructor(e,t,r){super(e,`JSON doesn't match to '${e.target.name}' schema. ${t}`,r)}}class oO extends nO{}class aO extends nO{constructor(e,t,r){super(`Cannot serialize by '${e}' schema. ${t}`,r),this.schemaName=e}}class cO extends sO{constructor(e,t,r={}){super(e,"Some keys doesn't match to schema"),this.keys=t,this.errors=r}}var lO;function uO(e,t){if(!function(e,t){switch(t){case lO.Boolean:return"boolean"==typeof e;case lO.Number:return"number"==typeof e;case lO.String:return"string"==typeof e}return!0}(e,t))throw new TypeError(`Value must be ${lO[t]}`)}function hO(e){return e&&e.prototype?!(!e.prototype.toJSON||!e.prototype.fromJSON)||hO(e.prototype):!!(e&&e.toJSON&&e.fromJSON)}!function(e){e[e.Any=0]="Any",e[e.Boolean=1]="Boolean",e[e.Number=2]="Number",e[e.String=3]="String"}(lO||(lO={}));const fO="default",pO=new class{constructor(){this.items=new Map}has(e){return this.items.has(e)||!!this.findParentSchema(e)}get(e){const t=this.items.get(e)||this.findParentSchema(e);if(!t)throw new Error("Cannot get schema for current target");return t}create(e){const t={names:{}},r=this.findParentSchema(e);if(r){Object.assign(t,r),t.names={};for(const e in r.names)t.names[e]=Object.assign({},r.names[e])}return t.target=e,t}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=e.__proto__;if(t){return this.items.get(t)||this.findParentSchema(t)}return null}};class dO{constructor(e){this.pattern=new RegExp(e)}validate(e){const t=new RegExp(this.pattern.source,this.pattern.flags);if("string"!=typeof e)throw new oO("Incoming value must be string");if(!t.exec(e))throw new oO(`Value doesn't match to pattern '${t.toString()}'`)}}class mO{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(uO(e,lO.Number),!(this.min<=e&&e<=this.max)){const e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new oO(`Value doesn't match to diapason [${e},${t}]`)}}}class yO{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(uO(e,lO.Number),!(this.min<e&&e<this.max)){const e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new oO(`Value doesn't match to diapason (${e},${t})`)}}}class gO{constructor(e,t,r){this.length=e,this.minLength=t,this.maxLength=r}validate(e){if(void 0===this.length){if(void 0!==this.minLength&&e.length<this.minLength)throw new oO(`Value length must be more than ${this.minLength}.`);if(void 0!==this.maxLength&&e.length>this.maxLength)throw new oO(`Value length must be less than ${this.maxLength}.`)}else if(e.length!==this.length)throw new oO(`Value length must be exactly ${this.length}.`)}}class vO{constructor(e){this.enumeration=e}validate(e){if(uO(e,lO.String),!this.enumeration.includes(e))throw new oO(`Value must be one of ${this.enumeration.map((e=>`'${e}'`)).join(", ")}`)}}class bO{static checkValues(e,t){const r=Array.isArray(e)?e:[e];for(const n of r)for(const r of t.validations)r instanceof gO&&t.repeated?r.validate(e):r.validate(n)}static checkTypes(e,t){if(t.repeated&&!Array.isArray(e))throw new TypeError("Value must be Array");if("number"==typeof t.type){const r=Array.isArray(e)?e:[e];for(const e of r)uO(e,t.type)}}static getSchemaByName(e,t=fO){return{...e.names[fO],...e.names[t]}}}class wO extends bO{static serialize(e,t,r,n){const i=this.toJSON(e,t);return JSON.stringify(i,r,n)}static toJSON(e,t={}){let r,n=t.targetSchema;const i=t.schemaName||fO;if(hO(e))return e.toJSON();if(Array.isArray(e)){r=[];for(const n of e)r.push(this.toJSON(n,t))}else if("object"==typeof e){if(n&&!pO.has(n))throw new nO("Cannot get schema for `targetSchema` param");if(n=n||e.constructor,pO.has(n)){const t=pO.get(n);r={};const s=this.getSchemaByName(t,i);for(const o in s)try{const t=s[o],a=e[o];let c;if(t.optional&&void 0===a||void 0!==t.defaultValue&&a===t.defaultValue)continue;if(!t.optional&&void 0===a)throw new aO(n.name,`Property '${o}' is required.`);c="number"==typeof t.type?t.converter?t.repeated?a.map((r=>t.converter.toJSON(r,e))):t.converter.toJSON(a,e):a:t.repeated?a.map((e=>this.toJSON(e,{schemaName:i}))):this.toJSON(a,{schemaName:i}),this.checkTypes(c,t),this.checkValues(c,t),r[t.name||o]=c}catch(e){throw e instanceof aO?e:new aO(t.target.name,`Property '${o}' is wrong. ${e.message}`,e)}}else{r={};for(const t in e)r[t]=this.toJSON(e[t],{schemaName:i})}}else r=e;return r}}class _O extends bO{static parse(e,t){const r=JSON.parse(e);return this.fromJSON(r,t)}static fromJSON(e,t){const r=t.targetSchema,n=t.schemaName||fO,i=new r;if(hO(i))return i.fromJSON(e);const s=pO.get(r),o=this.getSchemaByName(s,n),a={};t.strictProperty&&!Array.isArray(e)&&_O.checkStrictProperty(e,o,s);for(const r in o)try{const a=o[r],c=a.name||r,l=e[c];if(void 0===l&&(a.optional||void 0!==a.defaultValue))continue;if(!a.optional&&void 0===l)throw new sO(s,`Property '${c}' is required.`);if(this.checkTypes(l,a),this.checkValues(l,a),"number"==typeof a.type)a.converter?a.repeated?i[r]=l.map((e=>a.converter.fromJSON(e,i))):i[r]=a.converter.fromJSON(l,i):i[r]=l;else{const e={...t,targetSchema:a.type,schemaName:n};a.repeated?i[r]=l.map((t=>this.fromJSON(t,e))):i[r]=this.fromJSON(l,e)}}catch(e){if(e instanceof sO||(e=new sO(s,`Property '${r}' is wrong. ${e.message}`,e)),!t.strictAllKeys)throw e;a[r]=e}const c=Object.keys(a);if(c.length)throw new cO(s,c,a);return i}static checkStrictProperty(e,t,r){const n=Object.keys(e),i=Object.keys(t),s=[];for(const e of n)-1===i.indexOf(e)&&s.push(e);if(s.length)throw new cO(r,s)}}const SO=(e={})=>(t,r)=>{const n=`Cannot set type for ${r} property of ${t.constructor.name} schema`;let i;pO.has(t.constructor)?(i=pO.get(t.constructor),i.target!==t.constructor&&(i=pO.create(t.constructor),pO.set(t.constructor,i))):(i=pO.create(t.constructor),pO.set(t.constructor,i));const s={type:lO.Any,validations:[]},o=Object.assign(s,e);if(o.validations=function(e){const t=[];return e.pattern&&t.push(new dO(e.pattern)),e.type!==lO.Number&&e.type!==lO.Any||(void 0===e.minInclusive&&void 0===e.maxInclusive||t.push(new mO(e.minInclusive,e.maxInclusive)),void 0===e.minExclusive&&void 0===e.maxExclusive||t.push(new yO(e.minExclusive,e.maxExclusive)),void 0!==e.enumeration&&t.push(new vO(e.enumeration))),(e.type===lO.String||e.repeated||e.type===lO.Any)&&(void 0===e.length&&void 0===e.minLength&&void 0===e.maxLength||t.push(new gO(e.length,e.minLength,e.maxLength))),t}(o),"number"!=typeof o.type&&!pO.has(o.type)&&!hO(o.type))throw new Error(`${n}. Assigning type doesn't have schema.`);let a;a=Array.isArray(e.schema)?e.schema:[e.schema||fO];for(const e of a){i.names[e]||(i.names[e]={});i.names[e][r]=o}}
/*!
 Copyright (c) Peculiar Ventures, LLC
*/;class EO extends Error{}class AO extends EO{}class kO extends EO{constructor(e){super("Unsupported operation: "+(e?`${e}`:""))}}class xO extends EO{}class CO extends EO{constructor(e){super(`${e}: Missing required property`)}}class RO{async digest(...e){return this.checkDigest.apply(this,e),this.onDigest.apply(this,e)}checkDigest(e,t){this.checkAlgorithmName(e)}async onDigest(e,t){throw new kO("digest")}async generateKey(...e){return this.checkGenerateKey.apply(this,e),this.onGenerateKey.apply(this,e)}checkGenerateKey(e,t,r,...n){if(this.checkAlgorithmName(e),this.checkGenerateKeyParams(e),!r||!r.length)throw new TypeError("Usages cannot be empty when creating a key.");let i;i=Array.isArray(this.usages)?this.usages:this.usages.privateKey.concat(this.usages.publicKey),this.checkKeyUsages(r,i)}checkGenerateKeyParams(e){}async onGenerateKey(e,t,r,...n){throw new kO("generateKey")}async sign(...e){return this.checkSign.apply(this,e),this.onSign.apply(this,e)}checkSign(e,t,r,...n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"sign")}async onSign(e,t,r,...n){throw new kO("sign")}async verify(...e){return this.checkVerify.apply(this,e),this.onVerify.apply(this,e)}checkVerify(e,t,r,n,...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"verify")}async onVerify(e,t,r,n,...i){throw new kO("verify")}async encrypt(...e){return this.checkEncrypt.apply(this,e),this.onEncrypt.apply(this,e)}checkEncrypt(e,t,r,n={},...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"encrypt":void 0)}async onEncrypt(e,t,r,...n){throw new kO("encrypt")}async decrypt(...e){return this.checkDecrypt.apply(this,e),this.onDecrypt.apply(this,e)}checkDecrypt(e,t,r,n={},...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"decrypt":void 0)}async onDecrypt(e,t,r,...n){throw new kO("decrypt")}async deriveBits(...e){return this.checkDeriveBits.apply(this,e),this.onDeriveBits.apply(this,e)}checkDeriveBits(e,t,r,n={},...i){if(this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"deriveBits":void 0),r%8!=0)throw new xO("length: Is not multiple of 8")}async onDeriveBits(e,t,r,...n){throw new kO("deriveBits")}async exportKey(...e){return this.checkExportKey.apply(this,e),this.onExportKey.apply(this,e)}checkExportKey(e,t,...r){if(this.checkKeyFormat(e),this.checkCryptoKey(t),!t.extractable)throw new EO("key: Is not extractable")}async onExportKey(e,t,...r){throw new kO("exportKey")}async importKey(...e){return this.checkImportKey.apply(this,e),this.onImportKey.apply(this,e)}checkImportKey(e,t,r,n,i,...s){this.checkKeyFormat(e),this.checkKeyData(e,t),this.checkAlgorithmName(r),this.checkImportParams(r),Array.isArray(this.usages)&&this.checkKeyUsages(i,this.usages)}async onImportKey(e,t,r,n,i,...s){throw new kO("importKey")}checkAlgorithmName(e){if(e.name.toLowerCase()!==this.name.toLowerCase())throw new AO("Unrecognized name")}checkAlgorithmParams(e){}checkDerivedKeyParams(e){}checkKeyUsages(e,t){for(const r of e)if(-1===t.indexOf(r))throw new TypeError("Cannot create a key using the specified key usages")}checkCryptoKey(e,t){if(this.checkAlgorithmName(e.algorithm),t&&-1===e.usages.indexOf(t))throw new EO("key does not match that of operation")}checkRequiredProperty(e,t){if(!(t in e))throw new CO(t)}checkHashAlgorithm(e,t){for(const r of t)if(r.toLowerCase()===e.name.toLowerCase())return;throw new xO(`hash: Must be one of ${t.join(", ")}`)}checkImportParams(e){}checkKeyFormat(e){switch(e){case"raw":case"pkcs8":case"spki":case"jwk":break;default:throw new TypeError("format: Is invalid value. Must be 'jwk', 'raw', 'spki', or 'pkcs8'")}}checkKeyData(e,t){if(!t)throw new TypeError("keyData: Cannot be empty on empty on key importing");if("jwk"===e){if("object"!=typeof(r=t)||!("kty"in r))throw new TypeError("keyData: Is not JsonWebToken")}else if(!Xk.isBufferSource(t))throw new TypeError("keyData: Is not ArrayBufferView or ArrayBuffer");var r}prepareData(e){return Xk.toArrayBuffer(e)}}class OO extends RO{checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not of type Number");switch(e.length){case 128:case 192:case 256:break;default:throw new TypeError("length: Must be 128, 192, or 256")}}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}let NO=class extends OO{constructor(){super(...arguments),this.name="AES-CBC",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.iv.byteLength)throw new TypeError("iv: Must have length 16 bytes")}},IO=class extends OO{constructor(){super(...arguments),this.name="AES-CMAC",this.usages=["sign","verify"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new xO("length: Must be more than 0")}},TO=class extends OO{constructor(){super(...arguments),this.name="AES-CTR",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"counter"),!(e.counter instanceof ArrayBuffer||ArrayBuffer.isView(e.counter)))throw new TypeError("counter: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.counter.byteLength)throw new TypeError("iv: Must have length 16 bytes");if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new xO("length: Must be more than 0")}},PO=class extends OO{constructor(){super(...arguments),this.name="AES-ECB",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}},BO=class extends OO{constructor(){super(...arguments),this.name="AES-GCM",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength<1)throw new xO("iv: Must have length more than 0 and less than 2^64 - 1");switch("tagLength"in e||(e.tagLength=128),e.tagLength){case 32:case 64:case 96:case 104:case 112:case 120:case 128:break;default:throw new xO("tagLength: Must be one of 32, 64, 96, 104, 112, 120 or 128")}}},DO=class extends OO{constructor(){super(...arguments),this.name="AES-KW",this.usages=["wrapKey","unwrapKey"]}};class $O extends RO{constructor(){super(...arguments),this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.ivSize){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength!==this.ivSize)throw new TypeError(`iv: Must have length ${this.ivSize} bytes`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not of type Number");if(e.length!==this.keySizeBits)throw new xO(`algorithm.length: Must be ${this.keySizeBits}`)}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}class LO extends RO{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"]}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");const t=Zk.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");if(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength%8||e.modulusLength<256||e.modulusLength>16384)throw new TypeError("The modulus length must be a multiple of 8 bits and >= 256 and <= 16384")}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}let jO=class extends LO{constructor(){super(...arguments),this.name="RSASSA-PKCS1-v1_5",this.usages={privateKey:["sign"],publicKey:["verify"]}}},MO=class extends LO{constructor(){super(...arguments),this.name="RSA-PSS",this.usages={privateKey:["sign"],publicKey:["verify"]}}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"saltLength"),"number"!=typeof e.saltLength)throw new TypeError("saltLength: Is not a Number");if(e.saltLength<0)throw new RangeError("saltLength: Must be positive number")}},UO=class extends LO{constructor(){super(...arguments),this.name="RSA-OAEP",this.usages={privateKey:["decrypt","unwrapKey"],publicKey:["encrypt","wrapKey"]}}checkAlgorithmParams(e){if(e.label&&!(e.label instanceof ArrayBuffer||ArrayBuffer.isView(e.label)))throw new TypeError("label: Is not of type '(ArrayBuffer or ArrayBufferView)'")}};class KO extends RO{checkGenerateKeyParams(e){this.checkRequiredProperty(e,"namedCurve"),this.checkNamedCurve(e.namedCurve)}checkNamedCurve(e){for(const t of this.namedCurves)if(t.toLowerCase()===e.toLowerCase())return;throw new xO(`namedCurve: Must be one of ${this.namedCurves.join(", ")}`)}}let FO=class extends KO{constructor(){super(...arguments),this.name="ECDSA",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}};const HO=["secret","private","public"];let zO=class{static create(e,t,r,n){const i=new this;return i.algorithm=e,i.type=t,i.extractable=r,i.usages=n,i}static isKeyType(e){return-1!==HO.indexOf(e)}get[Symbol.toStringTag](){return"CryptoKey"}},VO=class extends KO{constructor(){super(...arguments),this.name="ECDH",this.usages={privateKey:["deriveBits","deriveKey"],publicKey:[]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"public"),!(e.public instanceof zO))throw new TypeError("public: Is not a CryptoKey");if("public"!==e.public.type)throw new xO("public: Is not a public key");if(e.public.algorithm.name!==this.name)throw new xO(`public: Is not ${this.name} key`)}},qO=class extends VO{constructor(){super(...arguments),this.name="ECDH-ES",this.namedCurves=["X25519","X448"]}},GO=class extends KO{constructor(){super(...arguments),this.name="EdDSA",this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["Ed25519","Ed448"]}},WO=class{constructor(e){e&&(this.value=e)}};rO([YR({type:wR.ObjectIdentifier})],WO.prototype,"value",void 0),WO=rO([JR({type:bR.Choice})],WO);class XO{constructor(e){Object.assign(this,e)}}rO([YR({type:wR.ObjectIdentifier})],XO.prototype,"algorithm",void 0),rO([YR({type:wR.Any,optional:!0})],XO.prototype,"parameters",void 0);class JO{constructor(){this.version=0,this.privateKeyAlgorithm=new XO,this.privateKey=new ArrayBuffer(0)}}rO([YR({type:wR.Integer})],JO.prototype,"version",void 0),rO([YR({type:XO})],JO.prototype,"privateKeyAlgorithm",void 0),rO([YR({type:wR.OctetString})],JO.prototype,"privateKey",void 0),rO([YR({type:wR.Any,optional:!0})],JO.prototype,"attributes",void 0);class YO{constructor(){this.publicKeyAlgorithm=new XO,this.publicKey=new ArrayBuffer(0)}}rO([YR({type:XO})],YO.prototype,"publicKeyAlgorithm",void 0),rO([YR({type:wR.BitString})],YO.prototype,"publicKey",void 0);const ZO={fromJSON:e=>Zk.FromBase64Url(e),toJSON:e=>Zk.ToBase64Url(new Uint8Array(e))},QO={fromASN:e=>{const t=e.valueBlock.valueHex;return new Uint8Array(t)[0]?e.valueBlock.valueHex:e.valueBlock.valueHex.slice(1)},toASN:e=>{const t=new Uint8Array(e)[0]>127?Qk(new Uint8Array([0]).buffer,e):e;return new fC({valueHex:t})}};let eN=class{constructor(){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0)}};rO([YR({type:wR.Integer,converter:ER})],eN.prototype,"version",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"n",converter:ZO})],eN.prototype,"modulus",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"e",converter:ZO})],eN.prototype,"publicExponent",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"d",converter:ZO})],eN.prototype,"privateExponent",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"p",converter:ZO})],eN.prototype,"prime1",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"q",converter:ZO})],eN.prototype,"prime2",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"dp",converter:ZO})],eN.prototype,"exponent1",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"dq",converter:ZO})],eN.prototype,"exponent2",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"qi",converter:ZO})],eN.prototype,"coefficient",void 0),rO([YR({type:wR.Any,optional:!0})],eN.prototype,"otherPrimeInfos",void 0);let tN=class{constructor(){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0)}};rO([YR({type:wR.Integer,converter:QO}),SO({name:"n",converter:ZO})],tN.prototype,"modulus",void 0),rO([YR({type:wR.Integer,converter:QO}),SO({name:"e",converter:ZO})],tN.prototype,"publicExponent",void 0);let rN=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){let e=new Uint8Array(this.value);if(4!==e[0])throw new EO("Wrong ECPoint. Current version supports only Uncompressed (0x04) point");e=new Uint8Array(this.value.slice(1));const t=e.length/2;return{x:Zk.ToBase64Url(e.buffer.slice(0,0+t)),y:Zk.ToBase64Url(e.buffer.slice(0+t,0+t+t))}}fromJSON(e){if(!("x"in e))throw new Error("x: Missing required property");if(!("y"in e))throw new Error("y: Missing required property");const t=Zk.FromBase64Url(e.x),r=Zk.FromBase64Url(e.y),n=Qk(new Uint8Array([4]).buffer,t,r);return this.value=new Uint8Array(n).buffer,this}};rO([YR({type:wR.OctetString})],rN.prototype,"value",void 0),rN=rO([JR({type:bR.Choice})],rN);let nN=class{constructor(){this.version=1,this.privateKey=new ArrayBuffer(0)}fromJSON(e){if(!("d"in e))throw new Error("d: Missing required property");if(this.privateKey=Zk.FromBase64Url(e.d),"x"in e){const t=new rN;t.fromJSON(e);const r=eO.toASN(t);"valueHex"in r.valueBlock&&(this.publicKey=r.valueBlock.valueHex)}return this}toJSON(){const e={};return e.d=Zk.ToBase64Url(this.privateKey),this.publicKey&&Object.assign(e,new rN(this.publicKey).toJSON()),e}};rO([YR({type:wR.Integer,converter:ER})],nN.prototype,"version",void 0),rO([YR({type:wR.OctetString})],nN.prototype,"privateKey",void 0),rO([YR({context:0,type:wR.Any,optional:!0})],nN.prototype,"parameters",void 0),rO([YR({context:1,type:wR.BitString,optional:!0})],nN.prototype,"publicKey",void 0);const iN={fromASN:e=>{const t=new Uint8Array(e.valueBlock.valueHex);return 0===t[0]?t.buffer.slice(1):t.buffer},toASN:e=>{const t=new Uint8Array(e);if(t[0]>127){const e=new Uint8Array(t.length+1);return e.set(t,1),new fC({valueHex:e.buffer})}return new fC({valueHex:e})}};var sN=Object.freeze({__proto__:null,AsnIntegerWithoutPaddingConverter:iN});class oN{static decodePoint(e,t){const r=Xk.toUint8Array(e);if(0===r.length||4!==r[0])throw new Error("Only uncompressed point format supported");const n=(r.length-1)/2;if(n!==Math.ceil(t/8))throw new Error("Point does not match field size");return{x:r.slice(1,n+1),y:r.slice(n+1,n+1+n)}}static encodePoint(e,t){const r=Math.ceil(t/8);if(e.x.byteLength!==r||e.y.byteLength!==r)throw new Error("X,Y coordinates don't match point size criteria");const n=Xk.toUint8Array(e.x),i=Xk.toUint8Array(e.y),s=new Uint8Array(2*r+1);return s[0]=4,s.set(n,1),s.set(i,r+1),s}static getSize(e){return Math.ceil(e/8)}static encodeSignature(e,t){const r=this.getSize(t),n=Xk.toUint8Array(e.r),i=Xk.toUint8Array(e.s),s=new Uint8Array(2*r);return s.set(this.padStart(n,r)),s.set(this.padStart(i,r),r),s}static decodeSignature(e,t){const r=this.getSize(t),n=Xk.toUint8Array(e);if(n.length!==2*r)throw new Error("Incorrect size of the signature");const i=n.slice(0,r),s=n.slice(r);return{r:this.trimStart(i),s:this.trimStart(s)}}static trimStart(e){let t=0;for(;t<e.length-1&&0===e[t];)t++;return 0===t?e:e.slice(t,e.length)}static padStart(e,t){if(t===e.length)return e;const r=new Uint8Array(t);return r.set(e,t-e.length),r}}class aN{constructor(){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0)}static fromWebCryptoSignature(e){const t=e.byteLength/2,r=oN.decodeSignature(e,8*t),n=new aN;return n.r=Xk.toArrayBuffer(r.r),n.s=Xk.toArrayBuffer(r.s),n}toWebCryptoSignature(e){null!=e||(e=8*Math.max(this.r.byteLength,this.s.byteLength));return oN.encodeSignature(this,e).buffer}}rO([YR({type:wR.Integer,converter:iN})],aN.prototype,"r",void 0),rO([YR({type:wR.Integer,converter:iN})],aN.prototype,"s",void 0);class cN extends JO{}rO([YR({context:1,implicit:!0,type:wR.BitString,optional:!0})],cN.prototype,"publicKey",void 0);let lN=class{constructor(){this.value=new ArrayBuffer(0)}fromJSON(e){if(!e.d)throw new Error("d: Missing required property");return this.value=Zk.FromBase64Url(e.d),this}toJSON(){return{d:Zk.ToBase64Url(this.value)}}};rO([YR({type:wR.OctetString})],lN.prototype,"value",void 0),lN=rO([JR({type:bR.Choice})],lN);let uN=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){return{x:Zk.ToBase64Url(this.value)}}fromJSON(e){if(!("x"in e))throw new Error("x: Missing required property");return this.value=Zk.FromBase64Url(e.x),this}};rO([YR({type:wR.BitString})],uN.prototype,"value",void 0),uN=rO([JR({type:bR.Choice})],uN);let hN=class{};rO([YR({type:wR.OctetString}),SO({type:lO.String,converter:ZO})],hN.prototype,"d",void 0),hN=rO([JR({type:bR.Choice})],hN);const fN="1.2.840.10045.3.1.7",pN="1.3.132.0",dN=`${pN}.34`,mN=`${pN}.35`,yN=`${pN}.10`,gN="1.3.36.3.3.2.8.1.1",vN=`${gN}.1`,bN=`${gN}.2`,wN=`${gN}.3`,_N=`${gN}.4`,SN=`${gN}.5`,EN=`${gN}.6`,AN=`${gN}.7`,kN=`${gN}.8`,xN=`${gN}.9`,CN=`${gN}.10`,RN=`${gN}.11`,ON=`${gN}.12`,NN=`${gN}.13`,IN=`${gN}.14`;var TN=Object.freeze({__proto__:null,AlgorithmIdentifier:XO,get CurvePrivateKey(){return hN},EcDsaSignature:aN,EcPrivateKey:nN,get EcPublicKey(){return rN},get EdPrivateKey(){return lN},get EdPublicKey(){return uN},get ObjectIdentifier(){return WO},OneAsymmetricKey:cN,PrivateKeyInfo:JO,PublicKeyInfo:YO,RsaPrivateKey:eN,RsaPublicKey:tN,converters:sN,idBrainpoolP160r1:vN,idBrainpoolP160t1:bN,idBrainpoolP192r1:wN,idBrainpoolP192t1:_N,idBrainpoolP224r1:SN,idBrainpoolP224t1:EN,idBrainpoolP256r1:AN,idBrainpoolP256t1:kN,idBrainpoolP320r1:xN,idBrainpoolP320t1:CN,idBrainpoolP384r1:RN,idBrainpoolP384t1:ON,idBrainpoolP512r1:NN,idBrainpoolP512t1:IN,idEd25519:"1.3.101.112",idEd448:"1.3.101.113",idEllipticCurve:pN,idSecp256k1:yN,idSecp256r1:fN,idSecp384r1:dN,idSecp521r1:mN,idVersionOne:gN,idX25519:"1.3.101.110",idX448:"1.3.101.111"});class PN{constructor(){}static register(e){const t=new WO;t.value=e.id;const r=tO.serialize(t);this.items.push({...e,raw:r}),this.names.push(e.name)}static find(e){e=e.toUpperCase();for(const t of this.items)if(t.name.toUpperCase()===e||t.id.toUpperCase()===e)return t;return null}static get(e){const t=this.find(e);if(!t)throw new Error(`Unsupported EC named curve '${e}'`);return t}}PN.items=[],PN.names=[],PN.register({name:"P-256",id:fN,size:256}),PN.register({name:"P-384",id:dN,size:384}),PN.register({name:"P-521",id:mN,size:521}),PN.register({name:"K-256",id:yN,size:256}),PN.register({name:"brainpoolP160r1",id:vN,size:160}),PN.register({name:"brainpoolP160t1",id:bN,size:160}),PN.register({name:"brainpoolP192r1",id:wN,size:192}),PN.register({name:"brainpoolP192t1",id:_N,size:192}),PN.register({name:"brainpoolP224r1",id:SN,size:224}),PN.register({name:"brainpoolP224t1",id:EN,size:224}),PN.register({name:"brainpoolP256r1",id:AN,size:256}),PN.register({name:"brainpoolP256t1",id:kN,size:256}),PN.register({name:"brainpoolP320r1",id:xN,size:320}),PN.register({name:"brainpoolP320t1",id:CN,size:320}),PN.register({name:"brainpoolP384r1",id:RN,size:384}),PN.register({name:"brainpoolP384t1",id:ON,size:384}),PN.register({name:"brainpoolP512r1",id:NN,size:512}),PN.register({name:"brainpoolP512t1",id:IN,size:512});let BN=class extends RO{constructor(){super(...arguments),this.name="HMAC",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["sign","verify"]}getDefaultLength(e){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":return 512;default:throw new Error(`Unknown algorithm name '${e}'`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),"length"in e){if("number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new RangeError("length: Number is out of range")}}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}},DN=class extends RO{constructor(){super(...arguments),this.name="PBKDF2",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveBits","deriveKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!(e.salt instanceof ArrayBuffer||ArrayBuffer.isView(e.salt)))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"iterations"),"number"!=typeof e.iterations)throw new TypeError("iterations: Is not a Number");if(e.iterations<1)throw new TypeError("iterations: Is less than 1")}checkImportKey(e,t,r,n,i,...s){if(super.checkImportKey(e,t,r,n,i),n)throw new SyntaxError("extractable: Must be 'false'")}},$N=class extends RO{constructor(){super(...arguments),this.name="HKDF",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveKey","deriveBits"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!Xk.isBufferSource(e.salt))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"info"),!Xk.isBufferSource(e.info))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'")}checkImportKey(e,t,r,n,i,...s){if(super.checkImportKey(e,t,r,n,i),n)throw new SyntaxError("extractable: Must be 'false'")}};class LN extends RO{constructor(){super(...arguments),this.usages=[],this.defaultLength=0}digest(...e){return e[0]={length:this.defaultLength,...e[0]},super.digest.apply(this,e)}checkDigest(e,t){super.checkDigest(e,t);const r=e.length||0;if("number"!=typeof r)throw new TypeError("length: Is not a Number");if(r<0)throw new TypeError("length: Is negative")}}let jN=class extends LN{constructor(){super(...arguments),this.name="shake128",this.defaultLength=16}},MN=class extends LN{constructor(){super(...arguments),this.name="shake256",this.defaultLength=32}},UN=class{get[Symbol.toStringTag](){return"Crypto"}randomUUID(){const e=this.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Zk.ToHex(e).toLowerCase();return`${t.substring(0,8)}-${t.substring(8,12)}-${t.substring(12,16)}-${t.substring(16,20)}-${t.substring(20)}`}};class KN{constructor(){this.items={}}get(e){return this.items[e.toLowerCase()]||null}set(e){this.items[e.name.toLowerCase()]=e}removeAt(e){const t=this.get(e.toLowerCase());return t&&delete this.items[e],t}has(e){return!!this.get(e)}get length(){return Object.keys(this.items).length}get algorithms(){const e=[];for(const t in this.items){const r=this.items[t];e.push(r.name)}return e.sort()}}let FN=class e{constructor(){this.providers=new KN}static isHashedAlgorithm(e){return!!(e&&"object"==typeof e&&"name"in e&&"hash"in e)}get[Symbol.toStringTag](){return"SubtleCrypto"}async digest(...e){this.checkRequiredArguments(e,2,"digest");const[t,r,...n]=e,i=this.prepareAlgorithm(t),s=Xk.toArrayBuffer(r),o=this.getProvider(i.name);return await o.digest(i,s,...n)}async generateKey(...e){this.checkRequiredArguments(e,3,"generateKey");const[t,r,n,...i]=e,s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.generateKey({...s,name:o.name},r,n,...i)}async sign(...e){this.checkRequiredArguments(e,3,"sign");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=Xk.toArrayBuffer(n),a=this.getProvider(s.name);return await a.sign({...s,name:a.name},r,o,...i)}async verify(...e){this.checkRequiredArguments(e,4,"verify");const[t,r,n,i,...s]=e;this.checkCryptoKey(r);const o=this.prepareAlgorithm(t),a=Xk.toArrayBuffer(i),c=Xk.toArrayBuffer(n),l=this.getProvider(o.name);return await l.verify({...o,name:l.name},r,c,a,...s)}async encrypt(...e){this.checkRequiredArguments(e,3,"encrypt");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=Xk.toArrayBuffer(n),a=this.getProvider(s.name);return await a.encrypt({...s,name:a.name},r,o,{keyUsage:!0},...i)}async decrypt(...e){this.checkRequiredArguments(e,3,"decrypt");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=Xk.toArrayBuffer(n),a=this.getProvider(s.name);return await a.decrypt({...s,name:a.name},r,o,{keyUsage:!0},...i)}async deriveBits(...e){this.checkRequiredArguments(e,3,"deriveBits");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.deriveBits({...s,name:o.name},r,n,{keyUsage:!0},...i)}async deriveKey(...e){this.checkRequiredArguments(e,5,"deriveKey");const[t,r,n,i,s,...o]=e,a=this.prepareAlgorithm(n);this.getProvider(a.name).checkDerivedKeyParams(a);const c=this.prepareAlgorithm(t),l=this.getProvider(c.name);l.checkCryptoKey(r,"deriveKey");const u=await l.deriveBits({...c,name:l.name},r,n.length||512,{keyUsage:!1},...o);return this.importKey("raw",u,n,i,s,...o)}async exportKey(...e){this.checkRequiredArguments(e,2,"exportKey");const[t,r,...n]=e;this.checkCryptoKey(r);const i=this.getProvider(r.algorithm.name);return await i.exportKey(t,r,...n)}async importKey(...e){this.checkRequiredArguments(e,5,"importKey");const[t,r,n,i,s,...o]=e,a=this.prepareAlgorithm(n),c=this.getProvider(a.name);if(-1!==["pkcs8","spki","raw"].indexOf(t)){const e=Xk.toArrayBuffer(r);return c.importKey(t,e,{...a,name:c.name},i,s,...o)}if(!r.kty)throw new TypeError("keyData: Is not JSON");return c.importKey(t,r,{...a,name:c.name},i,s,...o)}async wrapKey(e,t,r,n,...i){let s=await this.exportKey(e,t,...i);if("jwk"===e){const e=JSON.stringify(s);s=Zk.FromUtf8String(e)}const o=this.prepareAlgorithm(n),a=Xk.toArrayBuffer(s),c=this.getProvider(o.name);return c.encrypt({...o,name:c.name},r,a,{keyUsage:!1},...i)}async unwrapKey(e,t,r,n,i,s,o,...a){const c=this.prepareAlgorithm(n),l=Xk.toArrayBuffer(t),u=this.getProvider(c.name);let h=await u.decrypt({...c,name:u.name},r,l,{keyUsage:!1},...a);if("jwk"===e)try{h=JSON.parse(Zk.ToUtf8String(h))}catch(e){const t=new TypeError("wrappedKey: Is not a JSON");throw t.internal=e,t}return this.importKey(e,h,i,s,o,...a)}checkRequiredArguments(e,t,r){if(e.length<t)throw new TypeError(`Failed to execute '${r}' on 'SubtleCrypto': ${t} arguments required, but only ${e.length} present`)}prepareAlgorithm(t){if("string"==typeof t)return{name:t};if(e.isHashedAlgorithm(t)){const e={...t};return e.hash=this.prepareAlgorithm(t.hash),e}return{...t}}getProvider(e){const t=this.providers.get(e);if(!t)throw new AO("Unrecognized name");return t}checkCryptoKey(e){if(!(e instanceof zO))throw new TypeError("Key is not of type 'CryptoKey'")}};
/*!
 Copyright (c) Peculiar Ventures, LLC
*/const HN={fromJSON:e=>Buffer.from(Zk.FromBase64Url(e)),toJSON:e=>Zk.ToBase64Url(e)};class zN extends zO{constructor(){super(...arguments),this.data=Buffer.alloc(0),this.algorithm={name:""},this.extractable=!1,this.type="secret",this.usages=[],this.kty="oct",this.alg=""}}rO([SO({name:"ext",type:lO.Boolean,optional:!0})],zN.prototype,"extractable",void 0),rO([SO({name:"key_ops",type:lO.String,repeated:!0,optional:!0})],zN.prototype,"usages",void 0),rO([SO({type:lO.String})],zN.prototype,"kty",void 0),rO([SO({type:lO.String,optional:!0})],zN.prototype,"alg",void 0);class VN extends zN{constructor(){super(...arguments),this.kty="oct",this.type="secret"}}class qN extends zN{}class GN extends VN{get alg(){switch(this.algorithm.name.toUpperCase()){case"AES-CBC":return`A${this.algorithm.length}CBC`;case"AES-CTR":return`A${this.algorithm.length}CTR`;case"AES-GCM":return`A${this.algorithm.length}GCM`;case"AES-KW":return`A${this.algorithm.length}KW`;case"AES-CMAC":return`A${this.algorithm.length}CMAC`;case"AES-ECB":return`A${this.algorithm.length}ECB`;default:throw new AO("Unsupported algorithm name")}}set alg(e){}}rO([SO({name:"k",converter:HN})],GN.prototype,"data",void 0);class WN{static async generateKey(e,t,r){const n=new GN;return n.algorithm=e,n.extractable=t,n.usages=r,n.data=O.randomBytes(e.length>>3),n}static async exportKey(e,t){if(!(t instanceof GN))throw new Error("key: Is not AesCryptoKey");switch(e.toLowerCase()){case"jwk":return wO.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new xO("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=_O.fromJSON(t,{targetSchema:GN});break;case"raw":s=new GN,s.data=Buffer.from(t);break;default:throw new xO("format: Must be 'jwk' or 'raw'")}switch(s.algorithm=r,s.algorithm.length=s.data.length<<3,s.extractable=n,s.usages=i,s.algorithm.length){case 128:case 192:case 256:break;default:throw new xO("keyData: Is wrong key length")}return s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"AES-CBC":return this.encryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.encryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.encryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.encryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.encryptAesECB(e,t,Buffer.from(r));default:throw new xO("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof GN))throw new Error("key: Is not AesCryptoKey");switch(e.name.toUpperCase()){case"AES-CBC":return this.decryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.decryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.decryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.decryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.decryptAesECB(e,t,Buffer.from(r));default:throw new xO("algorithm: Is not recognized")}}static async encryptAesCBC(e,t,r){const n=O.createCipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesCBC(e,t,r){const n=O.createDecipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesCTR(e,t,r){const n=O.createCipheriv(`aes-${t.algorithm.length}-ctr`,t.data,Buffer.from(e.counter));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesCTR(e,t,r){const n=O.createDecipheriv(`aes-${t.algorithm.length}-ctr`,t.data,new Uint8Array(e.counter));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesGCM(e,t,r){const n=O.createCipheriv(`aes-${t.algorithm.length}-gcm`,t.data,Buffer.from(e.iv),{authTagLength:(e.tagLength||128)>>3});e.additionalData&&n.setAAD(Buffer.from(e.additionalData));let i=n.update(r);i=Buffer.concat([i,n.final(),n.getAuthTag()]);return new Uint8Array(i).buffer}static async decryptAesGCM(e,t,r){const n=O.createDecipheriv(`aes-${t.algorithm.length}-gcm`,t.data,new Uint8Array(e.iv)),i=(e.tagLength||128)>>3,s=r.slice(0,r.length-i),o=r.slice(r.length-i);e.additionalData&&n.setAAD(Buffer.from(e.additionalData)),n.setAuthTag(o);let a=n.update(s);return a=Buffer.concat([a,n.final()]),new Uint8Array(a).buffer}static async encryptAesKW(e,t,r){const n=O.createCipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV);let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async decryptAesKW(e,t,r){const n=O.createDecipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV);let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesECB(e,t,r){const n=O.createCipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesECB(e,t,r){const n=O.createDecipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}}WN.AES_KW_IV=Buffer.from("A6A6A6A6A6A6A6A6","hex");const XN=new WeakMap;function JN(e){const t=XN.get(e);if(!t)throw new xO("Cannot get CryptoKey from secure storage");return t}function YN(e){const t=zO.create(e.algorithm,e.type,e.extractable,e.usages);return Object.freeze(t),XN.set(t,e),t}class ZN extends NO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return WN.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return WN.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}const QN=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),eI=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,135]),tI=16;function rI(e){const t=Buffer.alloc(e.length),r=e.length-1;for(let n=0;n<r;n++)t[n]=e[n]<<1,128&e[n+1]&&(t[n]+=1);return t[r]=e[r]<<1,t}function nI(e,t){const r=Math.min(e.length,t.length),n=Buffer.alloc(r);for(let i=0;i<r;i++)n[i]=e[i]^t[i];return n}function iI(e,t){const r=R.createCipheriv("aes"+(e.length<<3),e,QN),n=r.update(t);return r.final(),n}function sI(e,t){const r=Buffer.alloc(tI),n=t*tI,i=n+tI;return e.copy(r,0,n,i),r}function oI(e,t){const r=function(e){const t=iI(e,QN);let r=rI(t);128&t[0]&&(r=nI(r,eI));let n=rI(r);return 128&r[0]&&(n=nI(n,eI)),{subkey1:r,subkey2:n}}(e);let n,i,s=Math.ceil(t.length/tI);0===s?(s=1,n=!1):n=t.length%tI==0;const o=s-1;i=n?nI(sI(t,o),r.subkey1):nI(function(e,t){const r=Buffer.alloc(tI),n=t*tI,i=e.length;return r.fill(0),e.copy(r,0,n,i),r[i-n]=128,r}(t,o),r.subkey2);let a,c=QN;for(let r=0;r<o;r++)a=nI(c,sI(t,r)),c=iI(e,a);return a=nI(i,c),iI(e,a)}class aI extends IO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onSign(e,t,r){const n=oI(JN(t).data,Buffer.from(r));return new Uint8Array(n).buffer}async onVerify(e,t,r,n){const i=await this.sign(e,t,n);return 0===Buffer.from(r).compare(Buffer.from(i))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}class cI extends TO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return WN.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return WN.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}class lI extends BO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return WN.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return WN.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}class uI extends DO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}async onEncrypt(e,t,r){return WN.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return WN.decrypt(e,JN(t),new Uint8Array(r))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}class hI extends PO{async onGenerateKey(e,t,r){return YN(await WN.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return WN.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return WN.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return WN.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await WN.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof GN))throw new TypeError("key: Is not a AesCryptoKey")}}class fI extends VN{get alg(){switch(this.algorithm.name.toUpperCase()){case"DES-CBC":return"DES-CBC";case"DES-EDE3-CBC":return"3DES-CBC";default:throw new AO("Unsupported algorithm name")}}set alg(e){}}rO([SO({name:"k",converter:HN})],fI.prototype,"data",void 0);class pI{static async generateKey(e,t,r){const n=new fI;return n.algorithm=e,n.extractable=t,n.usages=r,n.data=O.randomBytes(e.length>>3),n}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return wO.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new xO("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=_O.fromJSON(t,{targetSchema:fI});break;case"raw":s=new fI,s.data=Buffer.from(t);break;default:throw new xO("format: Must be 'jwk' or 'raw'")}return s.algorithm=r,s.extractable=n,s.usages=i,s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"DES-CBC":return this.encryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.encryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new xO("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof fI))throw new Error("key: Is not DesCryptoKey");switch(e.name.toUpperCase()){case"DES-CBC":return this.decryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.decryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new xO("algorithm: Is not recognized")}}static async encryptDesCBC(e,t,r){const n=O.createCipheriv("des-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptDesCBC(e,t,r){const n=O.createDecipheriv("des-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptDesEDE3CBC(e,t,r){const n=O.createCipheriv("des-ede3-cbc",t.data,Buffer.from(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptDesEDE3CBC(e,t,r){const n=O.createDecipheriv("des-ede3-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}}class dI extends $O{constructor(){super(...arguments),this.keySizeBits=64,this.ivSize=8,this.name="DES-CBC"}async onGenerateKey(e,t,r){return YN(await pI.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return pI.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return pI.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return pI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){const s=await pI.importKey(e,t,{name:this.name,length:this.keySizeBits},n,i);if(s.data.length!==this.keySizeBits>>3)throw new xO("keyData: Wrong key size");return YN(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof fI))throw new TypeError("key: Is not a DesCryptoKey")}}class mI extends $O{constructor(){super(...arguments),this.keySizeBits=192,this.ivSize=8,this.name="DES-EDE3-CBC"}async onGenerateKey(e,t,r){return YN(await pI.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return pI.encrypt(e,JN(t),new Uint8Array(r))}async onDecrypt(e,t,r){return pI.decrypt(e,JN(t),new Uint8Array(r))}async onExportKey(e,t){return pI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){const s=await pI.importKey(e,t,{name:this.name,length:this.keySizeBits},n,i);if(s.data.length!==this.keySizeBits>>3)throw new xO("keyData: Wrong key size");return YN(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof fI))throw new TypeError("key: Is not a DesCryptoKey")}}function yI(e){switch(e.name.toUpperCase()){case"RSA-OAEP":{const t=/(\d+)$/.exec(e.hash.name)[1];return"RSA-OAEP"+("1"!==t?`-${t}`:"")}case"RSASSA-PKCS1-V1_5":return`RS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PSS":return`PS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PKCS1":return"RS1";default:throw new xO("algorithm: Is not recognized")}}class gI extends qN{constructor(){super(...arguments),this.type="private"}getKey(){const e=QR.parse(this.data,TN.PrivateKeyInfo);return QR.parse(e.privateKey,TN.RsaPrivateKey)}toJSON(){const e=this.getKey(),t={kty:"RSA",alg:yI(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(t,wO.toJSON(e))}fromJSON(e){const t=_O.fromJSON(e,{targetSchema:TN.RsaPrivateKey}),r=new TN.PrivateKeyInfo;r.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.privateKeyAlgorithm.parameters=null,r.privateKey=eO.serialize(t),this.data=Buffer.from(eO.serialize(r))}}class vI extends qN{constructor(){super(...arguments),this.type="public"}getKey(){const e=QR.parse(this.data,TN.PublicKeyInfo);return QR.parse(e.publicKey,TN.RsaPublicKey)}toJSON(){const e=this.getKey(),t={kty:"RSA",alg:yI(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(t,wO.toJSON(e))}fromJSON(e){const t=_O.fromJSON(e,{targetSchema:TN.RsaPublicKey}),r=new TN.PublicKeyInfo;r.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.publicKeyAlgorithm.parameters=null,r.publicKey=eO.serialize(t),this.data=Buffer.from(eO.serialize(r))}}class bI{static async generateKey(e,t,r){const n=new gI;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new vI;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=Buffer.concat([Buffer.alloc(4-e.publicExponent.byteLength,0),Buffer.from(e.publicExponent)]).readInt32BE(0),o=O.generateKeyPairSync("rsa",{modulusLength:e.modulusLength,publicExponent:s,publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=o.privateKey,i.data=o.publicKey;return{privateKey:n,publicKey:i}}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return wO.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;default:throw new xO("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":if(t.d){const e=_O.fromJSON(t,{targetSchema:TN.RsaPrivateKey});return this.importPrivateKey(e,r,n,i)}{const e=_O.fromJSON(t,{targetSchema:TN.RsaPublicKey});return this.importPublicKey(e,r,n,i)}case"spki":{const e=QR.parse(new Uint8Array(t),TN.PublicKeyInfo),s=QR.parse(e.publicKey,TN.RsaPublicKey);return this.importPublicKey(s,r,n,i)}case"pkcs8":{const e=QR.parse(new Uint8Array(t),TN.PrivateKeyInfo),s=QR.parse(e.privateKey,TN.RsaPrivateKey);return this.importPrivateKey(s,r,n,i)}default:throw new xO("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async sign(e,t,r){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.signRsa(e,t,r);default:throw new xO("algorithm: Is not recognized")}}static async verify(e,t,r,n){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.verifySSA(e,t,n,r);default:throw new xO("algorithm: Is not recognized")}}static async encrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.encryptOAEP(e,t,r);throw new xO("algorithm: Is not recognized")}static async decrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.decryptOAEP(e,t,r);throw new xO("algorithm: Is not recognized")}static importPrivateKey(e,t,r,n){const i=new TN.PrivateKeyInfo;i.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",i.privateKeyAlgorithm.parameters=null,i.privateKey=eO.serialize(e);const s=new gI;return s.data=Buffer.from(eO.serialize(i)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=n,s}static importPublicKey(e,t,r,n){const i=new TN.PublicKeyInfo;i.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",i.publicKeyAlgorithm.parameters=null,i.publicKey=eO.serialize(e);const s=new vI;return s.data=Buffer.from(eO.serialize(i)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=n,s}static getCryptoAlgorithm(e){switch(e.hash.name.toUpperCase()){case"SHA-1":return"RSA-SHA1";case"SHA-256":return"RSA-SHA256";case"SHA-384":return"RSA-SHA384";case"SHA-512":return"RSA-SHA512";case"SHA3-256":return"RSA-SHA3-256";case"SHA3-384":return"RSA-SHA3-384";case"SHA3-512":return"RSA-SHA3-512";default:throw new xO("algorithm.hash: Is not recognized")}}static signRsa(e,t,r){const n=this.getCryptoAlgorithm(t.algorithm),i=O.createSign(n);i.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const s={key:t.pem};"RSA-PSS"===e.name.toUpperCase()&&(s.padding=O.constants.RSA_PKCS1_PSS_PADDING,s.saltLength=e.saltLength);const o=i.sign(s);return new Uint8Array(o).buffer}static verifySSA(e,t,r,n){const i=this.getCryptoAlgorithm(t.algorithm),s=O.createVerify(i);s.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const o={key:t.pem};"RSA-PSS"===e.name.toUpperCase()&&(o.padding=O.constants.RSA_PKCS1_PSS_PADDING,o.saltLength=e.saltLength);return s.verify(o,n)}static encryptOAEP(e,t,r){const n={key:`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`,padding:O.constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(O.publicEncrypt(n,r)).buffer}static decryptOAEP(e,t,r){const n={key:`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`,padding:O.constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(O.privateDecrypt(n,r)).buffer}}bI.publicKeyUsages=["verify","encrypt","wrapKey"],bI.privateKeyUsages=["sign","decrypt","unwrapKey"];class wI extends jO{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await bI.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onSign(e,t,r){return bI.sign(e,JN(t),new Uint8Array(r))}async onVerify(e,t,r,n){return bI.verify(e,JN(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return bI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await bI.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof gI||r instanceof vI))throw new TypeError("key: Is not RSA CryptoKey")}}class _I extends MO{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await bI.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onSign(e,t,r){return bI.sign(e,JN(t),new Uint8Array(r))}async onVerify(e,t,r,n){return bI.verify(e,JN(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return bI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await bI.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof gI||r instanceof vI))throw new TypeError("key: Is not RSA CryptoKey")}}class SI{static size(e){switch(e.name.toUpperCase()){case"SHA-1":return 160;case"SHA-256":case"SHA3-256":return 256;case"SHA-384":case"SHA3-384":return 384;case"SHA-512":case"SHA3-512":return 512;default:throw new Error("Unrecognized name")}}static getAlgorithmName(e){switch(e.name.toUpperCase()){case"SHA-1":return"sha1";case"SHA-256":return"sha256";case"SHA-384":return"sha384";case"SHA-512":return"sha512";case"SHA3-256":return"sha3-256";case"SHA3-384":return"sha3-384";case"SHA3-512":return"sha3-512";default:throw new Error("Unrecognized name")}}static digest(e,t){const r=this.getAlgorithmName(e),n=O.createHash(r).update(Buffer.from(t)).digest();return new Uint8Array(n).buffer}}class EI extends UO{async onGenerateKey(e,t,r){const n=await bI.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onEncrypt(e,t,r){const n=JN(t),i=new Uint8Array(r),s=Math.ceil(n.algorithm.modulusLength>>3),o=SI.size(n.algorithm.hash)>>3,a=i.byteLength,c=s-a-2*o-2;if(a>s-2*o-2)throw new Error("Data too large");const l=new Uint8Array(s),u=l.subarray(1,o+1),h=l.subarray(o+1);h.set(i,o+c+1);const f=O.createHash(n.algorithm.hash.name.replace("-","")).update(Xk.toUint8Array(e.label||new Uint8Array(0))).digest();h.set(f,0),h[o+c]=1,O.randomFillSync(u);const p=this.mgf1(n.algorithm.hash,u,h.length);for(let e=0;e<h.length;e++)h[e]^=p[e];const d=this.mgf1(n.algorithm.hash,h,u.length);for(let e=0;e<u.length;e++)u[e]^=d[e];n.pem||(n.pem=`-----BEGIN PUBLIC KEY-----\n${n.data.toString("base64")}\n-----END PUBLIC KEY-----`);const m=O.publicEncrypt({key:n.pem,padding:O.constants.RSA_NO_PADDING},Buffer.from(l));return new Uint8Array(m).buffer}async onDecrypt(e,t,r){const n=JN(t),i=Math.ceil(n.algorithm.modulusLength>>3),s=SI.size(n.algorithm.hash)>>3;if(r.byteLength!==i)throw new Error("Bad data");n.pem||(n.pem=`-----BEGIN PRIVATE KEY-----\n${n.data.toString("base64")}\n-----END PRIVATE KEY-----`);let o=O.privateDecrypt({key:n.pem,padding:O.constants.RSA_NO_PADDING},Buffer.from(r));const a=o[0],c=o.subarray(1,s+1),l=o.subarray(s+1);if(0!==a)throw new Error("Decryption failed");const u=this.mgf1(n.algorithm.hash,l,c.length);for(let e=0;e<c.length;e++)c[e]^=u[e];const h=this.mgf1(n.algorithm.hash,c,l.length);for(let e=0;e<l.length;e++)l[e]^=h[e];const f=O.createHash(n.algorithm.hash.name.replace("-","")).update(Xk.toUint8Array(e.label||new Uint8Array(0))).digest();for(let e=0;e<s;e++)if(f[e]!==l[e])throw new Error("Decryption failed");let p=s;for(;p<l.length;p++){const e=l[p];if(1===e)break;if(0!==e)throw new Error("Decryption failed")}if(p===l.length)throw new Error("Decryption failed");return o=l.subarray(p+1),new Uint8Array(o).buffer}async onExportKey(e,t){return bI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await bI.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof gI||r instanceof vI))throw new TypeError("key: Is not RSA CryptoKey")}mgf1(e,t,r=0){const n=SI.size(e)>>3,i=new Uint8Array(r),s=new Uint8Array(4),o=Math.ceil(r/n);for(let r=0;r<o;r++){s[0]=r>>>24,s[1]=r>>>16&255,s[2]=r>>>8&255,s[3]=255&r;const o=i.subarray(r*n);let a=O.createHash(e.name.replace("-","")).update(t).update(s).digest();a.length>o.length&&(a=a.subarray(0,o.length)),o.set(a)}return i}}class AI extends RO{constructor(){super(...arguments),this.name="RSAES-PKCS1-v1_5",this.usages={publicKey:["encrypt","wrapKey"],privateKey:["decrypt","unwrapKey"]}}async onGenerateKey(e,t,r){const n=await bI.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");const t=Zk.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new TypeError("modulusLength: Must be 1024, 2048, or 4096")}}async onEncrypt(e,t,r){const n=this.toCryptoOptions(t),i=R.publicEncrypt(n,new Uint8Array(r));return new Uint8Array(i).buffer}async onDecrypt(e,t,r){const n=this.toCryptoOptions(t),i=R.privateDecrypt(n,new Uint8Array(r));return new Uint8Array(i).buffer}async onExportKey(e,t){return bI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await bI.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof gI||r instanceof vI))throw new TypeError("key: Is not RSA CryptoKey")}toCryptoOptions(e){const t=e.type.toUpperCase();return{key:`-----BEGIN ${t} KEY-----\n${JN(e).data.toString("base64")}\n-----END ${t} KEY-----`,padding:R.constants.RSA_PKCS1_PADDING}}}const kI={"1.2.840.10045.3.1.7":"P-256","P-256":"1.2.840.10045.3.1.7","1.3.132.0.34":"P-384","P-384":"1.3.132.0.34","1.3.132.0.35":"P-521","P-521":"1.3.132.0.35","1.3.132.0.10":"K-256","K-256":"1.3.132.0.10",brainpoolP160r1:"1.3.36.3.3.2.8.1.1.1","1.3.36.3.3.2.8.1.1.1":"brainpoolP160r1",brainpoolP160t1:"1.3.36.3.3.2.8.1.1.2","1.3.36.3.3.2.8.1.1.2":"brainpoolP160t1",brainpoolP192r1:"1.3.36.3.3.2.8.1.1.3","1.3.36.3.3.2.8.1.1.3":"brainpoolP192r1",brainpoolP192t1:"1.3.36.3.3.2.8.1.1.4","1.3.36.3.3.2.8.1.1.4":"brainpoolP192t1",brainpoolP224r1:"1.3.36.3.3.2.8.1.1.5","1.3.36.3.3.2.8.1.1.5":"brainpoolP224r1",brainpoolP224t1:"1.3.36.3.3.2.8.1.1.6","1.3.36.3.3.2.8.1.1.6":"brainpoolP224t1",brainpoolP256r1:"1.3.36.3.3.2.8.1.1.7","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1",brainpoolP256t1:"1.3.36.3.3.2.8.1.1.8","1.3.36.3.3.2.8.1.1.8":"brainpoolP256t1",brainpoolP320r1:"1.3.36.3.3.2.8.1.1.9","1.3.36.3.3.2.8.1.1.9":"brainpoolP320r1",brainpoolP320t1:"1.3.36.3.3.2.8.1.1.10","1.3.36.3.3.2.8.1.1.10":"brainpoolP320t1",brainpoolP384r1:"1.3.36.3.3.2.8.1.1.11","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1",brainpoolP384t1:"1.3.36.3.3.2.8.1.1.12","1.3.36.3.3.2.8.1.1.12":"brainpoolP384t1",brainpoolP512r1:"1.3.36.3.3.2.8.1.1.13","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1",brainpoolP512t1:"1.3.36.3.3.2.8.1.1.14","1.3.36.3.3.2.8.1.1.14":"brainpoolP512t1"};function xI(e){const t=kI[e];if(!t)throw new xO(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class CI extends qN{constructor(){super(...arguments),this.type="private"}getKey(){const e=QR.parse(this.data,TN.PrivateKeyInfo);return QR.parse(e.privateKey,TN.EcPrivateKey)}toJSON(){const e=this.getKey(),t={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,wO.toJSON(e))}fromJSON(e){if(!e.crv)throw new xO("Cannot get named curve from JWK. Property 'crv' is required");const t=new TN.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",t.privateKeyAlgorithm.parameters=eO.serialize(new TN.ObjectIdentifier(xI(e.crv)));const r=_O.fromJSON(e,{targetSchema:TN.EcPrivateKey});return t.privateKey=eO.serialize(r),this.data=Buffer.from(eO.serialize(t)),this}}class RI extends qN{constructor(){super(...arguments),this.type="public"}getKey(){const e=QR.parse(this.data,TN.PublicKeyInfo);return new TN.EcPublicKey(e.publicKey)}toJSON(){const e=this.getKey(),t={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,wO.toJSON(e))}fromJSON(e){if(!e.crv)throw new xO("Cannot get named curve from JWK. Property 'crv' is required");const t=_O.fromJSON(e,{targetSchema:TN.EcPublicKey}),r=new TN.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1",r.publicKeyAlgorithm.parameters=eO.serialize(new TN.ObjectIdentifier(xI(e.crv))),r.publicKey=eO.toASN(t).valueHex,this.data=Buffer.from(eO.serialize(r)),this}}class OI extends RO{constructor(){super(...arguments),this.name="SHA-1",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class NI extends RO{constructor(){super(...arguments),this.name="SHA-256",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class II extends RO{constructor(){super(...arguments),this.name="SHA-384",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class TI extends RO{constructor(){super(...arguments),this.name="SHA-512",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class PI extends RO{constructor(){super(...arguments),this.name="SHA3-256",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class BI extends RO{constructor(){super(...arguments),this.name="SHA3-384",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class DI extends RO{constructor(){super(...arguments),this.name="SHA3-512",this.usages=[]}async onDigest(e,t){return SI.digest(e,t)}}class $I{static async generateKey(e,t,r){const n=new CI;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new RI;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=O.generateKeyPairSync("ec",{namedCurve:this.getOpenSSLNamedCurve(e.namedCurve),publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=s.privateKey,i.data=s.publicKey;return{privateKey:n,publicKey:i}}static async sign(e,t,r){const n=SI.getAlgorithmName(e.hash),i=O.createSign(n);i.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const s={key:t.pem},o=i.sign(s),a=QR.parse(o,TN.EcDsaSignature);return oN.encodeSignature(a,PN.get(t.algorithm.namedCurve).size).buffer}static async verify(e,t,r,n){const i=SI.getAlgorithmName(e.hash),s=O.createVerify(i);s.update(Buffer.from(n)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const o={key:t.pem},a=new TN.EcDsaSignature,c=PN.get(t.algorithm.namedCurve),l=oN.decodeSignature(r,c.size);a.r=Xk.toArrayBuffer(l.r),a.s=Xk.toArrayBuffer(l.s);const u=Buffer.from(eO.serialize(a));return s.verify(o,u)}static async deriveBits(e,t,r){const n=this.getOpenSSLNamedCurve(t.algorithm.namedCurve),i=O.createECDH(n),s=QR.parse(t.data,TN.PrivateKeyInfo),o=QR.parse(s.privateKey,TN.EcPrivateKey);i.setPrivateKey(Buffer.from(o.privateKey));const a=QR.parse(e.public.data,TN.PublicKeyInfo),c=i.computeSecret(Buffer.from(a.publicKey));return null===r?c:new Uint8Array(c).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return wO.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return QR.parse(t.data,TN.PublicKeyInfo).publicKey;default:throw new xO("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":if(t.d){const e=_O.fromJSON(t,{targetSchema:TN.EcPrivateKey});return this.importPrivateKey(e,r,n,i)}{const e=_O.fromJSON(t,{targetSchema:TN.EcPublicKey});return this.importPublicKey(e,r,n,i)}case"raw":{const e=new TN.EcPublicKey(t);return this.importPublicKey(e,r,n,i)}case"spki":{const e=QR.parse(new Uint8Array(t),TN.PublicKeyInfo),s=new TN.EcPublicKey(e.publicKey);return this.assertKeyParameters(e.publicKeyAlgorithm.parameters,r.namedCurve),this.importPublicKey(s,r,n,i)}case"pkcs8":{const e=QR.parse(new Uint8Array(t),TN.PrivateKeyInfo),s=QR.parse(e.privateKey,TN.EcPrivateKey);return this.assertKeyParameters(e.privateKeyAlgorithm.parameters,r.namedCurve),this.importPrivateKey(s,r,n,i)}default:throw new xO("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static assertKeyParameters(e,t){if(!e)throw new EO("Key info doesn't have required parameters");let r="";try{r=QR.parse(e,TN.ObjectIdentifier).value}catch(e){throw new EO("Cannot read key info parameters")}if(xI(t)!==r)throw new EO("Key info parameter doesn't match to named curve")}static async importPrivateKey(e,t,r,n){const i=new TN.PrivateKeyInfo;i.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",i.privateKeyAlgorithm.parameters=eO.serialize(new TN.ObjectIdentifier(xI(t.namedCurve))),i.privateKey=eO.serialize(e);const s=new CI;return s.data=Buffer.from(eO.serialize(i)),s.algorithm=Object.assign({},t),s.extractable=r,s.usages=n,s}static async importPublicKey(e,t,r,n){const i=new TN.PublicKeyInfo;i.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1";const s=xI(t.namedCurve);i.publicKeyAlgorithm.parameters=eO.serialize(new TN.ObjectIdentifier(s)),i.publicKey=e.value;const o=new RI;return o.data=Buffer.from(eO.serialize(i)),o.algorithm=Object.assign({},t),o.extractable=r,o.usages=n,o}static getOpenSSLNamedCurve(e){switch(e.toUpperCase()){case"P-256":return"prime256v1";case"K-256":return"secp256k1";case"P-384":return"secp384r1";case"P-521":return"secp521r1";default:return e}}}$I.publicKeyUsages=["verify"],$I.privateKeyUsages=["sign","deriveKey","deriveBits"];class LI extends FO{constructor(){super(...arguments),this.namedCurves=PN.names,this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await $I.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onSign(e,t,r){return $I.sign(e,JN(t),new Uint8Array(r))}async onVerify(e,t,r,n){return $I.verify(e,JN(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return $I.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await $I.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof CI||r instanceof RI))throw new TypeError("key: Is not EC CryptoKey")}}class jI extends VO{constructor(){super(...arguments),this.namedCurves=PN.names}async onGenerateKey(e,t,r){const n=await $I.generateKey({...e,name:this.name},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onExportKey(e,t){return $I.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await $I.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=JN(e);if(!(r instanceof CI||r instanceof RI))throw new TypeError("key: Is not EC CryptoKey")}async onDeriveBits(e,t,r){return await $I.deriveBits({...e,public:JN(e.public)},JN(t),r)}}const MI={[TN.idEd448]:"Ed448",ed448:TN.idEd448,[TN.idX448]:"X448",x448:TN.idX448,[TN.idEd25519]:"Ed25519",ed25519:TN.idEd25519,[TN.idX25519]:"X25519",x25519:TN.idX25519};function UI(e){const t=MI[e.toLowerCase()];if(!t)throw new xO(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class KI extends qN{constructor(){super(...arguments),this.type="private"}getKey(){const e=QR.parse(this.data,TN.PrivateKeyInfo);return QR.parse(e.privateKey,TN.CurvePrivateKey)}toJSON(){const e=this.getKey(),t={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,wO.toJSON(e))}fromJSON(e){if(!e.crv)throw new xO("Cannot get named curve from JWK. Property 'crv' is required");const t=new TN.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm=UI(e.crv);const r=_O.fromJSON(e,{targetSchema:TN.CurvePrivateKey});return t.privateKey=eO.serialize(r),this.data=Buffer.from(eO.serialize(t)),this}}class FI extends qN{constructor(){super(...arguments),this.type="public"}getKey(){return QR.parse(this.data,TN.PublicKeyInfo).publicKey}toJSON(){const e=this.getKey(),t={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,{x:Zk.ToBase64Url(e)})}fromJSON(e){if(!e.crv)throw new xO("Cannot get named curve from JWK. Property 'crv' is required");if(!e.x)throw new xO("Cannot get property from JWK. Property 'x' is required");const t=new TN.PublicKeyInfo;return t.publicKeyAlgorithm.algorithm=UI(e.crv),t.publicKey=Zk.FromBase64Url(e.x),this.data=Buffer.from(eO.serialize(t)),this}}class HI{static async generateKey(e,t,r){const n=new KI;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new FI;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=e.namedCurve.toLowerCase(),o=O.generateKeyPairSync(s,{publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=o.privateKey,i.data=o.publicKey;return{privateKey:n,publicKey:i}}static async sign(e,t,r){t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const n={key:t.pem},i=O.sign(null,Buffer.from(r),n);return Xk.toArrayBuffer(i)}static async verify(e,t,r,n){t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const i={key:t.pem};return O.verify(null,Buffer.from(n),i,Buffer.from(r))}static async deriveBits(e,t,r){const n=O.createPublicKey({key:e.public.data,format:"der",type:"spki"}),i=O.createPrivateKey({key:t.data,format:"der",type:"pkcs8"}),s=O.diffieHellman({publicKey:n,privateKey:i});return new Uint8Array(s).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return wO.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return QR.parse(t.data,TN.PublicKeyInfo).publicKey;default:throw new xO("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":{const e=t;if(e.d){const e=_O.fromJSON(t,{targetSchema:TN.CurvePrivateKey});return this.importPrivateKey(e,r,n,i)}if(!e.x)throw new TypeError("keyData: Cannot get required 'x' filed");return this.importPublicKey(Zk.FromBase64Url(e.x),r,n,i)}case"raw":return this.importPublicKey(t,r,n,i);case"spki":{const e=QR.parse(new Uint8Array(t),TN.PublicKeyInfo);return this.importPublicKey(e.publicKey,r,n,i)}case"pkcs8":{const e=QR.parse(new Uint8Array(t),TN.PrivateKeyInfo),s=QR.parse(e.privateKey,TN.CurvePrivateKey);return this.importPrivateKey(s,r,n,i)}default:throw new xO("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static importPrivateKey(e,t,r,n){const i=new KI;return i.fromJSON({crv:t.namedCurve,d:Zk.ToBase64Url(e.d)}),i.algorithm=Object.assign({},t),i.extractable=r,i.usages=n,i}static async importPublicKey(e,t,r,n){const i=new FI;return i.fromJSON({crv:t.namedCurve,x:Zk.ToBase64Url(e)}),i.algorithm=Object.assign({},t),i.extractable=r,i.usages=n,i}}HI.publicKeyUsages=["verify"],HI.privateKeyUsages=["sign","deriveKey","deriveBits"];class zI extends GO{async onGenerateKey(e,t,r){const n=await HI.generateKey({name:this.name,namedCurve:e.namedCurve.replace(/^ed/i,"Ed")},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onSign(e,t,r){return HI.sign(e,JN(t),new Uint8Array(r))}async onVerify(e,t,r,n){return HI.verify(e,JN(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return HI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await HI.importKey(e,t,{...r,name:this.name},n,i))}}class VI extends qO{async onGenerateKey(e,t,r){const n=await HI.generateKey({name:this.name,namedCurve:e.namedCurve.toUpperCase()},t,r);return{privateKey:YN(n.privateKey),publicKey:YN(n.publicKey)}}async onDeriveBits(e,t,r){return await HI.deriveBits({...e,public:JN(e.public)},JN(t),r)}async onExportKey(e,t){return HI.exportKey(e,JN(t))}async onImportKey(e,t,r,n,i){return YN(await HI.importKey(e,t,{...r,name:this.name},n,i))}}class qI extends zN{}class GI extends DN{async onDeriveBits(e,t,r){return new Promise(((n,i)=>{const s=Xk.toArrayBuffer(e.salt),o=e.hash.name.replace("-","");O.pbkdf2(JN(t).data,Buffer.from(s),e.iterations,r>>3,o,((e,t)=>{e?i(e):n(new Uint8Array(t).buffer)}))}))}async onImportKey(e,t,r,n,i){if("raw"===e){const e=new qI;return e.data=Buffer.from(t),e.algorithm={name:this.name},e.extractable=!1,e.usages=i,YN(e)}throw new xO("format: Must be 'raw'")}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof qI))throw new TypeError("key: Is not PBKDF CryptoKey")}}class WI extends zN{get alg(){return`HS${this.algorithm.hash.name.toUpperCase().replace("SHA-","")}`}set alg(e){}}rO([SO({name:"k",converter:HN})],WI.prototype,"data",void 0);class XI extends BN{async onGenerateKey(e,t,r){const n=(e.length||this.getDefaultLength(e.hash.name))>>3<<3,i=new WI;return i.algorithm={...e,length:n,name:this.name},i.extractable=t,i.usages=r,i.data=O.randomBytes(n>>3),YN(i)}async onSign(e,t,r){const n=SI.getAlgorithmName(t.algorithm.hash),i=O.createHmac(n,JN(t).data).update(Buffer.from(r)).digest();return new Uint8Array(i).buffer}async onVerify(e,t,r,n){const i=SI.getAlgorithmName(t.algorithm.hash);return 0===O.createHmac(i,JN(t).data).update(Buffer.from(n)).digest().compare(Buffer.from(r))}async onImportKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=_O.fromJSON(t,{targetSchema:WI});break;case"raw":s=new WI,s.data=Buffer.from(t);break;default:throw new xO("format: Must be 'jwk' or 'raw'")}return s.algorithm={hash:{name:r.hash.name},name:this.name,length:s.data.length<<3},s.extractable=n,s.usages=i,YN(s)}async onExportKey(e,t){switch(e.toLowerCase()){case"jwk":return wO.toJSON(JN(t));case"raw":return new Uint8Array(JN(t).data).buffer;default:throw new xO("format: Must be 'jwk' or 'raw'")}}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof WI))throw new TypeError("key: Is not HMAC CryptoKey")}}class JI extends zN{}class YI extends $N{async onImportKey(e,t,r,n,i){if("raw"!==e.toLowerCase())throw new xO("Operation not supported");const s=new JI;return s.data=Buffer.from(t),s.algorithm={name:this.name},s.extractable=n,s.usages=i,YN(s)}async onDeriveBits(e,t,r){const n=e.hash.name.replace("-",""),i=O.createHash(n).digest().length,s=r/8,o=Xk.toUint8Array(e.info),a=O.createHmac(n,Xk.toUint8Array(e.salt)).update(Xk.toUint8Array(JN(t).data)).digest(),c=[Buffer.alloc(0)],l=Math.ceil(s/i)+1;for(let e=1;e<l;++e)c.push(O.createHmac(n,a).update(Buffer.concat([c[e-1],o,Buffer.from([e])])).digest());return Buffer.concat(c).slice(0,s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(JN(e)instanceof JI))throw new TypeError("key: Is not HKDF CryptoKey")}}class ZI{static digest(e,t){const r=O.createHash(e.name.toLowerCase(),{outputLength:e.length}).update(Buffer.from(t)).digest();return new Uint8Array(r).buffer}}class QI extends jN{async onDigest(e,t){return ZI.digest(e,t)}}class eT extends MN{async onDigest(e,t){return ZI.digest(e,t)}}class tT extends FN{constructor(){var e;super(),this.providers.set(new ZN),this.providers.set(new cI),this.providers.set(new lI),this.providers.set(new aI),this.providers.set(new uI),this.providers.set(new hI);R.getCiphers().includes("des-cbc")&&this.providers.set(new dI),this.providers.set(new mI),this.providers.set(new wI),this.providers.set(new _I),this.providers.set(new EI),this.providers.set(new AI),this.providers.set(new LI),this.providers.set(new jI),this.providers.set(new OI),this.providers.set(new NI),this.providers.set(new II),this.providers.set(new TI),this.providers.set(new GI),this.providers.set(new XI),this.providers.set(new YI);const t=null===(e=/^v(\d+)/.exec(T.version))||void 0===e?void 0:e[1];t&&parseInt(t,10)>=12&&(this.providers.set(new QI),this.providers.set(new eT));const r=R.getHashes();r.includes("sha3-256")&&this.providers.set(new PI),r.includes("sha3-384")&&this.providers.set(new BI),r.includes("sha3-512")&&this.providers.set(new DI),t&&parseInt(t,10)>=14&&(this.providers.set(new zI),this.providers.set(new VI))}}global.crypto=new class extends UN{constructor(){super(...arguments),this.subtle=new tT}getRandomValues(e){if(!ArrayBuffer.isView(e))throw new TypeError("Failed to execute 'getRandomValues' on 'Crypto': parameter 1 is not of type 'ArrayBufferView'");const t=Buffer.from(e.buffer,e.byteOffset,e.byteLength);return O.randomFillSync(t),e}};const rT=new class extends Qr{constructor(...[e]){const t=Wg(e||{}),r=(n=t,{...n,useFipsEndpoint:n.useFipsEndpoint??!1,useDualstackEndpoint:n.useDualstackEndpoint??!1,forcePathStyle:n.forcePathStyle??!1,useAccelerateEndpoint:n.useAccelerateEndpoint??!1,useGlobalEndpoint:n.useGlobalEndpoint??!1,disableMultiregionAccessPoints:n.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"});var n;const i=pa(r),s=Ta(i),o=nc(s),a=ho(o);var c;const l=((e,t)=>{const r={...Sf(e),...wi(e),...Rr(e)};return t.forEach((e=>e.configure(r))),{...e,...Ef(r),..._i(r),...Or(r)}})((e=>({...e,eventStreamMarshaller:e.eventStreamSerdeProvider(e)}))(bo((c=a,{...c,forcePathStyle:c.forcePathStyle??!1,useAccelerateEndpoint:c.useAccelerateEndpoint??!1,disableMultiregionAccessPoints:c.disableMultiregionAccessPoints??!1}))),e?.extensions||[]);super(l),this.config=l,this.middlewareStack.use(lc(this.config)),this.middlewareStack.use(ya(this.config)),this.middlewareStack.use(Kr(this.config)),this.middlewareStack.use(Hr(this.config)),this.middlewareStack.use(qr(this.config)),this.middlewareStack.use(vo(this.config)),this.middlewareStack.use(Ui(this.config)),this.middlewareStack.use(Mr(this.config)),this.middlewareStack.use(ia(this.config))}destroy(){super.destroy()}}({region:process.env.STORAGE_S3_REGION});var nT=async({action:e})=>{e("modules_versions.items.create",(async e=>{const t=e.payload.package,r=t.id;if(r)try{const e={Bucket:process.env.STORAGE_S3_BUCKET,Key:t.filename_download},n=await rT.send(new sb(e));await new Promise(((e,t)=>{c.from(n.Body).pipe(bb.Parse()).on("entry",(async e=>{const t=`packages/${r}/${e.path}`,n={Bucket:process.env.STORAGE_S3_BUCKET_PACKAGES,Key:t,Body:e},i=new vb({client:rT,params:n});await i.done()})).on("close",(()=>{e()})).on("error",(e=>{t(new Error(`Error on unzip file: ${e}`))}))})),console.log(`Package ${r} uploaded to S3`)}catch(e){console.log(123,e)}}))};export{nT as default};
